{"nodes":[{"content":"UEFI Requirements: Boot time, Runtime, Hibernation State (S4)","pos":[35,96]},{"content":"UEFI Requirements: Boot time, Runtime, Hibernation State (S4)","pos":[205,266]},{"content":"UEFI Requirements: Boot time, Runtime, Hibernation State (S4)","pos":[275,336]},{"content":"This section describes UEFI and firmware requirements, including:","pos":[339,404]},{"content":"Boot time requirements","pos":[410,432]},{"content":"Runtime requirements","pos":[438,458]},{"content":"Hibernation State (S4) requirements","pos":[464,499]},{"content":"Requirements to Enable UEFI Platforms without CSM","pos":[505,554]},{"pos":[682,704],"content":"Boot time requirements"},{"content":"This section describes UEFI boot time requirements.","pos":[707,758]},{"pos":[881,901],"content":"Display at Boot Time"},{"content":"For a platform that has a console device, the UEFI 2.0 specification requires the firmware to implement the Simple Text Output Protocol.","pos":[903,1039]},{"content":"Optionally, the firmware can also support a graphical protocol.","pos":[1040,1103]},{"content":"UEFI 2.0 defines the Graphic Output Protocol (GOP), and EFI 1.1 defines the Universal Graphics Adapter (UGA) Protocol.","pos":[1104,1222]},{"content":"Windows supports all three protocols, but the user experience with each protocol is different.","pos":[1223,1317]},{"content":"For the best experience, if the firmware implements a graphical protocol, Windows recommends and prefers the GOP.","pos":[1318,1431]},{"content":"Windows requires a graphical protocol to render glyphs for non-English message resources.","pos":[1433,1522]},{"content":"To do so, the firmware must support the following:","pos":[1523,1573]},{"content":"A graphical protocolâ€”either GOP or UGA.","pos":[1579,1618]},{"content":"Either 1024x768 display resolution with 32-bit pixel color or 800x600 display resolution with 24-bit pixel color.","pos":[1624,1737]},{"content":"If the firmware does not support any of these graphics modes, Windows still functions, but all boot display reverts to text mode and English.","pos":[1739,1880]},{"content":"Windows 8.1, Windows Server 2012 R2, Windows 7, Windows Server 2008 R2, and Windows Server 2008 require GOP to display a high-resolution, animated image during boot.","pos":[1882,2047]},{"content":"If GOP is not available, Windows uses the video graphics array (VGA) standard to display a lower resolution image and a simple progress indicator.","pos":[2048,2194]},{"content":"For an optimal boot experience with these versions of Windows, sealed platforms without expansion card slots can safely boot with graphics mode enabled and eliminate transitions to text mode.","pos":[2195,2386]},{"content":"Whenever the firmware boot manager hands off execution to a Windows EFI application, platform firmware and the firmware boot manager must not use the frame buffer for any purpose.","pos":[2388,2567]},{"pos":[2684,2702],"content":"Input at Boot Time"},{"content":"For a platform that has a console device, the UEFI 2.0 specification requires the firmware to implement the Simple Input Protocol.","pos":[2704,2834]},{"content":"Windows supports this protocol for local keyboard input during boot.","pos":[2835,2903]},{"pos":[3002,3014],"content":"Network Boot"},{"content":"Windows implements support for the EFI Preboot eXecution Environment (PXE) Base Code Protocol.","pos":[3016,3110]},{"content":"Windows uses this protocol to boot over the network and support Windows Deployment Services (WDS).","pos":[3111,3209]},{"pos":[3299,3308],"content":"Disk Boot"},{"content":"Windows requires Block I/O Protocol and Device Path Protocol support for the disk that contains the EFI system partition and the Windows OS partition.","pos":[3310,3460]},{"pos":[3619,3651],"content":"Other Firmware Boot Requirements"},{"content":"To ensure proper operation, Windows requires EFI firmware to comply with its indicated specification version.","pos":[3653,3762]},{"content":"EFI firmware must fully implement the appropriate version of the EFI System Table, EFI Boot Services, and EFI Runtime Services.","pos":[3763,3890]},{"content":"Other specific required protocols and specifications include the following:","pos":[3891,3966]},{"content":"<bpt id=\"p1\">**</bpt>Trusted Computing Group (TCG) EFI Specifications<ept id=\"p1\">**</ept>.","pos":[3972,4025]},{"content":"All UEFI platforms that have a Trusted Platform Module (TPM) must implement the TCG EFI Platform and Protocol specifications.","pos":[4026,4151]},{"content":"<bpt id=\"p1\">**</bpt>EFI<ph id=\"ph1\">\\_</ph>PCI<ph id=\"ph2\">\\_</ph>ROOT<ph id=\"ph3\">\\_</ph>BRIDGE<ph id=\"ph4\">\\_</ph>IO<ph id=\"ph5\">\\_</ph>PROTOCOL<ept id=\"p1\">**</ept>.","pos":[4157,4198]},{"content":"Windows uses this protocol if Windows Boot Configuration Data (BCD) specifies IEEE 1394 boot debugging.","pos":[4199,4302]},{"pos":[4424,4444],"content":"Runtime Requirements"},{"content":"Windows minimizes its use of UEFI services during operating system runtime and, wherever possible, relies on runtime firmware such as ACPI and Windows drivers.","pos":[4447,4606]},{"content":"Windows uses the following UEFI Runtime Services to manage NVRAM boot entries and hardware error records after ExitBootServices() is called.","pos":[4607,4747]},{"content":"GetVariable","pos":[4753,4764]},{"content":"GetNextVariableName","pos":[4770,4789]},{"content":"SetVariable","pos":[4795,4806]},{"content":"QueryVariableInfo","pos":[4812,4829]},{"pos":[5029,5075],"content":"Hibernation State (S4) Transition Requirements"},{"content":"This section describes requirements for system and firmware memory that are related to transitions to the hibernation power state (S4).","pos":[5078,5213]},{"pos":[5354,5380],"content":"System Memory Requirements"},{"content":"Platform firmware must ensure that operating system physical memory is consistent across S4 sleep state transitions, in both size and location.","pos":[5382,5525]},{"pos":[5527,5828],"content":"Operating system physical memory is defined according to the ACPI 3.0 specification as any memory that is described by the firmware system address map interface with a memory type other than <bpt id=\"p1\">**</bpt>AddressRangeReserved<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>2<ph id=\"ph2\">\\]</ph>, <bpt id=\"p2\">**</bpt>AddressRangeUnusable<ept id=\"p2\">**</ept> <ph id=\"ph3\">\\[</ph>5<ph id=\"ph4\">\\]</ph>, or <bpt id=\"p3\">**</bpt>Undefined<ept id=\"p3\">**</ept> <ph id=\"ph5\">\\[</ph>any value greater than 5<ph id=\"ph6\">\\]</ph>."},{"pos":[5975,6003],"content":"Firmware Memory Requirements"},{"content":"On a UEFI platform, firmware runtime memory must be consistent across S4 sleep state transitions, in both size and location.","pos":[6005,6129]},{"content":"Runtime memory is defined according to the UEFI specification as any memory that is described by the GetMemoryMap() boot service, with the attribute <bpt id=\"p1\">**</bpt>EFI<ph id=\"ph1\">\\_</ph>MEMORY<ph id=\"ph2\">\\_</ph>RUNTIME<ept id=\"p1\">**</ept>.","pos":[6130,6304]},{"pos":[6513,6562],"content":"Requirements to Enable UEFI Platforms without CSM"},{"content":"First-generation 64-bit UEFI platforms typically contain some form of limited BIOS emulation such as a CSM to preserve the ability to run 32-bit operating systems and operating systems that do not support UEFI.","pos":[6565,6775]},{"content":"Existing Windows dependencies on INT 10 video BIOS functions also require a CSM.","pos":[6776,6856]},{"content":"To reduce the need for a CSM and improve boot times in the future, we are collaborating with the industry to eliminate this dependency and encourage changes to system firmware.","pos":[6858,7034]},{"content":"Firmware requirements:","pos":[7036,7058]},{"content":"<bpt id=\"p1\">**</bpt>GOP<ept id=\"p1\">**</ept>.","pos":[7060,7068]},{"content":"Windows uses the GOP to obtain a frame buffer pointer at boot time for use during operating system runtime.","pos":[7069,7176]},{"content":"GOP support is essential to replace VGA support and avoid the requirement for a CSM in future versions of Windows.","pos":[7177,7291]},{"content":"<bpt id=\"p1\">**</bpt>EFI Capsule Services<ept id=\"p1\">**</ept>.","pos":[7293,7318]},{"content":"Windows can use the EFI UpdateCapsule() service to persist information across a system restart and pass that information to the firmware.","pos":[7319,7456]},{"content":"This would potentially let the system report and/or respond to certain error conditions if the boot device or operating system were damaged or otherwise unavailable.","pos":[7457,7622]},{"pos":[7757,7781],"content":"Firmware recommendations"},{"content":"Note to firmware manufacturers: We recommend that when Secure Boot is disabled, then the firmware should trigger the following actions, to provide a better support experience for previous versions of Windows:","pos":[7783,7991]},{"content":"Enable the CSM for VGA support, though not BIOS mode emulation.","pos":[7997,8060]},{"content":"Enable messages during the POST process to show which keys open the boot menus.","pos":[8066,8145]}],"content":"---\nauthor: Justinha\nDescription: 'UEFI Requirements: Boot time, Runtime, Hibernation State (S4)'\nms.assetid: 8fad2f32-6ff5-49db-9d34-041485a34a4c\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: 'UEFI Requirements: Boot time, Runtime, Hibernation State (S4)'\n---\n\n# UEFI Requirements: Boot time, Runtime, Hibernation State (S4)\n\n\nThis section describes UEFI and firmware requirements, including:\n\n-   Boot time requirements\n\n-   Runtime requirements\n\n-   Hibernation State (S4) requirements\n\n-   Requirements to Enable UEFI Platforms without CSM\n\n## <span id=\"Boot_time_requirements\"></span><span id=\"boot_time_requirements\"></span><span id=\"BOOT_TIME_REQUIREMENTS\"></span>Boot time requirements\n\n\nThis section describes UEFI boot time requirements.\n\n### <span id=\"Display_at_Boot_Time\"></span><span id=\"display_at_boot_time\"></span><span id=\"DISPLAY_AT_BOOT_TIME\"></span>Display at Boot Time\n\nFor a platform that has a console device, the UEFI 2.0 specification requires the firmware to implement the Simple Text Output Protocol. Optionally, the firmware can also support a graphical protocol. UEFI 2.0 defines the Graphic Output Protocol (GOP), and EFI 1.1 defines the Universal Graphics Adapter (UGA) Protocol. Windows supports all three protocols, but the user experience with each protocol is different. For the best experience, if the firmware implements a graphical protocol, Windows recommends and prefers the GOP.\n\nWindows requires a graphical protocol to render glyphs for non-English message resources. To do so, the firmware must support the following:\n\n1.  A graphical protocolâ€”either GOP or UGA.\n\n2.  Either 1024x768 display resolution with 32-bit pixel color or 800x600 display resolution with 24-bit pixel color.\n\nIf the firmware does not support any of these graphics modes, Windows still functions, but all boot display reverts to text mode and English.\n\nWindows 8.1, Windows Server 2012 R2, Windows 7, Windows Server 2008 R2, and Windows Server 2008 require GOP to display a high-resolution, animated image during boot. If GOP is not available, Windows uses the video graphics array (VGA) standard to display a lower resolution image and a simple progress indicator. For an optimal boot experience with these versions of Windows, sealed platforms without expansion card slots can safely boot with graphics mode enabled and eliminate transitions to text mode.\n\nWhenever the firmware boot manager hands off execution to a Windows EFI application, platform firmware and the firmware boot manager must not use the frame buffer for any purpose.\n\n### <span id=\"Input_at_Boot_Time\"></span><span id=\"input_at_boot_time\"></span><span id=\"INPUT_AT_BOOT_TIME\"></span>Input at Boot Time\n\nFor a platform that has a console device, the UEFI 2.0 specification requires the firmware to implement the Simple Input Protocol. Windows supports this protocol for local keyboard input during boot.\n\n### <span id=\"Network_Boot\"></span><span id=\"network_boot\"></span><span id=\"NETWORK_BOOT\"></span>Network Boot\n\nWindows implements support for the EFI Preboot eXecution Environment (PXE) Base Code Protocol. Windows uses this protocol to boot over the network and support Windows Deployment Services (WDS).\n\n### <span id=\"Disk_Boot\"></span><span id=\"disk_boot\"></span><span id=\"DISK_BOOT\"></span>Disk Boot\n\nWindows requires Block I/O Protocol and Device Path Protocol support for the disk that contains the EFI system partition and the Windows OS partition.\n\n### <span id=\"Other_Firmware_Boot_Requirements\"></span><span id=\"other_firmware_boot_requirements\"></span><span id=\"OTHER_FIRMWARE_BOOT_REQUIREMENTS\"></span>Other Firmware Boot Requirements\n\nTo ensure proper operation, Windows requires EFI firmware to comply with its indicated specification version. EFI firmware must fully implement the appropriate version of the EFI System Table, EFI Boot Services, and EFI Runtime Services. Other specific required protocols and specifications include the following:\n\n-   **Trusted Computing Group (TCG) EFI Specifications**. All UEFI platforms that have a Trusted Platform Module (TPM) must implement the TCG EFI Platform and Protocol specifications.\n\n-   **EFI\\_PCI\\_ROOT\\_BRIDGE\\_IO\\_PROTOCOL**. Windows uses this protocol if Windows Boot Configuration Data (BCD) specifies IEEE 1394 boot debugging.\n\n## <span id=\"Runtime_Requirements\"></span><span id=\"runtime_requirements\"></span><span id=\"RUNTIME_REQUIREMENTS\"></span>Runtime Requirements\n\n\nWindows minimizes its use of UEFI services during operating system runtime and, wherever possible, relies on runtime firmware such as ACPI and Windows drivers. Windows uses the following UEFI Runtime Services to manage NVRAM boot entries and hardware error records after ExitBootServices() is called.\n\n-   GetVariable\n\n-   GetNextVariableName\n\n-   SetVariable\n\n-   QueryVariableInfo\n\n## <span id=\"Hibernation_State__S4__Transition_Requirements\"></span><span id=\"hibernation_state__s4__transition_requirements\"></span><span id=\"HIBERNATION_STATE__S4__TRANSITION_REQUIREMENTS\"></span>Hibernation State (S4) Transition Requirements\n\n\nThis section describes requirements for system and firmware memory that are related to transitions to the hibernation power state (S4).\n\n### <span id=\"System_Memory_Requirements\"></span><span id=\"system_memory_requirements\"></span><span id=\"SYSTEM_MEMORY_REQUIREMENTS\"></span>System Memory Requirements\n\nPlatform firmware must ensure that operating system physical memory is consistent across S4 sleep state transitions, in both size and location.\n\nOperating system physical memory is defined according to the ACPI 3.0 specification as any memory that is described by the firmware system address map interface with a memory type other than **AddressRangeReserved** \\[2\\], **AddressRangeUnusable** \\[5\\], or **Undefined** \\[any value greater than 5\\].\n\n### <span id=\"Firmware_Memory_Requirements\"></span><span id=\"firmware_memory_requirements\"></span><span id=\"FIRMWARE_MEMORY_REQUIREMENTS\"></span>Firmware Memory Requirements\n\nOn a UEFI platform, firmware runtime memory must be consistent across S4 sleep state transitions, in both size and location. Runtime memory is defined according to the UEFI specification as any memory that is described by the GetMemoryMap() boot service, with the attribute **EFI\\_MEMORY\\_RUNTIME**.\n\n## <span id=\"Requirements_to_Enable_UEFI_Platforms_without_CSM\"></span><span id=\"requirements_to_enable_uefi_platforms_without_csm\"></span><span id=\"REQUIREMENTS_TO_ENABLE_UEFI_PLATFORMS_WITHOUT_CSM\"></span>Requirements to Enable UEFI Platforms without CSM\n\n\nFirst-generation 64-bit UEFI platforms typically contain some form of limited BIOS emulation such as a CSM to preserve the ability to run 32-bit operating systems and operating systems that do not support UEFI. Existing Windows dependencies on INT 10 video BIOS functions also require a CSM.\n\nTo reduce the need for a CSM and improve boot times in the future, we are collaborating with the industry to eliminate this dependency and encourage changes to system firmware.\n\nFirmware requirements:\n\n**GOP**. Windows uses the GOP to obtain a frame buffer pointer at boot time for use during operating system runtime. GOP support is essential to replace VGA support and avoid the requirement for a CSM in future versions of Windows.\n\n**EFI Capsule Services**. Windows can use the EFI UpdateCapsule() service to persist information across a system restart and pass that information to the firmware. This would potentially let the system report and/or respond to certain error conditions if the boot device or operating system were damaged or otherwise unavailable.\n\n### <span id=\"Firmware_recommendations\"></span><span id=\"firmware_recommendations\"></span><span id=\"FIRMWARE_RECOMMENDATIONS\"></span>Firmware recommendations\n\nNote to firmware manufacturers: We recommend that when Secure Boot is disabled, then the firmware should trigger the following actions, to provide a better support experience for previous versions of Windows:\n\n-   Enable the CSM for VGA support, though not BIOS mode emulation.\n\n-   Enable messages during the POST process to show which keys open the boot menus.\n\n \n\n \n\n\n\n\n\n"}