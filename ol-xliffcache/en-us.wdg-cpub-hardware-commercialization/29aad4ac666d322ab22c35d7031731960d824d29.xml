{"nodes":[{"content":"Using CLR 4.0 NGEN PDB Support","pos":[11,41]},{"content":"Using CLR 4.0 NGEN PDB Support","pos":[55,85]},{"content":"Using CLR 4.0 NGEN PDB Support","pos":[274,304]},{"content":"Both Xperf and Windows Performance Recorder (WPR) can run with Common Language Runtime (CLR) 4.0 Native Image Generator (NGEN) PDB support enabled.","pos":[307,454]},{"pos":[456,566],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  WPR handles CLR symbols directly, so no flags are necessary when configuring and using NGEN support."},{"content":"When you start a recording in the WPR user interface (UI), NGEN program database files (PDBs) are generated next to the saved recording.","pos":[571,707]},{"content":"These PDBs decode symbols of modules that were created by using NGEN for managed scenarios.","pos":[708,799]},{"content":"For <bpt id=\"p1\">**</bpt>Recording.etl<ept id=\"p1\">**</ept>, the NGEN PDBs are in the <bpt id=\"p2\">**</bpt>Recording.etl.NGENPDB<ept id=\"p2\">**</ept> folder.","pos":[800,881]},{"content":"Using NGEN support with WPR","pos":[886,913]},{"content":"We recommend the following setup before running WPR with NGEN support enabled:","pos":[916,994]},{"content":"(Optional, but recommended) Set the SymCache path environment variable to a local directory","pos":[1000,1091]},{"content":"Using NGEN support with Xperf","pos":[1096,1125]},{"content":"To use NGEN support with Xperf, do the following:","pos":[1128,1177]},{"content":"At an elevated command prompt, type the following:","pos":[1183,1233]},{"content":"Type the following to start the kernel session:","pos":[1354,1401]},{"content":"Type the following to start the CLR runtime session recording:","pos":[1483,1545]},{"content":"Run your scenario.","pos":[1680,1698]},{"content":"Type the following to start the CLR rundown session:","pos":[1704,1756]},{"content":"Type the following to allow time for CLR rundown to complete by setting the timeout to 15:","pos":[1950,2040]},{"content":"Type the following to stop the CLR runtime session, CLR rundown session, and kernel session, and to merge them into a single file:","pos":[2088,2218]},{"content":"Decoding a recording that has CLR 4.0 NGEN PDB support enabled","pos":[2315,2377]},{"content":"At an elevated command prompt, type the following:","pos":[2380,2430]},{"content":"Transferring a recording that has CLR 4.0 NGEN PDB support enabled","pos":[2538,2604]},{"content":"To transfer a recording with CLR 4.0 NGEN PDB support enabled, include the following in the symbol path:","pos":[2607,2711]},{"pos":[2749,2925],"content":"To transfer the recording to a different computer, make sure that both <bpt id=\"p1\">**</bpt>Recording.etl<ept id=\"p1\">**</ept> and the entire folder <bpt id=\"p2\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Symbols.NGEN<ept id=\"p2\">**</ept> (along with its subfolders) are transferred."},{"content":"Related topics","pos":[2930,2944]},{"content":"Symbol Support","pos":[2948,2962]},{"content":"symbols","pos":[2985,2992]}],"content":"---\ntitle: Using CLR 4.0 NGEN PDB Support\ndescription: Using CLR 4.0 NGEN PDB Support\nMSHAttr:\n- 'PreferredSiteName:MSDN'\n- 'PreferredLib:/library/windows/hardware'\nms.assetid: 0297661e-99bf-44fa-9d1c-f624d6a96f41\nms.prod: W10\nms.mktglfcycl: operate\nms.sitesec: msdn\n---\n\n# Using CLR 4.0 NGEN PDB Support\n\n\nBoth Xperf and Windows Performance Recorder (WPR) can run with Common Language Runtime (CLR) 4.0 Native Image Generator (NGEN) PDB support enabled.\n\n**Note**  WPR handles CLR symbols directly, so no flags are necessary when configuring and using NGEN support.\n\n \n\nWhen you start a recording in the WPR user interface (UI), NGEN program database files (PDBs) are generated next to the saved recording. These PDBs decode symbols of modules that were created by using NGEN for managed scenarios. For **Recording.etl**, the NGEN PDBs are in the **Recording.etl.NGENPDB** folder.\n\n## Using NGEN support with WPR\n\n\nWe recommend the following setup before running WPR with NGEN support enabled:\n\n-   (Optional, but recommended) Set the SymCache path environment variable to a local directory\n\n## Using NGEN support with Xperf\n\n\nTo use NGEN support with Xperf, do the following:\n\n1.  At an elevated command prompt, type the following:\n\n    ``` syntax\n    set _NT_SYMBOL_PATH=srv*C:\\Symbols.NGEN;srv*http://msdl.microsoft.com/download/symbols\n    ```\n\n2.  Type the following to start the kernel session:\n\n    ``` syntax\n    xperf -on Base -stackwalk Profile -f kernel.etl\n    ```\n\n3.  Type the following to start the CLR runtime session recording:\n\n    ``` syntax\n    xperf -start ClrSession -on ClrAll:0x98:5 -f clr.etl -buffersize 128 -minbuffers 256 -maxbuffers 512\n    ```\n\n4.  Run your scenario.\n\n5.  Type the following to start the CLR rundown session:\n\n    ``` syntax\n    xperf -start ClrRundownSession -on ClrAll:0x118:5+a669021c-c450-4609-a035-5af59af4df18:0x118:5 -f clr_DCend.etl -buffersize 128 -minbuffers 256 -maxbuffers 512\n    ```\n\n6.  Type the following to allow time for CLR rundown to complete by setting the timeout to 15:\n\n    ``` syntax\n    timeout /t 15\n    ```\n\n7.  Type the following to stop the CLR runtime session, CLR rundown session, and kernel session, and to merge them into a single file:\n\n    ``` syntax\n    xperf -stop ClrSession ClrRundownSession -stop -d recording.etl\n    ```\n\n## Decoding a recording that has CLR 4.0 NGEN PDB support enabled\n\n\nAt an elevated command prompt, type the following:\n\n``` syntax\nset _NT_SYMBOL_PATH=srv*C:\\Symbols.NGEN;srv*http://msdl.microsoft.com/download/symbols\n```\n\n## Transferring a recording that has CLR 4.0 NGEN PDB support enabled\n\n\nTo transfer a recording with CLR 4.0 NGEN PDB support enabled, include the following in the symbol path:\n\n``` syntax\nsrv*C:\\Symbols.NGEN\n```\n\nTo transfer the recording to a different computer, make sure that both **Recording.etl** and the entire folder **C:\\\\Symbols.NGEN** (along with its subfolders) are transferred.\n\n## Related topics\n\n\n[Symbol Support](symbol-support.md)\n\n[symbols](symbols.md)\n\n \n\n \n\n\n\n\n\n\n\n"}