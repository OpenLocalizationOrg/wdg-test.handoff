{"nodes":[{"content":"Lab 1f: Build a retail image","pos":[183,211]},{"content":"Lab 1f: Build a retail image","pos":[220,248]},{"content":"This content has been tested on Windows 10 IoT Core Build 10586.","pos":[253,317]},{"content":"Some of these procedures do not yet work on newer preview builds, including Windows 10, version 1607.","pos":[318,419]},{"content":"We''ll take our test image and convert it to a retail build.","pos":[423,483]},{"pos":[585,598],"content":"Prerequisites"},{"content":"We'll start with the ProjectA image we created from <bpt id=\"p1\">[</bpt>Lab 1a: Create a basic image<ept id=\"p1\">](create-a-basic-image.md)</ept>.","pos":[601,709]},{"content":"You can include any of the updates from <bpt id=\"p1\">[</bpt>Lab 1b: Add an app to your image<ept id=\"p1\">](deploy-your-app-with-a-standard-board.md)</ept>, <bpt id=\"p2\">[</bpt>Lab 1c:  Add a file and a registry setting to an image<ept id=\"p2\">](add-a-registry-setting-to-an-image.md)</ept>, <bpt id=\"p3\">[</bpt>Lab 1d: Add a provisioning package to an image<ept id=\"p3\">](add-a-provisioning-package-to-an-image.md)</ept>, and <bpt id=\"p4\">[</bpt>Lab 1e: Add a driver to an image<ept id=\"p4\">](add-a-driver-to-an-image.md)</ept>.","pos":[710,1086]},{"pos":[1283,1328],"content":"Add your app to the retail configuration file"},{"pos":[1335,1469],"content":"Open your product's retail configuration file: <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>IoT-ADK-AddonKit<ph id=\"ph2\">\\\\</ph>Source-<ph id=\"ph3\">&amp;lt;</ph>arch<ph id=\"ph4\">&amp;gt;\\\\</ph>Products<ph id=\"ph5\">\\\\</ph>ProductA<ph id=\"ph6\">\\\\</ph>RetailOEMInput.xml<ept id=\"p1\">**</ept>.."},{"content":"Add your feature manifest, OEMFM.xml, into the list of AdditionalFMs.","pos":[1475,1544]},{"content":"At the same time, add the feature manifest: OEMCommonFM.xml, which contains the OEM<ph id=\"ph1\">\\_</ph>CustomCmd package that configures your app on the first boot:","pos":[1545,1691]},{"content":"Add the FeatureIDs for the your app package, the  and the OEM<ph id=\"ph1\">\\_</ph>CustomCmd package.","pos":[2049,2130]},{"content":"OEM_CustomCmd is required to trigger the app installation.","pos":[2478,2536]},{"content":"OEM_ProvAuto is required to pull in the provisioning package.","pos":[2546,2607]},{"content":"OEM_FileAndRegKey, OEM_AppxHelloWorld, and OEM_DriverHelloBlinky were sample packages added in previous labs.","pos":[2617,2726]},{"content":"To support your apps, add the FeatureIDs for IOT_UAP_OOBE and IOT_APP_TOOLKIT from the main list of Microsoft features:","pos":[2732,2851]},{"pos":[3259,3285],"content":"Build and create the image"},{"content":"Build the image","pos":[3289,3304]},{"content":"From the IoT Core Shell, create the image:","pos":[3312,3354]},{"content":"This creates the product binaries at C:<ph id=\"ph1\">\\\\</ph>IoT-ADK-AddonKit<ph id=\"ph2\">\\\\</ph>Build<ph id=\"ph3\">\\\\&amp;lt;</ph>arch<ph id=\"ph4\">&amp;gt;\\\\</ph>ProductA<ph id=\"ph5\">\\\\</ph>Retail<ph id=\"ph6\">\\\\</ph>Flash.FFU.","pos":[3416,3524]},{"content":"Start <bpt id=\"p1\">**</bpt>Windows IoT Core Dashboard<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Setup a new device<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Custom<ept id=\"p3\">**</ept>, and browse to your image.","pos":[3530,3637]},{"content":"Put the Micro SD card in the device, select it, accept the license terms, and click <bpt id=\"p1\">**</bpt>Install<ept id=\"p1\">**</ept>.","pos":[3638,3734]},{"content":"This replaces the previous image with our new image.","pos":[3735,3787]},{"content":"Put the card into the IoT device and start it up.","pos":[3792,3841]},{"content":"After a short while, the device should start automatically, and you should see your app.","pos":[3847,3935]},{"content":"Check to see if everything is working","pos":[3939,3976]},{"content":"With retail builds, you won't be able to log into the device using the SSH clients or by using the web interface.","pos":[3980,4093]},{"content":"However, any files and reg keys that your app relies on should still work.","pos":[4094,4168]},{"pos":[4263,4273],"content":"Next steps"},{"content":"Congratulations!","pos":[4276,4292]},{"content":"That's it for the first lab.","pos":[4295,4323]},{"content":"From here, you can continue on to:","pos":[4326,4360]},{"content":"Lab 2a: Replace a driver in an existing board support package","pos":[4365,4426]}],"content":"---\nauthor: kpacquer\nDescription: 'We''ll take our test image and convert it to a retail build.'\nMS-HAID: 'p\\_iot\\_core.build\\_retail\\_image'\nMSHAttr: 'PreferredLib:/library'\ntitle: 'Lab 1f: Build a retail image'\n---\n\n# Lab 1f: Build a retail image\n\n\n\\[This content has been tested on Windows 10 IoT Core Build 10586. Some of these procedures do not yet work on newer preview builds, including Windows 10, version 1607.\\]\n\nWe''ll take our test image and convert it to a retail build. \n\n## <span id=\"Prerequisites\"></span><span id=\"prerequisites\"></span><span id=\"PREREQUISITES\"></span>Prerequisites\n\n\nWe'll start with the ProjectA image we created from [Lab 1a: Create a basic image](create-a-basic-image.md).\nYou can include any of the updates from [Lab 1b: Add an app to your image](deploy-your-app-with-a-standard-board.md), [Lab 1c:  Add a file and a registry setting to an image](add-a-registry-setting-to-an-image.md), [Lab 1d: Add a provisioning package to an image](add-a-provisioning-package-to-an-image.md), and [Lab 1e: Add a driver to an image](add-a-driver-to-an-image.md).\n\n## <span id=\"Add_your_app_to_the_retail_configuration_file\"></span><span id=\"add_your_app_to_the_retail_configuration_file\"></span><span id=\"ADD_YOUR_APP_TO_THE_RETAIL_CONFIGURATION_FILE\"></span>Add your app to the retail configuration file\n\n\n1.  Open your product's retail configuration file: **C:\\\\IoT-ADK-AddonKit\\\\Source-&lt;arch&gt;\\\\Products\\\\ProductA\\\\RetailOEMInput.xml**..\n\n2.  Add your feature manifest, OEMFM.xml, into the list of AdditionalFMs. At the same time, add the feature manifest: OEMCommonFM.xml, which contains the OEM\\_CustomCmd package that configures your app on the first boot:\n\n    ``` syntax\n    <AdditionalFMs>\n        <AdditionalFM>%AKROOT%\\FMFiles\\arm\\IoTUAPRPi2FM.xml</AdditionalFM>\n        <AdditionalFM>%AKROOT%\\FMFiles\\arm\\RPi2FM.xml</AdditionalFM>\n        <AdditionalFM>%SRC_DIR%\\Packages\\OEMFM.xml</AdditionalFM>\n        <AdditionalFM>%COMMON_DIR%\\Packages\\OEMCommonFM.xml</AdditionalFM>\n      </AdditionalFMs>\n    ```\n\n3.  Add the FeatureIDs for the your app package, the  and the OEM\\_CustomCmd package.\n\n    ``` syntax\n    <OEM> \n    <Feature>RPI2_DRIVERS</Feature> \n    <Feature>RPI2_DEVICE_TARGETINGINFO</Feature> \n    <Feature>OEM_AppxHelloWorld</Feature> \n    <Feature>OEM_FileAndRegKey</Feature> \n    <Feature>OEM_CustomCmd</Feature> \n    <Feature>OEM_ProvAuto</Feature>\n    <Feature>OEM_DriverHelloBlinky</Feature> \n    </OEM>\n    ```\n    \n    OEM_CustomCmd is required to trigger the app installation.\n    \n    OEM_ProvAuto is required to pull in the provisioning package.\n    \n    OEM_FileAndRegKey, OEM_AppxHelloWorld, and OEM_DriverHelloBlinky were sample packages added in previous labs.\n\n4.  To support your apps, add the FeatureIDs for IOT_UAP_OOBE and IOT_APP_TOOLKIT from the main list of Microsoft features:\n\n    ```\n      <Features>\n        <Microsoft> \n         <Feature>IOT_EFIESP</Feature> \n         <Feature>IOT_DMAP_DRIVER</Feature> \n         <Feature>IOT_UAP_OOBE</Feature> \n         <Feature>IOT_APP_TOOLKIT</Feature> \n        </Microsoft>\n       </Features>\n    ```\n\n### <span id=\"Build_and_create_the_image\"></span><span id=\"build_and_create_the_image\"></span><span id=\"BUILD_AND_CREATE_THE_IMAGE\"></span>Build and create the image\n\n**Build the image**\n\n1.  From the IoT Core Shell, create the image:\n\n    ``` syntax\n    createimage ProductA Retail\n    ```\n\n    This creates the product binaries at C:\\\\IoT-ADK-AddonKit\\\\Build\\\\&lt;arch&gt;\\\\ProductA\\\\Retail\\\\Flash.FFU.\n\n2.  Start **Windows IoT Core Dashboard** &gt; **Setup a new device** &gt; **Custom**, and browse to your image. Put the Micro SD card in the device, select it, accept the license terms, and click **Install**. This replaces the previous image with our new image.\n3.  Put the card into the IoT device and start it up.\n\n    After a short while, the device should start automatically, and you should see your app.\n\n**Check to see if everything is working**\n\nWith retail builds, you won't be able to log into the device using the SSH clients or by using the web interface. However, any files and reg keys that your app relies on should still work.\n\n\n\n\n## <span id=\"Next_steps\"></span><span id=\"next_steps\"></span><span id=\"NEXT_STEPS\"></span>Next steps\n**Congratulations!**\nThat's it for the first lab. \n\nFrom here, you can continue on to:\n-  [Lab 2a: Replace a driver in an existing board support package](replace-a-driver-in-an-existing-bsp.md)\n\n\n\n "}