{"nodes":[{"content":"Reduce the Size of the Component Store in an Offline Windows Image","pos":[34,100]},{"content":"Reduce the Size of the Component Store in an Offline Windows Image","pos":[207,273]},{"content":"Reduce the Size of the Component Store in an Offline Windows Image","pos":[281,347]},{"content":"You can use the Deployment Image Servicing and Management (DISM) tool to mount a Windows image from a WIM, VHD, or VHDX file and modify it.","pos":[350,489]},{"pos":[803,887],"content":"Analyze and clean up the Component Store (WinSxS folder) in an offline Windows image"},{"content":"To complete the walkthrough, you need the following:","pos":[890,942]},{"content":"A computer running Windows 10, Windows 8.1, Windows 8, Windows 7, Windows Server 2016 Technical Preview, Windows Server 2012 R2, Windows Server 2012, or Windows Server 2008 R2 with the Windows 8.1 version of the Windows ADK tools installed on it.","pos":[948,1194]},{"content":"A .wim, .vhd, or .vhdx file of a Windows 10 or Windows Server 2016 Technical Preview image.","pos":[1200,1291]},{"content":"Analyze the size of the Component Store in an offline Windows image","pos":[1295,1362]},{"content":"Copy a .wim file, a .vhd, or a .vhdx that contains a Windows image, to the local drive.","pos":[1370,1457]},{"content":"For example, C:<ph id=\"ph1\">\\\\</ph>test<ph id=\"ph2\">\\\\</ph>images.","pos":[1458,1488]},{"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, and type <bpt id=\"p2\">**</bpt>deployment<ept id=\"p2\">**</ept>.","pos":[1494,1535]},{"content":"Right-click <bpt id=\"p1\">**</bpt>Deployment and Imaging Tools Environment<ept id=\"p1\">**</ept> and then select <bpt id=\"p2\">**</bpt>Run as administrator<ept id=\"p2\">**</ept>.","pos":[1536,1634]},{"content":"Create a folder for your mounted image.","pos":[1640,1679]},{"content":"For example, C:<ph id=\"ph1\">\\\\</ph>test<ph id=\"ph2\">\\\\</ph>offline.","pos":[1680,1711]},{"content":"Run the <bpt id=\"p1\">**</bpt>DISM /Get-ImageInfo<ept id=\"p1\">**</ept> command to retrieve the name or index number for the image that you want to update.","pos":[1717,1832]},{"content":"For example:","pos":[1833,1845]},{"content":"Mount the Windows image.","pos":[1937,1961]},{"content":"For example:","pos":[1962,1974]},{"content":"Since WIM files can contain one or more images, you must specify an index or name value.","pos":[2099,2187]},{"content":"To mount an image from a VHD, you must specify <ph id=\"ph1\">`/Index:1`</ph>.","pos":[2188,2246]},{"content":"Analyze the size of the component store.","pos":[2252,2292]},{"content":"For example:","pos":[2293,2305]},{"pos":[2405,2569],"content":"To understand the different values provided in the display, see <bpt id=\"p1\">[</bpt>Determine the Actual Size of the WinSxS Folder<ept id=\"p1\">](determine-the-actual-size-of-the-winsxs-folder.md)</ept>."},{"content":"If the component store cleanup was recommended in the displayed report, then you can start cleanup of the image.","pos":[2575,2687]},{"content":"For example:","pos":[2688,2700]},{"content":"You can reduce the size of the component store further by adding the /ResetBase parameter.","pos":[2800,2890]},{"content":"For example:","pos":[2891,2903]},{"content":"If DISM /Resetbase is a long-running operation, you can specify the /Defer parameter with /Resetbase to defer any long-running cleanup operations to the next automatic maintenance.","pos":[3018,3198]},{"content":"But we highly recommend you <bpt id=\"p1\">**</bpt>only<ept id=\"p1\">**</ept> use /Defer as an option in the factory where DISM /Resetbase requires more than 30 minutes to complete.","pos":[3199,3339]},{"content":"Commit the changes and unmounts the image in order to save the changes that you’ve made.","pos":[3349,3437]},{"content":"For example:","pos":[3438,3450]},{"pos":[3570,3584],"content":"Related topics"},{"content":"Manage the Component Store","pos":[3588,3614]},{"content":"Clean Up the WinSxS Folder","pos":[3649,3675]},{"content":"Determine the Actual Size of the WinSxS Folder","pos":[3710,3756]},{"content":"Where Did My Space Go?","pos":[3811,3833]},{"content":"(blog post)","pos":[3834,3845]},{"content":"NTFS Metafiles blog post","pos":[3931,3955]},{"content":"How to create and manipulate NTFS junction points","pos":[4034,4083]},{"content":"DISM Operating System Package Servicing Command-Line Options","pos":[4127,4187]}],"content":"---\nauthor: Justinha\nDescription: Reduce the Size of the Component Store in an Offline Windows Image\nms.assetid: 2cdff215-30b9-4360-9e2c-cc2c3d695608\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: Reduce the Size of the Component Store in an Offline Windows Image\n---\n\n# Reduce the Size of the Component Store in an Offline Windows Image\n\n\nYou can use the Deployment Image Servicing and Management (DISM) tool to mount a Windows image from a WIM, VHD, or VHDX file and modify it.\n\n## <span id=\"Analyze_and_clean_up_the_Component_Store__WinSxS_folder__in_an_offline_Windows_image\"></span><span id=\"analyze_and_clean_up_the_component_store__winsxs_folder__in_an_offline_windows_image\"></span><span id=\"ANALYZE_AND_CLEAN_UP_THE_COMPONENT_STORE__WINSXS_FOLDER__IN_AN_OFFLINE_WINDOWS_IMAGE\"></span>Analyze and clean up the Component Store (WinSxS folder) in an offline Windows image\n\n\nTo complete the walkthrough, you need the following:\n\n-   A computer running Windows 10, Windows 8.1, Windows 8, Windows 7, Windows Server 2016 Technical Preview, Windows Server 2012 R2, Windows Server 2012, or Windows Server 2008 R2 with the Windows 8.1 version of the Windows ADK tools installed on it.\n\n-   A .wim, .vhd, or .vhdx file of a Windows 10 or Windows Server 2016 Technical Preview image.\n\n**Analyze the size of the Component Store in an offline Windows image**\n\n1.  Copy a .wim file, a .vhd, or a .vhdx that contains a Windows image, to the local drive. For example, C:\\\\test\\\\images.\n\n2.  Click **Start**, and type **deployment**. Right-click **Deployment and Imaging Tools Environment** and then select **Run as administrator**.\n\n3.  Create a folder for your mounted image. For example, C:\\\\test\\\\offline.\n\n4.  Run the **DISM /Get-ImageInfo** command to retrieve the name or index number for the image that you want to update. For example:\n\n    ``` syntax\n    Dism /Get-ImageInfo /ImageFile:C:\\test\\images\\MyImage.wim\n    ```\n\n5.  Mount the Windows image. For example:\n\n    ``` syntax\n    Dism /Mount-Image /ImageFile:C:\\test\\images\\MyImage.wim /Index:1 /MountDir:C:\\test\\offline\n    ```\n\n    Since WIM files can contain one or more images, you must specify an index or name value. To mount an image from a VHD, you must specify `/Index:1`.\n\n6.  Analyze the size of the component store. For example:\n\n    ``` syntax\n    Dism /Image:C:\\test\\offline /Cleanup-Image /AnalyzeComponentStore\n    ```\n\n    To understand the different values provided in the display, see [Determine the Actual Size of the WinSxS Folder](determine-the-actual-size-of-the-winsxs-folder.md).\n\n7.  If the component store cleanup was recommended in the displayed report, then you can start cleanup of the image. For example:\n\n    ``` syntax\n    Dism /Image:C:\\test\\offline /Cleanup-Image /StartComponentCleanup\n    ```\n\n8.  You can reduce the size of the component store further by adding the /ResetBase parameter. For example:\n\n    ``` syntax\n    Dism /Image:C:\\test\\offline /Cleanup-Image /StartComponentCleanup /ResetBase\n    ```\n    \n    If DISM /Resetbase is a long-running operation, you can specify the /Defer parameter with /Resetbase to defer any long-running cleanup operations to the next automatic maintenance. But we highly recommend you **only** use /Defer as an option in the factory where DISM /Resetbase requires more than 30 minutes to complete.\n    \n9.  Commit the changes and unmounts the image in order to save the changes that you’ve made. For example:\n\n    ``` syntax\n    Dism /Unmount-Image /MountDir:C:\\test\\offline /Commit\n    ```\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[Manage the Component Store](manage-the-component-store.md)\n\n[Clean Up the WinSxS Folder](clean-up-the-winsxs-folder.md)\n\n[Determine the Actual Size of the WinSxS Folder](determine-the-actual-size-of-the-winsxs-folder.md)\n\n[Where Did My Space Go? (blog post)](http://blogs.technet.com/b/askcore/archive/2013/03/01/where-did-my-space-go.aspx)\n\n[NTFS Metafiles blog post](http://blogs.technet.com/b/askcore/archive/2009/12/30/ntfs-metafiles.aspx)\n\n[How to create and manipulate NTFS junction points](http://support.microsoft.com/kb/205524)\n\n[DISM Operating System Package Servicing Command-Line Options](dism-operating-system-package-servicing-command-line-options.md)\n\n \n\n \n\n\n\n\n\n\n"}