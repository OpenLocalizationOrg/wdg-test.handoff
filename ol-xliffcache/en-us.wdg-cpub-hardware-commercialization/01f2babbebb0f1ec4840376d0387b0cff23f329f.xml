{"nodes":[{"content":"Custom Injection of System Information","pos":[11,49]},{"content":"Custom Injection of System Information","pos":[63,101]},{"content":"Custom Injection of System Information","pos":[290,328]},{"content":"Kernel Trace Control allows custom injection of system information when multiple trace files are merged into a single output trace file.","pos":[331,467]},{"content":"To include system information, a single flag or combination of flags is set in the <bpt id=\"p1\">[</bpt>CreateMergedTraceFile<ept id=\"p1\">](createmergedtracefile.md)</ept> function.","pos":[468,610]},{"content":"The following flags define the system information to be added to the merged trace file:","pos":[611,698]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>NONE 0x00000000","pos":[778,837]},{"content":"No system information should be added to the merged trace file.","pos":[840,903]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>IMAGEID 0x00000001","pos":[986,1048]},{"content":"Inject image information such as checksum and timestamp used during symbol lookup.","pos":[1051,1133]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>BUILDINFO 0x00000002","pos":[1218,1282]},{"content":"Inject operating system build information such as product name and build lab.","pos":[1285,1362]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>VOLUME<ph id=\"ph6\">\\_</ph>MAPPING 0x00000004","pos":[1452,1522]},{"content":"Inject volume mapping between MS-DOS and Windows NT paths.","pos":[1525,1583]},{"content":"The payload of the event contains two NULL-terminated Unicode strings.","pos":[1584,1654]},{"content":"The first string contains the Windows NT path and the second string contains the MS-DOS path.","pos":[1655,1748]},{"content":"The length of the payload is the size, in bytes, of the two strings including the NULL characters.","pos":[1749,1847]},{"content":"For example, a Windows NT path “<ph id=\"ph1\">\\\\</ph>Device<ph id=\"ph2\">\\\\</ph>HarddiskVolume1<ph id=\"ph3\">\\\\</ph>” would be translated to the MS-DOS path “C:<ph id=\"ph4\">\\\\</ph>”.","pos":[1849,1956]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>WINSAT 0x00000008","pos":[2038,2099]},{"content":"Inject WinSat information.","pos":[2102,2128]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>EVENT<ph id=\"ph6\">\\_</ph>METADATA 0x00000010","pos":[2218,2288]},{"content":"Inject trace data header (TDH) metadata for events that are captured on computers other than the computer on which the events are being analyzed.","pos":[2291,2436]},{"content":"For more information about trace data header information, see <bpt id=\"p1\">[</bpt>Event Tracing<ept id=\"p1\">](https://msdn.microsoft.com/library/bb968803.aspx)</ept>.","pos":[2437,2565]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>METADATA<ph id=\"ph2\">\\_</ph>LOG<ph id=\"ph3\">\\_</ph>TYPE<ph id=\"ph4\">\\_</ph>TRACE<ph id=\"ph5\">\\_</ph>EVENT<ph id=\"ph6\">\\_</ph>INFO 0x20","pos":[2643,2701]},{"content":"Inject trace information that identifies the events logged through EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>EVENT<ph id=\"ph6\">\\_</ph>METADATA.","pos":[2704,2824]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>METADATA<ph id=\"ph2\">\\_</ph>LOG<ph id=\"ph3\">\\_</ph>TYPE<ph id=\"ph4\">\\_</ph>EVENT<ph id=\"ph5\">\\_</ph>MAP<ph id=\"ph6\">\\_</ph>INFO 0x21","pos":[2900,2956]},{"content":"Inject information that defines the metadata for the events logged as a result of setting the EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>EVENT<ph id=\"ph6\">\\_</ph>METADATA flag.","pos":[2959,3111]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>EVENT<ph id=\"ph1\">\\_</ph>MAP<ph id=\"ph2\">\\_</ph>INFO Structure<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/aa964762.aspx)</ept>.","pos":[3112,3233]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>PERFTRACK<ph id=\"ph6\">\\_</ph>METADATA 0x00000020","pos":[3327,3401]},{"content":"Inject <bpt id=\"p1\">**</bpt>PerfTrack<ept id=\"p1\">**</ept> events metadata for decoding of <bpt id=\"p2\">**</bpt>PerfTrack<ept id=\"p2\">**</ept> events on different computers.","pos":[3404,3501]},{"content":"These events are injected only on Windows 7 and Windows Server 2008.","pos":[3502,3570]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>DEFAULT 0x000FFFFF","pos":[3653,3715]},{"content":"Inject the data for image, build, volume mapping, WinSat, event metadata, and <bpt id=\"p1\">**</bpt>PerfTrack<ept id=\"p1\">**</ept> metadata.","pos":[3718,3819]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>ALL 0xFFFFFFF","pos":[3897,3954]},{"content":"Inject all extended data information to the output trace file.","pos":[3957,4019]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>NETWORK<ph id=\"ph6\">\\_</ph>INTERFACE 0x00000040","pos":[4112,4185]},{"content":"Inject network interface information.","pos":[4188,4225]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>NGEN<ph id=\"ph6\">\\_</ph>PDB 0x00000080","pos":[4320,4384]},{"content":"Create PDBs to enable symbol loading for NGEN binaries that appear in the trace.","pos":[4387,4467]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>COMPRESS<ph id=\"ph6\">\\_</ph>TRACE 0x10000000","pos":[4562,4632]},{"content":"Compress the merged trace.","pos":[4635,4661]},{"content":"Only supported on Windows 8 and higher.","pos":[4662,4701]},{"content":"define EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>MERGE<ph id=\"ph3\">\\_</ph>EXTENDED<ph id=\"ph4\">\\_</ph>DATA<ph id=\"ph5\">\\_</ph>INJECT<ph id=\"ph6\">\\_</ph>ONLY 0x40000000","pos":[4796,4863]},{"content":"Only inject image identification information, do not copy events from the input trace(s).","pos":[4866,4955]},{"content":"Remarks","pos":[4960,4967]},{"content":"Requirements:","pos":[4972,4985]},{"content":"<bpt id=\"p1\">**</bpt>Versions:<ept id=\"p1\">**</ept> Available beginning in Windows Vista.","pos":[4989,5040]},{"content":"This structure is distributed with Windows Performance Analyzer.","pos":[5041,5105]},{"content":"<bpt id=\"p1\">**</bpt>Headers:<ept id=\"p1\">**</ept> Declared in KernelTraceControl.h.","pos":[5107,5153]},{"content":"Include KernelTraceControl.h.","pos":[5154,5183]},{"pos":[5185,5234],"content":"<bpt id=\"p1\">**</bpt>Library:<ept id=\"p1\">**</ept> Contained in KernelTraceControl.dll."},{"content":"Related topics","pos":[5239,5253]},{"content":"Kernel Trace Control API Reference","pos":[5257,5291]},{"content":"CreateMergedTraceFile","pos":[5334,5355]}],"content":"---\ntitle: Custom Injection of System Information\ndescription: Custom Injection of System Information\nMSHAttr:\n- 'PreferredSiteName:MSDN'\n- 'PreferredLib:/library/windows/hardware'\nms.assetid: 18d70466-eb0c-4a3a-a711-59cda913b477\nms.prod: W10\nms.mktglfcycl: operate\nms.sitesec: msdn\n---\n\n# Custom Injection of System Information\n\n\nKernel Trace Control allows custom injection of system information when multiple trace files are merged into a single output trace file. To include system information, a single flag or combination of flags is set in the [CreateMergedTraceFile](createmergedtracefile.md) function. The following flags define the system information to be added to the merged trace file:\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-none-0x00000000\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_NONE 0x00000000  \nNo system information should be added to the merged trace file.\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-imageid-0x00000001\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_IMAGEID 0x00000001  \nInject image information such as checksum and timestamp used during symbol lookup.\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-buildinfo-0x00000002\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_BUILDINFO 0x00000002  \nInject operating system build information such as product name and build lab.\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-volume-mapping-0x00000004\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_VOLUME\\_MAPPING 0x00000004  \nInject volume mapping between MS-DOS and Windows NT paths. The payload of the event contains two NULL-terminated Unicode strings. The first string contains the Windows NT path and the second string contains the MS-DOS path. The length of the payload is the size, in bytes, of the two strings including the NULL characters.\n\nFor example, a Windows NT path “\\\\Device\\\\HarddiskVolume1\\\\” would be translated to the MS-DOS path “C:\\\\”.\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-winsat-0x00000008\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_WINSAT 0x00000008  \nInject WinSat information.\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-event-metadata-0x00000010\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_EVENT\\_METADATA 0x00000010  \nInject trace data header (TDH) metadata for events that are captured on computers other than the computer on which the events are being analyzed. For more information about trace data header information, see [Event Tracing](https://msdn.microsoft.com/library/bb968803.aspx).\n\n<a href=\"\" id=\"-define-event-metadata-log-type-trace-event-info-0x20\"></a>\\#define EVENT\\_METADATA\\_LOG\\_TYPE\\_TRACE\\_EVENT\\_INFO 0x20  \nInject trace information that identifies the events logged through EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_EVENT\\_METADATA.\n\n<a href=\"\" id=\"-define-event-metadata-log-type-event-map-info-0x21\"></a>\\#define EVENT\\_METADATA\\_LOG\\_TYPE\\_EVENT\\_MAP\\_INFO 0x21  \nInject information that defines the metadata for the events logged as a result of setting the EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_EVENT\\_METADATA flag. For more information, see [EVENT\\_MAP\\_INFO Structure](https://msdn.microsoft.com/library/windows/desktop/aa964762.aspx).\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-perftrack-metadata-0x00000020\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_PERFTRACK\\_METADATA 0x00000020  \nInject **PerfTrack** events metadata for decoding of **PerfTrack** events on different computers. These events are injected only on Windows 7 and Windows Server 2008.\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-default-0x000fffff\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_DEFAULT 0x000FFFFF  \nInject the data for image, build, volume mapping, WinSat, event metadata, and **PerfTrack** metadata.\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-all-0xfffffff\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_ALL 0xFFFFFFF  \nInject all extended data information to the output trace file.\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-network-interface-0x00000040\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_NETWORK\\_INTERFACE 0x00000040  \nInject network interface information.\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-ngen-pdb------------0x00000080\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_NGEN\\_PDB 0x00000080  \nCreate PDBs to enable symbol loading for NGEN binaries that appear in the trace.\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-compress-trace------0x10000000\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_COMPRESS\\_TRACE 0x10000000  \nCompress the merged trace. Only supported on Windows 8 and higher.\n\n<a href=\"\" id=\"-define-event-trace-merge-extended-data-inject-only---------0x40000000\"></a>\\#define EVENT\\_TRACE\\_MERGE\\_EXTENDED\\_DATA\\_INJECT\\_ONLY 0x40000000  \nOnly inject image identification information, do not copy events from the input trace(s).\n\n## Remarks\n\n\n**Requirements:**\n\n**Versions:** Available beginning in Windows Vista. This structure is distributed with Windows Performance Analyzer.\n\n**Headers:** Declared in KernelTraceControl.h. Include KernelTraceControl.h.\n\n**Library:** Contained in KernelTraceControl.dll.\n\n## Related topics\n\n\n[Kernel Trace Control API Reference](kernel-trace-control-api-reference.md)\n\n[CreateMergedTraceFile](createmergedtracefile.md)\n\n \n\n \n\n\n\n\n\n\n\n"}