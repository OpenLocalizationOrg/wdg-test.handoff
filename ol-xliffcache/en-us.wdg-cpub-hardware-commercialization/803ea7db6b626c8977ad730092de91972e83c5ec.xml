{"nodes":[{"content":"Lab 1d: Add a provisioning package to an image","pos":[205,251]},{"content":"Lab 1d: Add a provisioning package to an image","pos":[260,306]},{"content":"This content has been tested on Windows 10 IoT Core Build 10586.","pos":[310,374]},{"content":"Some of these procedures do not yet work on newer preview builds, including Windows 10, version 1607.","pos":[375,476]},{"content":"We'll create a provisioning package that contains some sample Wi-Fi settings.","pos":[480,557]},{"content":"You can use provisioning package in Windows Imaging and Configuration Designer (ICD) to add apps, drivers, features, or to modify many common settings, such as IT device management and policy settings.","pos":[558,759]},{"content":"Note, to test Wi-Fi, your board will need Wi-Fi support.","pos":[761,817]},{"content":"You can use a Wi-Fi adapter/dongle, or use a board like the Raspberry Pi 3 that has Wi-Fi built-in.","pos":[818,917]},{"pos":[1019,1032],"content":"Prerequisites"},{"pos":[1035,1335],"content":"We'll start with the ProjectA image we created from <bpt id=\"p1\">[</bpt>Lab 1a: Create a basic image<ept id=\"p1\">](create-a-basic-image.md)</ept>, and updated in <bpt id=\"p2\">[</bpt>Lab 1b: Add an app to your image<ept id=\"p2\">](deploy-your-app-with-a-standard-board.md)</ept> and <bpt id=\"p3\">[</bpt>Lab 1c: Add a file and a registry setting to an image<ept id=\"p3\">](add-a-registry-setting-to-an-image.md)</ept>."},{"pos":[1538,1585],"content":"Create your provisioning package in Windows ICD"},{"pos":[1592,1645],"content":"Start <bpt id=\"p1\">**</bpt>Windows Imaging and Configuration Designer<ept id=\"p1\">**</ept>."},{"pos":[1651,1683],"content":"Click <bpt id=\"p1\">**</bpt>File <ph id=\"ph1\">&amp;gt;</ph> New project<ept id=\"p1\">**</ept>."},{"pos":[1689,1801],"content":"For this example, use the name \"<bpt id=\"p1\">**</bpt>ProductAprov<ept id=\"p1\">**</ept>\" for the product name, accept the defaults, and click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"pos":[1807,1864],"content":"Select <bpt id=\"p1\">**</bpt>Provisioning package <ph id=\"ph1\">&amp;gt;</ph> Windows 10 IoT Core<ept id=\"p1\">**</ept>."},{"pos":[1870,1945],"content":"At the <bpt id=\"p1\">**</bpt>Import a provisioning package (optional)<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept>."},{"content":"Add a sample setting:","pos":[1951,1972]},{"pos":[1982,2074],"content":"Expand <bpt id=\"p1\">**</bpt>Runtime settings <ph id=\"ph1\">&amp;gt;</ph> Connectivity Profiles <ph id=\"ph2\">&amp;gt;</ph> WLAN <ph id=\"ph3\">&amp;gt;</ph> WLANSetting <ph id=\"ph4\">&amp;gt;</ph> SSID<ept id=\"p1\">**</ept>."},{"pos":[2084,2170],"content":"Type in the name of a Wi-Fi network name, for example, ContosoWiFi, and click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>."},{"pos":[2180,2271],"content":"Expand the <bpt id=\"p1\">**</bpt>SSID &gt; WLANXmlSettings &gt; SecurityType<ept id=\"p1\">**</ept> and choose a setting such as <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept>."},{"pos":[2281,2371],"content":"Expand the <bpt id=\"p1\">**</bpt>SSID &gt; WLANXmlSettings &gt; AutoConnect<ept id=\"p1\">**</ept> and choose a setting such as <bpt id=\"p2\">**</bpt>TRUE<ept id=\"p2\">**</ept>."},{"content":"Optional: to add more than one WLAN network, go back to WLANSetting, and repeat the process.","pos":[2381,2473]},{"content":"Optional: add other apps, drivers, and settings through the UI.","pos":[2479,2542]},{"content":"To learn more, see <bpt id=\"p1\">[</bpt>Configure customizations using Windows ICD<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/dn916109)</ept>.","pos":[2543,2669]},{"content":"Export the provisioning package.","pos":[2675,2707]},{"content":"For example, click <bpt id=\"p1\">**</bpt>Export <ph id=\"ph1\">&amp;gt;</ph> Provisioning Package <ph id=\"ph2\">&amp;gt;</ph> Next <ph id=\"ph3\">&amp;gt;</ph> Next <ph id=\"ph4\">&amp;gt;</ph> Build<ept id=\"p1\">**</ept>.","pos":[2708,2795]},{"content":"(To learn more, see <bpt id=\"p1\">[</bpt>Export a provisioning package<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/dn916110)</ept>.","pos":[2796,2910]},{"content":")","pos":[2911,2912]},{"content":"At the <bpt id=\"p1\">**</bpt>All done!<ept id=\"p1\">**</ept>","pos":[2918,2938]},{"content":"page, click the link to the <bpt id=\"p1\">**</bpt>Output location<ept id=\"p1\">**</ept>.","pos":[2939,2987]},{"content":"Create a folder for the provisioning package in your test product","pos":[2991,3056]},{"content":"In File Explorer, create a new folder, C:<ph id=\"ph1\">\\\\</ph>IoT-ADK-AddonKit<ph id=\"ph2\">\\\\</ph>Products<ph id=\"ph3\">\\\\</ph>ProductA<ph id=\"ph4\">\\\\</ph>prov.","pos":[3064,3150]},{"content":"This folder is structure is used by the script: Provisioning.Auto.pkg.xml file in Provisioning.Auto folder.","pos":[3156,3263]},{"content":"No changes are required.","pos":[3264,3288]},{"content":"Copy the .ppkg, .cat, and customizations.xml files into this folder.","pos":[3294,3362]},{"content":"If necessary, rename the files to (your project name)prov.cat and (your project name)prov.ppkg, for example, ProductAprov.cat and ProductAprov.ppkg.","pos":[3372,3520]},{"content":"Optional: update customizations.xml with any desired changes.","pos":[3530,3591]},{"content":"See <bpt id=\"p1\">[</bpt>Windows provisioning answer file<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/dn916153)</ept> for more info.","pos":[3592,3707]},{"content":"Check the auto-provisioning scripts to make sure they'll include your new provisioning package (optional)","pos":[3711,3816]},{"content":"Review the package definition file: Provisioning.Auto.pkg.xml: C:<ph id=\"ph1\">\\\\</ph>IoT-ADK-AddonKit<ph id=\"ph2\">\\\\</ph>Common<ph id=\"ph3\">\\\\</ph>Packages<ph id=\"ph4\">\\\\</ph>Provisioning.Auto<ph id=\"ph5\">\\\\</ph>Provisioning.Auto.pkg.xml.","pos":[3824,3972]},{"content":"No changes should required.","pos":[3973,4000]},{"content":"Make sure that the package definition file is referenced in the feature manifest.","pos":[4873,4954]},{"content":"For example, check C:<ph id=\"ph1\">\\\\</ph>IoT-ADK-AddonKit<ph id=\"ph2\">\\\\</ph>Common<ph id=\"ph3\">\\\\</ph>Packages<ph id=\"ph4\">\\\\</ph>OEMCommonFM.xml:","pos":[4955,5030]},{"pos":[5461,5585],"content":"Add the FeatureID to your test configuration file C:<ph id=\"ph1\">\\\\</ph>IoT-ADK-AddonKit<ph id=\"ph2\">\\\\</ph>Source-<ph id=\"ph3\">&lt;arch&gt;\\\\</ph>Products<ph id=\"ph4\">\\\\</ph>ProductA<ph id=\"ph5\">\\\\</ph>TestOEMInput.xml:"},{"pos":[5772,5796],"content":"Build and test the image"},{"content":"Build the image","pos":[5800,5815]},{"content":"From the IoT Core Shell, create the image:","pos":[5823,5865]},{"content":"This creates the product binaries at C:<ph id=\"ph1\">\\\\</ph>IoT-ADK-AddonKit<ph id=\"ph2\">\\\\</ph>Build<ph id=\"ph3\">\\\\&amp;lt;</ph>arch<ph id=\"ph4\">&amp;gt;\\\\</ph>ProductA<ph id=\"ph5\">\\\\</ph>Test<ph id=\"ph6\">\\\\</ph>Flash.FFU.","pos":[5925,6031]},{"content":"Start <bpt id=\"p1\">**</bpt>Windows IoT Core Dashboard<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Setup a new device<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Custom<ept id=\"p3\">**</ept>, and browse to your image.","pos":[6037,6144]},{"content":"Put the Micro SD card in the device, select it, accept the license terms, and click <bpt id=\"p1\">**</bpt>Install<ept id=\"p1\">**</ept>.","pos":[6145,6241]},{"content":"This replaces the previous image with our new image.","pos":[6242,6294]},{"content":"Put the card into the IoT device and start it up.","pos":[6300,6349]},{"content":"After a short while, the device should start automatically, and you should see your app.","pos":[6355,6443]},{"content":"Check to see if your provisioning settings were applied","pos":[6447,6502]},{"content":"Connect a network cable.","pos":[6510,6534]},{"content":"On your technician PC, open Internet Explorer, and type in the address with an http:// prefix and :8080 suffix:","pos":[6540,6651]},{"content":"This opens the <bpt id=\"p1\">[</bpt>Windows Device Portal<ept id=\"p1\">](http://ms-iot.github.io/content/en-US/win10/tools/DevicePortal.md)</ept>.","pos":[6711,6817]},{"content":"From here, you can upload app packages, see what apps are installed, and switch between them.","pos":[6818,6911]},{"content":"Use the default username (Administrator) and password (p@ssw0rd) to log on.","pos":[6917,6992]},{"pos":[6998,7019],"content":"Click <bpt id=\"p1\">**</bpt>Networking.<ept id=\"p1\">**</ept>"},{"pos":[7025,7104],"content":"Check the <bpt id=\"p1\">**</bpt>Profiles<ept id=\"p1\">**</ept> drop-down, you should see the Wi-Fi profile you created."},{"pos":[7115,7280],"content":"If the device is able to automatically connect to the WiFi network, then under <bpt id=\"p1\">**</bpt>Available Networks<ept id=\"p1\">**</ept>, you should see a checkmark next to the network you configured."},{"content":"If your network requires steps such as accepting license terms, the device may not auto-connect.","pos":[7286,7382]},{"pos":[7474,7484],"content":"Next steps"},{"content":"Lab 1e: Add a driver to an image","pos":[7487,7519]}],"content":"---\nauthor: kpacquer\nDescription: 'We''ll create a provisioning package that contains some sample Wi-Fi settings.'\nms.assetid: d9a50f87-e8c0-48da-89e7-0cdd542ce053\nMSHAttr: 'PreferredLib:/library'\ntitle: 'Lab 1d: Add a provisioning package to an image'\n---\n\n# Lab 1d: Add a provisioning package to an image\n\n\\[This content has been tested on Windows 10 IoT Core Build 10586. Some of these procedures do not yet work on newer preview builds, including Windows 10, version 1607.\\]\n\nWe'll create a provisioning package that contains some sample Wi-Fi settings. You can use provisioning package in Windows Imaging and Configuration Designer (ICD) to add apps, drivers, features, or to modify many common settings, such as IT device management and policy settings.\n\nNote, to test Wi-Fi, your board will need Wi-Fi support. You can use a Wi-Fi adapter/dongle, or use a board like the Raspberry Pi 3 that has Wi-Fi built-in. \n\n## <span id=\"Prerequisites\"></span><span id=\"prerequisites\"></span><span id=\"PREREQUISITES\"></span>Prerequisites\n\n\nWe'll start with the ProjectA image we created from [Lab 1a: Create a basic image](create-a-basic-image.md), and updated in [Lab 1b: Add an app to your image](deploy-your-app-with-a-standard-board.md) and [Lab 1c: Add a file and a registry setting to an image](add-a-registry-setting-to-an-image.md).\n\n## <span id=\"Create_your_provisioning_package_in_Windows_ICD\"></span><span id=\"create_your_provisioning_package_in_windows_icd\"></span><span id=\"CREATE_YOUR_PROVISIONING_PACKAGE_IN_WINDOWS_ICD\"></span>Create your provisioning package in Windows ICD\n\n\n1.  Start **Windows Imaging and Configuration Designer**.\n\n2.  Click **File &gt; New project**.\n\n3.  For this example, use the name \"**ProductAprov**\" for the product name, accept the defaults, and click **Next**.\n\n4.  Select **Provisioning package &gt; Windows 10 IoT Core**.\n\n5.  At the **Import a provisioning package (optional)** page, click **Finish**.\n\n6.  Add a sample setting:\n\n    1.  Expand **Runtime settings &gt; Connectivity Profiles &gt; WLAN &gt; WLANSetting &gt; SSID**.\n\n    2.  Type in the name of a Wi-Fi network name, for example, ContosoWiFi, and click **Add**.\n\n    3.  Expand the **SSID > WLANXmlSettings > SecurityType** and choose a setting such as **Open**.\n\n    4.  Expand the **SSID > WLANXmlSettings > AutoConnect** and choose a setting such as **TRUE**.\n\n    5.  Optional: to add more than one WLAN network, go back to WLANSetting, and repeat the process.\n\n7.  Optional: add other apps, drivers, and settings through the UI. To learn more, see [Configure customizations using Windows ICD](https://msdn.microsoft.com/library/windows/hardware/dn916109).\n\n8.  Export the provisioning package. For example, click **Export &gt; Provisioning Package &gt; Next &gt; Next &gt; Build**. (To learn more, see [Export a provisioning package](https://msdn.microsoft.com/library/windows/hardware/dn916110). )\n\n9.  At the **All done!** page, click the link to the **Output location**.\n\n**Create a folder for the provisioning package in your test product**\n\n1.  In File Explorer, create a new folder, C:\\\\IoT-ADK-AddonKit\\\\Products\\\\ProductA\\\\prov.\n\n    This folder is structure is used by the script: Provisioning.Auto.pkg.xml file in Provisioning.Auto folder. No changes are required.\n\n2.  Copy the .ppkg, .cat, and customizations.xml files into this folder.\n    \n    If necessary, rename the files to (your project name)prov.cat and (your project name)prov.ppkg, for example, ProductAprov.cat and ProductAprov.ppkg.\n    \n3.  Optional: update customizations.xml with any desired changes. See [Windows provisioning answer file](https://msdn.microsoft.com/library/windows/hardware/dn916153) for more info.\n\n**Check the auto-provisioning scripts to make sure they'll include your new provisioning package (optional)**\n\n1.  Review the package definition file: Provisioning.Auto.pkg.xml: C:\\\\IoT-ADK-AddonKit\\\\Common\\\\Packages\\\\Provisioning.Auto\\\\Provisioning.Auto.pkg.xml. No changes should required.\n\n    ``` syntax\n    <?xml version=\"1.0\" encoding=\"utf-8\"?>\n     <Package xmlns=\"urn:Microsoft.WindowsPhone/PackageSchema.v8.00\"\n        Owner=\"$(OEMNAME)\"\n        OwnerType=\"OEM\"\n        ReleaseType=\"Production\"\n        Platform=\"Common\"\n        Component=\"Provisioning\"\n        SubComponent=\"Auto\">\n        <Components>\n           <OSComponent>\n           <Files>\n            <!--\n            Source : Provisioning is product specific, so copied from the Product directory     \n            Destination : Auto provisioning folder which is C:\\Windows\\Provisioning\\Packages\n            -->\n            <File Source=\"$(PRJDIR)\\Products\\$(PROD)\\prov\\$(PROD)Prov.ppkg\"\n                    DestinationDir=\"$(runtime.windows)\\Provisioning\\Packages\" Name=\"ProvAuto.ppkg\"/>\n            </Files>\n           </OSComponent>\n        </Components>\n     </Package>\n        \n    ```\n\n2.  Make sure that the package definition file is referenced in the feature manifest. For example, check C:\\\\IoT-ADK-AddonKit\\\\Common\\\\Packages\\\\OEMCommonFM.xml:\n    ```\n          <PackageFile Path=\"%PKGBLD_DIR%\" Name=\"%OEM_NAME%.Provisioning.Auto.cab\">\n            <FeatureIDs>\n              <FeatureID>OEM_ProvAuto</FeatureID>\n            </FeatureIDs>\n          </PackageFile>    \n          \n        </OEM>\n    ...\n            <FeatureIDs>\n              <FeatureID>OEM_ProvAuto</FeatureID>\n              <FeatureID>OEM_ProvManual</FeatureID>        \n            </FeatureIDs>\n    ```\n\n3.  Add the FeatureID to your test configuration file C:\\\\IoT-ADK-AddonKit\\\\Source-<arch>\\\\Products\\\\ProductA\\\\TestOEMInput.xml:\n    ```\n    <Feature>OEM_ProvAuto</Feature>\n    ```\n\n### <span id=\"Build_and_test_the_image\"></span><span id=\"build_and_test_the_image\"></span><span id=\"BUILD_AND_TEST_THE_IMAGE\"></span>Build and test the image\n\n**Build the image**\n\n1.  From the IoT Core Shell, create the image:\n\n    ``` syntax\n    createimage ProductA Test\n    ```\n\n    This creates the product binaries at C:\\\\IoT-ADK-AddonKit\\\\Build\\\\&lt;arch&gt;\\\\ProductA\\\\Test\\\\Flash.FFU.\n\n2.  Start **Windows IoT Core Dashboard** &gt; **Setup a new device** &gt; **Custom**, and browse to your image. Put the Micro SD card in the device, select it, accept the license terms, and click **Install**. This replaces the previous image with our new image.\n\n3.  Put the card into the IoT device and start it up.\n\n    After a short while, the device should start automatically, and you should see your app.\n\n**Check to see if your provisioning settings were applied**\n\n1.  Connect a network cable.\n\n2.  On your technician PC, open Internet Explorer, and type in the address with an http:// prefix and :8080 suffix:\n\n    ``` syntax\n    http://100.100.0.100:8080\n    ```\n\n    This opens the [Windows Device Portal](http://ms-iot.github.io/content/en-US/win10/tools/DevicePortal.md). From here, you can upload app packages, see what apps are installed, and switch between them.\n\n3.  Use the default username (Administrator) and password (p@ssw0rd) to log on.\n\n4.  Click **Networking.**\n\n5.  Check the **Profiles** drop-down, you should see the Wi-Fi profile you created. \n    \n    If the device is able to automatically connect to the WiFi network, then under **Available Networks**, you should see a checkmark next to the network you configured.\n\n    If your network requires steps such as accepting license terms, the device may not auto-connect.\n\n## <span id=\"Next_steps\"></span><span id=\"next_steps\"></span><span id=\"NEXT_STEPS\"></span>Next steps\n\n[Lab 1e: Add a driver to an image](add-a-driver-to-an-image.md) \n"}