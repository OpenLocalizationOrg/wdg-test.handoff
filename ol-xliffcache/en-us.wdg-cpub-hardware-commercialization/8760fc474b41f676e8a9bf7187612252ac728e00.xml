{"nodes":[{"content":"WinPE: Install on a Hard Drive (Flat Boot or Non-RAM)","pos":[35,88]},{"content":"WinPE: Install on a Hard Drive (Flat Boot or Non-RAM)","pos":[197,250]},{"content":"WinPE: Install on a Hard Drive (Flat Boot or Non-RAM)","pos":[259,312]},{"content":"Windows Preinstallation Environment (Windows PE) is a minimal operating system where you can prepare a PC for installation, deployment, and servicing of Windows.","pos":[315,476]},{"content":"Here's how to download and install it to an internal or external hard drive.","pos":[477,553]},{"content":"These instructions show how to set up a basic Windows PE installation that runs from the drive.","pos":[555,650]},{"content":"This can sometimes give you better performance than booting from memory, and can help you run Windows PE on PCs or virtual environments with low memory.","pos":[651,803]},{"content":"This procedure is also known as a <bpt id=\"p1\">*</bpt>non-RAMDISK boot<ept id=\"p1\">*</ept>, or a <bpt id=\"p2\">*</bpt>flat boot<ept id=\"p2\">*</ept>.","pos":[804,875]},{"content":"Note","pos":[879,883]},{"content":"When Windows PE is running from the drive, you must turn off the PC before disconnecting the drive to avoid losing your work.","pos":[888,1013]},{"content":"Install the Windows ADK","pos":[1020,1043]},{"pos":[1051,1216],"content":"Get the <bpt id=\"p1\">[</bpt>Windows Assessment and Deployment Kit (Windows ADK) Technical Reference<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=526803)</ept>, including the Windows PE feature."},{"content":"Create a Set of Either 32-bit or 64-bit Windows PE Files","pos":[1220,1276]},{"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, and type <bpt id=\"p2\">**</bpt>deployment<ept id=\"p2\">**</ept>.","pos":[1284,1325]},{"content":"Right-click <bpt id=\"p1\">**</bpt>Deployment and Imaging Tools Environment<ept id=\"p1\">**</ept> and then select <bpt id=\"p2\">**</bpt>Run as administrator<ept id=\"p2\">**</ept>.","pos":[1326,1424]},{"pos":[1430,1538],"content":"In the <bpt id=\"p1\">**</bpt>Deployment and Imaging Tools Environment<ept id=\"p1\">**</ept>, copy the Windows PE files for the PCs you want to boot."},{"content":"The 64-bit version of Windows PE can boot 64-bit UEFI and 64-bit BIOS PCs:","pos":[1544,1618]},{"content":"The 32-bit version of Windows PE can boot 32-bit UEFI, 32-bit BIOS, and 64-bit BIOS PCs:","pos":[1680,1768]},{"content":"Create a Working Directory for Windows PE Files","pos":[1824,1871]},{"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, and type <bpt id=\"p2\">**</bpt>deployment<ept id=\"p2\">**</ept>.","pos":[1879,1920]},{"content":"Right-click <bpt id=\"p1\">**</bpt>Deployment and Imaging Tools Environment<ept id=\"p1\">**</ept> and then select <bpt id=\"p2\">**</bpt>Run as administrator<ept id=\"p2\">**</ept>.","pos":[1921,2019]},{"pos":[2025,2132],"content":"From the <bpt id=\"p1\">**</bpt>Deployment and Imaging Tools Environment<ept id=\"p1\">**</ept>, create a working directory for the Windows PE files."},{"content":"Install Windows PE to the Media","pos":[2192,2223]},{"content":"Use DiskPart to prepare the partitions.","pos":[2231,2270]},{"pos":[2276,2393],"content":"**Note**  \nThe following commands prepare a USB hard drive that can boot on either a BIOS-based or UEFI-based PC.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"The following commands prepare a USB hard drive that can boot on either a BIOS-based or UEFI-based PC.","pos":[11,113]}]},{"content":"On UEFI-based PCs, Windows PE requires a boot partition formatted using the FAT32 file format, which only supports file sizes up to 4 GB.","pos":[2399,2536]},{"content":"We recommend creating a separate partition on the drive, formatted using NTFS, so that you can store Windows images and other large files.","pos":[2537,2675]},{"pos":[3095,3175],"content":"where <bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>disk number<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the listed number of the external USB hard drive."},{"content":"Apply the Windows PE image to the hard drive.","pos":[3181,3226]},{"content":"Set up the boot files.","pos":[3352,3374]},{"pos":[3440,3532],"content":"**Note**  \nIgnore any warning messages that say \"Warning: Resume application not found.\"","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"Ignore any warning messages that say \"Warning: Resume application not found.\"","pos":[11,88]}]},{"content":"Boot to Windows PE","pos":[3543,3561]},{"content":"Connect the device (internal or external USB hard drive) into the PC you want to work on.","pos":[3569,3658]},{"content":"Turn on the PC, and use the boot menus to select the Windows PE drive.","pos":[3664,3734]},{"content":"Typically this requires pressing a hardware button or a key, such as the Esc key.","pos":[3735,3816]},{"pos":[3822,3978],"content":"**Note**  \nFor UEFI-based PCs, you might need to find an option to manually select the UEFI boot files, for example, USBDrive01\\\\EFI\\\\BOOT\\\\BOOTX64.EFI.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"For UEFI-based PCs, you might need to find an option to manually select the UEFI boot files, for example, USBDrive01<ph id=\"ph1\">\\\\</ph>EFI<ph id=\"ph2\">\\\\</ph>BOOT<ph id=\"ph3\">\\\\</ph>BOOTX64.EFI.","pos":[11,152]}]},{"content":"Windows PE starts automatically.","pos":[3991,4023]},{"content":"After the command window appears, the wpeinit command runs automatically.","pos":[4024,4097]},{"content":"This might take a few minutes.","pos":[4098,4128]},{"content":"Troubleshooting","pos":[4132,4147]},{"content":"If the PC does not boot, try the following steps in sequence, and try to boot the PC after each step:","pos":[4155,4256]},{"content":"For external USB drives, try inserting the drive into a different USB port.","pos":[4266,4341]},{"content":"Avoid using USB hubs or cables, because they might not be detected during the boot sequence.","pos":[4342,4434]},{"content":"Avoid USB 3.0 ports if the firmware does not contain native support for USB 3.0.","pos":[4435,4515]},{"content":"If your PC requires drivers to boot, such as storage drivers or video drivers, or if your driver requires changes to the registry, add the driver to the Windows PE image.","pos":[4525,4695]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>WinPE: Mount and Customize<ept id=\"p1\">](winpe-mount-and-customize.md)</ept>.","pos":[4696,4774]},{"content":"Update the firmware of the PC to the latest version.","pos":[4784,4836]},{"pos":[4842,4998],"content":"For tips on connecting to a network, see <bpt id=\"p1\">[</bpt>WinPE Network Drivers: Initializing and adding drivers<ept id=\"p1\">](winpe-network-drivers-initializing-and-adding-drivers.md)</ept>."},{"content":"Running Windows Setup from Windows PE","pos":[5002,5039]},{"pos":[5047,5377],"content":"See <bpt id=\"p1\">[</bpt>Windows Setup Supported Platforms and Cross-Platform Deployments<ept id=\"p1\">](windows-setup-supported-platforms-and-cross-platform-deployments.md)</ept> for tips on installing Windows on UEFI PCs that support both UEFI and legacy BIOS firmware modes, and for using the 32-bit (x86) version of Windows PE to install a 64-bit version of Windows."},{"pos":[5415,5429],"content":"Related topics"},{"content":"WinPE for Windows 10","pos":[5433,5453]},{"content":"WinPE: Create USB Bootable drive","pos":[5473,5505]},{"content":"WinPE: Mount and Customize","pos":[5545,5571]},{"content":"WinPE: Boot in UEFI or legacy BIOS mode","pos":[5605,5644]},{"content":"Windows Setup Supported Platforms and Cross-Platform Deployments","pos":[5691,5755]}],"content":"---\nauthor: Justinha\nDescription: 'WinPE: Install on a Hard Drive (Flat Boot or Non-RAM)'\nms.assetid: f4495adf-63db-4fdc-ae56-70166eed930c\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: 'WinPE: Install on a Hard Drive (Flat Boot or Non-RAM)'\n---\n\n# WinPE: Install on a Hard Drive (Flat Boot or Non-RAM)\n\n\nWindows Preinstallation Environment (Windows PE) is a minimal operating system where you can prepare a PC for installation, deployment, and servicing of Windows. Here's how to download and install it to an internal or external hard drive.\n\nThese instructions show how to set up a basic Windows PE installation that runs from the drive. This can sometimes give you better performance than booting from memory, and can help you run Windows PE on PCs or virtual environments with low memory. This procedure is also known as a *non-RAMDISK boot*, or a *flat boot*.\n\n**Note**  \nWhen Windows PE is running from the drive, you must turn off the PC before disconnecting the drive to avoid losing your work.\n\n \n\n**Install the Windows ADK**\n\n-   Get the [Windows Assessment and Deployment Kit (Windows ADK) Technical Reference](http://go.microsoft.com/fwlink/p/?LinkId=526803), including the Windows PE feature.\n\n**Create a Set of Either 32-bit or 64-bit Windows PE Files**\n\n1.  Click **Start**, and type **deployment**. Right-click **Deployment and Imaging Tools Environment** and then select **Run as administrator**.\n\n2.  In the **Deployment and Imaging Tools Environment**, copy the Windows PE files for the PCs you want to boot.\n\n    The 64-bit version of Windows PE can boot 64-bit UEFI and 64-bit BIOS PCs:\n\n    ``` syntax\n    copype amd64 C:\\WinPE_amd64\n    ```\n\n    The 32-bit version of Windows PE can boot 32-bit UEFI, 32-bit BIOS, and 64-bit BIOS PCs:\n\n    ``` syntax\n    copype x86 C:\\WinPE_x86\n    ```\n\n**Create a Working Directory for Windows PE Files**\n\n1.  Click **Start**, and type **deployment**. Right-click **Deployment and Imaging Tools Environment** and then select **Run as administrator**.\n\n2.  From the **Deployment and Imaging Tools Environment**, create a working directory for the Windows PE files.\n\n    ``` syntax\n    copype amd64 C:\\WinPE_amd64\n    ```\n\n**Install Windows PE to the Media**\n\n1.  Use DiskPart to prepare the partitions.\n\n    **Note**  \n    The following commands prepare a USB hard drive that can boot on either a BIOS-based or UEFI-based PC.\n\n    On UEFI-based PCs, Windows PE requires a boot partition formatted using the FAT32 file format, which only supports file sizes up to 4 GB. We recommend creating a separate partition on the drive, formatted using NTFS, so that you can store Windows images and other large files.\n\n     \n\n    ``` syntax\n    diskpart\n    list disk\n    select <disk number>\n    clean\n    rem === Create the Windows PE partition. ===\n    create partition primary size=2000\n    format quick fs=fat32 label=\"Windows PE\"\n    assign letter=P\n    active\n    rem === Create a data partition. ===\n    create partition primary\n    format fs=ntfs quick label=\"Other files\"\n    assign letter=O\n    list vol\n    exit\n    ```\n\n    where *&lt;disk number&gt;* is the listed number of the external USB hard drive.\n\n2.  Apply the Windows PE image to the hard drive.\n\n    ``` syntax\n    dism /Apply-Image /ImageFile:\"C:\\WinPE_amd64\\media\\sources\\boot.wim\" /Index:1 /ApplyDir:P:\\\n    ```\n\n3.  Set up the boot files.\n\n    ``` syntax\n    BCDboot P:\\Windows /s P: /f ALL\n    ```\n\n    **Note**  \n    Ignore any warning messages that say \"Warning: Resume application not found.\"\n\n     \n\n**Boot to Windows PE**\n\n1.  Connect the device (internal or external USB hard drive) into the PC you want to work on.\n\n2.  Turn on the PC, and use the boot menus to select the Windows PE drive. Typically this requires pressing a hardware button or a key, such as the Esc key.\n\n    **Note**  \n    For UEFI-based PCs, you might need to find an option to manually select the UEFI boot files, for example, USBDrive01\\\\EFI\\\\BOOT\\\\BOOTX64.EFI.\n\n     \n\n    Windows PE starts automatically. After the command window appears, the wpeinit command runs automatically. This might take a few minutes.\n\n**Troubleshooting**\n\n1.  If the PC does not boot, try the following steps in sequence, and try to boot the PC after each step:\n\n    1.  For external USB drives, try inserting the drive into a different USB port. Avoid using USB hubs or cables, because they might not be detected during the boot sequence. Avoid USB 3.0 ports if the firmware does not contain native support for USB 3.0.\n\n    2.  If your PC requires drivers to boot, such as storage drivers or video drivers, or if your driver requires changes to the registry, add the driver to the Windows PE image. For more info, see [WinPE: Mount and Customize](winpe-mount-and-customize.md).\n\n    3.  Update the firmware of the PC to the latest version.\n\n2.  For tips on connecting to a network, see [WinPE Network Drivers: Initializing and adding drivers](winpe-network-drivers-initializing-and-adding-drivers.md).\n\n**Running Windows Setup from Windows PE**\n\n-   See [Windows Setup Supported Platforms and Cross-Platform Deployments](windows-setup-supported-platforms-and-cross-platform-deployments.md) for tips on installing Windows on UEFI PCs that support both UEFI and legacy BIOS firmware modes, and for using the 32-bit (x86) version of Windows PE to install a 64-bit version of Windows.\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[WinPE for Windows 10](winpe-intro.md)\n\n[WinPE: Create USB Bootable drive](winpe-create-usb-bootable-drive.md)\n\n[WinPE: Mount and Customize](winpe-mount-and-customize.md)\n\n[WinPE: Boot in UEFI or legacy BIOS mode](winpe-boot-in-uefi-or-legacy-bios-mode.md)\n\n[Windows Setup Supported Platforms and Cross-Platform Deployments](windows-setup-supported-platforms-and-cross-platform-deployments.md)\n\n \n\n \n\n\n\n\n\n\n"}