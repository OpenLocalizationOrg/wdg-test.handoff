{"nodes":[{"content":"Save","pos":[11,15]},{"content":"Save","pos":[29,33]},{"content":"Save","pos":[222,226]},{"content":"Saves a recording that is logged to circular buffers in memory to the specified event trace log (ETL) file.","pos":[229,336]},{"content":"The recording continues to run.","pos":[337,368]},{"content":"Syntax","pos":[373,379]},{"content":"Parameters","pos":[543,553]},{"content":"bstrFileName","pos":[590,602]},{"content":"in<ph id=\"ph1\">\\]</ph> The name of the file to which merged events from recordings of all the profiles are saved.","pos":[608,703]},{"content":"pProfileCollection","pos":[745,763]},{"content":"in<ph id=\"ph1\">\\]</ph> A pointer to the <bpt id=\"p1\">[</bpt>IProfileCollection<ept id=\"p1\">](iprofilecollection.md)</ept> object that contains a collection of profiles to save.","pos":[769,889]},{"content":"pTraceMergeProperties","pos":[934,955]},{"content":"in<ph id=\"ph1\">\\]</ph> A pointer to the <bpt id=\"p1\">[</bpt>ITraceMergeProperties<ept id=\"p1\">](itracemergeproperties.md)</ept> object that contains properties with which to merge recordings.","pos":[961,1096]},{"content":"Return Value","pos":[1101,1113]},{"content":"The following table describes possible return values.","pos":[1116,1169]},{"content":"Return Value","pos":[1274,1286]},{"content":"Description","pos":[1296,1307]},{"content":"S_OK","pos":[1360,1364]},{"content":"The function successfully saved the recording.","pos":[1381,1427]},{"content":"E_INVALIDARG","pos":[1468,1480]},{"content":"One or more arguments are invalid.","pos":[1497,1531]},{"content":"E_WPRC_FAILED_TO_SAVE_PROFILE","pos":[1571,1600]},{"content":"The library failed to save a profile in the profile collection.","pos":[1617,1680]},{"content":"Use <bpt id=\"p1\">[</bpt>IControlErrorInfo<ept id=\"p1\">](icontrolerrorinfo.md)</ept> to obtain detailed error information.","pos":[1681,1764]},{"content":"E_WPRC_TRACE_MERGE_LOST_EVENTS","pos":[1805,1835]},{"content":"The Event Tracing for Windows (ETW) session lost events, and merging the event trace log (ETL) files from the session may create an incomplete ETL file.","pos":[1852,2004]},{"content":"Remarks","pos":[2045,2052]},{"content":"This function is used only for profiles that are logging to circular buffers.","pos":[2055,2132]},{"content":"After the sessions are saved, the recording continues to run.","pos":[2133,2194]},{"content":"Related topics","pos":[2199,2213]},{"content":"IControlManager","pos":[2217,2232]}],"content":"---\ntitle: Save\ndescription: Save\nMSHAttr:\n- 'PreferredSiteName:MSDN'\n- 'PreferredLib:/library/windows/hardware'\nms.assetid: eedd3310-1f95-4e44-9be2-b33ed98dfa9a\nms.prod: W10\nms.mktglfcycl: operate\nms.sitesec: msdn\n---\n\n# Save\n\n\nSaves a recording that is logged to circular buffers in memory to the specified event trace log (ETL) file. The recording continues to run.\n\n## Syntax\n\n\n``` syntax\nHRESULT Save\n  ([in] BSTR bstrFileName,\n  [in] IProfileCollection* pProfileCollection,\n  [in] ITraceMergeProperties* pTraceMergeProperties)\n;\n```\n\n## Parameters\n\n\n<a href=\"\" id=\"bstrfilename\"></a>*bstrFileName*  \n\\[in\\] The name of the file to which merged events from recordings of all the profiles are saved.\n\n<a href=\"\" id=\"pprofilecollection\"></a>*pProfileCollection*  \n\\[in\\] A pointer to the [IProfileCollection](iprofilecollection.md) object that contains a collection of profiles to save.\n\n<a href=\"\" id=\"ptracemergeproperties\"></a>*pTraceMergeProperties*  \n\\[in\\] A pointer to the [ITraceMergeProperties](itracemergeproperties.md) object that contains properties with which to merge recordings.\n\n## Return Value\n\n\nThe following table describes possible return values.\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th>Return Value</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><p>S_OK</p></td>\n<td><p>The function successfully saved the recording.</p></td>\n</tr>\n<tr class=\"even\">\n<td><p>E_INVALIDARG</p></td>\n<td><p>One or more arguments are invalid.</p></td>\n</tr>\n<tr class=\"odd\">\n<td><p>E_WPRC_FAILED_TO_SAVE_PROFILE</p></td>\n<td><p>The library failed to save a profile in the profile collection. Use [IControlErrorInfo](icontrolerrorinfo.md) to obtain detailed error information.</p></td>\n</tr>\n<tr class=\"even\">\n<td><p>E_WPRC_TRACE_MERGE_LOST_EVENTS</p></td>\n<td><p>The Event Tracing for Windows (ETW) session lost events, and merging the event trace log (ETL) files from the session may create an incomplete ETL file.</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n## Remarks\n\n\nThis function is used only for profiles that are logging to circular buffers. After the sessions are saved, the recording continues to run.\n\n## Related topics\n\n\n[IControlManager](icontrolmanager.md)\n\n \n\n \n\n\n\n\n\n\n\n"}