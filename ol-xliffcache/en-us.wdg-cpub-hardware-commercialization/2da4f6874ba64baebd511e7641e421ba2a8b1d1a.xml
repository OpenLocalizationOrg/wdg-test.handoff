{"nodes":[{"content":"Flashing security requirements","pos":[34,64]},{"content":"Flashing security requirements","pos":[171,201]},{"content":"Flashing security requirements","pos":[209,239]},{"content":"Before flashing occurs, all OEM flashing mechanisms must validate cryptographic signatures in the image that chain to keys owned by the OEM.","pos":[242,382]},{"content":"This validation of the cryptographic signature on the image must be done on the device (not on a desktop flashing tool) and must be done before the image is flashed to eMMC memory.","pos":[383,563]},{"content":"This requirement is intended to protect devices from being compromised by users attempting to subvert the security protections in the system.","pos":[564,705]},{"content":"Mechanisms that can flash or update the state of the device (debuggers, memory inspectors, etc.) and that are not properly secured could be used by an attacker to circumvent the device’s security mechanisms.","pos":[706,913]},{"content":"The implemented solutions must be fully resilient even if the device is reverse engineered (that is, even if the user understands the operation of the security code in the firmware or SoC).","pos":[915,1104]},{"pos":[1280,1318],"content":"Flashing security requirements summary"},{"content":"Security on retail devices must also meet the following requirements:","pos":[1321,1390]},{"content":"Only secure flashing technologies can be included on retail devices.","pos":[1396,1464]},{"content":"Images to be flashed must be cryptographically signed through a process that is controlled and verified by the OEM or Microsoft.","pos":[1470,1598]},{"content":"Cryptographic signatures on images to be flashed must be verified by code on the device immediately before flashing.","pos":[1604,1720]},{"content":"Code that verifies cryptographic signatures on the device must be tamper proof, and cryptographic key material on the device used for verification must be trustworthy at the point in time that it is used.","pos":[1726,1930]},{"content":"Sufficiently large encryption algorithms must be used—at a minimum, RSA 2048 with SHA-256.","pos":[1936,2026]},{"content":"The flashing tool must check the SMBIOS device identification values before flashing.","pos":[2032,2117]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Developing custom OEM flashing tools<ept id=\"p1\">](developing-custom-oem-flashing-tools.md)</ept>.","pos":[2118,2217]},{"content":"The flashing tool must implement image integrity validation to protect against tampered images.","pos":[2223,2318]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Developing custom OEM flashing tools<ept id=\"p1\">](developing-custom-oem-flashing-tools.md)</ept>.","pos":[2319,2418]},{"content":"Industry best practices for source code development and supply chain security must be followed.","pos":[2424,2519]},{"content":"A threat model must be applied to identify priority risks, threats, and vulnerabilities.","pos":[2525,2613]},{"pos":[2762,2791],"content":"Recommended flashing solution"},{"content":"The following diagram illustrates a flashing solution that conforms to the flashing security requirements.","pos":[2794,2900]},{"content":"Images to be flashed must be signed by the OEM signing authority using documented procedures, ensuring that there is a high level of control and security throughout the process.","pos":[2901,3078]},{"content":"The component that initiates the flashing operation must perform a cryptographic verification of the signature on the image to be flashed using trustworthy key material immediately before flashing.","pos":[3079,3276]},{"content":"The cryptographic key should be stored so that it is tied either to secure boot key material (OEM<ph id=\"ph1\">\\_</ph>PK<ph id=\"ph2\">\\_</ph>HASH or UEFI Variable PK) or to a public key that is embedded in a binary that is cryptographically validated by secure boot.","pos":[3278,3506]},{"content":"It is not acceptable to store the public or private key in the DPP, or in any other unsigned and unvalidated file store.","pos":[3507,3627]},{"content":"oem<ph id=\"ph1\">\\-</ph>fieldservicesec<ph id=\"ph2\">\\-</ph>flashingreq","pos":[3631,3664]},{"pos":[3747,3761],"content":"Related topics"},{"content":"Developing custom OEM flashing tools","pos":[3765,3801]},{"content":"Implementing image integrity validation in custom flashing tools","pos":[3846,3910]}],"content":"---\nauthor: kpacquer\nDescription: Flashing security requirements\nms.assetid: 78c22243-e9a4-4394-9f91-5922c15286e8\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: Flashing security requirements\n---\n\n# Flashing security requirements\n\n\nBefore flashing occurs, all OEM flashing mechanisms must validate cryptographic signatures in the image that chain to keys owned by the OEM. This validation of the cryptographic signature on the image must be done on the device (not on a desktop flashing tool) and must be done before the image is flashed to eMMC memory. This requirement is intended to protect devices from being compromised by users attempting to subvert the security protections in the system. Mechanisms that can flash or update the state of the device (debuggers, memory inspectors, etc.) and that are not properly secured could be used by an attacker to circumvent the device’s security mechanisms.\n\nThe implemented solutions must be fully resilient even if the device is reverse engineered (that is, even if the user understands the operation of the security code in the firmware or SoC).\n\n## <span id=\"Flashing_security_requirements_summary\"></span><span id=\"flashing_security_requirements_summary\"></span><span id=\"FLASHING_SECURITY_REQUIREMENTS_SUMMARY\"></span>Flashing security requirements summary\n\n\nSecurity on retail devices must also meet the following requirements:\n\n-   Only secure flashing technologies can be included on retail devices.\n\n-   Images to be flashed must be cryptographically signed through a process that is controlled and verified by the OEM or Microsoft.\n\n-   Cryptographic signatures on images to be flashed must be verified by code on the device immediately before flashing.\n\n-   Code that verifies cryptographic signatures on the device must be tamper proof, and cryptographic key material on the device used for verification must be trustworthy at the point in time that it is used.\n\n-   Sufficiently large encryption algorithms must be used—at a minimum, RSA 2048 with SHA-256.\n\n-   The flashing tool must check the SMBIOS device identification values before flashing. For more info, see [Developing custom OEM flashing tools](developing-custom-oem-flashing-tools.md).\n\n-   The flashing tool must implement image integrity validation to protect against tampered images. For more info, see [Developing custom OEM flashing tools](developing-custom-oem-flashing-tools.md).\n\n-   Industry best practices for source code development and supply chain security must be followed.\n\n-   A threat model must be applied to identify priority risks, threats, and vulnerabilities.\n\n## <span id=\"Recommended_flashing_solution\"></span><span id=\"recommended_flashing_solution\"></span><span id=\"RECOMMENDED_FLASHING_SOLUTION\"></span>Recommended flashing solution\n\n\nThe following diagram illustrates a flashing solution that conforms to the flashing security requirements. Images to be flashed must be signed by the OEM signing authority using documented procedures, ensuring that there is a high level of control and security throughout the process. The component that initiates the flashing operation must perform a cryptographic verification of the signature on the image to be flashed using trustworthy key material immediately before flashing.\n\nThe cryptographic key should be stored so that it is tied either to secure boot key material (OEM\\_PK\\_HASH or UEFI Variable PK) or to a public key that is embedded in a binary that is cryptographically validated by secure boot. It is not acceptable to store the public or private key in the DPP, or in any other unsigned and unvalidated file store.\n\n![oem\\-fieldservicesec\\-flashingreq](images/oem-fieldservicesec-flashingreq.png)\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[Developing custom OEM flashing tools](developing-custom-oem-flashing-tools.md)\n\n[Implementing image integrity validation in custom flashing tools](implementing-image-integrity-validation-in-custom-flashing-tools.md)\n\n \n\n \n\n\n\n\n\n\n"}