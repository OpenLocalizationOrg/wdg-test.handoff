{"nodes":[{"content":"BCD System Store Settings for UEFI","pos":[34,68]},{"content":"BCD System Store Settings for UEFI","pos":[175,209]},{"content":"BCD System Store Settings for UEFI","pos":[217,251]},{"content":"For a typical deployment scenario, you do not need to modify the BCD store.","pos":[254,329]},{"content":"This topic discusses the various BCD settings in the BCD store that you can modify.","pos":[330,413]},{"content":"On UEFI systems, this includes settings for the following boot applications:","pos":[414,490]},{"content":"Windows Boot Manager","pos":[497,517]},{"content":"Windows Boot Loader","pos":[546,565]},{"content":"Windows Memory Tester","pos":[593,614]},{"content":"The following sections describe the available settings for each of these boot applications in detail and how to modify each application for UEFI systems.","pos":[639,792]},{"content":"For simplicity, the BCDEdit examples in this section modify the BCD system store.","pos":[794,875]},{"content":"To modify another store, such as a copy of the BCD-template, include the store name in the command line.","pos":[876,980]},{"pos":[1096,1134],"content":"Windows Boot Manager Settings for UEFI"},{"content":"Windows Boot Manager (<ph id=\"ph1\">`{bootmgr}`</ph>) manages the boot process.","pos":[1137,1197]},{"content":"UEFI-based systems contain a firmware boot manager, Bootmgfw.efi, that loads an EFI application that is based on variables that are stored in NVRAM.","pos":[1198,1346]},{"content":"The BCD settings for the <ph id=\"ph1\">`device`</ph> and <ph id=\"ph2\">`path`</ph> elements in Windows Boot Manager indicate the firmware boot manager.","pos":[1348,1461]},{"content":"The template that is named BCD-template for Windows includes the following settings for Windows Boot Manager.","pos":[1462,1571]},{"pos":[1911,1925],"content":"Device Setting"},{"content":"The <ph id=\"ph1\">`device`</ph> element specifies the volume that contains Windows Boot Manager.","pos":[1927,2004]},{"content":"For UEFI systems, the <ph id=\"ph1\">`device`</ph> element for Windows Boot Manager is set to the system partition volume letter.","pos":[2005,2114]},{"content":"To determine the correct volume letter, use the Diskpart tool to view the disk partitions.","pos":[2115,2205]},{"content":"The following example assumes that the system has a single hard drive that has multiple partitions, including a system partition that has been assigned a drive letter of S.","pos":[2206,2378]},{"content":"The following Diskpart commands select disk 0 and then list the details of the volumes on that disk, including their drive letters.","pos":[2380,2511]},{"content":"It shows volume 2 as the system partition.","pos":[2512,2554]},{"content":"If the system partition does not have an assigned drive letter, assign one by using the <bpt id=\"p1\">**</bpt>Diskpart assign<ept id=\"p1\">**</ept> command.","pos":[2970,3086]},{"content":"The following example assumes that the system partition is volume 2 and assigns it S as the drive letter.","pos":[3087,3192]},{"content":"After you have determined the system partition volume, set the <ph id=\"ph1\">`device`</ph> element for Windows Boot Manager to the corresponding drive letter.","pos":[3324,3463]},{"content":"The following example sets <ph id=\"ph1\">`device`</ph> to drive S.","pos":[3464,3511]},{"pos":[3688,3700],"content":"Path Setting"},{"content":"The <ph id=\"ph1\">`path`</ph> element specifies the location of the Windows Boot Manager application on that volume.","pos":[3702,3799]},{"content":"For UEFI systems, <ph id=\"ph1\">`path`</ph> indicates the firmware boot manager, whose path is <ph id=\"ph2\">\\\\</ph>EFI<ph id=\"ph3\">\\\\</ph>Microsoft<ph id=\"ph4\">\\\\</ph>Boot<ph id=\"ph5\">\\\\</ph>Bootmgfw.efi.","pos":[3800,3913]},{"content":"You can confirm that BCD-template has the correct path by enumerating the values in the store, as follows:","pos":[3915,4021]},{"pos":[4077,4169],"content":"To explicitly set <ph id=\"ph1\">`path`</ph> to <ph id=\"ph2\">\\\\</ph>EFI<ph id=\"ph3\">\\\\</ph>Microsoft<ph id=\"ph4\">\\\\</ph>Boot<ph id=\"ph5\">\\\\</ph>Bootmgfw.efi, use the following command."},{"pos":[4351,4365],"content":"Other Settings"},{"content":"You should set Windows Boot Manager to be the first item in the display order of the UEFI firmware, as shown in the following example.","pos":[4367,4501]},{"content":"You should also specify the topmost Windows boot loader application in the Windows Boot Manager display order.","pos":[4577,4687]},{"content":"The following example shows how to put a specified Windows boot loader at the top of the display order.","pos":[4688,4791]},{"content":"In the preceding example, <ph id=\"ph1\">&amp;lt;</ph>GUID<ph id=\"ph2\">&amp;gt;</ph> is the identifier for the specified Windows boot loader object.","pos":[4864,4966]},{"content":"The next section discusses this identifier in greater detail.","pos":[4967,5028]},{"content":"Note","pos":[5032,5036]},{"content":"A multiboot system that has multiple installed operating systems has multiple instances of the Windows boot loader.","pos":[5041,5156]},{"content":"Each instance of the Windows boot loader has its own identifier.","pos":[5157,5221]},{"content":"You can set the default Windows boot loader (<ph id=\"ph1\">`{default}`</ph>) to any of these identifiers.","pos":[5222,5308]},{"pos":[5424,5452],"content":"Windows Boot Loader Settings"},{"content":"A BCD store has at least one instance, and optionally multiple instances, of the Windows boot loader.","pos":[5455,5556]},{"content":"A separate BCD object represents each instance.","pos":[5557,5604]},{"content":"Each instance loads one of the installed versions of Windows that has a configuration that the object's elements have specified.","pos":[5605,5733]},{"content":"Each Windows boot loader object has its own identifier, and the object's <ph id=\"ph1\">`device`</ph> and <ph id=\"ph2\">`path`</ph> settings indicate the correct partition and boot application.","pos":[5734,5888]},{"pos":[5905,5989],"content":"for Windows has a single Windows boot loader object that has the following settings."},{"content":"The identifier for this Windows boot loader is {9f25ee7a-e7b7-11db-94b5-f7e662935912}.","pos":[6379,6465]},{"content":"You can use this GUID on your system or let the BCDEdit tool generate a new GUID for you.","pos":[6466,6555]},{"content":"To simplify BCDEdit commands, you can specify one of the Windows boot loaders in the BCD system store as the default loader.","pos":[6557,6681]},{"content":"You can then use the standard identifier (<ph id=\"ph1\">`{default}`</ph>) in place of the full GUID.The following example specifies the Windows boot loader for EFI as the default boot loader, assuming that it uses the identifier GUID from BCD-template.","pos":[6682,6915]},{"pos":[7134,7162],"content":"Device and OSDevice Settings"},{"content":"The following elements specify key locations:","pos":[7164,7209]},{"pos":[7211,7291],"content":"The <ph id=\"ph1\">`device`</ph> element specifies the partition that contains the boot application."},{"pos":[7293,7370],"content":"The <ph id=\"ph1\">`osdevice`</ph> element specifies the partition that contains the system root."},{"content":"For the Windows boot loader for EFI, both elements are usually set to the drive letter of the Windows system partition.","pos":[7372,7491]},{"content":"However, if BitLocker is enabled or a computer has multiple installed versions of Windows, <ph id=\"ph1\">`osdevice`</ph> and <ph id=\"ph2\">`device`</ph> might be set to different partitions.BCD-template sets both elements to drive C, which is the typical value.","pos":[7492,7715]},{"content":"You can also explicitly set the <ph id=\"ph1\">`osdevice`</ph> and <ph id=\"ph2\">`device`</ph> values, as shown in the following example.","pos":[7716,7814]},{"content":"The example also assumes that you have specified the Windows boot loader for EFI as the default boot-loader object.","pos":[7815,7930]},{"pos":[8133,8145],"content":"Path Setting"},{"content":"The <ph id=\"ph1\">`path`</ph> element of a Windows boot loader specifies the location of the boot loader on that volume.","pos":[8147,8248]},{"content":"For UEFI systems, <ph id=\"ph1\">`path`</ph> indicates the Windows boot loader for EFI, whose path is <ph id=\"ph2\">\\\\</ph>Windows<ph id=\"ph3\">\\\\</ph>System32<ph id=\"ph4\">\\\\</ph>Winload.efi.","pos":[8249,8364]},{"content":"You can confirm that BCD-template has the correct <ph id=\"ph1\">`path`</ph> value by enumerating the values in the store.","pos":[8366,8468]},{"content":"You can also explicitly set the <ph id=\"ph1\">`path`</ph> value, as shown in the following example.","pos":[8469,8549]},{"pos":[8742,8772],"content":"Windows Memory Tester Settings"},{"content":"The Windows memory tester (<ph id=\"ph1\">`{memdiag}`</ph>) runs memory diagnostics at boot time.","pos":[8775,8852]},{"content":"The BCD settings for the application's <ph id=\"ph1\">`device`</ph> and <ph id=\"ph2\">`path`</ph> elements indicate the correct application.","pos":[8853,8954]},{"content":"Note","pos":[8958,8962]},{"content":"Note: Intel Itanium computers do not include a Windows memory tester and do not require <ph id=\"ph1\">`{memdiag}`</ph> settings.","pos":[8967,9076]},{"content":"BCD-template for Windows has the following settings.","pos":[9081,9133]},{"pos":[9464,9478],"content":"Device Setting"},{"content":"For UEFI systems, the <ph id=\"ph1\">`device`</ph> element for the Windows memory tester is set to the system partition drive letter.","pos":[9480,9593]},{"content":"The following example assumes that the system partition is drive S, as used in earlier examples.","pos":[9594,9690]},{"pos":[9869,9881],"content":"Path Setting"},{"content":"The <ph id=\"ph1\">`path`</ph> element specifies the location of Windows Test Manager on the volume that the <ph id=\"ph2\">`device`</ph> element has specified.","pos":[9883,10003]},{"content":"For UEFI systems, <ph id=\"ph1\">`path`</ph> indicates the EFI version of the application (<ph id=\"ph2\">\\\\</ph>EFI<ph id=\"ph3\">\\\\</ph>Microsoft<ph id=\"ph4\">\\\\</ph>Boot<ph id=\"ph5\">\\\\</ph>Memtest.efi).","pos":[10004,10112]},{"content":"You can confirm that BCD-template has the correct <ph id=\"ph1\">`path`</ph> value by enumerating the values in the store.","pos":[10114,10216]},{"content":"You can also use the BCDEdit tool to explicitly set the <ph id=\"ph1\">`path`</ph> value, as shown in the following example.","pos":[10217,10321]}],"content":"---\nauthor: Justinha\nDescription: BCD System Store Settings for UEFI\nms.assetid: bfafe378-7ac3-453e-99ca-e5fde83dee2f\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: BCD System Store Settings for UEFI\n---\n\n# BCD System Store Settings for UEFI\n\n\nFor a typical deployment scenario, you do not need to modify the BCD store. This topic discusses the various BCD settings in the BCD store that you can modify. On UEFI systems, this includes settings for the following boot applications:\n\n1.  [Windows Boot Manager](#windowsbootmanager)\n\n2.  [Windows Boot Loader](#windowsbootloader)\n\n3.  [Windows Memory Tester](#windowsmemorytester)\n\nThe following sections describe the available settings for each of these boot applications in detail and how to modify each application for UEFI systems.\n\nFor simplicity, the BCDEdit examples in this section modify the BCD system store. To modify another store, such as a copy of the BCD-template, include the store name in the command line.\n\n## <span id=\"WindowsBootManager\"></span><span id=\"windowsbootmanager\"></span><span id=\"WINDOWSBOOTMANAGER\"></span>Windows Boot Manager Settings for UEFI\n\n\nWindows Boot Manager (`{bootmgr}`) manages the boot process. UEFI-based systems contain a firmware boot manager, Bootmgfw.efi, that loads an EFI application that is based on variables that are stored in NVRAM.\n\nThe BCD settings for the `device` and `path` elements in Windows Boot Manager indicate the firmware boot manager. The template that is named BCD-template for Windows includes the following settings for Windows Boot Manager.\n\n``` syntax\n## Windows Boot Manager\n\nidentifier              {bootmgr}\ndevice                  partition=\\Device\\HarddiskVolume1\npath                    \\EFI\\Microsoft\\Boot\\bootmgfw.efi\ndescription             Windows Boot Manager\n```\n\n### <span id=\"Device_Setting\"></span><span id=\"device_setting\"></span><span id=\"DEVICE_SETTING\"></span>Device Setting\n\nThe `device` element specifies the volume that contains Windows Boot Manager. For UEFI systems, the `device` element for Windows Boot Manager is set to the system partition volume letter. To determine the correct volume letter, use the Diskpart tool to view the disk partitions. The following example assumes that the system has a single hard drive that has multiple partitions, including a system partition that has been assigned a drive letter of S.\n\nThe following Diskpart commands select disk 0 and then list the details of the volumes on that disk, including their drive letters. It shows volume 2 as the system partition.\n\n``` syntax\nDISKPART> select disk 0\nDISKPART> list volume\n\n  Volume ###  Ltr  Label   Fs     Type        Size     Status     Info\n  ----------  ---  ------  -----  ----------  -------  ---------  ------\n  Volume 0     D           NTFS   Partition    103 GB  Healthy\n  Volume 1     C           NTFS   Partition     49 GB  Healthy    Boot\n  Volume 2     S           FAT32  Partition    200 MB  Healthy    System\n```\n\nIf the system partition does not have an assigned drive letter, assign one by using the **Diskpart assign** command. The following example assumes that the system partition is volume 2 and assigns it S as the drive letter.\n\n``` syntax\nDiskpart\nselect disk 0\nlist volume\nselect volume 2   // assuming volume 2 is the system partition\nassign letter=s\n```\n\nAfter you have determined the system partition volume, set the `device` element for Windows Boot Manager to the corresponding drive letter. The following example sets `device` to drive S.\n\n``` syntax\nBcdedit /set {bootmgr} device partition=s:// system partition\n```\n\n### <span id=\"Path_Setting\"></span><span id=\"path_setting\"></span><span id=\"PATH_SETTING\"></span>Path Setting\n\nThe `path` element specifies the location of the Windows Boot Manager application on that volume. For UEFI systems, `path` indicates the firmware boot manager, whose path is \\\\EFI\\\\Microsoft\\\\Boot\\\\Bootmgfw.efi.\n\nYou can confirm that BCD-template has the correct path by enumerating the values in the store, as follows:\n\n``` syntax\nbcdedit /store bcd-template /enum all\n```\n\nTo explicitly set `path` to \\\\EFI\\\\Microsoft\\\\Boot\\\\Bootmgfw.efi, use the following command.\n\n``` syntax\nBcdedit /set {bootmgr} path \\efi\\microsoft\\boot\\bootmgfw.efi\n```\n\n### <span id=\"Other_Settings\"></span><span id=\"other_settings\"></span><span id=\"OTHER_SETTINGS\"></span>Other Settings\n\nYou should set Windows Boot Manager to be the first item in the display order of the UEFI firmware, as shown in the following example.\n\n``` syntax\nBcdedit /set {fwbootmgr} displayorder {bootmgr} /addfirst\n```\n\nYou should also specify the topmost Windows boot loader application in the Windows Boot Manager display order. The following example shows how to put a specified Windows boot loader at the top of the display order.\n\n``` syntax\nBcdedit /set {bootmgr} displayorder {<GUID>} /addfirst\n```\n\nIn the preceding example, &lt;GUID&gt; is the identifier for the specified Windows boot loader object. The next section discusses this identifier in greater detail.\n\n**Note**  \nA multiboot system that has multiple installed operating systems has multiple instances of the Windows boot loader. Each instance of the Windows boot loader has its own identifier. You can set the default Windows boot loader (`{default}`) to any of these identifiers.\n\n \n\n## <span id=\"WindowsBootLoader\"></span><span id=\"windowsbootloader\"></span><span id=\"WINDOWSBOOTLOADER\"></span>Windows Boot Loader Settings\n\n\nA BCD store has at least one instance, and optionally multiple instances, of the Windows boot loader. A separate BCD object represents each instance. Each instance loads one of the installed versions of Windows that has a configuration that the object's elements have specified. Each Windows boot loader object has its own identifier, and the object's `device` and `path` settings indicate the correct partition and boot application.\n\n`BCD-template` for Windows has a single Windows boot loader object that has the following settings.\n\n``` syntax\n## Windows Boot Loader\n\nidentifier              {9f25ee7a-e7b7-11db-94b5-f7e662935912}\ndevice                  partition=C:\npath                    \\Windows\\system32\\winload.efi\ndescription             Microsoft Windows Server\nlocale                  en-US\ninherit                 {bootloadersettings}\nosdevice                partition=C:\nsystemroot              \\Windows\n```\n\nThe identifier for this Windows boot loader is {9f25ee7a-e7b7-11db-94b5-f7e662935912}. You can use this GUID on your system or let the BCDEdit tool generate a new GUID for you.\n\nTo simplify BCDEdit commands, you can specify one of the Windows boot loaders in the BCD system store as the default loader. You can then use the standard identifier (`{default}`) in place of the full GUID.The following example specifies the Windows boot loader for EFI as the default boot loader, assuming that it uses the identifier GUID from BCD-template.\n\n``` syntax\nBcdedit /default {9f25ee7a-e7b7-11db-94b5-f7e662935912}\n```\n\n### <span id=\"Device_and_OSDevice_Settings\"></span><span id=\"device_and_osdevice_settings\"></span><span id=\"DEVICE_AND_OSDEVICE_SETTINGS\"></span>Device and OSDevice Settings\n\nThe following elements specify key locations:\n\nThe `device` element specifies the partition that contains the boot application.\n\nThe `osdevice` element specifies the partition that contains the system root.\n\nFor the Windows boot loader for EFI, both elements are usually set to the drive letter of the Windows system partition. However, if BitLocker is enabled or a computer has multiple installed versions of Windows, `osdevice` and `device` might be set to different partitions.BCD-template sets both elements to drive C, which is the typical value. You can also explicitly set the `osdevice` and `device` values, as shown in the following example. The example also assumes that you have specified the Windows boot loader for EFI as the default boot-loader object.\n\n``` syntax\nBcdedit /set {default} device partition=c:\nBcdedit /set {default} osdevice partition=c:\n```\n\n### <span id=\"Path_Setting\"></span><span id=\"path_setting\"></span><span id=\"PATH_SETTING\"></span>Path Setting\n\nThe `path` element of a Windows boot loader specifies the location of the boot loader on that volume. For UEFI systems, `path` indicates the Windows boot loader for EFI, whose path is \\\\Windows\\\\System32\\\\Winload.efi.\n\nYou can confirm that BCD-template has the correct `path` value by enumerating the values in the store. You can also explicitly set the `path` value, as shown in the following example.\n\n``` syntax\nBcdedit /set {default} path \\windows\\system32\\winload.efi\n```\n\n## <span id=\"WindowsMemoryTester\"></span><span id=\"windowsmemorytester\"></span><span id=\"WINDOWSMEMORYTESTER\"></span>Windows Memory Tester Settings\n\n\nThe Windows memory tester (`{memdiag}`) runs memory diagnostics at boot time. The BCD settings for the application's `device` and `path` elements indicate the correct application.\n\n**Note**  \nNote: Intel Itanium computers do not include a Windows memory tester and do not require `{memdiag}` settings.\n\n \n\nBCD-template for Windows has the following settings.\n\n``` syntax\n## Windows Memory Tester\n\nidentifier              {memdiag}\ndevice                  partition=\\Device\\HarddiskVolume1\npath                    \\boot\\memtest.exe\ndescription             Windows Memory Diagnostic\n```\n\n### <span id=\"Device_Setting\"></span><span id=\"device_setting\"></span><span id=\"DEVICE_SETTING\"></span>Device Setting\n\nFor UEFI systems, the `device` element for the Windows memory tester is set to the system partition drive letter. The following example assumes that the system partition is drive S, as used in earlier examples.\n\n``` syntax\nBcdedit /set {bootmgr} device partition=s:  // system partition\n```\n\n### <span id=\"Path_Setting\"></span><span id=\"path_setting\"></span><span id=\"PATH_SETTING\"></span>Path Setting\n\nThe `path` element specifies the location of Windows Test Manager on the volume that the `device` element has specified. For UEFI systems, `path` indicates the EFI version of the application (\\\\EFI\\\\Microsoft\\\\Boot\\\\Memtest.efi).\n\nYou can confirm that BCD-template has the correct `path` value by enumerating the values in the store. You can also use the BCDEdit tool to explicitly set the `path` value, as shown in the following example.\n\n``` syntax\nBcdedit /set {memdiag} path \\efi\\microsoft\\boot\\memtest.efi\n```\n\n \n\n \n\n\n\n\n\n"}