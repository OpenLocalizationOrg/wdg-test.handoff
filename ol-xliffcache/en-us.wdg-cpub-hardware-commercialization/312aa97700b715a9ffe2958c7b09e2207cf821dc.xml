{"nodes":[{"content":"StartHeapTrace","pos":[11,25]},{"content":"StartHeapTrace","pos":[39,53]},{"content":"StartHeapTrace","pos":[242,256]},{"content":"Some information relates to pre-released product which may be substantially modified before it's commercially released.","pos":[261,380]},{"content":"Microsoft makes no warranties, express or implied, with respect to the information provided here.","pos":[381,478]},{"content":"This function registers and starts a heap tracing session for a set of specified PIDs.","pos":[482,568]},{"content":"You can also enable stack walking for certain heap events such as allocation or deletion using this function.","pos":[569,678]},{"content":"The process for which heap tracing is to be enabled must be created before calling this function.","pos":[680,777]},{"content":"In order to capture heap events from the very start of the program, it is advisable that the process be started with the <bpt id=\"p1\">[</bpt>CREATE<ph id=\"ph1\">\\_</ph>SUSPENDED<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/ms682425.aspx)</ept> flag, then heap tracing enabled for its PID, then the process resumed.","pos":[778,1055]},{"content":"Heap tracing is very verbose and can quickly generate a very large trace file.","pos":[1057,1135]},{"content":"Events may be lost easily if the session’s buffers are too small or too few.","pos":[1136,1212]},{"content":"It is recommended that the number of processes for which heap tracing is enabled be limited in order to not lose events.","pos":[1213,1333]},{"content":"Enabling heap tracing may have a performance impact on the process being traced.","pos":[1334,1414]},{"content":"Parameters","pos":[1792,1802]},{"content":"<bpt id=\"p1\">*</bpt>TraceHandle<ept id=\"p1\">*</ept> <ph id=\"ph1\">\\[</ph>out","pos":[1843,1862]},{"content":"Stores a handle to an event tracing session.","pos":[1867,1911]},{"content":"This parameter is set to zero if the handle is not valid.","pos":[1912,1969]},{"content":"This parameter should not be compared to INVALID<ph id=\"ph1\">\\_</ph>HANDLE<ph id=\"ph2\">\\_</ph>VALUE.","pos":[1970,2034]},{"content":"Do not use this handle if the function fails.","pos":[2035,2080]},{"content":"<bpt id=\"p1\">*</bpt>Properties<ept id=\"p1\">*</ept> <ph id=\"ph1\">\\[</ph>in, out","pos":[2123,2145]},{"content":"Stores a pointer to an <bpt id=\"p1\">[</bpt>EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>PROPERTIES<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/aa363784.aspx)</ept> structure.","pos":[2150,2276]},{"content":"EVENT<ph id=\"ph1\">\\_</ph>TRACE<ph id=\"ph2\">\\_</ph>PROPERTIES configures certain aspects of session behavior.","pos":[2277,2349]},{"content":"It is not necessary to set the Guid member because this function always uses the its own value.","pos":[2351,2446]},{"content":"If you do specify a GUID it will not be used.","pos":[2447,2492]},{"content":"<bpt id=\"p1\">*</bpt>wszSessionName<ept id=\"p1\">*</ept> <ph id=\"ph1\">\\[</ph>in","pos":[2534,2555]},{"content":"SThe session name to pass to <bpt id=\"p1\">[</bpt>StartTrace<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/aa364117.aspx)</ept>.","pos":[2560,2668]},{"content":"<bpt id=\"p1\">*</bpt>Pids<ept id=\"p1\">*</ept> <ph id=\"ph1\">\\[</ph>in","pos":[2700,2711]},{"content":"An array of process IDs to enable heap tracing on.","pos":[2716,2766]},{"content":"<bpt id=\"p1\">*</bpt>cPids<ept id=\"p1\">*</ept> <ph id=\"ph1\">\\[</ph>in","pos":[2799,2811]},{"content":"The size of the Pids array.","pos":[2816,2843]},{"content":"<bpt id=\"p1\">*</bpt>cStackTracingEventIds<ept id=\"p1\">*</ept> <ph id=\"ph1\">\\[</ph>in","pos":[2892,2920]},{"content":"The size of the StackTracingEventIds array.","pos":[2925,2968]},{"content":"Return Value","pos":[2973,2985]},{"content":"ERROR<ph id=\"ph1\">\\_</ph>SUCCESS indicates success.","pos":[2988,3021]},{"content":"Possible error values are described in the following table.","pos":[3023,3082]},{"content":"Error Value","pos":[3187,3198]},{"content":"Description","pos":[3208,3219]},{"content":"ERROR_ALREADY_EXISTS","pos":[3272,3292]},{"content":"Only a single instance of the kernel logger runs on the system.","pos":[3309,3372]},{"content":"If this function attempts to start after another component has started kernel logging, this error is possibly returned.","pos":[3373,3492]},{"content":"ERROR_INVALID_FLAGS","pos":[3533,3552]},{"content":"Possibly indicates that there are invalid trace flags in <ph id=\"ph1\">&lt;strong&gt;</ph>Properties.EnableFlags<ph id=\"ph2\">&lt;/strong&gt;</ph>.","pos":[3569,3666]},{"content":"ERROR_OUT_OF_MEMORY","pos":[3706,3725]},{"content":"Possibly indicates failure to allocate memory for EVENT_TRACE_PROPERTIES.","pos":[3742,3815]},{"content":"If the function fails for a reason other than those listed, a system error code is returned.","pos":[3853,3945]},{"content":"Remarks","pos":[3950,3957]},{"content":"None","pos":[3960,3964]},{"content":"Related topics","pos":[3969,3983]},{"content":"Functions","pos":[3987,3996]},{"content":"UpdateHeapTrace","pos":[4018,4033]}],"content":"---\ntitle: StartHeapTrace\ndescription: StartHeapTrace\nMSHAttr:\n- 'PreferredSiteName:MSDN'\n- 'PreferredLib:/library/windows/hardware'\nms.assetid: 2f3ecae0-532a-45ab-a5e3-a5ed4868decf\nms.prod: W10\nms.mktglfcycl: operate\nms.sitesec: msdn\n---\n\n# StartHeapTrace\n\n\n\\[Some information relates to pre-released product which may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.\\]\n\nThis function registers and starts a heap tracing session for a set of specified PIDs. You can also enable stack walking for certain heap events such as allocation or deletion using this function.\n\nThe process for which heap tracing is to be enabled must be created before calling this function. In order to capture heap events from the very start of the program, it is advisable that the process be started with the [CREATE\\_SUSPENDED](https://msdn.microsoft.com/library/windows/desktop/ms682425.aspx) flag, then heap tracing enabled for its PID, then the process resumed.\n\nHeap tracing is very verbose and can quickly generate a very large trace file. Events may be lost easily if the session’s buffers are too small or too few. It is recommended that the number of processes for which heap tracing is enabled be limited in order to not lose events. Enabling heap tracing may have a performance impact on the process being traced.\n\n``` syntax\nULONG\nWINAPI\nStartHeapTrace(\n    _Out_ PTRACEHANDLE TraceHandle,\n    _Inout_ PEVENT_TRACE_PROPERTIES Properties,\n    _In_z_ LPCWSTR wszSessionName,\n    _In_reads_opt_(cPids) const ULONG Pids[],\n    _In_  ULONG cPids,\n    _In_reads_opt_(cStackTracingEventIds) const STACK_TRACING_EVENT_ID StackTracingEventIds[],\n    _In_  ULONG cStackTracingEventIds\n    );\n```\n\n## Parameters\n\n\n<a href=\"\" id=\"tracehandle--out-\"></a>*TraceHandle* \\[out\\]  \nStores a handle to an event tracing session. This parameter is set to zero if the handle is not valid. This parameter should not be compared to INVALID\\_HANDLE\\_VALUE. Do not use this handle if the function fails.\n\n<a href=\"\" id=\"properties--in--out-\"></a>*Properties* \\[in, out\\]  \nStores a pointer to an [EVENT\\_TRACE\\_PROPERTIES](https://msdn.microsoft.com/library/windows/desktop/aa363784.aspx) structure. EVENT\\_TRACE\\_PROPERTIES configures certain aspects of session behavior.\n\nIt is not necessary to set the Guid member because this function always uses the its own value. If you do specify a GUID it will not be used.\n\n<a href=\"\" id=\"wszsessionname--in-\"></a>*wszSessionName* \\[in\\]  \nSThe session name to pass to [StartTrace](https://msdn.microsoft.com/library/windows/desktop/aa364117.aspx).\n\n<a href=\"\" id=\"pids--in-\"></a>*Pids* \\[in\\]  \nAn array of process IDs to enable heap tracing on.\n\n<a href=\"\" id=\"cpids--in-\"></a>*cPids* \\[in\\]  \nThe size of the Pids array.\n\n<a href=\"\" id=\"cstacktracingeventids--in-\"></a>*cStackTracingEventIds* \\[in\\]  \nThe size of the StackTracingEventIds array.\n\n## Return Value\n\n\nERROR\\_SUCCESS indicates success.\n\nPossible error values are described in the following table.\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th>Error Value</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td><p>ERROR_ALREADY_EXISTS</p></td>\n<td><p>Only a single instance of the kernel logger runs on the system. If this function attempts to start after another component has started kernel logging, this error is possibly returned.</p></td>\n</tr>\n<tr class=\"even\">\n<td><p>ERROR_INVALID_FLAGS</p></td>\n<td><p>Possibly indicates that there are invalid trace flags in <strong>Properties.EnableFlags</strong>.</p></td>\n</tr>\n<tr class=\"odd\">\n<td><p>ERROR_OUT_OF_MEMORY</p></td>\n<td><p>Possibly indicates failure to allocate memory for EVENT_TRACE_PROPERTIES.</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\nIf the function fails for a reason other than those listed, a system error code is returned.\n\n## Remarks\n\n\nNone\n\n## Related topics\n\n\n[Functions](functions-wpa.md)\n\n[UpdateHeapTrace](updateheaptrace.md)\n\n \n\n \n\n\n\n\n\n\n\n"}