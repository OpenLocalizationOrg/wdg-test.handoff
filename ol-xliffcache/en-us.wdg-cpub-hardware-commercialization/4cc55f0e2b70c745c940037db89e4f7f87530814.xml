{"nodes":[{"content":"Wpeinit and Startnet.cmd: Using WinPE Startup Scripts","pos":[35,88]},{"content":"Wpeinit and Startnet.cmd: Using WinPE Startup Scripts","pos":[197,250]},{"content":"Wpeinit and Startnet.cmd: Using WinPE Startup Scripts","pos":[259,312]},{"content":"Use Wpeinit and Startnet.cmd to run startup scripts when Windows PE (WinPE) first runs.","pos":[315,402]},{"pos":[404,475],"content":"Wpeinit outputs log messages to <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>system32<ph id=\"ph3\">\\\\</ph>wpeinit.log<ept id=\"p1\">**</ept>."},{"pos":[542,554],"content":"Startnet.cmd"},{"content":"You can add customized command-line scripts in Windows PE by using Startnet.cmd.","pos":[557,637]},{"content":"By default, Windows PE includes a Startnet.cmd script located at %SYSTEMROOT%<ph id=\"ph1\">\\\\</ph>System32 of your customized Windows PE image.","pos":[638,762]},{"content":"Startnet.cmd starts Wpeinit.exe.","pos":[764,796]},{"content":"Wpeinit.exe installs Plug and Play devices, processes Unattend.xml settings, and loads network resources.","pos":[797,902]},{"pos":[904,982],"content":"For more info, see <bpt id=\"p1\">[</bpt>WinPE: Mount and Customize<ept id=\"p1\">](winpe-mount-and-customize.md)</ept>."},{"pos":[1128,1156],"content":"Wpeinit Command-Line Options"},{"content":"The following command-line option is available for Wpeinit:","pos":[1159,1218]},{"pos":[1220,1276],"content":"<bpt id=\"p1\">**</bpt>Wpeinit<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>-unattend:<bpt id=\"p2\">*</bpt><ph id=\"ph2\">&amp;lt;</ph>path<ph id=\"ph3\">\\_</ph>to<ph id=\"ph4\">\\_</ph>answer<ph id=\"ph5\">\\_</ph>file<ph id=\"ph6\">&amp;gt;</ph><ept id=\"p2\">*</ept>"},{"content":"Example:","pos":[1280,1288]},{"pos":[1486,1513],"content":"Supported Unattend settings"},{"content":"You can create an answer file and include any of the following settings for use with Windows PE:","pos":[1516,1612]},{"pos":[1618,1713],"content":"Microsoft-Windows-Setup/<bpt id=\"p1\">[</bpt>Display<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/dn915285)</ept>"},{"pos":[1719,1821],"content":"Microsoft-Windows-Setup/<bpt id=\"p1\">[</bpt>EnableFirewall<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/dn915375)</ept>"},{"pos":[1827,1928],"content":"Microsoft-Windows-Setup/<bpt id=\"p1\">[</bpt>EnableNetwork<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/dn915383)</ept>"},{"pos":[1934,2029],"content":"Microsoft-Windows-Setup/<bpt id=\"p1\">[</bpt>LogPath<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/dn915490)</ept>"},{"pos":[2035,2131],"content":"Microsoft-Windows-Setup/<bpt id=\"p1\">[</bpt>PageFile<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/dn915671)</ept>"},{"pos":[2137,2232],"content":"Microsoft-Windows-Setup/<bpt id=\"p1\">[</bpt>Restart<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/dn915783)</ept>"},{"pos":[2238,2341],"content":"Microsoft-Windows-Setup/<bpt id=\"p1\">[</bpt>RunAsynchronous<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/dn915800)</ept>"},{"pos":[2347,2449],"content":"Microsoft-Windows-Setup/<bpt id=\"p1\">[</bpt>RunSynchronous<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/dn915804)</ept>"},{"pos":[2487,2501],"content":"Related topics"},{"content":"WinPE for Windows 10","pos":[2505,2525]},{"content":"Winpeshl.ini Reference: Launching an app when WinPE starts","pos":[2545,2603]},{"content":"WinPE: Mount and Customize","pos":[2668,2694]},{"content":"Unattended Windows Setup Reference","pos":[2728,2762]}],"content":"---\nauthor: Justinha\nDescription: 'Wpeinit and Startnet.cmd: Using WinPE Startup Scripts'\nms.assetid: d43621bb-b9ab-4e19-8fb4-8d05d5ee3d07\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: 'Wpeinit and Startnet.cmd: Using WinPE Startup Scripts'\n---\n\n# Wpeinit and Startnet.cmd: Using WinPE Startup Scripts\n\n\nUse Wpeinit and Startnet.cmd to run startup scripts when Windows PE (WinPE) first runs.\n\nWpeinit outputs log messages to **C:\\\\Windows\\\\system32\\\\wpeinit.log**.\n\n## <span id=\"startnet.cmd\"></span><span id=\"STARTNET.CMD\"></span>Startnet.cmd\n\n\nYou can add customized command-line scripts in Windows PE by using Startnet.cmd. By default, Windows PE includes a Startnet.cmd script located at %SYSTEMROOT%\\\\System32 of your customized Windows PE image.\n\nStartnet.cmd starts Wpeinit.exe. Wpeinit.exe installs Plug and Play devices, processes Unattend.xml settings, and loads network resources.\n\nFor more info, see [WinPE: Mount and Customize](winpe-mount-and-customize.md).\n\n## <span id=\"Wpeinit_Command-Line_Options\"></span><span id=\"wpeinit_command-line_options\"></span><span id=\"WPEINIT_COMMAND-LINE_OPTIONS\"></span>Wpeinit Command-Line Options\n\n\nThe following command-line option is available for Wpeinit:\n\n**Wpeinit** \\[-unattend:*&lt;path\\_to\\_answer\\_file&gt;*\\]\n\nExample:\n\n``` syntax\nWpeinit â€“unattend:\"C:\\Unattend-PE.xml\"\n```\n\n## <span id=\"Supported_Unattend_settings\"></span><span id=\"supported_unattend_settings\"></span><span id=\"SUPPORTED_UNATTEND_SETTINGS\"></span>Supported Unattend settings\n\n\nYou can create an answer file and include any of the following settings for use with Windows PE:\n\n-   Microsoft-Windows-Setup/[Display](https://msdn.microsoft.com/library/windows/hardware/dn915285)\n\n-   Microsoft-Windows-Setup/[EnableFirewall](https://msdn.microsoft.com/library/windows/hardware/dn915375)\n\n-   Microsoft-Windows-Setup/[EnableNetwork](https://msdn.microsoft.com/library/windows/hardware/dn915383)\n\n-   Microsoft-Windows-Setup/[LogPath](https://msdn.microsoft.com/library/windows/hardware/dn915490)\n\n-   Microsoft-Windows-Setup/[PageFile](https://msdn.microsoft.com/library/windows/hardware/dn915671)\n\n-   Microsoft-Windows-Setup/[Restart](https://msdn.microsoft.com/library/windows/hardware/dn915783)\n\n-   Microsoft-Windows-Setup/[RunAsynchronous](https://msdn.microsoft.com/library/windows/hardware/dn915800)\n\n-   Microsoft-Windows-Setup/[RunSynchronous](https://msdn.microsoft.com/library/windows/hardware/dn915804)\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[WinPE for Windows 10](winpe-intro.md)\n\n[Winpeshl.ini Reference: Launching an app when WinPE starts](winpeshlini-reference-launching-an-app-when-winpe-starts.md)\n\n[WinPE: Mount and Customize](winpe-mount-and-customize.md)\n\n[Unattended Windows Setup Reference](http://go.microsoft.com/fwlink/?LinkId=206281)\n\n \n\n \n\n\n\n\n\n\n"}