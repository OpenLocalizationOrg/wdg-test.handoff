{"nodes":[{"content":"Install Windows PE","pos":[34,52]},{"content":"Install Windows PE","pos":[159,177]},{"content":"Install Windows PE","pos":[185,203]},{"content":"Windows Preinstallation Environment (WinPE) is a small, command-line based operating system.","pos":[206,298]},{"content":"You can use it to capture, update, and optimize Windows images, which you'll do in later sections.","pos":[299,397]},{"content":"In this section, you'll prepare a basic WinPE image on a bootable USB flash drive and try it out.","pos":[398,495]},{"content":"For this lab, you'll need two storage locations:","pos":[497,545]},{"content":"<bpt id=\"p1\">**</bpt>A Windows PE USB key<ept id=\"p1\">**</ept>.","pos":[551,576]},{"content":"Must be at least 512MB and at most 32GB.","pos":[577,617]},{"content":"It should not be a Windows-to-Go key or a key marked as a non-removable drive.","pos":[618,696]},{"content":"<bpt id=\"p1\">**</bpt>A storage USB key or external hard drive<ept id=\"p1\">**</ept>.","pos":[701,746]},{"content":"Must be at least 8GB.","pos":[747,768]},{"content":"Prepare the WinPE files","pos":[772,795]},{"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, type <bpt id=\"p2\">**</bpt>Deployment and Imaging Tools Environment<ept id=\"p2\">**</ept>.","pos":[803,870]},{"content":"Right-click <bpt id=\"p1\">**</bpt>Deployment and Imaging Tools Environment<ept id=\"p1\">**</ept> and select <bpt id=\"p2\">**</bpt>Run as administrator<ept id=\"p2\">**</ept>.","pos":[871,964]},{"pos":[969,1083],"content":"From the <bpt id=\"p1\">**</bpt>Deployment and Imaging Tools Environment<ept id=\"p1\">**</ept> command prompt, copy the base WinPE files into a new folder:"},{"content":"Repeat if you’re also deploying x86 devices:","pos":[1145,1189]},{"content":"Adding to WinPE","pos":[1245,1260]},{"content":"Mount the WinPE image:","pos":[1268,1290]},{"content":"For some devices, add drivers:","pos":[1435,1465]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Most devices don't need this step.","pos":[1471,1515]},{"content":"But if you boot WinPE later and find you can't see the screen or connect to the network, you may need to add a video or network driver.","pos":[1516,1651]},{"content":"Unmount the WinPE image:","pos":[1769,1793]},{"content":"Create a bootable drive","pos":[1886,1909]},{"content":"Plug in a USB key that you don't mind formatting.","pos":[1917,1966]},{"content":"Note the drive letter it uses, for example, D.","pos":[1967,2013]},{"content":"Install WinPE to an empty USB drive:","pos":[2018,2054]},{"pos":[2126,2191],"content":"When prompted, press <bpt id=\"p1\">**</bpt>Y<ept id=\"p1\">**</ept> to format the drive and install WinPE."},{"content":"Repeat if necessary, plugging in a separate USB key for use when deploying x86 devices:","pos":[2197,2284]},{"pos":[2354,2419],"content":"When prompted, press <bpt id=\"p1\">**</bpt>Y<ept id=\"p1\">**</ept> to format the drive and install WinPE."},{"pos":[2425,2486],"content":"In File Explorer, right-click the drive and select <bpt id=\"p1\">**</bpt>Eject<ept id=\"p1\">**</ept>."},{"content":"Try it out","pos":[2490,2500]},{"content":"Connect the WinPE USB drive to your reference device.","pos":[2508,2561]},{"content":"After WinPE starts, manually create a pagefile equal to 256 MB in the WinPE.","pos":[2566,2642]},{"content":"You'll need this later to deploy compressed images (CompactOS); those operations will require that WinPE has a pagefile equal to 256 MB.","pos":[2643,2779]},{"content":"Where \"C\" is the Windows partition.","pos":[2862,2897]},{"content":"Turn off the device, and then boot to the USB drive.","pos":[2903,2955]},{"content":"You usually do this by powering on the device and quickly pressing a key (for example, the <bpt id=\"p1\">**</bpt>Esc<ept id=\"p1\">**</ept> key or the <bpt id=\"p2\">**</bpt>Volume up<ept id=\"p2\">**</ept> key).","pos":[2956,3085]},{"pos":[3091,3544],"content":"**Note**   On some devices, you might need to go into the boot menus to choose the USB drive. If you're given a choice between booting in UEFI mode or BIOS mode, choose UEFI mode. To learn more, see [Boot to UEFI Mode or Legacy BIOS mode](http://go.microsoft.com/fwlink/?LinkId=526943).\nIf the device does not boot from the USB drive, see the troubleshooting tips in [WinPE: Create USB Bootable drive](http://go.microsoft.com/fwlink/?LinkId=526944).","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>   On some devices, you might need to go into the boot menus to choose the USB drive.","pos":[0,93]},{"content":"If you're given a choice between booting in UEFI mode or BIOS mode, choose UEFI mode.","pos":[94,179]},{"content":"To learn more, see <bpt id=\"p1\">[</bpt>Boot to UEFI Mode or Legacy BIOS mode<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=526943)</ept>.","pos":[180,286]},{"content":"If the device does not boot from the USB drive, see the troubleshooting tips in <bpt id=\"p1\">[</bpt>WinPE: Create USB Bootable drive<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=526944)</ept>.","pos":[287,449]}]},{"content":"WinPE starts at a command line, and runs <bpt id=\"p1\">**</bpt>wpeinit<ept id=\"p1\">**</ept> to set up the system.","pos":[3550,3624]},{"content":"This can take a few minutes.","pos":[3625,3653]}],"content":"---\nauthor: Justinha\nDescription: Install Windows PE\nms.assetid: e6e571df-8b4f-43f8-9a8c-cb5f25969a5d\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: Install Windows PE\n---\n\n# Install Windows PE\n\n\nWindows Preinstallation Environment (WinPE) is a small, command-line based operating system. You can use it to capture, update, and optimize Windows images, which you'll do in later sections. In this section, you'll prepare a basic WinPE image on a bootable USB flash drive and try it out.\n\nFor this lab, you'll need two storage locations:\n\n-   **A Windows PE USB key**. Must be at least 512MB and at most 32GB. It should not be a Windows-to-Go key or a key marked as a non-removable drive.\n-   **A storage USB key or external hard drive**. Must be at least 8GB.\n\n**Prepare the WinPE files**\n\n1.  Click **Start**, type **Deployment and Imaging Tools Environment**. Right-click **Deployment and Imaging Tools Environment** and select **Run as administrator**.\n2.  From the **Deployment and Imaging Tools Environment** command prompt, copy the base WinPE files into a new folder:\n\n    ``` syntax\n    copype amd64 C:\\winpe_amd64\n    ```\n\n    Repeat if you’re also deploying x86 devices:\n\n    ``` syntax\n    copype x86 C:\\winpe_x86\n    ```\n\n**Adding to WinPE**\n\n1.  Mount the WinPE image:\n\n    ``` syntax\n    Dism /Mount-Image /ImageFile:\"C:\\WinPE_amd64\\media\\sources\\boot.wim\" /index:1 /MountDir:\"C:\\WinPE_amd64\\mount\"\n    ```\n\n2.  For some devices, add drivers:\n\n    **Note**  Most devices don't need this step. But if you boot WinPE later and find you can't see the screen or connect to the network, you may need to add a video or network driver.\n\n    ``` syntax\n    Dism /Add-Driver /Image:\"C:\\WinPE_amd64\\mount\" /Driver:\"C:\\SampleDriver\\driver.inf\"\n    ```\n\n3.  Unmount the WinPE image:\n\n    ``` syntax\n    Dism /Unmount-Image /MountDir:\"C:\\WinPE_amd64\\mount\" /commit\n    ```\n\n**Create a bootable drive**\n\n1.  Plug in a USB key that you don't mind formatting. Note the drive letter it uses, for example, D.\n2.  Install WinPE to an empty USB drive:\n\n    ``` syntax\n    MakeWinPEMedia /UFD C:\\winpe_amd64 D:\n    ```\n\n    When prompted, press **Y** to format the drive and install WinPE.\n\n    Repeat if necessary, plugging in a separate USB key for use when deploying x86 devices:\n\n    ``` syntax\n    MakeWinPEMedia /UFD C:\\winpe_x86 E:\n    ```\n\n    When prompted, press **Y** to format the drive and install WinPE.\n\n3.  In File Explorer, right-click the drive and select **Eject**.\n\n**Try it out**\n\n1.  Connect the WinPE USB drive to your reference device.\n2.  After WinPE starts, manually create a pagefile equal to 256 MB in the WinPE. You'll need this later to deploy compressed images (CompactOS); those operations will require that WinPE has a pagefile equal to 256 MB.\n\n    ``` syntax\n    Wpeutil createpagefile C:\\pagefile.sys /size=256\n    ```\n\n    Where \"C\" is the Windows partition.\n\n3.  Turn off the device, and then boot to the USB drive. You usually do this by powering on the device and quickly pressing a key (for example, the **Esc** key or the **Volume up** key).\n\n    **Note**   On some devices, you might need to go into the boot menus to choose the USB drive. If you're given a choice between booting in UEFI mode or BIOS mode, choose UEFI mode. To learn more, see [Boot to UEFI Mode or Legacy BIOS mode](http://go.microsoft.com/fwlink/?LinkId=526943).\n    If the device does not boot from the USB drive, see the troubleshooting tips in [WinPE: Create USB Bootable drive](http://go.microsoft.com/fwlink/?LinkId=526944).\n\n    WinPE starts at a command line, and runs **wpeinit** to set up the system. This can take a few minutes.\n\n \n\n \n\n \n\n\n\n\n\n"}