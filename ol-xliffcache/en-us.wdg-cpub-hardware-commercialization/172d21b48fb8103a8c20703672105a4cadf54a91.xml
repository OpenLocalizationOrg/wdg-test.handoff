{"nodes":[{"content":"Bare metal reset/recovery: create recovery media while deploying new devices","pos":[35,111]},{"content":"Bare metal reset/recovery: create recovery media while deploying new devices","pos":[220,296]},{"content":"Bare metal reset/recovery: create recovery media while deploying new devices","pos":[305,381]},{"content":"Recovery media (bare metal recovery) helps restore a Windows device to the factory state, even if the user needs to replace the hard drive or completely wipe the drive clean.","pos":[384,558]},{"content":"You can include this media with new devices that you provide to your customers using the same Windows images used to deploy the devices.","pos":[560,696]},{"content":"Note","pos":[700,704]},{"content":"The PC firmware/BIOS must be configured so that the PC can boot from the media (USB drive or DVD drive).","pos":[713,817]},{"content":"The USB flash drive or DVD recovery media must have enough space for the Windows image.","pos":[822,909]},{"pos":[914,1162],"content":"If the Windows images are larger than 32GB or are larger the media you're using (for example, 4.7GB DVDs), you'll need to <bpt id=\"p1\">[</bpt>split the Windows image file to span across multiple DVDs<ept id=\"p1\">](split-a-windows-image--wim--file-to-span-across-multiple-dvds.md)</ept>."},{"pos":[1167,1313],"content":"To create a bootable USB recovery drive for a personal device, see <bpt id=\"p1\">[</bpt>Create a USB recovery drive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=296450)</ept>."},{"pos":[1408,1442],"content":"Create a bootable Windows RE image"},{"content":"To create the recovery media that you can include with the PC, you must have the following:","pos":[1445,1536]},{"content":"A Windows image (Install.wim).","pos":[1542,1572]},{"content":"You can either use the base Windows image or a customized recovery image.","pos":[1573,1646]},{"content":"A Windows RE tools image (Winre.wim).","pos":[1651,1688]},{"content":"You can either extract the base Windows RE tools image from the Windows image, or use a <bpt id=\"p1\">[</bpt>customized Windows RE image<ept id=\"p1\">](customize-windows-re.md)</ept>.","pos":[1689,1832]},{"content":"Step 1: Open the Deployment and Imaging Tools Environment","pos":[1836,1893]},{"pos":[1901,2019],"content":"Download and install the <bpt id=\"p1\">[</bpt>Windows Assessment and Deployment Kit (ADK)<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=526803)</ept>."},{"content":"On your technician PC: Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, and type <bpt id=\"p2\">**</bpt>deployment<ept id=\"p2\">**</ept>.","pos":[2024,2088]},{"content":"Right-click <bpt id=\"p1\">**</bpt>Deployment and Imaging Tools Environment<ept id=\"p1\">**</ept> and then select <bpt id=\"p2\">**</bpt>Run as administrator<ept id=\"p2\">**</ept>.","pos":[2089,2187]},{"content":"Step 2: Extract the Windows RE image from the Windows image","pos":[2191,2250]},{"content":"Mount the Windows image:","pos":[2258,2282]},{"content":"Copy the Windows RE image.","pos":[2421,2447]},{"content":"Unmount the Windows image:","pos":[2573,2599]},{"content":"Step 3: Create a working folder for Windows RE files","pos":[2685,2737]},{"content":"Create a folder structure for Windows RE, which is based on Windows PE:","pos":[2745,2816]},{"pos":[2883,2958],"content":"where <bpt id=\"p1\">*</bpt>amd64<ept id=\"p1\">*</ept> is the architecture of the system you are creating media for."},{"content":"Replace the default Windows PE boot image (Boot.wim) with a Windows RE tools image.","pos":[2964,3047]},{"content":"Step 4: Add the Windows image","pos":[3153,3182]},{"content":"Copy the Windows image to the working folder.","pos":[3190,3235]},{"pos":[3343,3458],"content":"where <bpt id=\"p1\">*</bpt>D:<ph id=\"ph1\">\\\\</ph>sources<ph id=\"ph2\">\\\\</ph>install.wim<ept id=\"p1\">*</ept> is either the base Windows image or a customized push-button reset recovery image."},{"content":"Step 5: Optional: Add bare metal recovery configuration scripts","pos":[3462,3525]},{"content":"If you're using a customized partition layout, add bare metal recovery configuration scripts to the working folder, under <ph id=\"ph1\">\\\\</ph>sources.","pos":[3533,3665]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Bare Metal Reset/Recovery: Enable Your Users to Create Media<ept id=\"p1\">](bare-metal-resetrecovery-enable-your-users-to-create-media-and-to-recover-hard-drive-space.md)</ept>.","pos":[3666,3843]},{"pos":[4213,4234],"content":"Create bootable media"},{"content":"To create a bootable USB flash drive:","pos":[4239,4276]},{"content":"Install Windows RE to a USB flash drive:","pos":[4284,4324]},{"pos":[4401,4454],"content":"where <bpt id=\"p1\">*</bpt>F<ept id=\"p1\">*</ept> is the drive letter of the USB flash drive."},{"content":"Label the USB flash drive with a descriptive name:","pos":[4460,4510]},{"pos":[4516,4610],"content":"In File Explorer, right-click the drive, and select <bpt id=\"p1\">**</bpt>Rename<ept id=\"p1\">**</ept>, and type <bpt id=\"p2\">**</bpt>Full-PC Recovery<ept id=\"p2\">**</ept>."},{"content":"To create a bootable DVD:","pos":[4614,4639]},{"content":"Create a DVD image file:","pos":[4647,4671]},{"content":"Insert a DVD.","pos":[4783,4796]},{"pos":[4801,4922],"content":"In File Explorer, navigate to <ph id=\"ph1\">`C:\\resetmedia_amd64`</ph>, right-click <ph id=\"ph2\">`RecoveryImage.iso`</ph>, and then click <bpt id=\"p1\">**</bpt>Burn disc image<ept id=\"p1\">**</ept>."},{"pos":[5095,5132],"content":"Test the bare metal recovery features"},{"content":"On a PC with an empty hard drive, insert your new recovery media.","pos":[5139,5204]},{"content":"Start the PC, press a key to open the firmware boot menus, and then select the appropriate boot device.","pos":[5209,5312]},{"pos":[5317,5398],"content":"At the <bpt id=\"p1\">**</bpt>Windows RE Tools<ept id=\"p1\">**</ept> menus, select a keyboard layout, for example, <bpt id=\"p2\">**</bpt>US<ept id=\"p2\">**</ept>."},{"pos":[5403,5462],"content":"Click <bpt id=\"p1\">**</bpt>Troubleshoot<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Reset your PC<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>"},{"pos":[5468,5616],"content":"**Note**  \nIf you are testing on the same PC, and you have not cleaned the hard drive, you may be prompted to select a drive. Select Windows 10.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"If you are testing on the same PC, and you have not cleaned the hard drive, you may be prompted to select a drive. Select Windows 10.","pos":[11,144],"nodes":[{"content":"If you are testing on the same PC, and you have not cleaned the hard drive, you may be prompted to select a drive.","pos":[0,114]},{"content":"Select Windows 10.","pos":[115,133]}]}]},{"pos":[5629,5713],"content":"Select <bpt id=\"p1\">**</bpt>Yes, repartition the drives<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Just remove my files<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Reset<ept id=\"p3\">**</ept>."},{"content":"Windows resets the computer to its original state by using the recovery image.","pos":[5719,5797]},{"pos":[5925,5947],"content":"Large-Scale Deployment"},{"content":"If you are deploying USB keys with your computers, you can create a basic copy of the Windows recovery media on USB by using the steps above.","pos":[5950,6091]},{"content":"After you have performed final customization of the image, you can boot the computer to Windows PE, and update the install.wim image on the USB recovery media.","pos":[6092,6251]},{"content":"You can potentially save manufacturing time by appending the Windows image on the USB flash drive, rather than recapturing the entire Windows image.","pos":[6253,6401]},{"content":"If you do this, you must also update the ResetConfig.xml configuration file element: <ph id=\"ph1\">`RestoreFromIndex`</ph> to the appropriate index number.","pos":[6402,6538]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Append a Volume Image to an Existing Image Using DISM<ept id=\"p1\">](append-a-volume-image-to-an-existing-image-using-dism--s14.md)</ept> and <bpt id=\"p2\">[</bpt>ResetConfig XML Reference<ept id=\"p2\">](resetconfig-xml-reference-s14.md)</ept>.","pos":[6539,6750]},{"pos":[6788,6802],"content":"Related topics"},{"content":"Bare Metal Reset/Recovery: Enable Your Users to Create Media","pos":[6806,6866]},{"content":"Push-Button Reset Overview","pos":[6965,6991]},{"content":"ResetConfig XML Reference","pos":[7026,7051]},{"content":"REAgentC Command-Line Options","pos":[7089,7118]}],"content":"---\nauthor: Justinha\nDescription: 'Bare metal reset/recovery: create recovery media while deploying new devices'\nms.assetid: 2244bddf-8f49-41db-949a-2fbe9e224003\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: 'Bare metal reset/recovery: create recovery media while deploying new devices'\n---\n\n# Bare metal reset/recovery: create recovery media while deploying new devices\n\n\nRecovery media (bare metal recovery) helps restore a Windows device to the factory state, even if the user needs to replace the hard drive or completely wipe the drive clean.\n\nYou can include this media with new devices that you provide to your customers using the same Windows images used to deploy the devices.\n\n**Note**  \n-   The PC firmware/BIOS must be configured so that the PC can boot from the media (USB drive or DVD drive).\n-   The USB flash drive or DVD recovery media must have enough space for the Windows image.\n-   If the Windows images are larger than 32GB or are larger the media you're using (for example, 4.7GB DVDs), you'll need to [split the Windows image file to span across multiple DVDs](split-a-windows-image--wim--file-to-span-across-multiple-dvds.md).\n\n \n\nTo create a bootable USB recovery drive for a personal device, see [Create a USB recovery drive](http://go.microsoft.com/fwlink/p/?linkid=296450).\n\n## <span id=\"CreateMedia\"></span><span id=\"createmedia\"></span><span id=\"CREATEMEDIA\"></span>Create a bootable Windows RE image\n\n\nTo create the recovery media that you can include with the PC, you must have the following:\n\n-   A Windows image (Install.wim). You can either use the base Windows image or a customized recovery image.\n-   A Windows RE tools image (Winre.wim). You can either extract the base Windows RE tools image from the Windows image, or use a [customized Windows RE image](customize-windows-re.md).\n\n**Step 1: Open the Deployment and Imaging Tools Environment**\n\n1.  Download and install the [Windows Assessment and Deployment Kit (ADK)](http://go.microsoft.com/fwlink/?LinkId=526803).\n2.  On your technician PC: Click **Start**, and type **deployment**. Right-click **Deployment and Imaging Tools Environment** and then select **Run as administrator**.\n\n**Step 2: Extract the Windows RE image from the Windows image**\n\n1.  Mount the Windows image:\n\n    ``` syntax\n    md c:\\mount\\Windows\n\n    Dism /Mount-Image /ImageFile:D:\\sources\\install.wim /Index:1 /MountDir:C:\\mount\n    ```\n\n2.  Copy the Windows RE image.\n\n    ``` syntax\n    md C:\\Images\n\n    xcopy C:\\mount\\Windows\\System32\\Recovery\\winre.wim C:\\Images\\winre.wim /h\n    ```\n\n3.  Unmount the Windows image:\n\n    ``` syntax\n    Dism /Unmount-Image /MountDir:C:\\mount\\winre /Discard\n    ```\n\n**Step 3: Create a working folder for Windows RE files**\n\n1.  Create a folder structure for Windows RE, which is based on Windows PE:\n\n    ``` syntax\n    copype amd64 C:\\resetmedia_amd64\n    ```\n\n    where *amd64* is the architecture of the system you are creating media for.\n\n2.  Replace the default Windows PE boot image (Boot.wim) with a Windows RE tools image.\n\n    ``` syntax\n    xcopy C:\\MyImages\\winre.wim C:\\resetmedia_amd64\\media\\sources\\boot.wim /h\n    ```\n\n**Step 4: Add the Windows image**\n\n-   Copy the Windows image to the working folder.\n\n    ``` syntax\n    copy D:\\sources\\install.wim C:\\resetmedia_amd64\\media\\sources\\install.wim\n    ```\n\n    where *D:\\\\sources\\\\install.wim* is either the base Windows image or a customized push-button reset recovery image.\n\n**Step 5: Optional: Add bare metal recovery configuration scripts**\n\n-   If you're using a customized partition layout, add bare metal recovery configuration scripts to the working folder, under \\\\sources. For more info, see [Bare Metal Reset/Recovery: Enable Your Users to Create Media](bare-metal-resetrecovery-enable-your-users-to-create-media-and-to-recover-hard-drive-space.md).\n\n    ``` syntax\n    copy E:\\Recovery\\RecoveryImage\\ResetConfig.xml C:\\resetmedia_amd64\\media\\sources\\ResetConfig.xml\n\n    copy E:\\Recovery\\RecoveryImage\\ResetPartitions-UEFI.txt C:\\resetmedia_amd64\\media\\sources\\ResetPartitions-UEFI.txt\n    ```\n\n## <span id=\"Create_bootable_media\"></span><span id=\"create_bootable_media\"></span><span id=\"CREATE_BOOTABLE_MEDIA\"></span>Create bootable media\n\n\n**To create a bootable USB flash drive:**\n\n1.  Install Windows RE to a USB flash drive:\n\n    ``` syntax\n    Makewinpemedia /ufd C:\\resetmedia_amd64 F:\n    ```\n\n    where *F* is the drive letter of the USB flash drive.\n\n2.  Label the USB flash drive with a descriptive name:\n\n    In File Explorer, right-click the drive, and select **Rename**, and type **Full-PC Recovery**.\n\n**To create a bootable DVD:**\n\n1.  Create a DVD image file:\n\n    ``` syntax\n    Makewinpemedia /iso C:\\resetmedia_amd64 C:\\resetmedia_amd64\\RecoveryImage.iso\n    ```\n\n2.  Insert a DVD.\n3.  In File Explorer, navigate to `C:\\resetmedia_amd64`, right-click `RecoveryImage.iso`, and then click **Burn disc image**.\n\n## <span id=\"Test_the_bare_metal_recovery_features\"></span><span id=\"test_the_bare_metal_recovery_features\"></span><span id=\"TEST_THE_BARE_METAL_RECOVERY_FEATURES\"></span>Test the bare metal recovery features\n\n\n1.  On a PC with an empty hard drive, insert your new recovery media.\n2.  Start the PC, press a key to open the firmware boot menus, and then select the appropriate boot device.\n3.  At the **Windows RE Tools** menus, select a keyboard layout, for example, **US**.\n4.  Click **Troubleshoot** &gt; **Reset your PC** &gt; **Next**\n\n    **Note**  \n    If you are testing on the same PC, and you have not cleaned the hard drive, you may be prompted to select a drive. Select Windows 10.\n\n     \n\n    Select **Yes, repartition the drives** &gt; **Just remove my files** &gt; **Reset**.\n\n    Windows resets the computer to its original state by using the recovery image.\n\n## <span id=\"Large-Scale_Deployment\"></span><span id=\"large-scale_deployment\"></span><span id=\"LARGE-SCALE_DEPLOYMENT\"></span>Large-Scale Deployment\n\n\nIf you are deploying USB keys with your computers, you can create a basic copy of the Windows recovery media on USB by using the steps above. After you have performed final customization of the image, you can boot the computer to Windows PE, and update the install.wim image on the USB recovery media.\n\nYou can potentially save manufacturing time by appending the Windows image on the USB flash drive, rather than recapturing the entire Windows image. If you do this, you must also update the ResetConfig.xml configuration file element: `RestoreFromIndex` to the appropriate index number. For more information, see [Append a Volume Image to an Existing Image Using DISM](append-a-volume-image-to-an-existing-image-using-dism--s14.md) and [ResetConfig XML Reference](resetconfig-xml-reference-s14.md).\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[Bare Metal Reset/Recovery: Enable Your Users to Create Media](bare-metal-resetrecovery-enable-your-users-to-create-media-and-to-recover-hard-drive-space.md)\n\n[Push-Button Reset Overview](push-button-reset-overview.md)\n\n[ResetConfig XML Reference](resetconfig-xml-reference-s14.md)\n\n[REAgentC Command-Line Options](reagentc-command-line-options.md)\n\n \n\n \n\n\n\n\n\n\n"}