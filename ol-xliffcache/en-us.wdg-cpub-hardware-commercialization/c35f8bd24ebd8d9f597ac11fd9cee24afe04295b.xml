{"nodes":[{"content":"Sysprep Process Overview","pos":[34,58]},{"content":"Sysprep Process Overview","pos":[165,189]},{"content":"Sysprep Process Overview","pos":[197,221]},{"content":"The System Preparation (<bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept>) tool is used to change Windows® images from a generalized state to a specialized state, and then back to a generalized state.","pos":[224,386]},{"content":"A generalized image can be deployed on any computer.","pos":[387,439]},{"content":"A specialized image is targeted to a specific computer.","pos":[440,495]},{"content":"You must reseal, or generalize, a Windows image before you capture and deploy the image.","pos":[496,584]},{"content":"For example, when you use the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> tool to generalize an image, <bpt id=\"p2\">**</bpt>Sysprep<ept id=\"p2\">**</ept> removes all system-specific information and resets the computer.","pos":[585,732]},{"content":"The next time that the computer restarts, your customers can add user-specific information through Out-Of-Box Experience (OOBE) and accept the Microsoft Software License Terms.","pos":[733,909]},{"pos":[911,1016],"content":"<bpt id=\"p1\">**</bpt>Sysprep.exe<ept id=\"p1\">**</ept> is located in the <bpt id=\"p2\">**</bpt>%WINDIR%<ph id=\"ph1\">\\\\</ph>system32<ph id=\"ph2\">\\\\</ph>sysprep<ept id=\"p2\">**</ept> directory on all Windows installations."},{"content":"If you transfer a Windows image to a different computer, you must run the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> command together with the <bpt id=\"p2\">**</bpt>/generalize<ept id=\"p2\">**</ept> option, even if the other computer has the same hardware configuration.","pos":[1018,1217]},{"content":"The <bpt id=\"p1\">**</bpt>Sysprep /generalize<ept id=\"p1\">**</ept> command removes unique information from your Windows installation so that you can reuse that image on a different computer.","pos":[1218,1369]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Sysprep (Generalize) a Windows installation<ept id=\"p1\">](sysprep--generalize--a-windows-installation.md)</ept>.","pos":[1370,1490]},{"content":"In this topic:","pos":[1492,1506]},{"content":"Sysprep Executable","pos":[1513,1531]},{"content":"Sysprep Process Overview","pos":[1559,1583]},{"content":"Persisting the Hardware Configuration","pos":[1608,1645]},{"content":"Adding Device Drivers","pos":[1664,1685]},{"content":"Booting to Audit Mode or OOBE","pos":[1702,1731]},{"content":"Detecting the State of a Windows Image","pos":[1776,1814]},{"content":"Sysprep Log Files","pos":[1857,1874]},{"content":"Creating and Using Sysprep Providers","pos":[1900,1936]},{"pos":[2085,2103],"content":"Sysprep Executable"},{"content":"<bpt id=\"p1\">**</bpt>Sysprep.exe<ept id=\"p1\">**</ept> is the main program that calls other executable files that prepare the Windows installation.","pos":[2106,2214]},{"content":"<bpt id=\"p1\">**</bpt>Sysprep.exe<ept id=\"p1\">**</ept> is located in the <bpt id=\"p2\">**</bpt>%WINDIR%<ph id=\"ph1\">\\\\</ph>system32<ph id=\"ph2\">\\\\</ph>sysprep<ept id=\"p2\">**</ept> directory on all Windows installations.","pos":[2215,2320]},{"content":"If you use the command line instead of the <bpt id=\"p1\">**</bpt>System Preparation Tool<ept id=\"p1\">**</ept> GUI, you must first close the GUI and then run <bpt id=\"p2\">**</bpt>Sysprep<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>%WINDIR%<ph id=\"ph1\">\\\\</ph>system32<ph id=\"ph2\">\\\\</ph>sysprep<ept id=\"p3\">**</ept> directory.","pos":[2321,2502]},{"content":"You must also run <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> on the same version of Windows that you used to install <bpt id=\"p2\">**</bpt>Sysprep<ept id=\"p2\">**</ept>.","pos":[2503,2601]},{"content":"Important","pos":[2605,2614]},{"content":"Beginning with Windows 8.1, the Sysprep user interface is deprecated.","pos":[2619,2688]},{"content":"The Sysprep UI will continue to be supported in this release however it may be removed in a future release.","pos":[2689,2796]},{"content":"We recommend that you update your Windows deployment workflow to use the Sysprep command line.","pos":[2797,2891]},{"content":"For more information about the Sysprep Command line tool, see <bpt id=\"p1\">[</bpt>Sysprep Command-Line Options<ept id=\"p1\">](sysprep-command-line-options.md)</ept>.","pos":[2892,3018]},{"pos":[3125,3149],"content":"Sysprep Process Overview"},{"content":"When Sysprep runs, it goes through the following process:","pos":[3152,3209]},{"content":"<bpt id=\"p1\">**</bpt>Sysprep verification<ept id=\"p1\">**</ept>.","pos":[3215,3240]},{"content":"Verifies that Sysprep can run.","pos":[3241,3271]},{"content":"Only an administrator can run Sysprep.","pos":[3272,3310]},{"content":"Only one instance of Sysprep can run at a time.","pos":[3311,3358]},{"content":"Also, Sysprep must run on the version of Windows that you used to install Sysprep.","pos":[3359,3441]},{"content":"<bpt id=\"p1\">**</bpt>Logging initialization<ept id=\"p1\">**</ept>.","pos":[3447,3474]},{"content":"Initializes logging.","pos":[3475,3495]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Sysprep Log Files<ept id=\"p1\">](#syspreplogfiles)</ept>.","pos":[3496,3560]},{"content":"<bpt id=\"p1\">**</bpt>Parsing command-line arguments<ept id=\"p1\">**</ept>.","pos":[3566,3601]},{"content":"Parses command-line arguments.","pos":[3602,3632]},{"content":"If a user does not provide command-line arguments, a System Preparation Tool window appears and enables users to specify Sysprep actions.","pos":[3633,3770]},{"content":"<bpt id=\"p1\">**</bpt>Processing Sysprep actions<ept id=\"p1\">**</ept>.","pos":[3776,3807]},{"content":"Processes Sysprep actions, calls appropriate .dll files and executable files, and adds actions to the log file.","pos":[3808,3919]},{"content":"<bpt id=\"p1\">**</bpt>Verifying Sysprep processing actions<ept id=\"p1\">**</ept>.","pos":[3925,3966]},{"content":"Verifies that all .dll files have processed all their tasks, and then either shuts down or restarts the system.","pos":[3967,4078]},{"pos":[4137,4174],"content":"Persisting the Hardware Configuration"},{"content":"If you create an image of this installation for deployment to a different computer, you must run the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> command together with the <bpt id=\"p2\">**</bpt>/generalize<ept id=\"p2\">**</ept> option, even if the other computer has the identical hardware configuration.","pos":[4177,4408]},{"content":"The <bpt id=\"p1\">**</bpt>Sysprep /generalize<ept id=\"p1\">**</ept> command removes unique information from a Windows installation so that you can reuse that image on different computers.","pos":[4409,4556]},{"content":"The next time that you boot the Windows image, the <bpt id=\"p1\">[</bpt>specialize<ept id=\"p1\">](specialize.md)</ept> configuration pass runs.","pos":[4557,4660]},{"content":"If you want to install a Windows image to computers that have the same hardware configuration, you can preserve the device-drivers installation in a Windows image.","pos":[4662,4825]},{"content":"To do this, in your answer file, specify the <bpt id=\"p1\">**</bpt>PersistAllDeviceInstalls<ept id=\"p1\">**</ept> setting in the <bpt id=\"p2\">**</bpt>Microsoft-Windows-PnPSysprep<ept id=\"p2\">**</ept> component.","pos":[4826,4958]},{"content":"The default value is <bpt id=\"p1\">**</bpt>false<ept id=\"p1\">**</ept>.","pos":[4959,4990]},{"content":"If you set the setting to <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept>, the Plug and Play devices remain on the computer during the <bpt id=\"p2\">[</bpt>generalize<ept id=\"p2\">](generalize.md)</ept> configuration pass.","pos":[4991,5134]},{"content":"You do not have to reinstall these devices during the <bpt id=\"p1\">[</bpt>specialize<ept id=\"p1\">](specialize.md)</ept> configuration pass.","pos":[5135,5236]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Use Answer Files with Sysprep<ept id=\"p1\">](use-answer-files-with-sysprep.md)</ept> and Unattended Windows Setup Reference Guide.","pos":[5237,5374]},{"pos":[5429,5450],"content":"Adding Device Drivers"},{"content":"Plug and Play devices include modems, sound cards, network adapters, and video cards.","pos":[5453,5538]},{"content":"The Plug and Play devices on the reference and destination computers do not have to come from the same manufacturer.","pos":[5539,5655]},{"content":"However, you must include the drivers for these devices in the installation.","pos":[5656,5732]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Add and Remove Drivers to an Offline Windows Image<ept id=\"p1\">](add-and-remove-drivers-to-an-offline-windows-image.md)</ept> and <bpt id=\"p2\">[</bpt>Add Device Drivers to Windows During Windows Setup<ept id=\"p2\">](add-device-drivers-to-windows-during-windows-setup.md)</ept>.","pos":[5733,5979]},{"pos":[6143,6172],"content":"Booting to Audit Mode or OOBE"},{"content":"When Windows boots, the computer can start in one of two modes:","pos":[6175,6238]},{"content":"OOBE","pos":[6244,6248]},{"content":"OOBE, also named the out-of-box experience (OOBE), is the first user experience.","pos":[6254,6334]},{"content":"The OOBE enables end users to customize their Windows installation.","pos":[6335,6402]},{"content":"End users can create user accounts, read and accept the Microsoft® Software License Terms, and select their language and time zones.","pos":[6403,6535]},{"content":"By default, all Windows installations boot to OOBE first.","pos":[6536,6593]},{"content":"The <bpt id=\"p1\">[</bpt>oobeSystem<ept id=\"p1\">](oobesystem.md)</ept> configuration pass runs immediately before OOBE starts.","pos":[6594,6681]},{"content":"If you do not automatically activate Windows by using a product key, OOBE prompts the user for a product key.","pos":[6687,6796]},{"content":"If the user skips this step during OOBE, Windows reminds the user to enter a valid product key later.","pos":[6797,6898]},{"content":"To automatically activate Windows by using a product key, specify a valid product key in the <bpt id=\"p1\">**</bpt>Microsoft-Windows-Shell-Setup<ph id=\"ph1\">\\\\</ph>ProductKey<ept id=\"p1\">**</ept> unattend setting during the <bpt id=\"p2\">[</bpt>specialize<ept id=\"p2\">](specialize.md)</ept> configuration pass.","pos":[6899,7113]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Work with Product Keys and Activation<ept id=\"p1\">](work-with-product-keys-and-activation-auth-phases.md)</ept>.","pos":[7114,7234]},{"content":"Audit Mode","pos":[7240,7250]},{"content":"If you are running a computer in audit mode to configure the installation to boot to OOBE, either use the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> GUI or run the <bpt id=\"p2\">**</bpt>Sysprep /oobe<ept id=\"p2\">**</ept> command.","pos":[7256,7415]},{"content":"To prepare a computer for an end user, you must configure the computer to boot to OOBE when an end user starts the computer for the first time.","pos":[7416,7559]},{"content":"In a default Windows installation, OOBE starts after installation is completed, but you can skip OOBE and boot directly to audit mode to customize images.","pos":[7560,7714]},{"content":"You can configure Windows to boot directly to audit mode by using the <bpt id=\"p1\">**</bpt>Microsoft-Windows-Deployment | Reseal | Mode<ept id=\"p1\">**</ept> setting in an answer file.","pos":[7720,7865]},{"content":"In audit mode, the computer processes settings in an unattended answer file in the <bpt id=\"p1\">[</bpt>auditSystem<ept id=\"p1\">](auditsystem.md)</ept> and <bpt id=\"p2\">[</bpt>auditUser<ept id=\"p2\">](audituser.md)</ept> configuration passes.","pos":[7866,8030]},{"content":"Audit mode enables you to add customizations to Windows images.","pos":[8036,8099]},{"content":"Audit mode does not require that you apply settings in OOBE.","pos":[8100,8160]},{"content":"By bypassing OOBE, you can access the desktop more quickly and perform your customizations.","pos":[8161,8252]},{"content":"You can add more device drivers, install applications, and test the validity of the installation.","pos":[8253,8350]},{"content":"For more information, see:","pos":[8352,8378]},{"content":"Audit Mode Overview","pos":[8385,8404]},{"content":"Boot Windows to Audit Mode or OOBE","pos":[8436,8470]},{"content":"How Configuration Passes Work","pos":[8517,8546]},{"content":"Enable and Disable the Built-in Administrator Account","pos":[8588,8641]},{"content":"Add a Driver Online in Audit Mode","pos":[8707,8740]},{"pos":[8937,8975],"content":"Detecting the State of a Windows Image"},{"content":"You can use Sysprep to identify the state of a Windows image.","pos":[8978,9039]},{"content":"That is, you can determine whether the image will boot to audit mode or OOBE, or if the image is still in the process of installation.","pos":[9040,9174]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Windows Setup Installation Process<ept id=\"p1\">](windows-setup-installation-process.md)</ept>.","pos":[9175,9277]},{"pos":[9384,9401],"content":"Sysprep Log Files"},{"content":"The <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> tool logs Windows Setup actions in different directories, depending on the configuration pass.","pos":[9404,9514]},{"content":"Because the <bpt id=\"p1\">[</bpt>generalize<ept id=\"p1\">](generalize.md)</ept> configuration pass deletes certain Windows Setup log files, the <bpt id=\"p2\">**</bpt>Sysprep<ept id=\"p2\">**</ept> tool logs generalize actions outside the standard Windows Setup log files.","pos":[9515,9705]},{"content":"The following table shows the different log file locations that <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> uses.","pos":[9706,9787]},{"content":"Item","pos":[9905,9909]},{"content":"Log Path","pos":[9932,9940]},{"content":"Generalize","pos":[10014,10024]},{"content":"%WINDIR%\\System32\\Sysprep\\Panther","pos":[10071,10104]},{"content":"Specialize","pos":[10175,10185]},{"content":"%WINDIR%\\Panther\\","pos":[10232,10249]},{"content":"Unattended Windows Setup actions","pos":[10311,10343]},{"content":"%WINDIR%\\Panther\\Unattendgc","pos":[10381,10408]},{"pos":[10455,10569],"content":"For more information, see <bpt id=\"p1\">[</bpt>Deployment Troubleshooting and Log Files<ept id=\"p1\">](deployment-troubleshooting-and-log-files.md)</ept>."},{"pos":[10727,10763],"content":"Creating and Using Sysprep Providers"},{"content":"Independent software vendors (ISVs) and independent hardware vendors (IHVs) can create <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> providers that enable their applications to support imaging and deployment scenarios.","pos":[10766,10950]},{"content":"If an application does not currently support generalize operations by using the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> tool, you can create a provider that removes all software-specific and hardware-specific information from the application.","pos":[10951,11165]},{"pos":[11167,11227],"content":"To create a <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> provider, you must do the following:"},{"pos":[11233,11349],"content":"Determine which configuration pass (<bpt id=\"p1\">**</bpt>cleanup<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>generalize<ept id=\"p2\">**</ept>, or <bpt id=\"p3\">**</bpt>specialize<ept id=\"p3\">**</ept>) your Sysprep provider addresses."},{"pos":[11355,11464],"content":"Create the appropriate entry point for your <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> provider, based on your choice of configuration pass."},{"pos":[11470,11536],"content":"Register the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> provider for use by the <bpt id=\"p2\">**</bpt>Sysprep<ept id=\"p2\">**</ept> tool."},{"content":"Test your <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> provider to validate that the provider functions correctly.","pos":[11542,11623]},{"content":"Make sure that you review the log files for warnings and errors.","pos":[11624,11688]},{"pos":[11690,11858],"content":"For more information about <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> providers, see the <bpt id=\"p2\">[</bpt>System Preparation (Sysprep) Tool Provider Developer’s Guide<ept id=\"p2\">](http://go.microsoft.com/fwlink/?LinkId=205568)</ept>."},{"pos":[11896,11910],"content":"Related topics"},{"content":"Sysprep (System Preparation) Overview","pos":[11914,11951]},{"content":"Sysprep Command-Line Options","pos":[11997,12025]},{"content":"Sysprep (Generalize) a Windows installation","pos":[12062,12105]},{"content":"Sysprep Support for Server Roles","pos":[12157,12189]},{"content":"Use Answer Files with Sysprep","pos":[12230,12259]}],"content":"---\nauthor: Justinha\nDescription: Sysprep Process Overview\nms.assetid: e764e19f-8a8a-4fae-aa1f-22e70caf1599\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: Sysprep Process Overview\n---\n\n# Sysprep Process Overview\n\n\nThe System Preparation (**Sysprep**) tool is used to change Windows® images from a generalized state to a specialized state, and then back to a generalized state. A generalized image can be deployed on any computer. A specialized image is targeted to a specific computer. You must reseal, or generalize, a Windows image before you capture and deploy the image. For example, when you use the **Sysprep** tool to generalize an image, **Sysprep** removes all system-specific information and resets the computer. The next time that the computer restarts, your customers can add user-specific information through Out-Of-Box Experience (OOBE) and accept the Microsoft Software License Terms.\n\n**Sysprep.exe** is located in the **%WINDIR%\\\\system32\\\\sysprep** directory on all Windows installations.\n\nIf you transfer a Windows image to a different computer, you must run the **Sysprep** command together with the **/generalize** option, even if the other computer has the same hardware configuration. The **Sysprep /generalize** command removes unique information from your Windows installation so that you can reuse that image on a different computer. For more information, see [Sysprep (Generalize) a Windows installation](sysprep--generalize--a-windows-installation.md).\n\nIn this topic:\n\n-   [Sysprep Executable](#sysprepexecutable)\n\n-   [Sysprep Process Overview](#sysprepprocess)\n\n-   [Persisting the Hardware Configuration](#bkmk-new)\n\n-   [Adding Device Drivers](#device)\n\n-   [Booting to Audit Mode or OOBE](#bootingtoauditmodeorwindowswelcome)\n\n-   [Detecting the State of a Windows Image](#detectingthestateofawindowsimage)\n\n-   [Sysprep Log Files](#syspreplogfiles)\n\n-   [Creating and Using Sysprep Providers](#creatingandusingsysprepproviders)\n\n## <span id=\"SysprepExecutable\"></span><span id=\"sysprepexecutable\"></span><span id=\"SYSPREPEXECUTABLE\"></span>Sysprep Executable\n\n\n**Sysprep.exe** is the main program that calls other executable files that prepare the Windows installation. **Sysprep.exe** is located in the **%WINDIR%\\\\system32\\\\sysprep** directory on all Windows installations. If you use the command line instead of the **System Preparation Tool** GUI, you must first close the GUI and then run **Sysprep** from the **%WINDIR%\\\\system32\\\\sysprep** directory. You must also run **Sysprep** on the same version of Windows that you used to install **Sysprep**.\n\n**Important**  \nBeginning with Windows 8.1, the Sysprep user interface is deprecated. The Sysprep UI will continue to be supported in this release however it may be removed in a future release. We recommend that you update your Windows deployment workflow to use the Sysprep command line. For more information about the Sysprep Command line tool, see [Sysprep Command-Line Options](sysprep-command-line-options.md).\n\n \n\n## <span id=\"SysprepProcess\"></span><span id=\"sysprepprocess\"></span><span id=\"SYSPREPPROCESS\"></span>Sysprep Process Overview\n\n\nWhen Sysprep runs, it goes through the following process:\n\n1.  **Sysprep verification**. Verifies that Sysprep can run. Only an administrator can run Sysprep. Only one instance of Sysprep can run at a time. Also, Sysprep must run on the version of Windows that you used to install Sysprep.\n\n2.  **Logging initialization**. Initializes logging. For more information, see [Sysprep Log Files](#syspreplogfiles).\n\n3.  **Parsing command-line arguments**. Parses command-line arguments. If a user does not provide command-line arguments, a System Preparation Tool window appears and enables users to specify Sysprep actions.\n\n4.  **Processing Sysprep actions**. Processes Sysprep actions, calls appropriate .dll files and executable files, and adds actions to the log file.\n\n5.  **Verifying Sysprep processing actions**. Verifies that all .dll files have processed all their tasks, and then either shuts down or restarts the system.\n\n## <span id=\"bkmk_new\"></span><span id=\"BKMK_NEW\"></span>Persisting the Hardware Configuration\n\n\nIf you create an image of this installation for deployment to a different computer, you must run the **Sysprep** command together with the **/generalize** option, even if the other computer has the identical hardware configuration. The **Sysprep /generalize** command removes unique information from a Windows installation so that you can reuse that image on different computers. The next time that you boot the Windows image, the [specialize](specialize.md) configuration pass runs.\n\nIf you want to install a Windows image to computers that have the same hardware configuration, you can preserve the device-drivers installation in a Windows image. To do this, in your answer file, specify the **PersistAllDeviceInstalls** setting in the **Microsoft-Windows-PnPSysprep** component. The default value is **false**. If you set the setting to **true**, the Plug and Play devices remain on the computer during the [generalize](generalize.md) configuration pass. You do not have to reinstall these devices during the [specialize](specialize.md) configuration pass. For more information, see [Use Answer Files with Sysprep](use-answer-files-with-sysprep.md) and Unattended Windows Setup Reference Guide.\n\n## <span id=\"device\"></span><span id=\"DEVICE\"></span>Adding Device Drivers\n\n\nPlug and Play devices include modems, sound cards, network adapters, and video cards. The Plug and Play devices on the reference and destination computers do not have to come from the same manufacturer. However, you must include the drivers for these devices in the installation. For more information, see [Add and Remove Drivers to an Offline Windows Image](add-and-remove-drivers-to-an-offline-windows-image.md) and [Add Device Drivers to Windows During Windows Setup](add-device-drivers-to-windows-during-windows-setup.md).\n\n## <span id=\"BootingToAuditModeOrWindowsWelcome\"></span><span id=\"bootingtoauditmodeorwindowswelcome\"></span><span id=\"BOOTINGTOAUDITMODEORWINDOWSWELCOME\"></span>Booting to Audit Mode or OOBE\n\n\nWhen Windows boots, the computer can start in one of two modes:\n\n-   OOBE\n\n    OOBE, also named the out-of-box experience (OOBE), is the first user experience. The OOBE enables end users to customize their Windows installation. End users can create user accounts, read and accept the Microsoft® Software License Terms, and select their language and time zones. By default, all Windows installations boot to OOBE first. The [oobeSystem](oobesystem.md) configuration pass runs immediately before OOBE starts.\n\n    If you do not automatically activate Windows by using a product key, OOBE prompts the user for a product key. If the user skips this step during OOBE, Windows reminds the user to enter a valid product key later. To automatically activate Windows by using a product key, specify a valid product key in the **Microsoft-Windows-Shell-Setup\\\\ProductKey** unattend setting during the [specialize](specialize.md) configuration pass. For more information, see [Work with Product Keys and Activation](work-with-product-keys-and-activation-auth-phases.md).\n\n-   Audit Mode\n\n    If you are running a computer in audit mode to configure the installation to boot to OOBE, either use the **Sysprep** GUI or run the **Sysprep /oobe** command. To prepare a computer for an end user, you must configure the computer to boot to OOBE when an end user starts the computer for the first time. In a default Windows installation, OOBE starts after installation is completed, but you can skip OOBE and boot directly to audit mode to customize images.\n\n    You can configure Windows to boot directly to audit mode by using the **Microsoft-Windows-Deployment | Reseal | Mode** setting in an answer file. In audit mode, the computer processes settings in an unattended answer file in the [auditSystem](auditsystem.md) and [auditUser](audituser.md) configuration passes.\n\n    Audit mode enables you to add customizations to Windows images. Audit mode does not require that you apply settings in OOBE. By bypassing OOBE, you can access the desktop more quickly and perform your customizations. You can add more device drivers, install applications, and test the validity of the installation.\n\nFor more information, see:\n\n-   [Audit Mode Overview](audit-mode-overview.md)\n\n-   [Boot Windows to Audit Mode or OOBE](boot-windows-to-audit-mode-or-oobe.md)\n\n-   [How Configuration Passes Work](how-configuration-passes-work.md)\n\n-   [Enable and Disable the Built-in Administrator Account](enable-and-disable-the-built-in-administrator-account.md)\n\n-   [Add a Driver Online in Audit Mode](add-a-driver-online-in-audit-mode.md)\n\n## <span id=\"DetectingTheStateOfAWindowsImage\"></span><span id=\"detectingthestateofawindowsimage\"></span><span id=\"DETECTINGTHESTATEOFAWINDOWSIMAGE\"></span>Detecting the State of a Windows Image\n\n\nYou can use Sysprep to identify the state of a Windows image. That is, you can determine whether the image will boot to audit mode or OOBE, or if the image is still in the process of installation. For more information, see [Windows Setup Installation Process](windows-setup-installation-process.md).\n\n## <span id=\"SysprepLogFiles\"></span><span id=\"syspreplogfiles\"></span><span id=\"SYSPREPLOGFILES\"></span>Sysprep Log Files\n\n\nThe **Sysprep** tool logs Windows Setup actions in different directories, depending on the configuration pass. Because the [generalize](generalize.md) configuration pass deletes certain Windows Setup log files, the **Sysprep** tool logs generalize actions outside the standard Windows Setup log files. The following table shows the different log file locations that **Sysprep** uses.\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Item</th>\n<th align=\"left\">Log Path</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><strong>Generalize</strong></p></td>\n<td align=\"left\"><p><strong>%WINDIR%\\System32\\Sysprep\\Panther</strong></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><strong>Specialize</strong></p></td>\n<td align=\"left\"><p><strong>%WINDIR%\\Panther\\</strong></p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Unattended Windows Setup actions</p></td>\n<td align=\"left\"><p><strong>%WINDIR%\\Panther\\Unattendgc</strong></p></td>\n</tr>\n</tbody>\n</table>\n\n \n\nFor more information, see [Deployment Troubleshooting and Log Files](deployment-troubleshooting-and-log-files.md).\n\n## <span id=\"CreatingAndUsingSysprepProviders\"></span><span id=\"creatingandusingsysprepproviders\"></span><span id=\"CREATINGANDUSINGSYSPREPPROVIDERS\"></span>Creating and Using Sysprep Providers\n\n\nIndependent software vendors (ISVs) and independent hardware vendors (IHVs) can create **Sysprep** providers that enable their applications to support imaging and deployment scenarios. If an application does not currently support generalize operations by using the **Sysprep** tool, you can create a provider that removes all software-specific and hardware-specific information from the application.\n\nTo create a **Sysprep** provider, you must do the following:\n\n1.  Determine which configuration pass (**cleanup**, **generalize**, or **specialize**) your Sysprep provider addresses.\n\n2.  Create the appropriate entry point for your **Sysprep** provider, based on your choice of configuration pass.\n\n3.  Register the **Sysprep** provider for use by the **Sysprep** tool.\n\n4.  Test your **Sysprep** provider to validate that the provider functions correctly. Make sure that you review the log files for warnings and errors.\n\nFor more information about **Sysprep** providers, see the [System Preparation (Sysprep) Tool Provider Developer’s Guide](http://go.microsoft.com/fwlink/?LinkId=205568).\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[Sysprep (System Preparation) Overview](sysprep--system-preparation--overview.md)\n\n[Sysprep Command-Line Options](sysprep-command-line-options.md)\n\n[Sysprep (Generalize) a Windows installation](sysprep--generalize--a-windows-installation.md)\n\n[Sysprep Support for Server Roles](sysprep-support-for-server-roles.md)\n\n[Use Answer Files with Sysprep](use-answer-files-with-sysprep.md)\n\n \n\n \n\n\n\n\n\n\n"}