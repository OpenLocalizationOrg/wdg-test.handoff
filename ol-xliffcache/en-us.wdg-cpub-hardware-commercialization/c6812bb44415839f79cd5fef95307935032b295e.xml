{"nodes":[{"content":"Lab 1: Customize and install Windows using the Windows Imaging and Configuration Designer (ICD)","pos":[35,130]},{"content":"Lab 1: Customize and install Windows using the Windows Imaging and Configuration Designer (ICD)","pos":[239,334]},{"content":"Lab 1: Customize and install Windows using the Windows Imaging and Configuration Designer (ICD)","pos":[343,438]},{"content":"The fastest way to deploy customized Windows devices is by creating bootable USB keys using Windows Imaging and Configuration Designer (ICD).","pos":[441,582]},{"content":"This tool helps you install device drivers, set system settings, and add languages so you can quickly install Windows onto test or retail devices.","pos":[583,729]},{"pos":[845,863],"content":"Design your images"},{"content":"Here’s a sample set of hardware configurations that you might design.","pos":[866,935]},{"content":"Hardware Configuration:","pos":[1151,1174]},{"content":"1","pos":[1182,1183]},{"content":"1B","pos":[1197,1199]},{"content":"2","pos":[1219,1220]},{"content":"Form factor","pos":[1257,1268]},{"content":"Small tablet","pos":[1288,1300]},{"content":"2-in-1","pos":[1303,1309]},{"content":"Notebook","pos":[1325,1333]},{"content":"RAM","pos":[1363,1366]},{"content":"1 GB","pos":[1394,1398]},{"content":"2 GB","pos":[1409,1413]},{"content":"4 GB","pos":[1431,1435]},{"content":"Disk capacity and type","pos":[1469,1491]},{"content":"16 GB eMMC","pos":[1500,1510]},{"content":"32 GB eMMC","pos":[1515,1525]},{"content":"500 GB HDD","pos":[1537,1547]},{"content":"Display size","pos":[1575,1587]},{"content":"8”","pos":[1606,1608]},{"content":"10”","pos":[1621,1624]},{"content":"14”","pos":[1643,1646]},{"content":"Windows SKU","pos":[1681,1692]},{"content":"Core","pos":[1712,1716]},{"content":"Pro","pos":[1727,1730]},{"content":"Core","pos":[1749,1753]},{"content":"Language(s)","pos":[1787,1798]},{"content":"EN-US","pos":[1818,1823]},{"content":"EN-US, FR-FR, ES-ES","pos":[1833,1852]},{"content":"EN-GB, DE-DE, FR-FR, ES-ES, ZH-CN","pos":[1855,1888]},{"content":"Cortana","pos":[1893,1900]},{"content":"Yes","pos":[1924,1927]},{"content":"Yes","pos":[1939,1942]},{"content":"Yes","pos":[1961,1964]},{"content":"Inbox apps (Universal)","pos":[1999,2021]},{"content":"Yes","pos":[2030,2033]},{"content":"Yes","pos":[2045,2048]},{"content":"Yes","pos":[2067,2070]},{"content":"Pen","pos":[2105,2108]},{"content":"No","pos":[2136,2138]},{"content":"Yes","pos":[2151,2154]},{"content":"No","pos":[2173,2175]},{"content":"Office (Universal)","pos":[2211,2229]},{"content":"Yes","pos":[2242,2245]},{"content":"Yes","pos":[2257,2260]},{"content":"Yes","pos":[2279,2282]},{"content":"Classic Windows applications","pos":[2317,2345]},{"content":"No","pos":[2348,2350]},{"content":"Yes","pos":[2363,2366]},{"content":"Yes","pos":[2385,2388]},{"content":"Office 2013","pos":[2423,2434]},{"content":"No","pos":[2454,2456]},{"content":"Yes","pos":[2469,2472]},{"content":"Yes","pos":[2491,2494]},{"content":"Compact OS","pos":[2529,2539]},{"content":"Yes","pos":[2560,2563]},{"content":"Yes","pos":[2575,2578]},{"content":"No","pos":[2597,2599]},{"content":"This lab will walk you through hardware configuration 1 with optional steps included for hardware configuration 2.","pos":[2637,2751]},{"content":"Lab 1b continues the lab to include Classic Windows applications to deploy hardware configuration 1b and 2.","pos":[2752,2859]},{"content":"Lab 1c continues the lab to show you how to edit an expand on existing projects.","pos":[2860,2940]},{"pos":[3029,3072],"content":"Step 1: Create a new project in Windows ICD"},{"pos":[3079,3172],"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, type <bpt id=\"p2\">**</bpt>icd<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Windows Imaging and Configuration Designer<ept id=\"p3\">**</ept>."},{"pos":[3178,3240],"content":"If the <bpt id=\"p1\">**</bpt>User Account Control<ept id=\"p1\">**</ept> window appears, click <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept>."},{"pos":[3246,3288],"content":"Click <bpt id=\"p1\">**</bpt>New Windows image customization<ept id=\"p1\">**</ept>."},{"pos":[3293,3387],"content":"On the <bpt id=\"p1\">**</bpt>Enter project details<ept id=\"p1\">**</ept> page, use the following information, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>:"},{"pos":[3396,3448],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>Fabrikam<ph id=\"ph1\">\\_</ph>Notebook<ph id=\"ph2\">\\_</ph>1<ept id=\"p2\">**</ept>."},{"pos":[3457,3496],"content":"Leave the <bpt id=\"p1\">**</bpt>Project folder<ept id=\"p1\">**</ept> box as-is."},{"pos":[3505,3601],"content":"In the <bpt id=\"p1\">**</bpt>Description<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>Base hardware design for the Fabrikam Notebook PC Series 1<ept id=\"p2\">**</ept>."},{"pos":[3607,3734],"content":"On the <bpt id=\"p1\">**</bpt>Select imaging source format<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>The Windows image is based on a Windows image (WIM) file<ept id=\"p2\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"pos":[3739,3786],"content":"On the <bpt id=\"p1\">**</bpt>Select Image<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept>."},{"pos":[3795,3889],"content":"Browse to <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Images<ph id=\"ph2\">\\\\</ph>Win10<ph id=\"ph3\">\\_</ph>x64<ph id=\"ph4\">\\\\</ph>sources<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>install.wim<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept>."},{"content":"If working with design 1, select Windows 10 Home.","pos":[3898,3947]},{"content":"If working with design 1b, select Windows 10 Pro.","pos":[3948,3997]},{"pos":[4006,4021],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>."},{"content":"On the <bpt id=\"p1\">**</bpt>Import a Provisioning Package (Optional)<ept id=\"p1\">**</ept> page, if you have a provisioning package (similar to the one you create in Lab 1b), you can add it now, and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept>.","pos":[4027,4209]},{"content":"Otherwise, you can leave this step blank and click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","pos":[4210,4272]},{"content":"The project is created and the main editing windows appear.","pos":[4274,4333]},{"content":"<bpt id=\"p1\">**</bpt>Troubleshooting:<ept id=\"p1\">**</ept> If you get an error while creating the project, make sure you obtained the Windows image from a dedicated download center for OEMs and System Builders.","pos":[4335,4507]},{"content":"The <bpt id=\"p1\">[</bpt>Windows 10 installation media<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=626022)</ept> that can be downloaded using the media creation tool cannot be used with Windows Imaging tools.","pos":[4508,4688]},{"pos":[4871,4941],"content":"Step 2: Add the Universal Windows apps and Windows 8.1 apps (Optional)"},{"content":"You can preload Universal Windows apps to your image so they are available on the PC when your customers start the PC for the first time.","pos":[4944,5081]},{"content":"With Windows ICD, you add Windows 8.1 apps the same way you add Windows Universal apps to your image.","pos":[5082,5183]},{"content":"For hardware configuration 1, you can skip this step if you don’t want to add any apps to your low disk footprint device.","pos":[5185,5306]},{"content":"For this walkthrough, we'll add the Office Preview apps (Word, Excel, and PowerPoint).","pos":[5308,5394]},{"content":"You can repeat these steps for any Universal Windows apps and Windows 8.1 apps you want to add to the image.","pos":[5395,5503]},{"pos":[5509,5623],"content":"In Windows ICD, under <bpt id=\"p1\">**</bpt>Available customizations<ept id=\"p1\">**</ept>, expand <bpt id=\"p2\">**</bpt>Deployment assets<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Applications<ept id=\"p3\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Package path<ept id=\"p1\">**</ept> box, click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept>.","pos":[5628,5674]},{"content":"Change the view to <bpt id=\"p1\">**</bpt>Application Bundle (<ph id=\"ph1\">\\*</ph>.appxbundle)<ept id=\"p1\">**</ept>, select the Word Preview app bundle package, and then click <bpt id=\"p2\">**</bpt>Open.<ept id=\"p2\">**</ept>","pos":[5675,5802]},{"pos":[5807,5850],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>Word Preview<ept id=\"p2\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>License path<ept id=\"p1\">**</ept> box, click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept>.","pos":[5855,5901]},{"content":"Select the Word Preview license file, and then click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>.","pos":[5902,5964]},{"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>.","pos":[5969,5983]},{"content":"The app’s name should appear in the <bpt id=\"p1\">**</bpt>Selected customizations<ept id=\"p1\">**</ept> pane.","pos":[5984,6053]},{"content":"Repeat steps 1 – 5 for the Excel Preview and PowerPoint Preview app bundle packages and any other Universal Windows apps and Windows 8.1 apps you want to add to the image.","pos":[6055,6226]},{"content":"OneNote and Reader 8.1 apps are included on the event-provided USB.","pos":[6227,6294]},{"pos":[6383,6416],"content":"Step 3: Add a driver to the image"},{"content":"You can use Windows ICD to add your own INF-based driver to your image.","pos":[6419,6490]},{"pos":[6496,6605],"content":"In Windows ICD, under <bpt id=\"p1\">**</bpt>Available Customizations<ept id=\"p1\">**</ept>, expand <bpt id=\"p2\">**</bpt>Deployment assets<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Drivers<ept id=\"p3\">**</ept>."},{"content":"In the middle pane, next to <bpt id=\"p1\">**</bpt>Driver folder path<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept>.","pos":[6610,6679]},{"content":"Browse to your INF-based driver, and then click OK.","pos":[6680,6731]},{"content":"The driver .inf file should show up in the <bpt id=\"p1\">**</bpt>Drivers<ept id=\"p1\">**</ept> box.","pos":[6737,6796]},{"content":"If there are multiple drivers in that folder, all of the drivers in that folder will be added.","pos":[6797,6891]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Some drivers are packaged as .zip or .exe files.","pos":[6897,6955]},{"content":"You'll need to unzip or extract these files before adding them.","pos":[6956,7019]},{"content":"Some driver files, like the sample driver given, include files for both x86 and x64 devices, this is OK.","pos":[7020,7124]},{"pos":[7137,7189],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">*</bpt>Fabrikam Video Card 100<ept id=\"p2\">*</ept>."},{"content":"If you're testing new device designs with prototype or pre-release drivers from your hardware manufacturer, select the <bpt id=\"p1\">**</bpt>Force unsigned install<ept id=\"p1\">**</ept> check box, then click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>.","pos":[7195,7371]},{"content":"The driver's descriptive name should appear in the <bpt id=\"p1\">**</bpt>Selected customizations<ept id=\"p1\">**</ept> pane.","pos":[7372,7456]},{"pos":[7551,7600],"content":"Step 4: Add some customized settings to the image"},{"pos":[7607,7720],"content":"In Windows ICD, in the <bpt id=\"p1\">**</bpt>Available Customizations<ept id=\"p1\">**</ept> pane, expand <bpt id=\"p2\">**</bpt>Image time settings<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>OEM<ept id=\"p3\">**</ept>."},{"pos":[7725,7782],"content":"In the middle pane, in the <bpt id=\"p1\">*</bpt>Name<ept id=\"p1\">*</ept> box, type <bpt id=\"p2\">**</bpt>Fabrikam<ept id=\"p2\">**</ept>."},{"pos":[7787,7866],"content":"In the <bpt id=\"p1\">**</bpt>Available Customizations<ept id=\"p1\">**</ept> pane, under <bpt id=\"p2\">**</bpt>OEM<ept id=\"p2\">**</ept>, click <bpt id=\"p3\">**</bpt>Information.<ept id=\"p3\">**</ept>"},{"content":"Fill in the following information:","pos":[7872,7906]},{"pos":[7916,7963],"content":"In the <bpt id=\"p1\">**</bpt>Manufacturer<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>Fabrikam<ept id=\"p2\">**</ept>."},{"pos":[7972,8022],"content":"In the <bpt id=\"p1\">**</bpt>SupportHours<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>8 AM - 5 PM<ept id=\"p2\">**</ept>."},{"pos":[8031,8078],"content":"In the <bpt id=\"p1\">**</bpt>SupportPhone<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>555-1212<ept id=\"p2\">**</ept>."},{"pos":[8087,8151],"content":"In the <bpt id=\"p1\">**</bpt>SupportURL<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>http://support.fabrikam.com<ept id=\"p2\">**</ept>."},{"pos":[8153,8213],"content":"The settings appear in the <bpt id=\"p1\">**</bpt>Selected customizations<ept id=\"p1\">**</ept> pane."},{"pos":[8377,8411],"content":"Step 5: Customize the Start layout"},{"pos":[8414,8609],"content":"In Windows 10, OEMs can modify the default Start layout and specify the layout of the OEM tiles by creating a <bpt id=\"p1\">**</bpt>LayoutModification.xml<ept id=\"p1\">**</ept> file and placing this file in the correct system location."},{"content":"Create a layoutmodification.xml file.","pos":[8615,8652]},{"content":"For this lab, you can use the sample on the USB.","pos":[8653,8701]},{"content":"The sample will pin Office, OneNote and Reader 8.1 to Start if they have been preloaded on the device (Step 2).","pos":[8702,8813]},{"content":"To create your own layoutmodification.xml file by using an XML editor, see the <bpt id=\"p1\">[</bpt>Sample scripts<ept id=\"p1\">](windows-deployment-sample-scripts-sxs.md)</ept>.","pos":[8814,8952]},{"pos":[8957,9092],"content":"In Windows ICD, in the <bpt id=\"p1\">**</bpt>Available customizations<ept id=\"p1\">**</ept> pane, expand <bpt id=\"p2\">**</bpt>Runtime settings<ept id=\"p2\">**</ept>, click <bpt id=\"p3\">**</bpt>Start<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>StartLayout<ept id=\"p4\">**</ept>."},{"pos":[9097,9134],"content":"In the middle pane, click <bpt id=\"p1\">**</bpt>Browse.<ept id=\"p1\">**</ept>"},{"content":"Navigate to the location where you saved the LayoutModification.xml file.","pos":[9139,9212]},{"content":"Select the file, and then click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>.","pos":[9217,9258]},{"content":"This should set the value of StartLayout.","pos":[9259,9300]},{"content":"The setting appears in the Selected customizations pane.","pos":[9306,9362]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  You cannot add .url and .lnk files directly in Windows ICD.","pos":[9368,9437]},{"content":"If you have these files, follow Step 2 in lab 2 in the section ”Add the files you need to modify the Start layout”.","pos":[9438,9553]},{"pos":[9643,9665],"content":"Step 6: Add a language"},{"content":"Windows ICD provides a basic method of adding languages.","pos":[9668,9724]},{"pos":[9730,9855],"content":"In Windows ICD, in the <bpt id=\"p1\">**</bpt>Available customizations<ept id=\"p1\">**</ept> pane, expand <bpt id=\"p2\">**</bpt>Deployment assets<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Language packages<ept id=\"p3\">**</ept>."},{"content":"In the middle pane, next to <bpt id=\"p1\">**</bpt>Cab file<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept>.","pos":[9860,9919]},{"content":"Browse to the language pack file, for example: <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Samples<ph id=\"ph2\">\\\\</ph>Languages<ph id=\"ph3\">\\\\</ph>fr-fr x64-client<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>lp.cab<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Open.<ept id=\"p3\">**</ept>","pos":[9920,10055]},{"pos":[10060,10136],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>French user interface<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>."},{"pos":[10142,10214],"content":"The language pack should appear in the <bpt id=\"p1\">**</bpt>Selected customizations<ept id=\"p1\">**</ept> pane."},{"content":"This method also does not update the language resources for Windows applications.","pos":[10216,10297]},{"content":"Including the Windows inbox apps.","pos":[10298,10331]},{"content":"While some Windows apps will be updated automatically through Windows Update, others may need to be reinstalled later.","pos":[10332,10450]},{"content":"To update the resources for Windows RE and for apps, modify the Windows install.wim image, using the instructions from <bpt id=\"p1\">[</bpt>Lab 2: Classic-style deployment<ept id=\"p1\">](part-2--classic-style-deployment.md)</ept>.","pos":[10452,10642]},{"content":"You can skip steps 4 and 5 (adding windows drivers and modifying the Start layout), and you can skip optional steps 11 and 12 (upgrading the Windows edition and setting the image to boot to audit mode).","pos":[10643,10845]},{"pos":[10940,10970],"content":"Step 7: Add features on demand"},{"content":"Features on demand (FODs) are Windows feature packages that can be added at any time.","pos":[10973,11058]},{"content":"When a user needs a new feature, they can request the feature package from Windows Update.","pos":[11059,11149]},{"content":"OEMs can preinstall these features to enable them on their devices out of the box.","pos":[11150,11232]},{"content":"Common features include language resources like handwriting recognition.","pos":[11234,11306]},{"content":"Some of these features are required to enable full Cortana functionality.","pos":[11307,11380]},{"content":"The following table shows the types of language components available for Windows and which ones apply to Cortana.","pos":[11381,11494]},{"content":"In addition, to enable Cortana or for pen support, features need to be added in a specific order.","pos":[11496,11593]},{"content":"For example, to enable Cortana, install these features in this order: <bpt id=\"p1\">**</bpt>lp.cab<ept id=\"p1\">**</ept>, then <bpt id=\"p2\">**</bpt>Basic<ept id=\"p2\">**</ept>, then <bpt id=\"p3\">**</bpt>TextToSpeech<ept id=\"p3\">**</ept>, then <bpt id=\"p4\">**</bpt>Speech<ept id=\"p4\">**</ept>.","pos":[11594,11731]},{"content":"To enable pen support, install these features in this order: <bpt id=\"p1\">**</bpt>lp.cab<ept id=\"p1\">**</ept>, then <bpt id=\"p2\">**</bpt>Basic<ept id=\"p2\">**</ept>, then <bpt id=\"p3\">**</bpt>Handwriting<ept id=\"p3\">**</ept>.","pos":[11732,11842]},{"content":"Component","pos":[12000,12009]},{"content":"Sample file name","pos":[12032,12048]},{"content":"Dependencies","pos":[12071,12083]},{"content":"Description","pos":[12106,12117]},{"content":"Language pack","pos":[12180,12193]},{"content":"None","pos":[12258,12262]},{"content":"UI text, including basic Cortana capabilities.","pos":[12285,12331]},{"content":"Language interface pack","pos":[12378,12401]},{"content":"Requires a specific fully-localized or partially-localized language pack.","pos":[12466,12539]},{"content":"Example: ca-ES requires es-ES.","pos":[12540,12570]},{"content":"To learn more, see <bpt id=\"p1\">[</bpt>Available Language Packs for Windows<ept id=\"p1\">](available-language-packs-for-windows.md)</ept>.","pos":[12571,12670]},{"content":"UI text, including basic Cortana capabilities.","pos":[12696,12742]},{"content":"Basic","pos":[12792,12797]},{"content":"None","pos":[12910,12914]},{"content":"Spell checking, text prediction, word breaking, and hyphenation if available for the language.","pos":[12940,13034]},{"content":"You must add this component before adding any of the following components.","pos":[13042,13116]},{"content":"Fonts","pos":[13167,13172]},{"content":"None","pos":[13284,13288]},{"content":"Fonts.","pos":[13314,13320]},{"content":"Required for some regions to render text that appears in documents.","pos":[13328,13395]},{"content":"Example, th-TH requires the Thai font pack.","pos":[13396,13439]},{"content":"To learn more, see <bpt id=\"p1\">[</bpt>Features On Demand V2 (Capabilities)<ept id=\"p1\">](features-on-demand-v2--capabilities.md)</ept>.","pos":[13440,13538]},{"content":"Optical character recognition","pos":[13588,13617]},{"content":"Basic","pos":[13728,13733]},{"content":"Recognizes and outputs text in an image.","pos":[13756,13796]},{"content":"Handwriting recognition","pos":[13843,13866]},{"content":"Basic","pos":[13985,13990]},{"content":"Enables handwriting recognition for devices with pen input.","pos":[14013,14072]},{"content":"Text-to-speech","pos":[14118,14132]},{"content":"Basic","pos":[14252,14257]},{"content":"Enables text to speech, used by Cortana and Narrator.","pos":[14280,14333]},{"content":"Speech recognition","pos":[14380,14398]},{"content":"Basic, Text-To-Speech recognition","pos":[14512,14545]},{"content":"Recognizes voice input, used by Cortana and Windows Speech Recognition.","pos":[14568,14639]},{"pos":[14677,14803],"content":"In Windows ICD, in the <bpt id=\"p1\">**</bpt>Available customizations<ept id=\"p1\">**</ept> pane, expand <bpt id=\"p2\">**</bpt>Deployment assets<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Features on demand<ept id=\"p3\">**</ept>."},{"content":"In the middle pane, next to <bpt id=\"p1\">**</bpt>Features package path<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept>.","pos":[14808,14880]},{"content":"Browse to the FOD file, for example: <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Samples<ph id=\"ph2\">\\\\</ph>Languages<ph id=\"ph3\">\\\\</ph>fr-fr x64-client<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Microsoft-Windows-LanguageFeatures-Basic-fr-fr-Package.cab<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Open.<ept id=\"p3\">**</ept>","pos":[14881,15058]},{"pos":[15063,15149],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>French basic language component<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>."},{"pos":[15155,15234],"content":"The language component should appear in the <bpt id=\"p1\">**</bpt>Configured customizations<ept id=\"p1\">**</ept> pane."},{"content":"In the middle pane, next to <bpt id=\"p1\">**</bpt>Cab File<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept>.","pos":[15240,15299]},{"content":"Browse to the FOD file, for example: <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Samples<ph id=\"ph2\">\\\\</ph>Languages<ph id=\"ph3\">\\\\</ph>fr-fr x64-client<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Microsoft-Windows-LanguageFeatures-Speech-fr-fr-Package.cab<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Open.<ept id=\"p3\">**</ept>","pos":[15300,15478]},{"pos":[15483,15570],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>French speech language component<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>."},{"pos":[15576,15654],"content":"The language components should appear in the <bpt id=\"p1\">**</bpt>Selected customizations<ept id=\"p1\">**</ept> pane."},{"content":"Repeat the steps to add the <bpt id=\"p1\">**</bpt>Text-to-Speech<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Speech<ept id=\"p2\">**</ept> components.","pos":[15660,15733]},{"content":"The language components should appear in the <bpt id=\"p1\">**</bpt>Selected customizations<ept id=\"p1\">**</ept> pane.","pos":[15734,15812]},{"content":"For languages that require fonts, such as Chinese (Simplified), add the font pack.","pos":[15817,15899]},{"content":"To learn which languages require fonts, see <bpt id=\"p1\">[</bpt>Features On Demand V2 (Capabilities)<ept id=\"p1\">](features-on-demand-v2--capabilities.md)</ept>.","pos":[15900,16023]},{"content":"In the middle pane, next to <bpt id=\"p1\">**</bpt>Cab File<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept>.","pos":[16029,16088]},{"content":"Browse to the FOD file, for example: <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Samples<ph id=\"ph2\">\\\\</ph>Languages<ph id=\"ph3\">\\\\</ph>zh-cn x64-client<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Microsoft-Windows-LanguageFeatures-Fonts-Hans-Package.cab<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Open<ept id=\"p3\">**</ept>.","pos":[16089,16265]},{"pos":[16271,16370],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> box, type <bpt id=\"p2\">**</bpt>Chinese (simplified) font language component<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Add<ept id=\"p3\">**</ept>."},{"pos":[16376,16456],"content":"The language components should appear in the <bpt id=\"p1\">**</bpt>Configured customizations<ept id=\"p1\">**</ept> pane."},{"content":"Note","pos":[16460,16464]},{"content":"You can’t update the language in the Windows Recovery Environment from Windows ICD.","pos":[16473,16556]},{"content":"By default, if there's a problem, the device will show recovery screens in English only.","pos":[16557,16645]},{"content":"You run Dism.exe (or a script) to remove English after you add another language.","pos":[16650,16730]},{"content":"For an example, see <bpt id=\"p1\">[</bpt>Lab 2: Classic-style deployment<ept id=\"p1\">](part-2--classic-style-deployment.md)</ept>, step 7.","pos":[16731,16830]},{"content":"After adding a language, you'll need to re-add the Universal apps (APPX).","pos":[16835,16908]},{"content":"This process needs to be performed during Audit mode.","pos":[16909,16962]},{"content":"For more information on how to remove and re-add these applications, please refer to <bpt id=\"p1\">[</bpt>Lab 2: Classic-style deployment<ept id=\"p1\">](part-2--classic-style-deployment.md)</ept>, step 8.","pos":[16963,17127]},{"content":"In Windows 10 builds after <bpt id=\"p1\">**</bpt>August 18, 2015<ept id=\"p1\">**</ept>, you can now add new Universal apps (APPX) on top of the existing ones.","pos":[17128,17246]},{"content":"It is no longer necessary to remove the prior versions before re-adding them.","pos":[17247,17324]},{"pos":[17422,17444],"content":"Step 8: Save the image"},{"content":"Windows ICD can store the entire image into a single .FFU file.","pos":[17447,17510]},{"content":"The FFU format was developed for <bpt id=\"p1\">[</bpt>faster, safer deployment<ept id=\"p1\">](wim-vs-ffu-image-file-formats.md)</ept> by using sector-based imaging and security headers.","pos":[17511,17656]},{"pos":[17662,17705],"content":"Click <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Production media<ept id=\"p2\">**</ept>."},{"pos":[17710,17739],"content":"Select <bpt id=\"p1\">**</bpt>FFU<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"pos":[17744,17843],"content":"For hardware designs 1 and 1b, select <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept> under <bpt id=\"p2\">**</bpt>Enable Compact OS<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"pos":[17848,17940],"content":"On the <bpt id=\"p1\">**</bpt>Configure Audit Mode Boot<ept id=\"p1\">**</ept>, leave all options by default, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"pos":[17945,18204],"content":"In **Choose where the FFU file is saved**, give the file a name, such as C:\\\\Images\\\\MyFFUImage.ffu, and then click **Next**.\n**Note**  We recommend choosing a location on a hard drive rather than a USB key, as it can make the FFU creation process faster.","leadings":["","    "],"nodes":[{"content":"In <bpt id=\"p1\">**</bpt>Choose where the FFU file is saved<ept id=\"p1\">**</ept>, give the file a name, such as C:<ph id=\"ph1\">\\\\</ph>Images<ph id=\"ph2\">\\\\</ph>MyFFUImage.ffu, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","pos":[0,125]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  We recommend choosing a location on a hard drive rather than a USB key, as it can make the FFU creation process faster.","pos":[126,255]}]},{"content":"Review the settings and ensure they are correct.","pos":[18217,18265]},{"content":"Click <bpt id=\"p1\">**</bpt>Build<ept id=\"p1\">**</ept>.","pos":[18266,18282]},{"content":"Windows ICD creates the FFU file using the name and path indicated in the previous step.","pos":[18283,18371]},{"content":"This will take a few minutes.","pos":[18372,18401]},{"content":"Click <bpt id=\"p1\">**</bpt>Finish<ept id=\"p1\">**</ept>.","pos":[18402,18419]},{"content":"Troubleshooting: If the project fails to build:","pos":[18427,18474]},{"content":"Check to make sure there's no leading or trailing spaces in the project name.","pos":[18486,18563]},{"content":"If there is, recreate the project.","pos":[18564,18598]},{"pos":[18607,18782],"content":"<bpt id=\"p1\">**</bpt>The requested operation couldn't be completed due to a file size limitation<ept id=\"p1\">**</ept>: Check to see that the drive is formatted using the NTFS file format and has at least 5GB free."},{"pos":[18791,19009],"content":"If at any time you end up repeating this walkthrough, if you want to use the same project, delete the existing project folder from <bpt id=\"p1\">**</bpt>Documents<ph id=\"ph1\">\\\\</ph>Windows Imaging and Configuration Designer (WICD)<ept id=\"p1\">**</ept> before starting again."},{"content":"Copy the FFU file to a removable storage device, like a separate USB key or an external USB drive.","pos":[19015,19113]},{"content":"You may need to reformat the drive using the NTFS format so that it can accept very large files - depending on how many languages, drivers, and apps you add, the .FFU file can easily be 5GB or larger.","pos":[19114,19314]},{"content":"You probably won't be able to use the Windows PE key for this - it's formatted using FAT32, which only accepts files that are 4GB or smaller.","pos":[19315,19456]},{"pos":[19563,19610],"content":"Step 9: Install Windows on the reference device"},{"pos":[19617,19675],"content":"Insert the <bpt id=\"p1\">**</bpt>WinPE<ept id=\"p1\">**</ept> USB drive into your reference device."},{"content":"Boot up the reference device to the boot device selection menu.","pos":[19680,19743]},{"content":"You usually do this by powering on the device and quickly pressing a specific key or button (for example, the <bpt id=\"p1\">**</bpt>Esc<ept id=\"p1\">**</ept> key or the <bpt id=\"p2\">**</bpt>Volume down<ept id=\"p2\">**</ept> button), and selecting the USB key.","pos":[19744,19924]},{"content":"Insert the <bpt id=\"p1\">**</bpt>FFU<ept id=\"p1\">**</ept> USB drive into your reference device.","pos":[19929,19985]},{"content":"Determine which driver letter is assigned to this drive by doing the following:","pos":[19986,20065]},{"pos":[20075,20141],"content":"From the WinPE command prompt, type: <bpt id=\"p1\">**</bpt>diskpart<ept id=\"p1\">**</ept> and press Enter."},{"pos":[20150,20210],"content":"At the diskpart prompt, type<bpt id=\"p1\">**</bpt>list volume<ept id=\"p1\">**</ept> and press Enter."},{"content":"This lists all of the volumes present in the system.","pos":[20216,20268]},{"content":"Determine the driver letter that corresponds to the FFU USB key, for example, G.","pos":[20269,20349]},{"content":"From the WinPE command prompt, type the following:","pos":[20355,20405]},{"content":"Where G:<ph id=\"ph1\">\\\\</ph>MyFFUImage.ffu is the file location of the FFU file.","pos":[20570,20632]},{"content":"<bpt id=\"p1\">**</bpt>Repeat Step 9: Use your new Windows installation key to set up more devices<ept id=\"p1\">**</ept>.","pos":[20634,20714]},{"content":"At the <bpt id=\"p1\">**</bpt>Get going fast<ept id=\"p1\">**</ept> screen, turn off the device by pressing and holding the power button.","pos":[20715,20810]},{"content":"Do not complete the OOBE for your customer.","pos":[20811,20854]},{"content":"There's a known bug where if your PC is set to automatically boot to a USB key, it will get caught in a loop during the install process: after Windows installs, it reinstalls again and again.","pos":[20856,21047]},{"content":"To avoid this loop:","pos":[21048,21067]},{"content":"Workaround: Prepare the reference device","pos":[21071,21111]},{"content":"On your reference device, open the device's boot menus.","pos":[21119,21174]},{"content":"You usually do this by powering on the device and quickly pressing a specific key or button (for example, the <bpt id=\"p1\">**</bpt>Esc<ept id=\"p1\">**</ept> key or the <bpt id=\"p2\">**</bpt>Volume up<ept id=\"p2\">**</ept> button).","pos":[21175,21326]},{"pos":[21331,21502],"content":"Find the boot order menu (this menu has different names and locations) and make sure that the <bpt id=\"p1\">**</bpt>hard drive<ept id=\"p1\">**</ept> is set up to be first in the boot sequence, not the USB drive."},{"content":"If your device doesn't appear to have a way to change the boot order on during the boot sequence, the option may be disabled.","pos":[21507,21632]},{"content":"Look for a option like \"Enable Boot Options on Startup\" or \"F12 Boot Menu\", and enable the menu.","pos":[21633,21729]},{"pos":[21836,21851],"content":"Troubleshooting"},{"content":"If Windows doesn't install on the reference device, try each of these steps:","pos":[21854,21930]},{"content":"<bpt id=\"p1\">**</bpt>USB key doesn't appear in the boot menus<ept id=\"p1\">**</ept>: Try using different USB ports on the computer.","pos":[21936,22028]},{"content":"Avoid using USB hubs or cables.","pos":[22029,22060]},{"content":"Restart the PC and open the device's boot menus.","pos":[22066,22114]},{"content":"Look for an option to enable a boot device selection menu on startup (example: \"F12 Boot menu\").","pos":[22115,22211]},{"content":"If you find one, enable it!","pos":[22212,22239]},{"pos":[22245,22360],"content":"<bpt id=\"p1\">**</bpt>UEFI or BIOS<ept id=\"p1\">**</ept>: If your boot menus give you a choice between booting in UEFI mode or BIOS mode, choose UEFI mode."},{"content":"If the device boots up to the <bpt id=\"p1\">**</bpt>Drive Selection<ept id=\"p1\">**</ept> menu, select the primary hard drive, this is usually the <bpt id=\"p2\">**</bpt>C<ept id=\"p2\">**</ept> drive.","pos":[22365,22484]},{"content":"If you're not sure which drive is which, press <bpt id=\"p1\">**</bpt>Shift-F10<ept id=\"p1\">**</ept> to open the Command Prompt.","pos":[22485,22573]},{"content":"Type <bpt id=\"p1\">**</bpt>diskpart<ept id=\"p1\">**</ept> and press Enter.","pos":[22574,22608]},{"content":"At the Diskpart prompt, type <bpt id=\"p1\">**</bpt>list volume<ept id=\"p1\">**</ept> to show the partitions.","pos":[22609,22677]},{"content":"Type <bpt id=\"p1\">**</bpt>exit<ept id=\"p1\">**</ept>.","pos":[22678,22692]},{"content":"Press <bpt id=\"p1\">**</bpt>Alt-Tab<ept id=\"p1\">**</ept> to try again.","pos":[22693,22724]},{"content":"If the device gets through 6% of the installation and then fails, you may need to prepare the drive:","pos":[22729,22829]},{"content":"Plug the USB key.","pos":[22839,22856]},{"pos":[22865,22931],"content":"Select <bpt id=\"p1\">**</bpt>Troubleshoot <ph id=\"ph1\">&amp;gt;</ph> Advanced Options <ph id=\"ph2\">&amp;gt;</ph> Command Prompt<ept id=\"p1\">**</ept>."},{"content":"Type <bpt id=\"p1\">**</bpt>diskpart<ept id=\"p1\">**</ept> and press Enter.","pos":[22940,22974]},{"content":"At the Diskpart prompt, type <bpt id=\"p1\">**</bpt>list volume<ept id=\"p1\">**</ept> to list the drives.","pos":[22975,23039]},{"content":"Type <bpt id=\"p1\">**</bpt>exit<ept id=\"p1\">**</ept> to leave the Diskpart prompt.","pos":[23040,23083]},{"pos":[23092,23151],"content":"Type <bpt id=\"p1\">**</bpt>diskpart /s D:<ph id=\"ph1\">\\\\</ph>Samples<ph id=\"ph2\">\\\\</ph>CreatePartitions-UEFI.txt<ept id=\"p1\">**</ept>"},{"content":"where D is the drive letter of the USB key.","pos":[23161,23204]},{"content":"For BIOS-based PCs, use CreatePartitions-BIOS.txt instead.","pos":[23214,23272]},{"pos":[23282,23324],"content":"Type <bpt id=\"p1\">**</bpt>exit<ept id=\"p1\">**</ept> to leave the Command prompt."},{"pos":[23333,23361],"content":"Select <bpt id=\"p1\">**</bpt>Turn off your PC<ept id=\"p1\">**</ept>."},{"content":"Turn on the device and open the boot device selection.","pos":[23370,23424]},{"content":"If you have a choice between booting in BIOS or UEFI mode, select UEFI mode.","pos":[23425,23501]},{"content":"Windows ICD should install correctly.","pos":[23502,23539]},{"content":"If the device boots up to the <bpt id=\"p1\">**</bpt>Choose an option: Troubleshoot / Turn off your PC<ept id=\"p1\">**</ept> menu, you may be seeing a known bug with USB 3.0 and Windows ICD images.","pos":[23545,23701]},{"content":"Try again using a <bpt id=\"p1\">**</bpt>USB 2.0<ept id=\"p1\">**</ept> key or port.","pos":[23702,23744]},{"content":"Make sure your device and the Windows image match.","pos":[23749,23799]},{"content":"If they don't match, try creating the image again using the correct architecture.","pos":[23800,23881]},{"pos":[23936,23959],"content":"Test the customizations"},{"content":"Do these steps to test an image.","pos":[23962,23994]},{"content":"Note, this requires completing the First User Experience and creating a user account.","pos":[23995,24080]},{"content":"After performing these steps, you'd typically need to reinstall Windows onto the device before sending it to a customer.","pos":[24081,24201]},{"content":"Make sure the device is not plugged into the network, and turn it on.","pos":[24207,24276]},{"content":"After the device boots, if the <bpt id=\"p1\">**</bpt>Languages<ept id=\"p1\">**</ept> screen appears and shows the French language, then the language pack has been added correctly.","pos":[24281,24420]},{"content":"Choose the language you're most familiar with, choose your keyboard, and then click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[24421,24514]},{"content":"Complete the Out of Box Experience (OOBE): these steps may vary based on language.","pos":[24519,24601]},{"pos":[24606,24651],"content":"On the <bpt id=\"p1\">**</bpt>Hi there<ept id=\"p1\">**</ept> screen, click <bpt id=\"p2\">**</bpt>Accept<ept id=\"p2\">**</ept>."},{"content":"If it asks you for a product key, click <bpt id=\"p1\">**</bpt>Do this later<ept id=\"p1\">**</ept>.","pos":[24656,24714]},{"content":"If you're plugged into a network connection, you may be asked to provide a product key.","pos":[24715,24802]},{"content":"To avoid using a product key, disconnect the device and try again.","pos":[24803,24869]},{"pos":[24874,24959],"content":"Click <bpt id=\"p1\">**</bpt>Accept<ept id=\"p1\">**</ept> , click <bpt id=\"p2\">**</bpt>Skip this step<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Use express settings<ept id=\"p3\">**</ept>."},{"pos":[24964,25039],"content":"On the <bpt id=\"p1\">**</bpt>Who owns this PC?<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>I do<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"pos":[25044,25100],"content":"On the <bpt id=\"p1\">**</bpt>Make it yours<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Skip this step<ept id=\"p2\">**</ept>."},{"pos":[25105,25165],"content":"Add a user name (example: \"Terry\"), and then click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>."},{"content":"The device finalizes setup and reboots to the desktop.","pos":[25170,25224]},{"pos":[25229,25432],"content":"When the desktop appears, in <bpt id=\"p1\">**</bpt>Settings<ept id=\"p1\">**</ept> under <bpt id=\"p2\">**</bpt>System <ph id=\"ph1\">&amp;gt;</ph> About<ept id=\"p2\">**</ept>, you should see the technical support info that you entered earlier appear (company name, support phone number, and support website)."}],"content":"---\nauthor: Justinha\nDescription: 'Lab 1: Customize and install Windows using the Windows Imaging and Configuration Designer (ICD)'\nms.assetid: 97f2cc2b-ae4b-4117-a73b-42e508fe7a03\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: 'Lab 1: Customize and install Windows using the Windows Imaging and Configuration Designer (ICD)'\n---\n\n# Lab 1: Customize and install Windows using the Windows Imaging and Configuration Designer (ICD)\n\n\nThe fastest way to deploy customized Windows devices is by creating bootable USB keys using Windows Imaging and Configuration Designer (ICD). This tool helps you install device drivers, set system settings, and add languages so you can quickly install Windows onto test or retail devices.\n\n## <span id=\"Design_your_images\"></span><span id=\"design_your_images\"></span><span id=\"DESIGN_YOUR_IMAGES\"></span>Design your images\n\n\nHere’s a sample set of hardware configurations that you might design.\n\n|                              |              |                     |                                   |\n|------------------------------|--------------|---------------------|-----------------------------------|\n| Hardware Configuration:      | 1            | 1B                  | 2                                 |\n| Form factor                  | Small tablet | 2-in-1              | Notebook                          |\n| RAM                          | 1 GB         | 2 GB                | 4 GB                              |\n| Disk capacity and type       | 16 GB eMMC   | 32 GB eMMC          | 500 GB HDD                        |\n| Display size                 | 8”           | 10”                 | 14”                               |\n| Windows SKU                  | Core         | Pro                 | Core                              |\n| Language(s)                  | EN-US        | EN-US, FR-FR, ES-ES | EN-GB, DE-DE, FR-FR, ES-ES, ZH-CN |\n| Cortana                      | Yes          | Yes                 | Yes                               |\n| Inbox apps (Universal)       | Yes          | Yes                 | Yes                               |\n| Pen                          | No           | Yes                 | No                                |\n| Office (Universal)           | Yes          | Yes                 | Yes                               |\n| Classic Windows applications | No           | Yes                 | Yes                               |\n| Office 2013                  | No           | Yes                 | Yes                               |\n| Compact OS                   | Yes          | Yes                 | No                                |\n\n \n\nThis lab will walk you through hardware configuration 1 with optional steps included for hardware configuration 2. Lab 1b continues the lab to include Classic Windows applications to deploy hardware configuration 1b and 2. Lab 1c continues the lab to show you how to edit an expand on existing projects.\n\n## <span id=\"loadImage\"></span><span id=\"loadimage\"></span><span id=\"LOADIMAGE\"></span>Step 1: Create a new project in Windows ICD\n\n\n1.  Click **Start**, type **icd**, and then click **Windows Imaging and Configuration Designer**.\n\n    If the **User Account Control** window appears, click **Yes**.\n\n2.  Click **New Windows image customization**.\n3.  On the **Enter project details** page, use the following information, and then click **Next**:\n    -   In the **Name** box, type **Fabrikam\\_Notebook\\_1**.\n    -   Leave the **Project folder** box as-is.\n    -   In the **Description** box, type **Base hardware design for the Fabrikam Notebook PC Series 1**.\n\n4.  On the **Select imaging source format** page, click **The Windows image is based on a Windows image (WIM) file** &gt; **Next**.\n5.  On the **Select Image** page, click **Browse**.\n    -   Browse to **C:\\\\Images\\\\Win10\\_x64\\\\sources**, click **install.wim**, and then click **Open**.\n    -   If working with design 1, select Windows 10 Home. If working with design 1b, select Windows 10 Pro.\n    -   Click **Next**.\n\n6.  On the **Import a Provisioning Package (Optional)** page, if you have a provisioning package (similar to the one you create in Lab 1b), you can add it now, and then click **Finish**. Otherwise, you can leave this step blank and click **Finish**.\n\nThe project is created and the main editing windows appear.\n\n**Troubleshooting:** If you get an error while creating the project, make sure you obtained the Windows image from a dedicated download center for OEMs and System Builders. The [Windows 10 installation media](http://go.microsoft.com/fwlink/p/?LinkId=626022) that can be downloaded using the media creation tool cannot be used with Windows Imaging tools.\n\n## <span id=\"step_2__add_the_universal_windows_apps_and_windows_8.1_apps__optional_\"></span><span id=\"STEP_2__ADD_THE_UNIVERSAL_WINDOWS_APPS_AND_WINDOWS_8.1_APPS__OPTIONAL_\"></span>Step 2: Add the Universal Windows apps and Windows 8.1 apps (Optional)\n\n\nYou can preload Universal Windows apps to your image so they are available on the PC when your customers start the PC for the first time. With Windows ICD, you add Windows 8.1 apps the same way you add Windows Universal apps to your image.\n\nFor hardware configuration 1, you can skip this step if you don’t want to add any apps to your low disk footprint device.\n\nFor this walkthrough, we'll add the Office Preview apps (Word, Excel, and PowerPoint). You can repeat these steps for any Universal Windows apps and Windows 8.1 apps you want to add to the image.\n\n1.  In Windows ICD, under **Available customizations**, expand **Deployment assets**, and then click **Applications**.\n2.  In the **Package path** box, click **Browse**. Change the view to **Application Bundle (\\*.appxbundle)**, select the Word Preview app bundle package, and then click **Open.**\n3.  In the **Name** box, type **Word Preview**.\n4.  In the **License path** box, click **Browse**. Select the Word Preview license file, and then click **Open**.\n5.  Click **Add**. The app’s name should appear in the **Selected customizations** pane.\n\nRepeat steps 1 – 5 for the Excel Preview and PowerPoint Preview app bundle packages and any other Universal Windows apps and Windows 8.1 apps you want to add to the image. OneNote and Reader 8.1 apps are included on the event-provided USB.\n\n## <span id=\"addDriver\"></span><span id=\"adddriver\"></span><span id=\"ADDDRIVER\"></span>Step 3: Add a driver to the image\n\n\nYou can use Windows ICD to add your own INF-based driver to your image.\n\n1.  In Windows ICD, under **Available Customizations**, expand **Deployment assets**, and then click **Drivers**.\n2.  In the middle pane, next to **Driver folder path**, click **Browse**. Browse to your INF-based driver, and then click OK.\n\n    The driver .inf file should show up in the **Drivers** box. If there are multiple drivers in that folder, all of the drivers in that folder will be added.\n\n    **Note**  Some drivers are packaged as .zip or .exe files. You'll need to unzip or extract these files before adding them. Some driver files, like the sample driver given, include files for both x86 and x64 devices, this is OK.\n\n     \n\n3.  In the **Name** box, type *Fabrikam Video Card 100*.\n\n    If you're testing new device designs with prototype or pre-release drivers from your hardware manufacturer, select the **Force unsigned install** check box, then click **Add**. The driver's descriptive name should appear in the **Selected customizations** pane.\n\n## <span id=\"addSettings\"></span><span id=\"addsettings\"></span><span id=\"ADDSETTINGS\"></span>Step 4: Add some customized settings to the image\n\n\n1.  In Windows ICD, in the **Available Customizations** pane, expand **Image time settings**, and then click **OEM**.\n2.  In the middle pane, in the *Name* box, type **Fabrikam**.\n3.  In the **Available Customizations** pane, under **OEM**, click **Information.**\n\n    Fill in the following information:\n\n    -   In the **Manufacturer** box, type **Fabrikam**.\n    -   In the **SupportHours** box, type **8 AM - 5 PM**.\n    -   In the **SupportPhone** box, type **555-1212**.\n    -   In the **SupportURL** box, type **http://support.fabrikam.com**.\n\nThe settings appear in the **Selected customizations** pane.\n\n## <span id=\"Step_5__Customize_the_Start_layout\"></span><span id=\"step_5__customize_the_start_layout\"></span><span id=\"STEP_5__CUSTOMIZE_THE_START_LAYOUT\"></span>Step 5: Customize the Start layout\n\n\nIn Windows 10, OEMs can modify the default Start layout and specify the layout of the OEM tiles by creating a **LayoutModification.xml** file and placing this file in the correct system location.\n\n1.  Create a layoutmodification.xml file. For this lab, you can use the sample on the USB. The sample will pin Office, OneNote and Reader 8.1 to Start if they have been preloaded on the device (Step 2). To create your own layoutmodification.xml file by using an XML editor, see the [Sample scripts](windows-deployment-sample-scripts-sxs.md).\n2.  In Windows ICD, in the **Available customizations** pane, expand **Runtime settings**, click **Start**, and then click **StartLayout**.\n3.  In the middle pane, click **Browse.**\n4.  Navigate to the location where you saved the LayoutModification.xml file.\n5.  Select the file, and then click **Open**. This should set the value of StartLayout.\n\n    The setting appears in the Selected customizations pane.\n\n    **Note**  You cannot add .url and .lnk files directly in Windows ICD. If you have these files, follow Step 2 in lab 2 in the section ”Add the files you need to modify the Start layout”.\n\n     \n\n## <span id=\"addLang\"></span><span id=\"addlang\"></span><span id=\"ADDLANG\"></span>Step 6: Add a language\n\n\nWindows ICD provides a basic method of adding languages.\n\n1.  In Windows ICD, in the **Available customizations** pane, expand **Deployment assets**, and then click **Language packages**.\n2.  In the middle pane, next to **Cab file**, click **Browse**. Browse to the language pack file, for example: **C:\\\\Samples\\\\Languages\\\\fr-fr x64-client**, click **lp.cab**, and then click **Open.**\n3.  In the **Name** box, type **French user interface**, and then click **Add**.\n\n    The language pack should appear in the **Selected customizations** pane.\n\nThis method also does not update the language resources for Windows applications. Including the Windows inbox apps. While some Windows apps will be updated automatically through Windows Update, others may need to be reinstalled later.\n\nTo update the resources for Windows RE and for apps, modify the Windows install.wim image, using the instructions from [Lab 2: Classic-style deployment](part-2--classic-style-deployment.md). You can skip steps 4 and 5 (adding windows drivers and modifying the Start layout), and you can skip optional steps 11 and 12 (upgrading the Windows edition and setting the image to boot to audit mode).\n\n## <span id=\"addLangComp\"></span><span id=\"addlangcomp\"></span><span id=\"ADDLANGCOMP\"></span>Step 7: Add features on demand\n\n\nFeatures on demand (FODs) are Windows feature packages that can be added at any time. When a user needs a new feature, they can request the feature package from Windows Update. OEMs can preinstall these features to enable them on their devices out of the box.\n\nCommon features include language resources like handwriting recognition. Some of these features are required to enable full Cortana functionality. The following table shows the types of language components available for Windows and which ones apply to Cortana.\n\nIn addition, to enable Cortana or for pen support, features need to be added in a specific order. For example, to enable Cortana, install these features in this order: **lp.cab**, then **Basic**, then **TextToSpeech**, then **Speech**. To enable pen support, install these features in this order: **lp.cab**, then **Basic**, then **Handwriting**.\n\n<table>\n<colgroup>\n<col width=\"25%\" />\n<col width=\"25%\" />\n<col width=\"25%\" />\n<col width=\"25%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Component</th>\n<th align=\"left\">Sample file name</th>\n<th align=\"left\">Dependencies</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\">Language pack</td>\n<td align=\"left\"><code>lp.cab</code></td>\n<td align=\"left\">None</td>\n<td align=\"left\">UI text, including basic Cortana capabilities.</td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\">Language interface pack</td>\n<td align=\"left\"><code>lp.cab</code></td>\n<td align=\"left\">Requires a specific fully-localized or partially-localized language pack. Example: ca-ES requires es-ES. To learn more, see [Available Language Packs for Windows](available-language-packs-for-windows.md).</td>\n<td align=\"left\"><p>UI text, including basic Cortana capabilities.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\">Basic</td>\n<td align=\"left\"><code>Microsoft-Windows-LanguageFeatures-Basic-fr-fr-Package</code></td>\n<td align=\"left\">None</td>\n<td align=\"left\"><p>Spell checking, text prediction, word breaking, and hyphenation if available for the language.</p>\n<p>You must add this component before adding any of the following components.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\">Fonts</td>\n<td align=\"left\"><code>Microsoft-Windows-LanguageFeatures-Fonts-Thai-Package</code></td>\n<td align=\"left\">None</td>\n<td align=\"left\"><p>Fonts.</p>\n<p>Required for some regions to render text that appears in documents. Example, th-TH requires the Thai font pack. To learn more, see [Features On Demand V2 (Capabilities)](features-on-demand-v2--capabilities.md).</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\">Optical character recognition</td>\n<td align=\"left\"><code>Microsoft-Windows-LanguageFeatures-OCR-fr-fr-Package</code></td>\n<td align=\"left\">Basic</td>\n<td align=\"left\">Recognizes and outputs text in an image.</td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\">Handwriting recognition</td>\n<td align=\"left\"><code>Microsoft-Windows-LanguageFeatures-Handwriting-fr-fr-Package</code></td>\n<td align=\"left\">Basic</td>\n<td align=\"left\">Enables handwriting recognition for devices with pen input.</td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\">Text-to-speech</td>\n<td align=\"left\"><code>Microsoft-Windows-LanguageFeatures-TextToSpeech-fr-fr-Package</code></td>\n<td align=\"left\">Basic</td>\n<td align=\"left\">Enables text to speech, used by Cortana and Narrator.</td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\">Speech recognition</td>\n<td align=\"left\"><code>Microsoft-Windows-LanguageFeatures-Speech-fr-fr-Package</code></td>\n<td align=\"left\">Basic, Text-To-Speech recognition</td>\n<td align=\"left\">Recognizes voice input, used by Cortana and Windows Speech Recognition.</td>\n</tr>\n</tbody>\n</table>\n\n \n\n1.  In Windows ICD, in the **Available customizations** pane, expand **Deployment assets**, and then click **Features on demand**.\n2.  In the middle pane, next to **Features package path**, click **Browse**. Browse to the FOD file, for example: **C:\\\\Samples\\\\Languages\\\\fr-fr x64-client**, click **Microsoft-Windows-LanguageFeatures-Basic-fr-fr-Package.cab**, and then click **Open.**\n3.  In the **Name** box, type **French basic language component**, and then click **Add**.\n\n    The language component should appear in the **Configured customizations** pane.\n\n4.  In the middle pane, next to **Cab File**, click **Browse**. Browse to the FOD file, for example: **C:\\\\Samples\\\\Languages\\\\fr-fr x64-client**, click **Microsoft-Windows-LanguageFeatures-Speech-fr-fr-Package.cab**, and then click **Open.**\n5.  In the **Name** box, type **French speech language component**, and then click **Add**.\n\n    The language components should appear in the **Selected customizations** pane.\n\n6.  Repeat the steps to add the **Text-to-Speech** and **Speech** components. The language components should appear in the **Selected customizations** pane.\n7.  For languages that require fonts, such as Chinese (Simplified), add the font pack. To learn which languages require fonts, see [Features On Demand V2 (Capabilities)](features-on-demand-v2--capabilities.md).\n\n    In the middle pane, next to **Cab File**, click **Browse**. Browse to the FOD file, for example: **C:\\\\Samples\\\\Languages\\\\zh-cn x64-client**, click **Microsoft-Windows-LanguageFeatures-Fonts-Hans-Package.cab**, and then click **Open**.\n\n    In the **Name** box, type **Chinese (simplified) font language component**, and then click **Add**.\n\n    The language components should appear in the **Configured customizations** pane.\n\n**Note**  \n-   You can’t update the language in the Windows Recovery Environment from Windows ICD. By default, if there's a problem, the device will show recovery screens in English only.\n-   You run Dism.exe (or a script) to remove English after you add another language. For an example, see [Lab 2: Classic-style deployment](part-2--classic-style-deployment.md), step 7.\n-   After adding a language, you'll need to re-add the Universal apps (APPX). This process needs to be performed during Audit mode. For more information on how to remove and re-add these applications, please refer to [Lab 2: Classic-style deployment](part-2--classic-style-deployment.md), step 8. In Windows 10 builds after **August 18, 2015**, you can now add new Universal apps (APPX) on top of the existing ones. It is no longer necessary to remove the prior versions before re-adding them.\n\n \n\n## <span id=\"buildUSBKey\"></span><span id=\"buildusbkey\"></span><span id=\"BUILDUSBKEY\"></span>Step 8: Save the image\n\n\nWindows ICD can store the entire image into a single .FFU file. The FFU format was developed for [faster, safer deployment](wim-vs-ffu-image-file-formats.md) by using sector-based imaging and security headers.\n\n1.  Click **Create** &gt; **Production media**.\n2.  Select **FFU** &gt; **Next**.\n3.  For hardware designs 1 and 1b, select **Yes** under **Enable Compact OS**, and then click **Next**.\n4.  On the **Configure Audit Mode Boot**, leave all options by default, and then click **Next**.\n5.  In **Choose where the FFU file is saved**, give the file a name, such as C:\\\\Images\\\\MyFFUImage.ffu, and then click **Next**.\n    **Note**  We recommend choosing a location on a hard drive rather than a USB key, as it can make the FFU creation process faster.\n\n     \n\n6.  Review the settings and ensure they are correct. Click **Build**. Windows ICD creates the FFU file using the name and path indicated in the previous step. This will take a few minutes. Click **Finish**.\n\n    **Troubleshooting: If the project fails to build:**\n\n    1.  Check to make sure there's no leading or trailing spaces in the project name. If there is, recreate the project.\n    2.  **The requested operation couldn't be completed due to a file size limitation**: Check to see that the drive is formatted using the NTFS file format and has at least 5GB free.\n    3.  If at any time you end up repeating this walkthrough, if you want to use the same project, delete the existing project folder from **Documents\\\\Windows Imaging and Configuration Designer (WICD)** before starting again.\n\n7.  Copy the FFU file to a removable storage device, like a separate USB key or an external USB drive. You may need to reformat the drive using the NTFS format so that it can accept very large files - depending on how many languages, drivers, and apps you add, the .FFU file can easily be 5GB or larger. You probably won't be able to use the Windows PE key for this - it's formatted using FAT32, which only accepts files that are 4GB or smaller.\n\n## <span id=\"bootReferencePC\"></span><span id=\"bootreferencepc\"></span><span id=\"BOOTREFERENCEPC\"></span>Step 9: Install Windows on the reference device\n\n\n1.  Insert the **WinPE** USB drive into your reference device.\n2.  Boot up the reference device to the boot device selection menu. You usually do this by powering on the device and quickly pressing a specific key or button (for example, the **Esc** key or the **Volume down** button), and selecting the USB key.\n3.  Insert the **FFU** USB drive into your reference device. Determine which driver letter is assigned to this drive by doing the following:\n\n    1.  From the WinPE command prompt, type: **diskpart** and press Enter.\n    2.  At the diskpart prompt, type**list volume** and press Enter.\n\n    This lists all of the volumes present in the system. Determine the driver letter that corresponds to the FFU USB key, for example, G.\n\n4.  From the WinPE command prompt, type the following:\n\n    ``` syntax\n    Dism.exe /apply-image /imagefile=G:\\MyFFUImage.ffu /applydrive=\\\\.\\physicaldrive0 /skipplatformcheck /logpath:G:\\dism.applyffu.log\n    ```\n\n    Where G:\\\\MyFFUImage.ffu is the file location of the FFU file.\n\n**Repeat Step 9: Use your new Windows installation key to set up more devices**. At the **Get going fast** screen, turn off the device by pressing and holding the power button. Do not complete the OOBE for your customer.\n\nThere's a known bug where if your PC is set to automatically boot to a USB key, it will get caught in a loop during the install process: after Windows installs, it reinstalls again and again. To avoid this loop:\n\n**Workaround: Prepare the reference device**\n\n1.  On your reference device, open the device's boot menus. You usually do this by powering on the device and quickly pressing a specific key or button (for example, the **Esc** key or the **Volume up** button).\n2.  Find the boot order menu (this menu has different names and locations) and make sure that the **hard drive** is set up to be first in the boot sequence, not the USB drive.\n3.  If your device doesn't appear to have a way to change the boot order on during the boot sequence, the option may be disabled. Look for a option like \"Enable Boot Options on Startup\" or \"F12 Boot Menu\", and enable the menu.\n\n## <span id=\"Troubleshooting\"></span><span id=\"troubleshooting\"></span><span id=\"TROUBLESHOOTING\"></span>Troubleshooting\n\n\nIf Windows doesn't install on the reference device, try each of these steps:\n\n-   **USB key doesn't appear in the boot menus**: Try using different USB ports on the computer. Avoid using USB hubs or cables.\n\n    Restart the PC and open the device's boot menus. Look for an option to enable a boot device selection menu on startup (example: \"F12 Boot menu\"). If you find one, enable it!\n\n-   **UEFI or BIOS**: If your boot menus give you a choice between booting in UEFI mode or BIOS mode, choose UEFI mode.\n-   If the device boots up to the **Drive Selection** menu, select the primary hard drive, this is usually the **C** drive. If you're not sure which drive is which, press **Shift-F10** to open the Command Prompt. Type **diskpart** and press Enter. At the Diskpart prompt, type **list volume** to show the partitions. Type **exit**. Press **Alt-Tab** to try again.\n-   If the device gets through 6% of the installation and then fails, you may need to prepare the drive:\n\n    1.  Plug the USB key.\n    2.  Select **Troubleshoot &gt; Advanced Options &gt; Command Prompt**.\n    3.  Type **diskpart** and press Enter. At the Diskpart prompt, type **list volume** to list the drives. Type **exit** to leave the Diskpart prompt.\n    4.  Type **diskpart /s D:\\\\Samples\\\\CreatePartitions-UEFI.txt**\n\n        where D is the drive letter of the USB key.\n\n        For BIOS-based PCs, use CreatePartitions-BIOS.txt instead.\n\n    5.  Type **exit** to leave the Command prompt.\n    6.  Select **Turn off your PC**.\n    7.  Turn on the device and open the boot device selection. If you have a choice between booting in BIOS or UEFI mode, select UEFI mode. Windows ICD should install correctly.\n\n-   If the device boots up to the **Choose an option: Troubleshoot / Turn off your PC** menu, you may be seeing a known bug with USB 3.0 and Windows ICD images. Try again using a **USB 2.0** key or port.\n-   Make sure your device and the Windows image match. If they don't match, try creating the image again using the correct architecture.\n\n## <span id=\"verify\"></span><span id=\"VERIFY\"></span>Test the customizations\n\n\nDo these steps to test an image. Note, this requires completing the First User Experience and creating a user account. After performing these steps, you'd typically need to reinstall Windows onto the device before sending it to a customer.\n\n1.  Make sure the device is not plugged into the network, and turn it on.\n2.  After the device boots, if the **Languages** screen appears and shows the French language, then the language pack has been added correctly. Choose the language you're most familiar with, choose your keyboard, and then click **Next**.\n3.  Complete the Out of Box Experience (OOBE): these steps may vary based on language.\n4.  On the **Hi there** screen, click **Accept**.\n5.  If it asks you for a product key, click **Do this later**. If you're plugged into a network connection, you may be asked to provide a product key. To avoid using a product key, disconnect the device and try again.\n6.  Click **Accept** , click **Skip this step**, and then click **Use express settings**.\n7.  On the **Who owns this PC?** page, click **I do**, and then click **Next**.\n8.  On the **Make it yours** page, click **Skip this step**.\n9.  Add a user name (example: \"Terry\"), and then click **Next**.\n10. The device finalizes setup and reboots to the desktop.\n11. When the desktop appears, in **Settings** under **System &gt; About**, you should see the technical support info that you entered earlier appear (company name, support phone number, and support website).\n\n \n\n \n\n\n\n\n\n"}