{"nodes":[{"content":"Kernel Trace Control API Reference","pos":[11,45]},{"content":"Kernel Trace Control API Reference","pos":[59,93]},{"content":"Kernel Trace Control API Reference","pos":[282,316]},{"content":"This API enables capturing kernel stack traces, merging multiple trace files for analysis, heap tracing, and including system information in the merged files.","pos":[319,477]},{"content":"The Kernel Trace Control API became available in Windows Vista.","pos":[479,542]},{"content":"On Windows 7 and Windows Vista, stackwalking on x64 systems requires that you set the <bpt id=\"p1\">**</bpt>DisablePagingExecutive<ept id=\"p1\">**</ept> registry value in <bpt id=\"p2\">**</bpt>HKLM<ph id=\"ph1\">\\\\</ph>SYSTEM<ph id=\"ph2\">\\\\</ph>CurrentControlSet<ph id=\"ph3\">\\\\</ph>Control<ph id=\"ph4\">\\\\</ph>Session Manager<ph id=\"ph5\">\\\\</ph>Memory Management<ept id=\"p2\">**</ept>.","pos":[544,756]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>DisablePagingExecutive<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=213095)</ept>.","pos":[757,857]},{"pos":[859,936],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Systems with Windows 8 and higher do not need this registry change."},{"content":"The following example shows how to query for this registry value.","pos":[941,1006]},{"content":"The following example shows how to enable stackwalking.","pos":[1135,1190]},{"content":"Note","pos":[1495,1499]},{"content":"To make these changes effective, you must restart the system.","pos":[1504,1565]},{"content":"The following example shows how to disable stackwalking.","pos":[1570,1626]},{"content":"Note","pos":[1931,1935]},{"content":"To make these changes effective, you must restart the system.","pos":[1940,2001]},{"content":"In This Section","pos":[2009,2024]},{"content":"Functions","pos":[2028,2037]},{"content":"Structures","pos":[2059,2069]},{"content":"Trace Control Flags","pos":[2092,2111]},{"content":"Trace Control Event Types","pos":[2139,2164]},{"content":"Custom Injection of System Information","pos":[2198,2236]},{"content":"Related topics","pos":[2285,2299]},{"content":"Windows Performance Toolkit Technical Reference","pos":[2303,2350]}],"content":"---\ntitle: Kernel Trace Control API Reference\ndescription: Kernel Trace Control API Reference\nMSHAttr:\n- 'PreferredSiteName:MSDN'\n- 'PreferredLib:/library/windows/hardware'\nms.assetid: 16ecacd5-25aa-43d7-b842-cb8f92db8eeb\nms.prod: W10\nms.mktglfcycl: operate\nms.sitesec: msdn\n---\n\n# Kernel Trace Control API Reference\n\n\nThis API enables capturing kernel stack traces, merging multiple trace files for analysis, heap tracing, and including system information in the merged files.\n\nThe Kernel Trace Control API became available in Windows Vista.\n\nOn Windows 7 and Windows Vista, stackwalking on x64 systems requires that you set the **DisablePagingExecutive** registry value in **HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Memory Management**. For more information, see [DisablePagingExecutive](http://go.microsoft.com/fwlink/p/?linkid=213095).\n\n**Note**  Systems with Windows 8 and higher do not need this registry change.\n\n \n\nThe following example shows how to query for this registry value.\n\n``` syntax\n@REG QUERY \"HKLM\\System\\CurrentControlSet\\Control\\Session Manager\\Memory Management\" -v DisablePagingExecutive\n```\n\nThe following example shows how to enable stackwalking.\n\n``` syntax\n@REG ADD \"HKLM\\System\\CurrentControlSet\\Control\\Session Manager\\Memory Management\" -v DisablePagingExecutive -d 0x1 -t REG_DWORD -f\n@IF NOT %ERRORLEVEL% == 0 echo error: Could not configure system for 64-bit stackwalking. Please run this script from an elevated administrator console.\n```\n\n**Note**  \nTo make these changes effective, you must restart the system.\n\n \n\nThe following example shows how to disable stackwalking.\n\n``` syntax\n@REG ADD \"HKLM\\System\\CurrentControlSet\\Control\\Session Manager\\Memory Management\" -v DisablePagingExecutive -d 0x0 -t REG_DWORD -f\n@IF NOT %ERRORLEVEL% == 0 echo error: Could not remove 64-bit stackwalking configuration. Please run this script from an elevated administrator console.\n```\n\n**Note**  \nTo make these changes effective, you must restart the system.\n\n \n\n## In This Section\n\n\n[Functions](functions-wpa.md)\n\n[Structures](structures-wpa.md)\n\n[Trace Control Flags](trace-control-flags.md)\n\n[Trace Control Event Types](trace-control-event-types.md)\n\n[Custom Injection of System Information](custom-injection-of-system-information.md)\n\n## Related topics\n\n\n[Windows Performance Toolkit Technical Reference](windows-performance-toolkit-technical-reference.md)\n\n \n\n \n\n\n\n\n\n\n\n"}