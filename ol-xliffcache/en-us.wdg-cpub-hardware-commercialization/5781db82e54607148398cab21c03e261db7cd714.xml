{"nodes":[{"content":"Deploy and test a user-mode test application in MMOS","pos":[35,87]},{"content":"Deploy and test a user-mode test application in MMOS","pos":[196,248]},{"content":"Deploy and test a user-mode test application in MMOS","pos":[257,309]},{"content":"To copy files to an MMOS image and run programs, you can use FTP and Telnet over a Virtual Ethernet connection.","pos":[312,423]},{"content":"Important","pos":[427,436]},{"content":"The USB drivers and protocols described here must not be used in manufacturing or retail servicing.","pos":[441,540]},{"content":"They are provided as a convenience for engineering bring-up.","pos":[541,601]},{"pos":[726,746],"content":"Preparing the device"},{"content":"Engineering builds of the OS typically include Ping, FTP, and Telnet servers.","pos":[749,826]},{"content":"To confirm that these are active in the OS, examine the startup configuration or establish a debug connection to MMOS to view the files that are loaded.","pos":[827,979]},{"content":"To configure a device to support TCP/IP over USB, you must install the necessary tools and use the BCDEdit tool to modify the device’s boot options that are stored in the BCD file.","pos":[981,1161]},{"pos":[1430,1499],"content":"Running Virtual Ethernet and determining the IP address of the device"},{"content":"Virtual Ethernet creates a connection between the device's USB connection and the TCP/IP transport on the PC.","pos":[1502,1611]},{"content":"connecting the device or powering it on, start Virtual Ethernet on the PC.","pos":[1612,1686]},{"content":"VirtEth.exe is located in the “%ProgramFiles(x86)%<ph id=\"ph1\">\\\\</ph>Microsoft Windows Phone 8 KDBG Connectivity<ph id=\"ph2\">\\\\</ph>bin” folder.","pos":[1687,1796]},{"content":"A Virtual Ethernet console window will open.","pos":[1798,1842]},{"content":"Leave this window open to maintain the connection to the phone; closing the window closes the connection.","pos":[1843,1948]},{"content":"With Virtual Ethernet running, connect and power on the phone.","pos":[1954,2016]},{"content":"When the device is connected, you will see lines of output that include the MAC address of the device.","pos":[2017,2119]},{"content":"Virtual Ethernet reports the device’s MAC address in output similar to the following:","pos":[2120,2205]},{"content":"Note the 12-digit device MAC address from the VirtEth console window and use it in the next step to determine the device's TCP/IP address.","pos":[2275,2413]},{"content":"Open a new command-prompt window and type <bpt id=\"p1\">**</bpt>arp -a<ept id=\"p1\">**</ept>.","pos":[2419,2472]},{"content":"Output similar to the following will be displayed.","pos":[2473,2523]},{"content":"Use the IP address that is associated with the device MAC address to connect to the device via FTP and Telnet.","pos":[2839,2949]},{"pos":[3101,3131],"content":"Establishing an FTP connection"},{"content":"To browse and copy files via FTP:","pos":[3134,3167]},{"pos":[3173,3301],"content":"Open Windows Explorer and type: <bpt id=\"p1\">**</bpt>FTP:<ph id=\"ph1\">\\\\\\\\</ph><ept id=\"p1\">**</ept><bpt id=\"p2\">*</bpt>W.X.Y.Z<ept id=\"p2\">*</ept> in the address bar, replacing <bpt id=\"p3\">*</bpt>W.X.Y.Z<ept id=\"p3\">*</ept> with the IP address of the device."},{"content":"You should see the files on the device listed.","pos":[3303,3349]},{"content":"Use Windows Explorer to copy files to or from the device, such as executable test programs or logs of test results.","pos":[3350,3465]},{"pos":[3467,3599],"content":"To close the FTP connection, unmount the phone file system by selecting <bpt id=\"p1\">**</bpt>Safely Remove Hardware<ept id=\"p1\">**</ept> in the Windows notification area."},{"pos":[3748,3777],"content":"Establishing a Telnet session"},{"content":"Make sure Telnet is enabled on the PC.","pos":[3780,3818]},{"content":"To enable Telnet in the Windows operating system, select <bpt id=\"p1\">**</bpt>Control Panel<ept id=\"p1\">**</ept> <ph id=\"ph1\">&amp;gt;</ph> <bpt id=\"p2\">**</bpt>Programs and Features<ept id=\"p2\">**</ept> <ph id=\"ph2\">&amp;gt;</ph> <bpt id=\"p3\">**</bpt>Turn Windows features on or off<ept id=\"p3\">**</ept>.","pos":[3819,3966]},{"content":"In the Windows Features list, select <bpt id=\"p1\">**</bpt>Telnet Client<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[3967,4045]},{"content":"To establish a Telnet session with the device:","pos":[4047,4093]},{"pos":[4099,4213],"content":"Open a command-prompt window and type: <bpt id=\"p1\">**</bpt>telnet<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>W.X.Y.Z<ept id=\"p2\">*</ept>, replacing <bpt id=\"p3\">*</bpt>W.X.Y.Z<ept id=\"p3\">*</ept> with the IP address of the device"},{"content":"The command prompt window that appears is cmd.exe running on the device.","pos":[4215,4287]},{"content":"From that command prompt, you can run commands on the device, such as executing test applications that you included in the MMOS image.","pos":[4288,4422]},{"pos":[4625,4672],"content":"Troubleshooting: Confirming TCP/IP connectivity"},{"pos":[4675,4742],"content":"You can use <bpt id=\"p1\">**</bpt>ping<ept id=\"p1\">**</ept> to test the TCP/IP connection with the device:"},{"pos":[4748,4859],"content":"Open a command-prompt window and type: <bpt id=\"p1\">**</bpt>ping<ept id=\"p1\">**</ept><bpt id=\"p2\">*</bpt>W.X.Y.Z<ept id=\"p2\">*</ept>, replacing <bpt id=\"p3\">*</bpt>W.X.Y.Z<ept id=\"p3\">*</ept> with the IP address of the device"},{"content":"The command should indicate that the packets were returned.","pos":[4861,4920]},{"content":"If this does not work, one common issue to investigate is the firewall configuration on the PC.","pos":[4921,5016]},{"pos":[5129,5146],"content":"Debugging in MMOS"},{"content":"To enable debugger support in MMOS, both communication and OS settings must be modified.","pos":[5149,5237]},{"pos":[5366,5388],"content":"Enabling debug support"},{"content":"To enable debugging support in MMOS, specify the following internal optional feature in the MfgOEMInput.xml file.","pos":[5390,5503]},{"content":"This adds the required packages to the MMOS image.","pos":[5592,5642]},{"content":"For more info about working with the MfgOEMInput.xml file, see <bpt id=\"p1\">[</bpt>MMOS image definition<ept id=\"p1\">](mmos-image-definition.md)</ept>.","pos":[5643,5756]},{"pos":[5912,5943],"content":"Enabling communication settings"},{"content":"To enable the OS, communication settings must be changed after the image is flashed.","pos":[5945,6029]},{"pos":[6191,6224],"content":"Establishing the debug connection"},{"content":"To connect to MMOS for debugging, use WinDbg to specify the key and port that you configured earlier by using BCDEdit.","pos":[6226,6344]}],"content":"---\nauthor: kpacquer\nDescription: 'Deploy and test a user-mode test application in MMOS'\nms.assetid: f8a7c14f-66b6-4023-86cb-c10bc3f52734\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: 'Deploy and test a user-mode test application in MMOS'\n---\n\n# Deploy and test a user-mode test application in MMOS\n\n\nTo copy files to an MMOS image and run programs, you can use FTP and Telnet over a Virtual Ethernet connection.\n\n**Important**  \nThe USB drivers and protocols described here must not be used in manufacturing or retail servicing. They are provided as a convenience for engineering bring-up.\n\n \n\n## <span id=\"Preparing_the_device\"></span><span id=\"preparing_the_device\"></span><span id=\"PREPARING_THE_DEVICE\"></span>Preparing the device\n\n\nEngineering builds of the OS typically include Ping, FTP, and Telnet servers. To confirm that these are active in the OS, examine the startup configuration or establish a debug connection to MMOS to view the files that are loaded.\n\nTo configure a device to support TCP/IP over USB, you must install the necessary tools and use the BCDEdit tool to modify the device’s boot options that are stored in the BCD file.\n\n## <span id=\"Running_Virtual_Ethernet_and_determining_the_IP_address_of_the_device\"></span><span id=\"running_virtual_ethernet_and_determining_the_ip_address_of_the_device\"></span><span id=\"RUNNING_VIRTUAL_ETHERNET_AND_DETERMINING_THE_IP_ADDRESS_OF_THE_DEVICE\"></span>Running Virtual Ethernet and determining the IP address of the device\n\n\nVirtual Ethernet creates a connection between the device's USB connection and the TCP/IP transport on the PC. connecting the device or powering it on, start Virtual Ethernet on the PC. VirtEth.exe is located in the “%ProgramFiles(x86)%\\\\Microsoft Windows Phone 8 KDBG Connectivity\\\\bin” folder.\n\nA Virtual Ethernet console window will open. Leave this window open to maintain the connection to the phone; closing the window closes the connection.\n\n1.  With Virtual Ethernet running, connect and power on the phone. When the device is connected, you will see lines of output that include the MAC address of the device. Virtual Ethernet reports the device’s MAC address in output similar to the following:\n\n    ``` syntax\n    NIC UP: 00-11-38-EA-88-7E : SUCCESS\n    ```\n\n    Note the 12-digit device MAC address from the VirtEth console window and use it in the next step to determine the device's TCP/IP address.\n\n2.  Open a new command-prompt window and type **arp -a**. Output similar to the following will be displayed.\n\n    ``` syntax\n    C:\\>arp -a\n\n    Interface: 10.178.1.40 --- 0xb\n      Internet Address      Physical Address      Type\n      10.178.0.1            cc-ef-48-a7-6f-3f     dynamic\n      10.178.1.94           00-11-38-ea-88-7e     dynamic\n      10.178.3.255          ff-ff-ff-ff-ff-ff     static\n      ... \n    ```\n\nUse the IP address that is associated with the device MAC address to connect to the device via FTP and Telnet.\n\n## <span id=\"Establishing_an_FTP_connection\"></span><span id=\"establishing_an_ftp_connection\"></span><span id=\"ESTABLISHING_AN_FTP_CONNECTION\"></span>Establishing an FTP connection\n\n\nTo browse and copy files via FTP:\n\n-   Open Windows Explorer and type: **FTP:\\\\\\\\***W.X.Y.Z* in the address bar, replacing *W.X.Y.Z* with the IP address of the device.\n\nYou should see the files on the device listed. Use Windows Explorer to copy files to or from the device, such as executable test programs or logs of test results.\n\nTo close the FTP connection, unmount the phone file system by selecting **Safely Remove Hardware** in the Windows notification area.\n\n## <span id=\"Establishing_a_Telnet_session\"></span><span id=\"establishing_a_telnet_session\"></span><span id=\"ESTABLISHING_A_TELNET_SESSION\"></span>Establishing a Telnet session\n\n\nMake sure Telnet is enabled on the PC. To enable Telnet in the Windows operating system, select **Control Panel** &gt; **Programs and Features** &gt; **Turn Windows features on or off**. In the Windows Features list, select **Telnet Client**, and then click **OK**.\n\nTo establish a Telnet session with the device:\n\n-   Open a command-prompt window and type: **telnet** *W.X.Y.Z*, replacing *W.X.Y.Z* with the IP address of the device\n\nThe command prompt window that appears is cmd.exe running on the device. From that command prompt, you can run commands on the device, such as executing test applications that you included in the MMOS image.\n\n## <span id=\"Troubleshooting__Confirming_TCP_IP_connectivity\"></span><span id=\"troubleshooting__confirming_tcp_ip_connectivity\"></span><span id=\"TROUBLESHOOTING__CONFIRMING_TCP_IP_CONNECTIVITY\"></span>Troubleshooting: Confirming TCP/IP connectivity\n\n\nYou can use **ping** to test the TCP/IP connection with the device:\n\n-   Open a command-prompt window and type: **ping***W.X.Y.Z*, replacing *W.X.Y.Z* with the IP address of the device\n\nThe command should indicate that the packets were returned. If this does not work, one common issue to investigate is the firewall configuration on the PC.\n\n## <span id=\"Debugging_in_MMOS\"></span><span id=\"debugging_in_mmos\"></span><span id=\"DEBUGGING_IN_MMOS\"></span>Debugging in MMOS\n\n\nTo enable debugger support in MMOS, both communication and OS settings must be modified.\n\n### <span id=\"Enabling_debug_support\"></span><span id=\"enabling_debug_support\"></span><span id=\"ENABLING_DEBUG_SUPPORT\"></span>Enabling debug support\n\nTo enable debugging support in MMOS, specify the following internal optional feature in the MfgOEMInput.xml file.\n\n``` syntax\n<Microsoft>\n  ...\n  <Feature>KDNETUSB_ON</Feature>\n   ...\n</Microsoft>\n```\n\nThis adds the required packages to the MMOS image. For more info about working with the MfgOEMInput.xml file, see [MMOS image definition](mmos-image-definition.md).\n\n### <span id=\"Enabling_communication_settings\"></span><span id=\"enabling_communication_settings\"></span><span id=\"ENABLING_COMMUNICATION_SETTINGS\"></span>Enabling communication settings\n\nTo enable the OS, communication settings must be changed after the image is flashed.\n\n### <span id=\"Establishing_the_debug_connection\"></span><span id=\"establishing_the_debug_connection\"></span><span id=\"ESTABLISHING_THE_DEBUG_CONNECTION\"></span>Establishing the debug connection\n\nTo connect to MMOS for debugging, use WinDbg to specify the key and port that you configured earlier by using BCDEdit.\n\n``` syntax\nwindbg.exe -k net:Port=50000,Key=1.2.3.4\n```\n\n \n\n \n\n\n\n\n\n"}