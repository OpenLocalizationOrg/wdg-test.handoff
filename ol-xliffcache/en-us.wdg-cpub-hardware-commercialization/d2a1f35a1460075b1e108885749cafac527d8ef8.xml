{"nodes":[{"content":"Add or Remove Packages Offline Using DISM","pos":[34,75]},{"content":"Add or Remove Packages Offline Using DISM","pos":[182,223]},{"content":"Add or Remove Packages Offline Using DISM","pos":[231,272]},{"content":"Deployment Image Servicing and Management (DISM.exe) is a command-line tool that is used to update offline Windows® images.","pos":[275,398]},{"content":"There are two ways to install or remove packages offline with DISM.","pos":[399,466]},{"content":"You can either apply an unattend answer file to the offline image, or you can add or remove the package directly from the command prompt.","pos":[467,604]},{"content":"If you are installing multiple packages to a Windows image, and there are dependency requirements, the best way to ensure the correct order of the installation is by using an answer file.","pos":[606,793]},{"content":"You can use DISM to apply the Unattend.xml answer file to the image.","pos":[794,862]},{"content":"When you use DISM to apply an answer file, the unattend settings in the <bpt id=\"p1\">**</bpt>offlineServicing<ept id=\"p1\">**</ept> configuration pass are applied to the Windows image.","pos":[863,1008]},{"content":"You must install the latest version of the Windows Assessment and Deployment Kit (Windows ADK), which contains all of the tools that are required, including DISM.","pos":[1010,1172]},{"content":"To add packages to an offline image by using DISM","pos":[1177,1226]},{"content":"At an elevated command prompt, locate the Windows ADK servicing folder, and type the following command to retrieve the name or index number for the image that you want to modify.","pos":[1232,1410]},{"content":"An index or name value is required for most operations that specify an image file.","pos":[1502,1584]},{"content":"Type the following command to mount the offline Windows image.","pos":[1590,1652]},{"content":"At a command prompt, type the following command to add a specific package to the image.","pos":[1796,1883]},{"content":"You can add multiple packages on one command line.","pos":[1884,1934]},{"content":"They will be installed in the order listed in the command line.","pos":[1935,1998]},{"content":"At a command prompt, type the following command to commit the changes and unmount the image.","pos":[2149,2241]},{"content":"To remove packages from an offline image by using DISM","pos":[2328,2382]},{"content":"At an elevated command prompt, locate the Windows ADK servicing folder, and type the following command to retrieve the name or index number for the image that you want to modify.","pos":[2388,2566]},{"content":"An index or name value is required for most operations that specify an image file.","pos":[2658,2740]},{"content":"Type the following command to mount the offline Windows image.","pos":[2746,2808]},{"content":"Optional: Type the following command to list the packages in the image.","pos":[2952,3023]},{"pos":[3099,3209],"content":"You can use <ph id=\"ph1\">`&gt;featurelist.txt`</ph> to redirect the output of the command to a text file that is named FeatureList."},{"content":"Review the list of packages that are available in your mounted image and note the package identity of the package.","pos":[3215,3329]},{"content":"At a command prompt, specify the package identity to remove it from the image.","pos":[3335,3413]},{"content":"You can remove multiple packages on one command line.","pos":[3414,3467]},{"content":"You can use the <bpt id=\"p1\">**</bpt>/PackagePath<ept id=\"p1\">**</ept> option to point to the original source of the package, or to specify the path to the .cab file, or you can use the <bpt id=\"p2\">**</bpt>/PackageName<ept id=\"p2\">**</ept> option to specify the package by name as it is listed in the image.","pos":[3701,3933]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>DISM Operating System Package Servicing Command-Line Options<ept id=\"p1\">](dism-operating-system-package-servicing-command-line-options.md)</ept>.","pos":[3934,4088]},{"content":"At a command prompt, type the following command to commit the changes and unmount the image.","pos":[4094,4186]},{"content":"To add or remove packages offline by using DISM and an answer file","pos":[4273,4339]},{"content":"Open Windows SIM.","pos":[4345,4362]},{"content":"To add a new package, click <bpt id=\"p1\">**</bpt>Insert<ept id=\"p1\">**</ept> on the main menu, and select <bpt id=\"p2\">**</bpt>Package(s)<ept id=\"p2\">**</ept>.","pos":[4368,4451]},{"content":"Browse to the package you want to add, and then click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>.","pos":[4452,4515]},{"content":"To remove an existing package, select the package in the <bpt id=\"p1\">**</bpt>Answer file<ept id=\"p1\">**</ept> pane that you want to remove.","pos":[4521,4623]},{"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> pane, change the <bpt id=\"p2\">**</bpt>Action<ept id=\"p2\">**</ept> property to <bpt id=\"p3\">**</bpt>Remove<ept id=\"p3\">**</ept>.","pos":[4624,4697]},{"pos":[4703,4792],"content":"**Note**  \nThe packages must be added to the **offlineServicing** configuration pass.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"The packages must be added to the <bpt id=\"p1\">**</bpt>offlineServicing<ept id=\"p1\">**</ept> configuration pass.","pos":[11,85]}]},{"content":"Validate and save the answer file.","pos":[4798,4832]},{"content":"At an elevated command prompt, locate the Windows ADK servicing folder, and then type the following command to retrieve the name or index number for the image that you want to mount.","pos":[4838,5020]},{"content":"Type the following command to mount the offline Windows image.","pos":[5112,5174]},{"content":"An index or name value is required for most operations that specify an image file.","pos":[5318,5400]},{"content":"At a command prompt, type the following command to apply the unattended answer file to the image.","pos":[5406,5503]},{"content":"At a command prompt, type the following command to commit the changes and unmount the image.","pos":[5616,5708]},{"pos":[5792,5910],"content":"For more information about Windows SIM, see <bpt id=\"p1\">[</bpt>Windows Setup Technical Reference<ept id=\"p1\">](windows-setup-technical-reference.md)</ept>."},{"pos":[5948,5962],"content":"Related topics"},{"content":"DISM - Deployment Image Servicing and Management Technical Reference for Windows","pos":[5966,6046]},{"content":"DISM Operating System Package Servicing Command-Line Options","pos":[6135,6195]},{"content":"DISM Unattended Servicing Command-Line Options","pos":[6264,6310]}],"content":"---\nauthor: Justinha\nDescription: Add or Remove Packages Offline Using DISM\nms.assetid: 32785116-e5ed-40ae-8802-9c2a67cd9938\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: Add or Remove Packages Offline Using DISM\n---\n\n# Add or Remove Packages Offline Using DISM\n\n\nDeployment Image Servicing and Management (DISM.exe) is a command-line tool that is used to update offline Windows® images. There are two ways to install or remove packages offline with DISM. You can either apply an unattend answer file to the offline image, or you can add or remove the package directly from the command prompt.\n\nIf you are installing multiple packages to a Windows image, and there are dependency requirements, the best way to ensure the correct order of the installation is by using an answer file. You can use DISM to apply the Unattend.xml answer file to the image. When you use DISM to apply an answer file, the unattend settings in the **offlineServicing** configuration pass are applied to the Windows image.\n\nYou must install the latest version of the Windows Assessment and Deployment Kit (Windows ADK), which contains all of the tools that are required, including DISM.\n\n## To add packages to an offline image by using DISM\n\n1.  At an elevated command prompt, locate the Windows ADK servicing folder, and type the following command to retrieve the name or index number for the image that you want to modify.\n\n    ``` syntax\n    Dism /Get-ImageInfo /ImageFile:C:\\test\\images\\install.wim\n    ```\n\n    An index or name value is required for most operations that specify an image file.\n\n2.  Type the following command to mount the offline Windows image.\n\n    ``` syntax\n    Dism /Mount-Image /ImageFile:C:\\test\\images\\install.wim /Name:\"Windows 7 HomeBasic\" /MountDir:C:\\test\\offline\n    ```\n\n3.  At a command prompt, type the following command to add a specific package to the image. You can add multiple packages on one command line. They will be installed in the order listed in the command line.\n\n    ``` syntax\n    Dism /Image:C:\\test\\offline /Add-Package /PackagePath:C:\\packages\\package1.cab /PackagePath:C:\\packages\\package2.cab\n    ```\n\n4.  At a command prompt, type the following command to commit the changes and unmount the image.\n\n    ``` syntax\n    Dism /Unmount-Image /MountDir:C:\\test\\offline /Commit\n    ```\n\n## To remove packages from an offline image by using DISM\n\n1.  At an elevated command prompt, locate the Windows ADK servicing folder, and type the following command to retrieve the name or index number for the image that you want to modify.\n\n    ``` syntax\n    Dism /Get-ImageInfo /ImageFile:C:\\test\\images\\install.wim\n    ```\n\n    An index or name value is required for most operations that specify an image file.\n\n2.  Type the following command to mount the offline Windows image.\n\n    ``` syntax\n    Dism /Mount-Image /ImageFile:C:\\test\\images\\install.wim /Name:\"Windows 7 HomeBasic\" /MountDir:C:\\test\\offline\n    ```\n\n3.  Optional: Type the following command to list the packages in the image.\n\n    ``` syntax\n    Dism /Image:C:\\test\\offline /Get-Packages\n    ```\n\n    You can use `>featurelist.txt` to redirect the output of the command to a text file that is named FeatureList.\n\n4.  Review the list of packages that are available in your mounted image and note the package identity of the package.\n\n5.  At a command prompt, specify the package identity to remove it from the image. You can remove multiple packages on one command line.\n\n    ``` syntax\n    DISM /Image:C:\\test\\offline /Remove-Package /PackageName:Microsoft.Windows.Calc.Demo~6595b6144ccf1df~x86~en~1.0.0.0 /PackageName:Microsoft-Windows-MediaPlayer-Package~31bf3856ad364e35~x86~~6.1.6801.0\n    ```\n\n    You can use the **/PackagePath** option to point to the original source of the package, or to specify the path to the .cab file, or you can use the **/PackageName** option to specify the package by name as it is listed in the image. For more information, see [DISM Operating System Package Servicing Command-Line Options](dism-operating-system-package-servicing-command-line-options.md).\n\n6.  At a command prompt, type the following command to commit the changes and unmount the image.\n\n    ``` syntax\n    Dism /Unmount-Image /MountDir:C:\\test\\offline /Commit\n    ```\n\n## To add or remove packages offline by using DISM and an answer file\n\n1.  Open Windows SIM.\n\n2.  To add a new package, click **Insert** on the main menu, and select **Package(s)**. Browse to the package you want to add, and then click **Open**.\n\n3.  To remove an existing package, select the package in the **Answer file** pane that you want to remove. In the **Properties** pane, change the **Action** property to **Remove**.\n\n    **Note**  \n    The packages must be added to the **offlineServicing** configuration pass.\n\n4.  Validate and save the answer file.\n\n5.  At an elevated command prompt, locate the Windows ADK servicing folder, and then type the following command to retrieve the name or index number for the image that you want to mount.\n\n    ``` syntax\n    Dism /Get-ImageInfo /ImageFile:C:\\test\\images\\install.wim\n    ```\n\n6.  Type the following command to mount the offline Windows image.\n\n    ``` syntax\n    Dism /Mount-Image /ImageFile:C:\\test\\images\\install.wim /name:\"Windows 7 HomeBasic\" /MountDir:C:\\test\\offline\n    ```\n\n    An index or name value is required for most operations that specify an image file.\n\n7.  At a command prompt, type the following command to apply the unattended answer file to the image.\n\n    ``` syntax\n    DISM /Image:C:\\test\\offline /Apply-Unattend:C:\\test\\answerfiles\\myunattend.xml\n    ```\n\n8.  At a command prompt, type the following command to commit the changes and unmount the image.\n\n    ``` syntax\n    Dism /Unmount-Image /MountDir:C:\\test\\offline /Commit\n    ```\n\nFor more information about Windows SIM, see [Windows Setup Technical Reference](windows-setup-technical-reference.md).\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[DISM - Deployment Image Servicing and Management Technical Reference for Windows](dism---deployment-image-servicing-and-management-technical-reference-for-windows.md)\n\n[DISM Operating System Package Servicing Command-Line Options](dism-operating-system-package-servicing-command-line-options.md)\n\n[DISM Unattended Servicing Command-Line Options](dism-unattended-servicing-command-line-options.md)\n\n \n\n \n\n\n\n\n\n\n"}