{"nodes":[{"content":"WinPE: Boot in UEFI or legacy BIOS mode","pos":[35,74]},{"content":"WinPE: Boot in UEFI or legacy BIOS mode","pos":[183,222]},{"content":"WinPE: Boot in UEFI or legacy BIOS mode","pos":[231,270]},{"content":"When you boot Windows PE on a UEFI PC, you may need to check whether the PC is booted in UEFI mode or legacy BIOS-compatibility mode.","pos":[273,406]},{"content":"For example, running Windows Setup through Windows PE requires you to be in the correct firmware mode.","pos":[408,510]},{"content":"For many operations, such as applying Windows images using Diskpart and DISM, the firmware mode might not make a difference.","pos":[512,636]},{"content":"Boot to UEFI mode","pos":[640,657]},{"content":"When booting the PC, you may need to manually select the UEFI boot files: <ph id=\"ph1\">\\\\</ph>EFI<ph id=\"ph2\">\\\\</ph>BOOT<ph id=\"ph3\">\\\\</ph>BOOTX64.EFI.","pos":[665,764]},{"content":"Boot your PC and press the key to get into the firmware menus (examples: Esc, F2, F9, F12).","pos":[774,865]},{"content":"Look for a firmware option to choose the boot file (examples: Boot to file, Boot to EFI file).","pos":[875,969]},{"pos":[979,1039],"content":"Select the file from the USB drive: <ph id=\"ph1\">`\\EFI\\BOOT\\BOOTX64.EFI`</ph>."},{"content":"Detect whether Windows PE is booted in BIOS or UEFI mode","pos":[1043,1099]},{"content":"Check the <bpt id=\"p1\">**</bpt>HKLM<ph id=\"ph1\">\\\\</ph>System<ph id=\"ph2\">\\\\</ph>CurrentControlSet<ph id=\"ph3\">\\\\</ph>Control<ph id=\"ph4\">\\\\</ph>PEFirmwareType<ept id=\"p1\">**</ept> registry value to see if the PC is booted to UEFI or BIOS mode.","pos":[1107,1241]},{"content":"Note: you may need to run <ph id=\"ph1\">`wpeutil UpdateBootInfo`</ph> to make sure this value is present.","pos":[1242,1328]},{"content":"This command returns 0x1 if the PC is booted into BIOS mode, or 0x2 if the PC is booted in UEFI mode.","pos":[1428,1529]},{"content":"Sample script:","pos":[1535,1549]},{"content":"If this is a frequent problem, you can remove the boot files for UEFI mode or BIOS mode to prevent the PC from booting in the wrong mode.","pos":[1906,2043]},{"content":"If the PC firmware is set up to boot in the wrong mode, the media will immediately fail to boot, allowing you to immediately retry booting the PC into the correct mode.","pos":[2044,2212]},{"pos":[2222,2347],"content":"<bpt id=\"p1\">**</bpt>Boot in UEFI mode<ept id=\"p1\">**</ept>: To prevent Windows PE from booting in BIOS mode, remove the <bpt id=\"p2\">**</bpt>bootmgr<ept id=\"p2\">**</ept> file on the root of the media."},{"pos":[2357,2480],"content":"<bpt id=\"p1\">**</bpt>Boot in BIOS mode<ept id=\"p1\">**</ept>: To prevent Windows PE from booting in UEFI mode, remove the <bpt id=\"p2\">**</bpt>efi<ept id=\"p2\">**</ept> folder on the root of the media."},{"pos":[2518,2532],"content":"Related topics"},{"content":"WinPE for Windows 10","pos":[2536,2556]},{"content":"Windows Setup: Installing using the MBR or GPT partition style","pos":[2576,2638]},{"content":"Wpeutil Command-Line Options","pos":[2708,2736]},{"content":"UEFI Firmware","pos":[2773,2786]}],"content":"---\nauthor: Justinha\nDescription: 'WinPE: Boot in UEFI or legacy BIOS mode'\nms.assetid: bc3c4d41-c4f7-4432-b11a-f409e171d60d\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: 'WinPE: Boot in UEFI or legacy BIOS mode'\n---\n\n# WinPE: Boot in UEFI or legacy BIOS mode\n\n\nWhen you boot Windows PE on a UEFI PC, you may need to check whether the PC is booted in UEFI mode or legacy BIOS-compatibility mode.\n\nFor example, running Windows Setup through Windows PE requires you to be in the correct firmware mode.\n\nFor many operations, such as applying Windows images using Diskpart and DISM, the firmware mode might not make a difference.\n\n**Boot to UEFI mode**\n\n-   When booting the PC, you may need to manually select the UEFI boot files: \\\\EFI\\\\BOOT\\\\BOOTX64.EFI.\n\n    1.  Boot your PC and press the key to get into the firmware menus (examples: Esc, F2, F9, F12).\n\n    2.  Look for a firmware option to choose the boot file (examples: Boot to file, Boot to EFI file).\n\n    3.  Select the file from the USB drive: `\\EFI\\BOOT\\BOOTX64.EFI`.\n\n**Detect whether Windows PE is booted in BIOS or UEFI mode**\n\n1.  Check the **HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\PEFirmwareType** registry value to see if the PC is booted to UEFI or BIOS mode. Note: you may need to run `wpeutil UpdateBootInfo` to make sure this value is present.\n\n    ``` syntax\n    reg query HKLM\\System\\CurrentControlSet\\Control /v PEFirmwareType\n    ```\n\n    This command returns 0x1 if the PC is booted into BIOS mode, or 0x2 if the PC is booted in UEFI mode.\n\n    Sample script:\n\n    ``` syntax\n    wpeutil UpdateBootInfo\n    for /f \"tokens=2* delims=    \" %%A in ('reg query HKLM\\System\\CurrentControlSet\\Control /v PEFirmwareType') DO SET Firmware=%%B\n    :: Note: delims is a TAB followed by a space.\n    if %Firmware%==0x1 echo The PC is booted in BIOS mode.\n    if %Firmware%==0x2 echo The PC is booted in UEFI mode.\n    ```\n\n2.  If this is a frequent problem, you can remove the boot files for UEFI mode or BIOS mode to prevent the PC from booting in the wrong mode. If the PC firmware is set up to boot in the wrong mode, the media will immediately fail to boot, allowing you to immediately retry booting the PC into the correct mode.\n\n    -   **Boot in UEFI mode**: To prevent Windows PE from booting in BIOS mode, remove the **bootmgr** file on the root of the media.\n\n    -   **Boot in BIOS mode**: To prevent Windows PE from booting in UEFI mode, remove the **efi** folder on the root of the media.\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[WinPE for Windows 10](winpe-intro.md)\n\n[Windows Setup: Installing using the MBR or GPT partition style](windows-setup-installing-using-the-mbr-or-gpt-partition-style.md)\n\n[Wpeutil Command-Line Options](wpeutil-command-line-options.md)\n\n[UEFI Firmware](uefi-firmware.md)\n\n \n\n \n\n\n\n\n\n\n"}