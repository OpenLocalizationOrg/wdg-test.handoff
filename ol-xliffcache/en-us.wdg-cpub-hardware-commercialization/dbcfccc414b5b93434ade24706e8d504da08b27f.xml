{"nodes":[{"content":"Optimizing Performance and Responsiveness","pos":[11,52]},{"content":"Customers expect high-performing and responsive systems.","pos":[66,122]},{"content":"Optimizing Performance and Responsiveness","pos":[311,352]},{"content":"Customers expect high-performing and responsive systems.","pos":[355,411]},{"content":"This encompasses a broad scope of scenarios ranging from boot time to fluid user interactions with applications.","pos":[412,524]},{"content":"Analyzing performance problems requires a lot of expertise and domain-specific knowledge.","pos":[525,614]},{"content":"Microsoft provides tools to help you tackle this complex task.","pos":[615,677]},{"content":"This guide introduces you to the process of measuring, analyzing, and solving the root causes of performance issues in key areas.","pos":[679,808]},{"content":"Topics include:","pos":[809,824]},{"pos":[830,877],"content":"Using the <bpt id=\"p1\">**</bpt>Windows Performance Toolkit (WPT)<ept id=\"p1\">**</ept>"},{"content":"Capturing event trace log (ETL) traces","pos":[883,921]},{"content":"Boot, application launch, and UI delays","pos":[927,966]},{"content":"CPU and disk resource usage analysis","pos":[972,1008]},{"content":"Critical path and wait analysis","pos":[1014,1045]},{"content":"Goals","pos":[1050,1055]},{"content":"This guide will show you how to perform the following tasks:","pos":[1058,1118]},{"content":"Gather relevant data to analyze performance problems on any system","pos":[1124,1190]},{"content":"Understand the analysis process to look at system resource consumption like CPU and disk","pos":[1196,1284]},{"content":"Identify what can impact the system responsiveness in some key Windows scenarios","pos":[1290,1370]},{"content":"Tools","pos":[1375,1380]},{"content":"The Windows Assessment Toolkit in the ADK provides a set of performance-related tests called assessments.","pos":[1383,1488]},{"content":"The assessment results are used to diagnose potential problems, so that the hardware and software that you develop are both responsive and have a minimal impact on battery life, startup performance, and shutdown time.","pos":[1489,1706]},{"content":"The same assessments are available to OEM/ISV/IHV partners, enthusiasts, and other members of the community, to establish a common framework to measure, compare, and review aspects of quality.","pos":[1707,1899]},{"content":"The <bpt id=\"p1\">**</bpt>Windows Performance Toolkit<ept id=\"p1\">**</ept> consists of two independent tools: <bpt id=\"p2\">**</bpt>Windows Performance Recorder (WPR)<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>Windows Performance Analyzer (WPA)<ept id=\"p3\">**</ept>.","pos":[1901,2054]},{"content":"<bpt id=\"p1\">**</bpt>WPR<ept id=\"p1\">**</ept> is a powerful recording tool that creates Event Tracing for Windows (ETW) recordings.","pos":[2055,2148]},{"content":"You can run <bpt id=\"p1\">**</bpt>WPR<ept id=\"p1\">**</ept> from the user interface (UI) or from the command line (CL).","pos":[2149,2228]},{"content":"<bpt id=\"p1\">**</bpt>WPR<ept id=\"p1\">**</ept> provides built-in profiles that you can use to select the events you want to record.","pos":[2229,2321]},{"content":"<bpt id=\"p1\">**</bpt>WPA<ept id=\"p1\">**</ept> is a powerful analysis tool that combines a flexible UI with extensive graphing capabilities and data tables that can be pivoted and have full text search capabilities.","pos":[2322,2498]},{"content":"Fast Startup Behavior","pos":[2503,2524]},{"content":"Introduced in Windows 8, Fast Startup is the default boot behavior.","pos":[2527,2594]},{"content":"The shutdown process was updated to include writing data to disk in a way that mirrors how hibernate works.","pos":[2595,2702]},{"content":"During boot, the system goes through the phases that are described in the following table.","pos":[2703,2793]},{"content":"Phase","pos":[2797,2802]},{"content":"Description","pos":[2827,2838]},{"content":"BIOS Initialization","pos":[3181,3200]},{"content":"The time the operating system takes to initialize the BIOS, including the Pre-Boot Execution Environment (PXE).","pos":[3209,3320]},{"content":"Hiberfile Read","pos":[3372,3386]},{"content":"The time the operating system takes to read the hiberfile from disk.","pos":[3400,3468]},{"content":"The hiberfile contains all of the system context as written during shutdown.","pos":[3469,3545]},{"content":"Resume Devices","pos":[3563,3577]},{"content":"The time the operating system takes to resume devices and put them back in the active power state.","pos":[3591,3689]},{"content":"WinLogon Resume","pos":[3754,3769]},{"content":"The time the operating system takes to resume the Winlogon process.","pos":[3782,3849]},{"content":"Explorer Initialization","pos":[3945,3968]},{"content":"The time the operating system takes to initialize the Windows shell (explorer.exe).","pos":[3973,4056]},{"content":"This phase ends when the desktop or Start screen is visible to the user.","pos":[4057,4129]},{"content":"Post On/Off Duration","pos":[4136,4156]},{"content":"The time Windows takes to complete all startup tasks after the desktop appears, but until CPU and disk resource become idle.","pos":[4164,4288]},{"pos":[4327,4480],"content":"For more information about Fast Startup Behavior, see the <bpt id=\"p1\">[</bpt>On/Off Transition Performance<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619168)</ept> topic on MSDN."},{"content":"CPU Scheduling and Threads","pos":[4485,4511]},{"content":"Because the number of processors in a system is limited, all threads cannot be run at the same time.","pos":[4514,4614]},{"content":"Windows implements processor time-sharing, which allows a thread to run for a period of time before the processor switches to another thread.","pos":[4615,4756]},{"content":"The act of switching between threads is called a context-switch and is performed by a Windows component called the dispatcher.","pos":[4757,4883]},{"content":"Each thread exists in a particular execution state at any given time.","pos":[4884,4953]},{"content":"Windows uses three states that are relevant to performance: <bpt id=\"p1\">**</bpt>Running<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>Ready<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>Waiting<ept id=\"p3\">**</ept>.","pos":[4954,5054]},{"content":"Threads being executed are in the <bpt id=\"p1\">**</bpt>Running<ept id=\"p1\">**</ept> state.","pos":[5056,5108]},{"content":"Threads that can execute, but are currently not running, are in the <bpt id=\"p1\">**</bpt>Ready<ept id=\"p1\">**</ept> state.","pos":[5109,5193]},{"content":"Threads that cannot run (because they are waiting for a particular event) are in the <bpt id=\"p1\">**</bpt>Waiting<ept id=\"p1\">**</ept> state.","pos":[5194,5297]},{"content":"The following figure illustrates the possible thread transitions.","pos":[5298,5363]},{"pos":[5412,5574],"content":"A thread in the <bpt id=\"p1\">**</bpt>Running<ept id=\"p1\">**</ept> state initiates a transition to the <bpt id=\"p2\">**</bpt>Waiting<ept id=\"p2\">**</ept> state by calling a wait function such as <bpt id=\"p3\">**</bpt>WaitForSingleObject<ept id=\"p3\">**</ept> or <bpt id=\"p4\">**</bpt>Sleep(<ph id=\"ph1\">&amp;gt;</ph> 0)<ept id=\"p4\">**</ept>."},{"pos":[5580,5707],"content":"A running thread or kernel operation readies a thread in the <bpt id=\"p1\">**</bpt>Waiting<ept id=\"p1\">**</ept> state (for example, <bpt id=\"p2\">**</bpt>SetEvent<ept id=\"p2\">**</ept> or timer expiration)."},{"pos":[5713,5866],"content":"A thread in the <bpt id=\"p1\">**</bpt>Ready<ept id=\"p1\">**</ept> state is scheduled for processing by the dispatcher when a running thread waits or reaches the end of its quantum of execution."},{"pos":[5872,6050],"content":"A thread in the <bpt id=\"p1\">**</bpt>Running<ept id=\"p1\">**</ept> state is switched out and placed into the <bpt id=\"p2\">**</bpt>Ready<ept id=\"p2\">**</ept> state by the dispatcher when it is preempted by a higher priority thread or when its quantum ends."},{"content":"Thread state becomes an important factor in performance only when a user is waiting for a thread to complete an operation.","pos":[6052,6174]},{"pos":[6176,6305],"content":"For more information about CPU Scheduling, see the <bpt id=\"p1\">[</bpt>CPU Analysis<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=619178)</ept> topic on MSDN."},{"content":"Exercises","pos":[6310,6319]},{"content":"This guide consists of the following exercises.","pos":[6322,6369]},{"content":"Exercise 1 - Evaluate Fast Startup Using the Assessment Toolkit","pos":[6376,6439]},{"content":"Exercise 2 - Evaluate Fast Startup Using Windows Performance Toolkit","pos":[6504,6572]},{"content":"Exercise 3 - Understand Critical Path and Wait Analysis","pos":[6637,6692]}],"content":"---\ntitle: Optimizing Performance and Responsiveness\ndescription: Customers expect high-performing and responsive systems.\nMSHAttr:\n- 'PreferredSiteName:MSDN'\n- 'PreferredLib:/library/windows/hardware'\nms.assetid: AC976D67-DDFF-4238-8887-7030B14F960B\nms.prod: W10\nms.mktglfcycl: operate\nms.sitesec: msdn\n---\n\n# Optimizing Performance and Responsiveness\n\n\nCustomers expect high-performing and responsive systems. This encompasses a broad scope of scenarios ranging from boot time to fluid user interactions with applications. Analyzing performance problems requires a lot of expertise and domain-specific knowledge. Microsoft provides tools to help you tackle this complex task.\n\nThis guide introduces you to the process of measuring, analyzing, and solving the root causes of performance issues in key areas. Topics include:\n\n-   Using the **Windows Performance Toolkit (WPT)**\n\n-   Capturing event trace log (ETL) traces\n\n-   Boot, application launch, and UI delays\n\n-   CPU and disk resource usage analysis\n\n-   Critical path and wait analysis\n\n## Goals\n\n\nThis guide will show you how to perform the following tasks:\n\n-   Gather relevant data to analyze performance problems on any system\n\n-   Understand the analysis process to look at system resource consumption like CPU and disk\n\n-   Identify what can impact the system responsiveness in some key Windows scenarios\n\n## Tools\n\n\nThe Windows Assessment Toolkit in the ADK provides a set of performance-related tests called assessments. The assessment results are used to diagnose potential problems, so that the hardware and software that you develop are both responsive and have a minimal impact on battery life, startup performance, and shutdown time. The same assessments are available to OEM/ISV/IHV partners, enthusiasts, and other members of the community, to establish a common framework to measure, compare, and review aspects of quality.\n\nThe **Windows Performance Toolkit** consists of two independent tools: **Windows Performance Recorder (WPR)** and **Windows Performance Analyzer (WPA)**. **WPR** is a powerful recording tool that creates Event Tracing for Windows (ETW) recordings. You can run **WPR** from the user interface (UI) or from the command line (CL). **WPR** provides built-in profiles that you can use to select the events you want to record. **WPA** is a powerful analysis tool that combines a flexible UI with extensive graphing capabilities and data tables that can be pivoted and have full text search capabilities.\n\n## Fast Startup Behavior\n\n\nIntroduced in Windows 8, Fast Startup is the default boot behavior. The shutdown process was updated to include writing data to disk in a way that mirrors how hibernate works. During boot, the system goes through the phases that are described in the following table.\n\n| Phase                       | Description                                                                                                                                                  |\n|-----------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| **BIOS Initialization**     | The time the operating system takes to initialize the BIOS, including the Pre-Boot Execution Environment (PXE).                                              |\n| **Hiberfile Read**          | The time the operating system takes to read the hiberfile from disk. The hiberfile contains all of the system context as written during shutdown.            |\n| **Resume Devices**          | The time the operating system takes to resume devices and put them back in the active power state.                                                           |\n| **WinLogon Resume**         | The time the operating system takes to resume the Winlogon process.                                                                                          |\n| **Explorer Initialization** | The time the operating system takes to initialize the Windows shell (explorer.exe). This phase ends when the desktop or Start screen is visible to the user. |\n| **Post On/Off Duration**    | The time Windows takes to complete all startup tasks after the desktop appears, but until CPU and disk resource become idle.                                 |\n\n \n\nFor more information about Fast Startup Behavior, see the [On/Off Transition Performance](http://go.microsoft.com/fwlink/p/?linkid=619168) topic on MSDN.\n\n## CPU Scheduling and Threads\n\n\nBecause the number of processors in a system is limited, all threads cannot be run at the same time. Windows implements processor time-sharing, which allows a thread to run for a period of time before the processor switches to another thread. The act of switching between threads is called a context-switch and is performed by a Windows component called the dispatcher. Each thread exists in a particular execution state at any given time. Windows uses three states that are relevant to performance: **Running**, **Ready**, and **Waiting**.\n\nThreads being executed are in the **Running** state. Threads that can execute, but are currently not running, are in the **Ready** state. Threads that cannot run (because they are waiting for a particular event) are in the **Waiting** state. The following figure illustrates the possible thread transitions.\n\n![](images/optimizingperformancelab1.png)\n\n1.  A thread in the **Running** state initiates a transition to the **Waiting** state by calling a wait function such as **WaitForSingleObject** or **Sleep(&gt; 0)**.\n\n2.  A running thread or kernel operation readies a thread in the **Waiting** state (for example, **SetEvent** or timer expiration).\n\n3.  A thread in the **Ready** state is scheduled for processing by the dispatcher when a running thread waits or reaches the end of its quantum of execution.\n\n4.  A thread in the **Running** state is switched out and placed into the **Ready** state by the dispatcher when it is preempted by a higher priority thread or when its quantum ends.\n\nThread state becomes an important factor in performance only when a user is waiting for a thread to complete an operation.\n\nFor more information about CPU Scheduling, see the [CPU Analysis](http://go.microsoft.com/fwlink/p/?linkid=619178) topic on MSDN.\n\n## Exercises\n\n\nThis guide consists of the following exercises.\n\n-   [Exercise 1 - Evaluate Fast Startup Using the Assessment Toolkit](optimizing-performance-and-responsiveness-exercise-1.md)\n\n-   [Exercise 2 - Evaluate Fast Startup Using Windows Performance Toolkit](optimizing-performance-and-responsiveness-exercise-2.md)\n\n-   [Exercise 3 - Understand Critical Path and Wait Analysis](optimizing-performance-and-responsiveness-exercise-3.md)\n\n \n\n \n\n\n\n\n\n\n"}