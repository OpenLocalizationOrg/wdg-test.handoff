{"nodes":[{"content":"Windows Setup States","pos":[34,54]},{"content":"Windows Setup States","pos":[161,181]},{"content":"Windows Setup States","pos":[189,209]},{"content":"There are several states assigned to a Windows® image during installation.","pos":[212,286]},{"content":"This state information can be used to detect automatically the different states and stages of Windows Setup.","pos":[287,395]},{"pos":[511,542],"content":"Windows Setup State Information"},{"content":"The Windows image state is stored in two locations, in the registry and in a file.","pos":[545,627]},{"content":"In the registry:","pos":[633,649]},{"pos":[655,744],"content":"KEY: <bpt id=\"p1\">**</bpt>HKEY<ph id=\"ph1\">\\_</ph>LOCAL<ph id=\"ph2\">\\_</ph>MACHINE<ph id=\"ph3\">\\\\</ph>SOFTWARE<ph id=\"ph4\">\\\\</ph>Microsoft<ph id=\"ph5\">\\\\</ph>Windows<ph id=\"ph6\">\\\\</ph>CurrentVersion<ph id=\"ph7\">\\\\</ph>Setup<ph id=\"ph8\">\\\\</ph>State<ept id=\"p1\">**</ept>"},{"content":"TYPE: REG<ph id=\"ph1\">\\_</ph>SZ","pos":[750,763]},{"pos":[769,787],"content":"VALUE: <bpt id=\"p1\">*</bpt>StateName<ept id=\"p1\">*</ept>"},{"content":"In a file:","pos":[793,803]},{"content":"FILE: %WINDIR%<ph id=\"ph1\">\\\\</ph>Setup<ph id=\"ph2\">\\\\</ph>State<ph id=\"ph3\">\\\\</ph>State.ini","pos":[809,848]},{"content":"SECTION: <ph id=\"ph1\">\\[</ph>State","pos":[854,870]},{"pos":[878,896],"content":"VALUE: <bpt id=\"p1\">*</bpt>StateName<ept id=\"p1\">*</ept>"},{"pos":[898,966],"content":"The following table describes the values that exist for <bpt id=\"p1\">*</bpt>StateName<ept id=\"p1\">*</ept>."},{"content":"State name","pos":[1084,1094]},{"content":"Description","pos":[1117,1128]},{"content":"IMAGE_STATE_COMPLETE","pos":[1194,1214]},{"content":"The image has successfully been installed.","pos":[1244,1286]},{"content":"The <ph id=\"ph1\">&lt;strong&gt;</ph>specialize<ph id=\"ph2\">&lt;/strong&gt;</ph> and <ph id=\"ph3\">&lt;strong&gt;</ph>oobeSystem<ph id=\"ph4\">&lt;/strong&gt;</ph> configuration passes are complete.","pos":[1287,1385]},{"content":"This image is not deployable to a computer that has a different hardware configuration because it is now hardware-dependent.","pos":[1386,1510]},{"content":"To deploy this image to a computer that has a different hardware configuration, you must run <ph id=\"ph1\">&lt;strong&gt;</ph>sysprep /generalize<ph id=\"ph2\">&lt;/strong&gt;</ph>.","pos":[1511,1641]},{"content":"IMAGE_STATE _UNDEPLOYABLE","pos":[1695,1720]},{"content":"This is the default state for an image in a given phase of Windows Setup that is not yet complete.","pos":[1750,1848]},{"content":"If a process queries the IMAGE_STATE value and IMG_UNDEPLOYABLE is returned, the image is in one of the following states:","pos":[1849,1970]},{"content":"Setup is currently running and has not fully completed the phase.","pos":[1987,2052]},{"content":"Once a given phase is complete, the IMAGE_STATE will be set to an appropriate completion value.","pos":[2053,2148]},{"content":"If queried online when Setup is not running, there was a failure when completing a Setup phase.","pos":[2165,2260]},{"content":"This image must be reinstalled.","pos":[2261,2292]},{"content":"If queried offline, the image did not finish a phase and will never be deployable.","pos":[2309,2391]},{"content":"IMAGE_STATE_GENERALIZE_RESEAL_TO_OOBE","pos":[2455,2492]},{"content":"The image has successfully completed the <ph id=\"ph1\">&lt;strong&gt;</ph>generalize<ph id=\"ph2\">&lt;/strong&gt;</ph> configuration pass and will continue into <ph id=\"ph3\">&lt;strong&gt;</ph>OOBEsystem<ph id=\"ph4\">&lt;/strong&gt;</ph> configuration pass when Setup is initiated.","pos":[2522,2704]},{"content":"IMAGE_STATE_GENERALIZE_RESEAL_TO_AUDIT","pos":[2758,2796]},{"content":"The image has successfully completed the <ph id=\"ph1\">&lt;strong&gt;</ph>generalize<ph id=\"ph2\">&lt;/strong&gt;</ph> configuration pass and will continue into audit mode when Setup is initiated.","pos":[2826,2972]},{"content":"IMAGE_STATE_SPECIALIZE_RESEAL_TO_OOBE","pos":[3025,3062]},{"content":"The image has successfully completed the <ph id=\"ph1\">&lt;strong&gt;</ph>specialize<ph id=\"ph2\">&lt;/strong&gt;</ph> pass and will continue into <ph id=\"ph3\">&lt;strong&gt;</ph>OOBEsystem<ph id=\"ph4\">&lt;/strong&gt;</ph> configuration pass when Setup is initiated.","pos":[3092,3260]},{"content":"IMAGE_STATE_SPECIALIZE_RESEAL_TO_AUDIT","pos":[3314,3352]},{"content":"The image has successfully completed the <ph id=\"ph1\">&lt;strong&gt;</ph>specialize<ph id=\"ph2\">&lt;/strong&gt;</ph> configuration pass and will continue into audit mode when Setup is initiated.","pos":[3382,3528]},{"content":"The following examples show how to access state information.","pos":[3566,3626]},{"content":"To access state information from the registry:","pos":[3632,3678]},{"content":"To access state information from a file:","pos":[3952,3992]},{"pos":[4165,4179],"content":"Related topics"},{"content":"Windows Setup Command-Line Options","pos":[4183,4217]},{"content":"Windows Setup Edition Configuration and Product ID Files (EI.cfg and PID.txt)","pos":[4260,4337]},{"content":"Windows Setup Log Files and Event Logs","pos":[4420,4458]}],"content":"---\nauthor: Justinha\nDescription: Windows Setup States\nms.assetid: f67b1396-b2a5-4ac1-8104-7188e5cff54c\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: Windows Setup States\n---\n\n# Windows Setup States\n\n\nThere are several states assigned to a Windows® image during installation. This state information can be used to detect automatically the different states and stages of Windows Setup.\n\n## <span id=\"WindowsSetupStates\"></span><span id=\"windowssetupstates\"></span><span id=\"WINDOWSSETUPSTATES\"></span>Windows Setup State Information\n\n\nThe Windows image state is stored in two locations, in the registry and in a file.\n\n-   In the registry:\n\n    KEY: **HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Setup\\\\State**\n\n    TYPE: REG\\_SZ\n\n    VALUE: *StateName*\n\n-   In a file:\n\n    FILE: %WINDIR%\\\\Setup\\\\State\\\\State.ini\n\n    SECTION: \\[State\\]\n\n    VALUE: *StateName*\n\nThe following table describes the values that exist for *StateName*.\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">State name</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>IMAGE_STATE_COMPLETE</p></td>\n<td align=\"left\"><p>The image has successfully been installed. The <strong>specialize</strong> and <strong>oobeSystem</strong> configuration passes are complete. This image is not deployable to a computer that has a different hardware configuration because it is now hardware-dependent. To deploy this image to a computer that has a different hardware configuration, you must run <strong>sysprep /generalize</strong>.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>IMAGE_STATE _UNDEPLOYABLE</p></td>\n<td align=\"left\"><p>This is the default state for an image in a given phase of Windows Setup that is not yet complete. If a process queries the IMAGE_STATE value and IMG_UNDEPLOYABLE is returned, the image is in one of the following states:</p>\n<ul>\n<li><p>Setup is currently running and has not fully completed the phase. Once a given phase is complete, the IMAGE_STATE will be set to an appropriate completion value.</p></li>\n<li><p>If queried online when Setup is not running, there was a failure when completing a Setup phase. This image must be reinstalled.</p></li>\n<li><p>If queried offline, the image did not finish a phase and will never be deployable.</p></li>\n</ul></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>IMAGE_STATE_GENERALIZE_RESEAL_TO_OOBE</p></td>\n<td align=\"left\"><p>The image has successfully completed the <strong>generalize</strong> configuration pass and will continue into <strong>OOBEsystem</strong> configuration pass when Setup is initiated.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>IMAGE_STATE_GENERALIZE_RESEAL_TO_AUDIT</p></td>\n<td align=\"left\"><p>The image has successfully completed the <strong>generalize</strong> configuration pass and will continue into audit mode when Setup is initiated.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>IMAGE_STATE_SPECIALIZE_RESEAL_TO_OOBE</p></td>\n<td align=\"left\"><p>The image has successfully completed the <strong>specialize</strong> pass and will continue into <strong>OOBEsystem</strong> configuration pass when Setup is initiated.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>IMAGE_STATE_SPECIALIZE_RESEAL_TO_AUDIT</p></td>\n<td align=\"left\"><p>The image has successfully completed the <strong>specialize</strong> configuration pass and will continue into audit mode when Setup is initiated.</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\nThe following examples show how to access state information.\n\n-   To access state information from the registry:\n\n    ``` syntax\n    C:\\>reg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Setup\\State /v Imag\n    eState\n\n    HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Setup\\State\n        ImageState    REG_SZ    IMAGE_STATE_SPECIALIZE_RESEAL_TO_OOBE\n    ```\n\n-   To access state information from a file:\n\n    ``` syntax\n    C:\\>type %windir%\\Setup\\State\\State.ini\n    [State]\n    ImageState=\"IMAGE_STATE_SPECIALIZE_RESEAL_TO_OOBE\"\n    ```\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[Windows Setup Command-Line Options](windows-setup-command-line-options.md)\n\n[Windows Setup Edition Configuration and Product ID Files (EI.cfg and PID.txt)](windows-setup-edition-configuration-and-product-id-files--eicfg-and-pidtxt.md)\n\n[Windows Setup Log Files and Event Logs](windows-setup-log-files-and-event-logs.md)\n\n \n\n \n\n\n\n\n\n\n"}