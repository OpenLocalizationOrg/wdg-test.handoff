{"nodes":[{"content":"Apply Images Using DISM","pos":[34,57]},{"content":"Apply Images Using DISM","pos":[164,187]},{"content":"Apply Images Using DISM","pos":[195,218]},{"content":"This topic describes how to deploy images captured from your reference computer to one or more destination computers using the Deployment Image Servicing and Management (DISM) tool.","pos":[221,402]},{"content":"For more information about configuring recommended hard drive partitions, see <bpt id=\"p1\">[</bpt>Configure UEFI/GPT-Based Hard Drive Partitions<ept id=\"p1\">](configure-uefigpt-based-hard-drive-partitions.md)</ept> and <bpt id=\"p2\">[</bpt>Configure BIOS/MBR-Based Hard Drive Partitions<ept id=\"p2\">](configure-biosmbr-based-hard-drive-partitions.md)</ept>.","pos":[403,683]},{"pos":[799,820],"content":"Apply a Windows Image"},{"content":"On the destination computer, you will create a structure for the partitions where you apply your images.","pos":[823,927]},{"content":"The partition structure on the destination computer must match the partition structure of the reference computer.","pos":[928,1041]},{"content":"If you apply an image to a volume with an existing Windows installation, files from the previous installation may not be deleted.","pos":[1043,1172]},{"content":"Format the volume by using a tool such as DiskPart before applying the new image.","pos":[1173,1254]},{"content":"To partition the hard drive and apply an image","pos":[1258,1304]},{"content":"Boot the destination computer to Windows PE.","pos":[1312,1356]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Windows PE (WinPE) Technical Reference<ept id=\"p1\">](winpe-intro.md)</ept>.","pos":[1357,1440]},{"content":"Connect to the network distribution share where your Windows image is stored.","pos":[1446,1523]},{"content":"For example, you can use the <bpt id=\"p1\">**</bpt>net use<ept id=\"p1\">**</ept> command to do this:","pos":[1524,1584]},{"content":"If prompted, provide your network credentials.","pos":[1644,1690]},{"pos":[1696,1777],"content":"At the Windows PE command prompt, type <ph id=\"ph1\">`diskpart`</ph> to start the <bpt id=\"p1\">**</bpt>Diskpart<ept id=\"p1\">**</ept> tool."},{"content":"Create your partition structure using the <bpt id=\"p1\">**</bpt>Diskpart<ept id=\"p1\">**</ept> tool.","pos":[1783,1843]},{"content":"For example:","pos":[1844,1856]},{"content":"This example temporarily assigns these drive letters: Windows=C, System=S, and Recovery=R.","pos":[2235,2325]},{"content":"If you’re deploying to PCs with unformatted hard drives, change the Windows drive letter to a letter that’s near the end of the alphabet, such as W, to avoid drive letter conflicts.","pos":[2326,2507]},{"content":"Do not use X, because this drive letter is reserved for Windows PE.","pos":[2508,2575]},{"content":"After the PC reboots, the Windows partition is assigned the letter C, and the other partitions don’t receive drive letters.","pos":[2576,2699]},{"pos":[2705,2961],"content":"For examples of recommended partition structures, see <bpt id=\"p1\">[</bpt>Configure BIOS/MBR-Based Hard Drive Partitions<ept id=\"p1\">](configure-biosmbr-based-hard-drive-partitions.md)</ept> and <bpt id=\"p2\">[</bpt>Configure UEFI/GPT-Based Hard Drive Partitions<ept id=\"p2\">](configure-uefigpt-based-hard-drive-partitions.md)</ept>."},{"pos":[2967,3154],"content":"**Note**  \nYou can automate this task with the `diskpart /s <script>` command. For more information, see [Diskpart Command line syntax](http://go.microsoft.com/fwlink/?LinkId=128458).","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"You can automate this task with the `diskpart /s <script>` command. For more information, see [Diskpart Command line syntax](http://go.microsoft.com/fwlink/?LinkId=128458).","pos":[11,183],"nodes":[{"content":"You can automate this task with the <ph id=\"ph1\">`diskpart /s &lt;script&gt;`</ph> command.","pos":[0,67]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Diskpart Command line syntax<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=128458)</ept>.","pos":[68,172]}]}]},{"content":"Use the DISM tool to apply images to your Windows partition.","pos":[3167,3227]},{"pos":[3233,3419],"content":"For each partition that you apply an image to, run the <bpt id=\"p1\">**</bpt>DISM<ept id=\"p1\">**</ept> <bpt id=\"p2\">**</bpt>/apply-image<ept id=\"p2\">**</ept> /imageFile: <bpt id=\"p3\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>image<ph id=\"ph2\">\\_</ph>file<ph id=\"ph3\">&amp;gt;</ph><ept id=\"p3\">*</ept> /index:<bpt id=\"p4\">*</bpt><ph id=\"ph4\">&amp;lt;</ph>index<ph id=\"ph5\">\\_</ph>number<ph id=\"ph6\">&amp;gt;</ph><ept id=\"p4\">*</ept> /ApplyDir:<bpt id=\"p5\">*</bpt><ph id=\"ph7\">&amp;lt;</ph>image<ph id=\"ph8\">\\_</ph>path<ph id=\"ph9\">&amp;gt;</ph><ept id=\"p5\">*</ept> command."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  If the DISM /Apply-Image command fails, make sure you’re using a <bpt id=\"p2\">[</bpt>supported version of DISM<ept id=\"p2\">](dism-supported-platforms.md)</ept> for that Windows image.","pos":[3540,3695]},{"content":"For example, to apply a Windows 10 image, you’ll need the Windows 10 version of DISM.","pos":[3696,3781]},{"content":"To set up a basic system partition, you can use the BCDboot tool to copy a simple set of system files to a system partition.","pos":[3794,3918]},{"content":"These files include boot configuration data (BCD) information that is used to start Windows:","pos":[3919,4011]},{"content":"Use the BCDboot tool to copy common system partition files and to initialize boot configuration data:","pos":[4017,4118]},{"pos":[4200,4324],"content":"For more information about the BCDboot tool, see <bpt id=\"p1\">[</bpt>BCDboot Command-Line Options<ept id=\"p1\">](bcdboot-command-line-options-techref-di.md)</ept>."},{"pos":[4330,4463],"content":"**Note**  \nYou can also set up the system partition by applying an image. Use the **DISM** **/apply-image** command. For example:","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"You can also set up the system partition by applying an image. Use the **DISM** **/apply-image** command. For example:","pos":[11,129],"nodes":[{"content":"You can also set up the system partition by applying an image.","pos":[0,62]},{"content":"Use the <bpt id=\"p1\">**</bpt>DISM<ept id=\"p1\">**</ept> <bpt id=\"p2\">**</bpt>/apply-image<ept id=\"p2\">**</ept> command.","pos":[63,105]},{"content":"For example:","pos":[106,118]}]}]},{"content":"You can set up the computer to reinstall your Windows image in the event of a system failure.","pos":[4565,4658]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Windows Recovery Environment (Windows RE) Technical Reference<ept id=\"p1\">](windows-recovery-environment--windows-re--technical-reference.md)</ept>.","pos":[4659,4815]},{"content":"Important","pos":[4819,4828]},{"content":"Microsoft Reserved partitions (MSR) and Extended partitions are managed by the computer.","pos":[4833,4921]},{"content":"Do not apply an image to these partitions.","pos":[4922,4964]},{"content":"You can use audit mode to test the computer and to perform additional customizations before you ship it to your end user.","pos":[4969,5090]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Boot Windows to Audit Mode or OOBE<ept id=\"p1\">](boot-windows-to-audit-mode-or-oobe.md)</ept>.","pos":[5091,5193]},{"content":"You can also perform some customizations to the computer without booting it.","pos":[5195,5271]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Service an Applied Windows Image<ept id=\"p1\">](service-an-applied-windows-image.md)</ept>.","pos":[5272,5370]},{"content":"Note","pos":[5374,5378]},{"content":"If you receive the error message: <bpt id=\"p1\">**</bpt>Bootmgr not found. Press CTRL+ALT+DEL<ept id=\"p1\">**</ept>, this indicates that Windows cannot identify the boot information in the active partition.","pos":[5383,5549]},{"content":"If you receive this error message, check the following:","pos":[5550,5605]},{"content":"Use the DiskPart tool to check to make sure that the system partition is set to Active.","pos":[5611,5698]},{"content":"Check to make sure that the active partition includes system files.","pos":[5704,5771]},{"pos":[5812,5826],"content":"Related topics"},{"content":"Capture Images of Hard Disk Partitions Using DISM","pos":[5830,5879]},{"content":"Boot Windows to Audit Mode or OOBE","pos":[5937,5971]},{"content":"DISM Image Management Command-Line Options","pos":[6014,6056]},{"content":"Applying Images using a script","pos":[6111,6141]}],"content":"---\nauthor: Justinha\nDescription: Apply Images Using DISM\nms.assetid: f9e0727d-a210-4efa-85af-5b222c53624e\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: Apply Images Using DISM\n---\n\n# Apply Images Using DISM\n\n\nThis topic describes how to deploy images captured from your reference computer to one or more destination computers using the Deployment Image Servicing and Management (DISM) tool. For more information about configuring recommended hard drive partitions, see [Configure UEFI/GPT-Based Hard Drive Partitions](configure-uefigpt-based-hard-drive-partitions.md) and [Configure BIOS/MBR-Based Hard Drive Partitions](configure-biosmbr-based-hard-drive-partitions.md).\n\n## <span id=\"BootUsingWindowsPE\"></span><span id=\"bootusingwindowspe\"></span><span id=\"BOOTUSINGWINDOWSPE\"></span>Apply a Windows Image\n\n\nOn the destination computer, you will create a structure for the partitions where you apply your images. The partition structure on the destination computer must match the partition structure of the reference computer.\n\nIf you apply an image to a volume with an existing Windows installation, files from the previous installation may not be deleted. Format the volume by using a tool such as DiskPart before applying the new image.\n\n**To partition the hard drive and apply an image**\n\n1.  Boot the destination computer to Windows PE. For more information, see [Windows PE (WinPE) Technical Reference](winpe-intro.md).\n\n2.  Connect to the network distribution share where your Windows image is stored. For example, you can use the **net use** command to do this:\n\n    ``` syntax\n    net use n: \\\\server\\share\n    ```\n\n    If prompted, provide your network credentials.\n\n3.  At the Windows PE command prompt, type `diskpart` to start the **Diskpart** tool.\n\n4.  Create your partition structure using the **Diskpart** tool. For example:\n\n    ``` syntax\n    select disk 0\n    clean\n    create partition primary size=3000 id=27\n    format quick fs=ntfs label=\"Recovery\"\n    assign letter=\"R\"\n    create partition primary size=300\n    format quick fs=ntfs label=\"System\"\n    assign letter=\"S\"\n    active\n    create partition primary\n    format quick fs=ntfs label=\"Windows\"\n    assign letter=\"C\"\n    exit\n    ```\n\n    This example temporarily assigns these drive letters: Windows=C, System=S, and Recovery=R. If you’re deploying to PCs with unformatted hard drives, change the Windows drive letter to a letter that’s near the end of the alphabet, such as W, to avoid drive letter conflicts. Do not use X, because this drive letter is reserved for Windows PE. After the PC reboots, the Windows partition is assigned the letter C, and the other partitions don’t receive drive letters.\n\n    For examples of recommended partition structures, see [Configure BIOS/MBR-Based Hard Drive Partitions](configure-biosmbr-based-hard-drive-partitions.md) and [Configure UEFI/GPT-Based Hard Drive Partitions](configure-uefigpt-based-hard-drive-partitions.md).\n\n    **Note**  \n    You can automate this task with the `diskpart /s <script>` command. For more information, see [Diskpart Command line syntax](http://go.microsoft.com/fwlink/?LinkId=128458).\n\n     \n\n5.  Use the DISM tool to apply images to your Windows partition.\n\n    For each partition that you apply an image to, run the **DISM** **/apply-image** /imageFile: *&lt;image\\_file&gt;* /index:*&lt;index\\_number&gt;* /ApplyDir:*&lt;image\\_path&gt;* command.\n\n    ``` syntax\n    Dism /apply-image /imagefile:N:\\Images\\my-windows-partition.wim /index:1 /ApplyDir:C:\\\n    ```\n\n    **Note**  If the DISM /Apply-Image command fails, make sure you’re using a [supported version of DISM](dism-supported-platforms.md) for that Windows image. For example, to apply a Windows 10 image, you’ll need the Windows 10 version of DISM.\n\n     \n\n6.  To set up a basic system partition, you can use the BCDboot tool to copy a simple set of system files to a system partition. These files include boot configuration data (BCD) information that is used to start Windows:\n\n    Use the BCDboot tool to copy common system partition files and to initialize boot configuration data:\n\n    ``` syntax\n    C:\\Windows\\System32\\bcdboot C:\\Windows /l en-US\n    ```\n\n    For more information about the BCDboot tool, see [BCDboot Command-Line Options](bcdboot-command-line-options-techref-di.md).\n\n    **Note**  \n    You can also set up the system partition by applying an image. Use the **DISM** **/apply-image** command. For example:\n\n    `Dism /apply-image /imagefile:N:\\Images\\my-system-partition.wim /index:1 /ApplyDir:S:\\`\n\n     \n\nYou can set up the computer to reinstall your Windows image in the event of a system failure. For more information, see [Windows Recovery Environment (Windows RE) Technical Reference](windows-recovery-environment--windows-re--technical-reference.md).\n\n**Important**  \nMicrosoft Reserved partitions (MSR) and Extended partitions are managed by the computer. Do not apply an image to these partitions.\n\n \n\nYou can use audit mode to test the computer and to perform additional customizations before you ship it to your end user. For more information, see [Boot Windows to Audit Mode or OOBE](boot-windows-to-audit-mode-or-oobe.md).\n\nYou can also perform some customizations to the computer without booting it. For more information, see [Service an Applied Windows Image](service-an-applied-windows-image.md).\n\n**Note**  \nIf you receive the error message: **Bootmgr not found. Press CTRL+ALT+DEL**, this indicates that Windows cannot identify the boot information in the active partition. If you receive this error message, check the following:\n\n-   Use the DiskPart tool to check to make sure that the system partition is set to Active.\n\n-   Check to make sure that the active partition includes system files.\n\n \n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[Capture Images of Hard Disk Partitions Using DISM](capture-images-of-hard-disk-partitions-using-dism.md)\n\n[Boot Windows to Audit Mode or OOBE](boot-windows-to-audit-mode-or-oobe.md)\n\n[DISM Image Management Command-Line Options](dism-image-management-command-line-options-s14.md)\n\n[Applying Images using a script](http://go.microsoft.com/fwlink/?LinkId=618399)\n\n \n\n \n\n\n\n\n\n\n"}