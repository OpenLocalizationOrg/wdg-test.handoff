{"nodes":[{"content":"Using Xperf Profiles","pos":[11,31]},{"content":"Using Xperf Profiles","pos":[45,65]},{"content":"Using Xperf Profiles","pos":[254,274]},{"content":"This section shows how to capture traces by using profiles.","pos":[277,336]},{"content":"If you are analyzing memory, consider writing your trace to a file, because ETW writes through and does not disturb the cache.","pos":[337,463]},{"content":"If you are analyzing disk I/O, consider saving your trace into a circular buffer in memory.","pos":[464,555]},{"content":"There are also other considerations such as whether you need to capture a long trace, which would not fit into a buffer in memory, or if you only care about the last 5-10 seconds of the trace content.","pos":[556,756]},{"content":"Procedure","pos":[761,770]},{"pos":[777,916],"content":"Select a profile such as <bpt id=\"p1\">**</bpt>perf!FileIOProfiles.InBuffer<ept id=\"p1\">**</ept> and use command similar to the following example to display information about it."},{"content":"This command lists all profiles, followed by the sessions and providers in that profile:","pos":[995,1083]},{"content":"Profile: FileIOProfiles.InBuffer","pos":[1089,1121]},{"content":"Sessions: FileIOProfiles.InBuffer.Sessions","pos":[1127,1169]},{"content":"Session: FileIOProfiles.InBuffer.Sessions<ph id=\"ph1\">\\[</ph>0<ph id=\"ph2\">\\]</ph>.Kernel<ph id=\"ph3\">\\[</ph>0","pos":[1175,1231]},{"content":"Session: FileIOProfiles.InBuffer.Sessions<ph id=\"ph1\">\\[</ph>0<ph id=\"ph2\">\\]</ph>.User<ph id=\"ph3\">\\[</ph>0","pos":[1239,1293]},{"content":"Providers: FileIOProfiles.InBuffer.Providers","pos":[1301,1345]},{"content":"Provider: FileIOProfiles.InBuffer.Providers<ph id=\"ph1\">\\[</ph>0<ph id=\"ph2\">\\]</ph>.Kernel<ph id=\"ph3\">\\[</ph>0","pos":[1351,1409]},{"content":"Provider: FileIOProfiles.InBuffer.Providers<ph id=\"ph1\">\\[</ph>0<ph id=\"ph2\">\\]</ph>.User<ph id=\"ph3\">\\[</ph>0","pos":[1417,1473]},{"pos":[1481,1607],"content":"Assuming that you chose to use a file-based trace, start an <bpt id=\"p1\">**</bpt>InSequentialFile<ept id=\"p1\">**</ept> trace profile by using the following command."},{"content":"If a problem occurs, an error is reported.","pos":[1692,1734]},{"content":"For example, starting the same profile twice would result in an error that the session is already running.","pos":[1735,1841]},{"pos":[1847,1962],"content":"Show which <bpt id=\"p1\">**</bpt>InSequentialFile<ept id=\"p1\">**</ept> loggers have already started for a specific profile by using the following command."},{"content":"The response to this command is similar to the following example.","pos":[2056,2121]},{"content":"Session Status for \"perf!GeneralProfiles.InSequentialFile\":","pos":[2127,2186]},{"content":"\"NT Kernel Logger\" : Running","pos":[2192,2220]},{"content":"PerfCoreUserSession<ph id=\"ph1\">\\_</ph>InSequentialFile : Running","pos":[2226,2273]},{"pos":[2279,2431],"content":"Stop the <bpt id=\"p1\">**</bpt>InSequentialFile<ept id=\"p1\">**</ept> trace profile, save the traces, and then merge them into a trace file, such as Merged.etl, by using the following command."},{"content":"If a problem occurs, an error is reported.","pos":[2526,2568]},{"content":"Start the <bpt id=\"p1\">**</bpt>InSequentialFile<ept id=\"p1\">**</ept> trace profile, overriding, at start time, <bpt id=\"p2\">*</bpt>MaxBuffers<ept id=\"p2\">*</ept> values for all ETW sessions, for which loggers are to be started to 256.","pos":[2574,2732]},{"content":"To perform this action, use the following command.","pos":[2733,2783]},{"content":"If a problem occurs, an error is reported.","pos":[2884,2926]},{"pos":[2932,3069],"content":"Update <bpt id=\"p1\">*</bpt>MaxBuffers<ept id=\"p1\">*</ept> values for the active <bpt id=\"p2\">**</bpt>InSequentialFile<ept id=\"p2\">**</ept> ETW loggers specified in the trace profile by using the following command."},{"content":"No response is displayed after issuing this command.","pos":[3171,3223]},{"content":"Related topics","pos":[3228,3242]},{"content":"Xperf Profiles","pos":[3246,3260]}],"content":"---\ntitle: Using Xperf Profiles\ndescription: Using Xperf Profiles\nMSHAttr:\n- 'PreferredSiteName:MSDN'\n- 'PreferredLib:/library/windows/hardware'\nms.assetid: 31673dde-fe06-4b54-afe2-f9bd9c5e60d2\nms.prod: W10\nms.mktglfcycl: operate\nms.sitesec: msdn\n---\n\n# Using Xperf Profiles\n\n\nThis section shows how to capture traces by using profiles. If you are analyzing memory, consider writing your trace to a file, because ETW writes through and does not disturb the cache. If you are analyzing disk I/O, consider saving your trace into a circular buffer in memory. There are also other considerations such as whether you need to capture a long trace, which would not fit into a buffer in memory, or if you only care about the last 5-10 seconds of the trace content.\n\n## Procedure\n\n\n1.  Select a profile such as **perf!FileIOProfiles.InBuffer** and use command similar to the following example to display information about it.\n\n    ``` syntax\n    xperf -profiles perf!FileIOProfiles.InBuffer\n    ```\n\n    This command lists all profiles, followed by the sessions and providers in that profile:\n\n    Profile: FileIOProfiles.InBuffer\n\n    Sessions: FileIOProfiles.InBuffer.Sessions\n\n    Session: FileIOProfiles.InBuffer.Sessions\\[0\\].Kernel\\[0\\]\n\n    Session: FileIOProfiles.InBuffer.Sessions\\[0\\].User\\[0\\]\n\n    Providers: FileIOProfiles.InBuffer.Providers\n\n    Provider: FileIOProfiles.InBuffer.Providers\\[0\\].Kernel\\[0\\]\n\n    Provider: FileIOProfiles.InBuffer.Providers\\[0\\].User\\[0\\]\n\n2.  Assuming that you chose to use a file-based trace, start an **InSequentialFile** trace profile by using the following command.\n\n    ``` syntax\n    xperf -start perf!GeneralProfiles.InSequentialFile\n    ```\n\n    If a problem occurs, an error is reported. For example, starting the same profile twice would result in an error that the session is already running.\n\n3.  Show which **InSequentialFile** loggers have already started for a specific profile by using the following command.\n\n    ``` syntax\n    xperf -profileloggers perf!GeneralProfiles.InSequentialFile\n    ```\n\n    The response to this command is similar to the following example.\n\n    Session Status for \"perf!GeneralProfiles.InSequentialFile\":\n\n    \"NT Kernel Logger\" : Running\n\n    PerfCoreUserSession\\_InSequentialFile : Running\n\n4.  Stop the **InSequentialFile** trace profile, save the traces, and then merge them into a trace file, such as Merged.etl, by using the following command.\n\n    ``` syntax\n    xperf -stop perf!GeneralProfiles.InSequentialFile merged.etl\n    ```\n\n    If a problem occurs, an error is reported.\n\n5.  Start the **InSequentialFile** trace profile, overriding, at start time, *MaxBuffers* values for all ETW sessions, for which loggers are to be started to 256. To perform this action, use the following command.\n\n    ``` syntax\n    xperf -start perf!GeneralProfiles.InSequentialFile -MaxBuffers 256\n    ```\n\n    If a problem occurs, an error is reported.\n\n6.  Update *MaxBuffers* values for the active **InSequentialFile** ETW loggers specified in the trace profile by using the following command.\n\n    ``` syntax\n    xperf -update perf!GeneralProfiles.InSequentialFile -MaxBuffers 256\n    ```\n\n    No response is displayed after issuing this command.\n\n## Related topics\n\n\n[Xperf Profiles](xperf-profiles.md)\n\n \n\n \n\n\n\n\n\n\n\n"}