{"nodes":[{"content":"Results for the Internet Explorer Startup Performance Assessment","pos":[11,75]},{"content":"Results for the Internet Explorer Startup Performance Assessment","pos":[89,153]},{"content":"Results for the Internet Explorer Startup Performance Assessment","pos":[339,403]},{"content":"The Internet Explorer Startup Performance assessment can help you evaluate the activities that are performed during the creation of a new Internet Explorer window.","pos":[406,569]},{"content":"The assessment measures the time that it takes to fully render a new Internet Explorer window on the desktop, with a single tab and simple content.","pos":[570,717]},{"content":"This measurement includes the load time of the IExplore.exe process and the frame-creation and tab-creation intervals.","pos":[718,836]},{"content":"It also measures the performance of extensions which are loaded and initialized during startup.","pos":[838,933]},{"content":"There are several types of extensions, including shortcut menus, toolbars, Explorer Bars, and Browser Helper Objects (BHOs).","pos":[934,1058]},{"content":"To see the types of extensions that are installed on a computer, in Internet Explorer, in the <bpt id=\"p1\">**</bpt>Manage Add-ons<ept id=\"p1\">**</ept> dialog, right-choose the column header, choose <bpt id=\"p2\">**</bpt>Columns<ept id=\"p2\">**</ept> and then choose <bpt id=\"p3\">**</bpt>Type<ept id=\"p3\">**</ept>.","pos":[1059,1256]},{"content":"This topic can help you interpret the results produced by the Internet Explorer Startup Performance assessment.","pos":[1258,1369]},{"content":"It also provides guidance on how to use the results to identify and resolve common issues that negatively affect your experience while starting Internet Explorer.","pos":[1370,1532]},{"content":"In this topic:","pos":[1534,1548]},{"content":"Goals File","pos":[1555,1565]},{"content":"Metrics","pos":[1586,1593]},{"content":"Issues","pos":[1625,1631]},{"pos":[1657,1815],"content":"For more information about system requirements and assessment settings, see <bpt id=\"p1\">[</bpt>Internet Explorer Startup Performance<ept id=\"p1\">](internet-explorer-startup-performance.md)</ept>."},{"pos":[1851,1861],"content":"Goals File"},{"content":"You can create custom goals to measure your improvements in the Results View.","pos":[1864,1941]},{"content":"Goals files are a triage tool that can help you understand how a PC is performing and to compare PCs in your business.","pos":[1942,2060]},{"content":"For example, goals for a basic laptop might be different than the goals you set for a high end desktop computer, or market expectations might change in such a way that you want the flexibility to define different goals and key requirements as time passes and technology improves.","pos":[2062,2341]},{"content":"When a metric value is compared to the goal for that metric, the status is color coded in the Result View as follows:","pos":[2343,2460]},{"content":"Light purple means that the system has a great user experience and that there are no perceived problems.","pos":[2466,2570]},{"content":"Medium purple means that the user experience is tolerable and you can optimize the system.","pos":[2576,2666]},{"content":"Review the recommendations and analysis to see what improvements can be made to the system.","pos":[2667,2758]},{"content":"These can be software changes, configuration changes or hardware changes.","pos":[2759,2832]},{"content":"Dark purple means that the system has a poor user experience and that there is significant room for improvements.","pos":[2838,2951]},{"content":"Review the recommendations and analysis to see the improvements that can be made to the system.","pos":[2952,3047]},{"content":"These can be software changes, configuration changes or hardware changes.","pos":[3048,3121]},{"content":"You might have to consider making tradeoffs to deliver a high quality Windows experience.","pos":[3122,3211]},{"content":"No color means that there are no goals defined for the metric.","pos":[3217,3279]},{"content":"Note","pos":[3283,3287]},{"content":"In the Windows Assessment Toolkit for Windows 8, some assessments include default goals files.","pos":[3292,3386]},{"content":"The first time you view results using this version of the tools, the default goals file is used.","pos":[3387,3483]},{"content":"However, you can also define custom goals for Windows 8 the same way that you can for Windows 8.1 and Windows 10.","pos":[3484,3597]},{"content":"You can set the goals file location and add a goals file to that location before you can use the UI to apply the custom goals.","pos":[3602,3728]},{"content":"Once a goals file is selected it will continue to be the goals file that is used for any results that are opened.","pos":[3729,3842]},{"content":"Only one goals file can be used at a time.","pos":[3844,3886]},{"content":"Goals for all assessments are set in a single goals file.","pos":[3887,3944]},{"content":"The assessment tools will search for goals in the following order:","pos":[3945,4011]},{"content":"A custom goals file","pos":[4017,4036]},{"content":"Goals that are defined in the results file","pos":[4042,4084]},{"content":"Goals that are defined in the assessment manifest","pos":[4090,4139]},{"content":"You can use the sample goals file that is provided at %PROGRAMFILES%<ph id=\"ph1\">\\\\</ph>Windows Kits<ph id=\"ph2\">\\\\</ph>10<ph id=\"ph3\">\\\\</ph>Assessment and Deployment Kit<ph id=\"ph4\">\\\\</ph>Windows Assessment Toolkit<ph id=\"ph5\">\\\\</ph>SDK<ph id=\"ph6\">\\\\</ph>Samples<ph id=\"ph7\">\\\\</ph>Goals to create your own goals file.","pos":[4141,4338]},{"content":"Note","pos":[4342,4346]},{"content":"You cannot package a goals file with a job, but you can store it on a share for others to use.","pos":[4351,4445]},{"pos":[4495,4502],"content":"Metrics"},{"content":"This section describes the metrics reported by the Internet Explorer Startup assessment, common causes of poor results for each metric and possible remediation for these issues.","pos":[4505,4682]},{"content":"The metrics are aligned with the stages of Internet Explorer startup.","pos":[4683,4752]},{"content":"There are six stages of Internet Explorer Startup: process creation, frame creation, tab creation, extension creation (CoCreateInstance), extension initialization (Set Site), and show docking window (for some extension types).","pos":[4753,4979]},{"content":"The corresponding metrics are covered here.","pos":[4980,5023]},{"content":"Note","pos":[5027,5031]},{"content":"The top-level <bpt id=\"p1\">**</bpt>IE Startup Duration<ept id=\"p1\">**</ept> metric is comprehensive and includes tasks that run after the process, frame, and tab are created.","pos":[5036,5172]},{"content":"Create Internet Explorer Process","pos":[5182,5214]},{"content":"Internet Explorer Frame Create","pos":[5246,5276]},{"content":"Internet Explorer Tab Create","pos":[5305,5333]},{"content":"Create Extensions Addon Count","pos":[5360,5389]},{"content":"Set Site for Extensions","pos":[5420,5443]},{"content":"Extension Toolbar Show Docking Window","pos":[5471,5508]},{"content":"Note","pos":[5537,5541]},{"content":"If you enabled the Enable Minifilter Diagnostic Mode setting, the assessment results will include minifilter metrics.","pos":[5546,5663]},{"content":"For more information about minifilter metrics and results, see <bpt id=\"p1\">[</bpt>Minifilter Diagnostics<ept id=\"p1\">](minifilter-diagnostics.md)</ept>.","pos":[5664,5779]},{"pos":[5830,5862],"content":"Create Internet Explorer Process"},{"pos":[5864,5942],"content":"<bpt id=\"p1\">**</bpt>Most applicable to:<ept id=\"p1\">**</ept> Equipment manufacturers, Anti-malware software vendors"},{"content":"This metric measures the time that it takes to create the Internet Explorer process.","pos":[5944,6028]},{"content":"This includes the interval of time from when the operating system begins to load and execute iexplorer.exe, to when Internet Explorer signals that it has begun the Create Frame stage of initialization.","pos":[6029,6230]},{"content":"Or, the interval of time from when iexplorer.exe is launched (as reported by the Windows kernel) until the Create Frame stage is started (as reported by Internet Explorer).","pos":[6231,6403]},{"content":"Typical Influencing Factors","pos":[6407,6434]},{"content":"CPU speed","pos":[6442,6451]},{"content":"Anti-malware","pos":[6457,6469]},{"content":"Analysis and Remediation Steps","pos":[6473,6503]},{"content":"If the assessment is consistently reporting that this stage is taking too long, then in-depth analysis in WPA to find the root cause is recommended.","pos":[6507,6655]},{"pos":[6700,6730],"content":"Internet Explorer Frame Create"},{"pos":[6732,6835],"content":"<bpt id=\"p1\">**</bpt>Most applicable to:<ept id=\"p1\">**</ept> Equipment manufacturers, Anti-malware software vendors, Video driver developers"},{"content":"This metric measures the time that it takes to fully render a window frame in Internet Explorer, including the interval of time from startup before Internet Explorer creates the first tab and before it loads or initializes any extensions, including creating a top-level window (frame) and initializing Direct3D rendering within that window.","pos":[6837,7177]},{"content":"The Internet Explorer frame is the parent process and UI container for the tabs in a single top-level Internet Explorer window.","pos":[7178,7305]},{"content":"Tabs are hosted in a separate process, but the parent process is responsible for emitting the tracing events that are used for assessment analysis.","pos":[7306,7453]},{"content":"Typical Influencing Factors","pos":[7457,7484]},{"content":"CPU speed","pos":[7492,7501]},{"content":"Anti-malware","pos":[7507,7519]},{"content":"Video driver","pos":[7525,7537]},{"content":"Analysis and Remediation Steps","pos":[7541,7571]},{"content":"If the assessment is consistently reporting that the duration of Internet Explorer Frame Create is taking too long, follow the WPA further analysis link to see advanced details and find the root cause.","pos":[7575,7776]},{"pos":[7819,7847],"content":"Internet Explorer Tab Create"},{"pos":[7849,7926],"content":"<bpt id=\"p1\">**</bpt>Most applicable to:<ept id=\"p1\">**</ept> Equipment manufacturers, Antimalware software vendors"},{"content":"This metric measures the time that it takes to create a new tab in Internet Explorer, including the interval of time for creating and initializing a tab in a frame, as well as creating and initializing all of its extensions.","pos":[7928,8152]},{"content":"The tab is the process and UI container for a single tab and its content.","pos":[8153,8226]},{"content":"There is always at least one tab, although multiple tabs may be hosted in the same process.","pos":[8227,8318]},{"content":"Extensions are created and initialized in the tab’s process.","pos":[8319,8379]},{"content":"Typical Influencing Factors","pos":[8383,8410]},{"content":"CPU speed","pos":[8418,8427]},{"content":"Antimalware","pos":[8433,8444]},{"content":"Extensions","pos":[8450,8460]},{"content":"Analysis and Remediation Steps","pos":[8464,8494]},{"content":"For analysis of extension performance, we recommend that you focus on the various extension-related metrics such as Create and Set Site.","pos":[8498,8634]},{"content":"However, if this stage is consistently being reported as taking too long, but the performance of individual extensions is not being flagged, follow the WPA further analysis link to see advanced details and find the root cause.","pos":[8635,8861]},{"pos":[8908,8937],"content":"Create Extensions Addon Count"},{"pos":[8939,9017],"content":"<bpt id=\"p1\">**</bpt>Most applicable to:<ept id=\"p1\">**</ept> Equipment manufacturers, Anti-malware software vendors"},{"content":"This metric enumerates Internet Explorer Add-ons involved in the CreateExtension action.","pos":[9019,9107]},{"content":"You can expand this metric to see a list of each extension and their corresponding durations.","pos":[9108,9201]},{"content":"For each, the time that it takes to instantiate an extension using CoCreateInstance() is measured.","pos":[9202,9300]},{"content":"This also includes the time to load the extension’s DLL and any of its static DLL dependencies.","pos":[9301,9396]},{"content":"When Internet Explorer initializes an add-on, it first calls the CoCreateInstance() function with the add-on’s CLSID, which in turn invokes the add-on module’s DllGetClassObject() function to create an object in memory.","pos":[9397,9616]},{"content":"Add-ons do not typically incur a performance delay during this function call.","pos":[9617,9694]},{"content":"However, it’s important to focus on this function call while optimizing startup performance because slow performance can be related to add-ons.","pos":[9695,9838]},{"content":"Typical Influencing Factors","pos":[9842,9869]},{"content":"CPU speed","pos":[9877,9886]},{"content":"DLL dependencies","pos":[9892,9908]},{"content":"Synchronous or blocking I/O operations (disk or network)","pos":[9914,9970]},{"content":"Antimalware","pos":[9976,9987]},{"content":"Analysis and Remediation Steps","pos":[9991,10021]},{"content":"An extension should not do very much during this stage, therefore any non-trivial amount of time spent here can be an issue.","pos":[10025,10149]},{"content":"For equipment manufacturers, you may have to uninstall the extension.","pos":[10150,10219]},{"content":"For extension authors, in-depth analysis in WPA is recommended in addition to a code review of the following areas of the code for the extension:","pos":[10220,10365]},{"pos":[10371,10478],"content":"<bpt id=\"p1\">**</bpt>DllMain<ept id=\"p1\">**</ept>: It is uncommon for the DllMain method to spend a non-trivial amount of time during this stage."},{"pos":[10484,10611],"content":"<bpt id=\"p1\">**</bpt>DllGetClassObject<ept id=\"p1\">**</ept>: It is uncommon for the DllGetClassObject method to spend a non-trivial amount of time during this stage."},{"pos":[10617,10818],"content":"<bpt id=\"p1\">**</bpt>Class constructor (C++) (or equivalent)<ept id=\"p1\">**</ept>: An extension should not do much during creation, which includes the constructor for the class that is being constructed (the class identified by the CLSID)."},{"content":"<bpt id=\"p1\">**</bpt>Static DLL dependencies<ept id=\"p1\">**</ept>: These are DLLs that have at least one static import demand from the extension DLL.","pos":[10824,10935]},{"content":"They must be loaded and resolved before Windows will return from the LoadLibrary() call made from Internet Explorer, regardless of whether they are actually used.","pos":[10936,11098]},{"content":"This does not include DLLs that are delay loaded, either by using /DELAYLOAD or LoadLibrary().","pos":[11104,11198]},{"content":"If a specific DLL is only occasionally used, or is not used at startup or during initialization, consider using /DELAYLOAD.","pos":[11204,11327]},{"content":"<bpt id=\"p1\">**</bpt>Dynamic DLL dependencies<ept id=\"p1\">**</ept>: If the extension calls the LoadLibrary() API, or calls into a DLL that is in the /DELAYLOAD list, then that usage should be reviewed to determine if it can be deferred until later.","pos":[11333,11543]},{"content":"If a DLL is delay loaded, but is always used at startup or during initialization, consider removing it from the /DELAYLOAD list.","pos":[11544,11672]},{"pos":[11678,12064],"content":"**Note**  \nThis should not be done for any Windows APIs that are called depending on which version of Windows is running; those should always be delay loaded. For instance, if an extension uses DirectWrite for text rendering and uses GDI as a fallback, then it should not statically link to dwrite.dll. Doing so can completely prevent it from loading on earlier versions of Windows.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"This should not be done for any Windows APIs that are called depending on which version of Windows is running; those should always be delay loaded. For instance, if an extension uses DirectWrite for text rendering and uses GDI as a fallback, then it should not statically link to dwrite.dll. Doing so can completely prevent it from loading on earlier versions of Windows.","pos":[11,382],"nodes":[{"content":"This should not be done for any Windows APIs that are called depending on which version of Windows is running; those should always be delay loaded.","pos":[0,147]},{"content":"For instance, if an extension uses DirectWrite for text rendering and uses GDI as a fallback, then it should not statically link to dwrite.dll.","pos":[148,291]},{"content":"Doing so can completely prevent it from loading on earlier versions of Windows.","pos":[292,371]}]}]},{"content":"Additional Information","pos":[12075,12097]},{"content":"MSDN: /DELAYLOAD (Delay Load Import)","pos":[12102,12138]},{"pos":[12232,12255],"content":"Set Site for Extensions"},{"pos":[12257,12323],"content":"<bpt id=\"p1\">**</bpt>Most applicable to:<ept id=\"p1\">**</ept> Extension authors, Equipment manufacturers"},{"content":"This metric enumerates Internet Explorer Addons involved in the SetSite action.","pos":[12325,12404]},{"content":"You can expand this metric to see a list of each extension and their corresponding durations.","pos":[12405,12498]},{"content":"For each, the time that it takes for Internet Explorer to call into the extension’s IObjectWithSite::SetSite() method is measured.","pos":[12499,12629]},{"content":"This method establishes the extension’s ability to communicate with Internet Explorer.","pos":[12630,12716]},{"content":"Extensions typically perform the bulk of startup/initialization here.","pos":[12717,12786]},{"content":"This establishes the add-on’s initial communication with Internet Explorer, and is exposed by the IObjectWithSite interface which all Internet Explorer add-ons must implement.","pos":[12787,12962]},{"content":"Add-ons typically run their initialization routines in this function such as displaying toolbar UI or loading other modules.","pos":[12963,13087]},{"content":"Typical Influencing Factors","pos":[13091,13118]},{"content":"This is typically influenced only by the extension’s implementation of IObjectWithSite::SetSite().","pos":[13122,13220]},{"content":"It is important avoid synchronous/blocking disk or network I/O as much as possible during this method.","pos":[13221,13323]},{"content":"Analysis and Remediation Steps","pos":[13327,13357]},{"content":"For equipment manufacturers, you may have to uninstall the extension.","pos":[13361,13430]},{"content":"For extension authors, in-depth analysis with WPA is recommended in addition to a code review of the IObjectWithSite::SetSite() implementation.","pos":[13431,13574]},{"content":"There could be portions of this code which can be deferred until a later time, or perhaps performed asynchronously so that they can run in parallel with the initialization of other plugins.","pos":[13575,13764]},{"content":"Additional Information","pos":[13768,13790]},{"content":"MSDN: IObjectWithSite Interface","pos":[13795,13826]},{"pos":[13924,13961],"content":"Extension Toolbar Show Docking Window"},{"pos":[13963,14063],"content":"<bpt id=\"p1\">**</bpt>Most applicable to:<ept id=\"p1\">**</ept> Extension authors (toolbars and Explorer bars only), Equipment manufacturers"},{"content":"This metric enumerates Internet Explorer Addons that display a separate toolbar.","pos":[14065,14145]},{"content":"You can expand this metric to see a list of each extension and their corresponding durations.","pos":[14146,14239]},{"content":"For each of these, the interval of time that is spent in the IDockingWindow::ShowDW() implementation is measured.","pos":[14240,14353]},{"content":"If the add-on being initialized is a Toolbar or Explorer Bar, Internet Explorer calls the add-on’s IDockingWindow::ShowDW() function to make the add-on visible on the browser window.","pos":[14354,14536]},{"content":"Some add-ons choose to run their UI rendering code within this function, therefore it can also affect startup performance.","pos":[14537,14659]},{"content":"Typical Influencing Factors","pos":[14663,14690]},{"content":"CPU speed","pos":[14698,14707]},{"content":"Complexity of the UI being shown or initialized","pos":[14713,14760]},{"content":"Analysis and Remediation Steps","pos":[14764,14794]},{"content":"For equipment manufacturers, you may have to uninstall the addon.","pos":[14798,14863]},{"content":"For extension authors, in-depth analysis with WPA is recommended in addition to a code review of the IDockingWindow::ShowDW() implementation.","pos":[14864,15005]},{"content":"If the extension is running UI rendering code, for example WM<ph id=\"ph1\">\\_</ph>PAINT, it may be possible to defer it until later, depending on how the extension has been written.","pos":[15007,15169]},{"content":"If it is not possible or feasible to avoid rendering code (WM<ph id=\"ph1\">\\_</ph>PAINT) during this stage, you can try to defer rendering with the following strategy or something similar.","pos":[15170,15339]},{"content":"After creating and displaying the main HWND for the extension’s UI, but before you add any child windows to it, use SendMessage to send it a WM<ph id=\"ph1\">\\_</ph>SETREDRAW message with wParam equal to FALSE.","pos":[15345,15535]},{"pos":[15541,15726],"content":"**Warning**  \nThis will temporarily disable all painting for the window. This should be used carefully; if it is used incorrectly, it can cause problems that are difficult to debug.","leadings":["","    "],"nodes":[{"content":"Warning","pos":[2,9]},{"content":"This will temporarily disable all painting for the window. This should be used carefully; if it is used incorrectly, it can cause problems that are difficult to debug.","pos":[14,181],"nodes":[{"content":"This will temporarily disable all painting for the window.","pos":[0,58]},{"content":"This should be used carefully; if it is used incorrectly, it can cause problems that are difficult to debug.","pos":[59,167]}]}]},{"content":"Next, create and add the child windows or content.","pos":[15739,15789]},{"content":"Send the window another WM<ph id=\"ph1\">\\_</ph>SETREDRAW message with wParam equal to TRUE.","pos":[15795,15867]},{"content":"Use InvalidateRect or RedrawWindow to redraw the window.","pos":[15873,15929]},{"content":"Return from IDockingWindow::ShowDW().","pos":[15935,15972]},{"content":"Additional Information","pos":[15976,15998]},{"content":"MSDN: IDockingWindow::ShowDW method","pos":[16003,16038]},{"content":"MSDN: WM<ph id=\"ph1\">\\_</ph>SETREDRAW message","pos":[16107,16134]},{"pos":[16243,16249],"content":"Issues"},{"content":"The Internet Explorer Startup Performance assessment performs advanced issue analysis and provides links to Windows® Performance Analyzer (WPA) to troubleshoot the issues that are identified.","pos":[16252,16443]},{"content":"When WPA opens additional details about disk activity or CPU activity might be available depending on the type of issue identified.","pos":[16444,16575]},{"content":"For more information about in-depth analysis issues and recommendations see, <bpt id=\"p1\">[</bpt>Common In-Depth Analysis Issues<ept id=\"p1\">](common-in-depth-analysis-issues.md)</ept>.","pos":[16576,16723]},{"content":"The assessment reports an exit code of 0x80050006","pos":[16729,16778]},{"content":"This error occurs when maintenance tasks have been registered on the PC but have not completed before the assessment run.","pos":[16780,16901]},{"content":"This prevents the assessment from running, as maintenance tasks often impact assessment metrics.","pos":[16902,16998]},{"content":"To resolve this issue, do one of the following:","pos":[17000,17047]},{"content":"Ensure that the computer is connected to a network and is running on AC power.","pos":[17053,17131]},{"content":"Manually initiate pending maintenance tasks with the following command from an elevated prompt:","pos":[17132,17227]},{"content":"Disable regular and idle maintenance tasks, and stop all maintenance tasks before running the assessment.","pos":[17283,17388]},{"content":"Related topics","pos":[17393,17407]},{"content":"Internet Explorer Startup Performance","pos":[17411,17448]},{"content":"Assessments","pos":[17494,17505]},{"content":"On/Off Transition Performance","pos":[17525,17554]}],"content":"---\ntitle: Results for the Internet Explorer Startup Performance Assessment\ndescription: Results for the Internet Explorer Startup Performance Assessment\nMSHAttr:\n- 'PreferredSiteName:MSDN'\n- 'PreferredLib:/library/windows/hardware'\nms.assetid: c61f4af5-a8ac-4671-98ca-97aaf72bd4f0\nms.prod: W10\nms.mktglfcycl: plan\nms.sitesec: msdn\n---\n\n# Results for the Internet Explorer Startup Performance Assessment\n\n\nThe Internet Explorer Startup Performance assessment can help you evaluate the activities that are performed during the creation of a new Internet Explorer window. The assessment measures the time that it takes to fully render a new Internet Explorer window on the desktop, with a single tab and simple content. This measurement includes the load time of the IExplore.exe process and the frame-creation and tab-creation intervals.\n\nIt also measures the performance of extensions which are loaded and initialized during startup. There are several types of extensions, including shortcut menus, toolbars, Explorer Bars, and Browser Helper Objects (BHOs). To see the types of extensions that are installed on a computer, in Internet Explorer, in the **Manage Add-ons** dialog, right-choose the column header, choose **Columns** and then choose **Type**.\n\nThis topic can help you interpret the results produced by the Internet Explorer Startup Performance assessment. It also provides guidance on how to use the results to identify and resolve common issues that negatively affect your experience while starting Internet Explorer.\n\nIn this topic:\n\n-   [Goals File](#bkmk-goals)\n\n-   [Metrics](#bkmk-iestartupmetrics)\n\n-   [Issues](#bkmk-iestartupissues)\n\nFor more information about system requirements and assessment settings, see [Internet Explorer Startup Performance](internet-explorer-startup-performance.md).\n\n## <a href=\"\" id=\"bkmk-goals\"></a>Goals File\n\n\nYou can create custom goals to measure your improvements in the Results View. Goals files are a triage tool that can help you understand how a PC is performing and to compare PCs in your business.\n\nFor example, goals for a basic laptop might be different than the goals you set for a high end desktop computer, or market expectations might change in such a way that you want the flexibility to define different goals and key requirements as time passes and technology improves.\n\nWhen a metric value is compared to the goal for that metric, the status is color coded in the Result View as follows:\n\n-   Light purple means that the system has a great user experience and that there are no perceived problems.\n\n-   Medium purple means that the user experience is tolerable and you can optimize the system. Review the recommendations and analysis to see what improvements can be made to the system. These can be software changes, configuration changes or hardware changes.\n\n-   Dark purple means that the system has a poor user experience and that there is significant room for improvements. Review the recommendations and analysis to see the improvements that can be made to the system. These can be software changes, configuration changes or hardware changes. You might have to consider making tradeoffs to deliver a high quality Windows experience.\n\n-   No color means that there are no goals defined for the metric.\n\n**Note**  \nIn the Windows Assessment Toolkit for Windows 8, some assessments include default goals files. The first time you view results using this version of the tools, the default goals file is used. However, you can also define custom goals for Windows 8 the same way that you can for Windows 8.1 and Windows 10.\n\n \n\nYou can set the goals file location and add a goals file to that location before you can use the UI to apply the custom goals. Once a goals file is selected it will continue to be the goals file that is used for any results that are opened.\n\nOnly one goals file can be used at a time. Goals for all assessments are set in a single goals file. The assessment tools will search for goals in the following order:\n\n1.  A custom goals file\n\n2.  Goals that are defined in the results file\n\n3.  Goals that are defined in the assessment manifest\n\nYou can use the sample goals file that is provided at %PROGRAMFILES%\\\\Windows Kits\\\\10\\\\Assessment and Deployment Kit\\\\Windows Assessment Toolkit\\\\SDK\\\\Samples\\\\Goals to create your own goals file.\n\n**Note**  \nYou cannot package a goals file with a job, but you can store it on a share for others to use.\n\n \n\n## <a href=\"\" id=\"bkmk-iestartupmetrics\"></a>Metrics\n\n\nThis section describes the metrics reported by the Internet Explorer Startup assessment, common causes of poor results for each metric and possible remediation for these issues. The metrics are aligned with the stages of Internet Explorer startup. There are six stages of Internet Explorer Startup: process creation, frame creation, tab creation, extension creation (CoCreateInstance), extension initialization (Set Site), and show docking window (for some extension types). The corresponding metrics are covered here.\n\n**Note**  \nThe top-level **IE Startup Duration** metric is comprehensive and includes tasks that run after the process, frame, and tab are created.\n\n \n\n-   [Create Internet Explorer Process](#bkmkl-createieprocess)\n\n-   [Internet Explorer Frame Create](#bkmk-ieframecreate)\n\n-   [Internet Explorer Tab Create](#bkmk-ietabcreate)\n\n-   [Create Extensions Addon Count](#bkmk-createextension)\n\n-   [Set Site for Extensions](#bkmk-setextension)\n\n-   [Extension Toolbar Show Docking Window](#bkmk-extensiontoolbar)\n\n**Note**  \nIf you enabled the Enable Minifilter Diagnostic Mode setting, the assessment results will include minifilter metrics. For more information about minifilter metrics and results, see [Minifilter Diagnostics](minifilter-diagnostics.md).\n\n \n\n### <a href=\"\" id=\"bkmkl-createieprocess\"></a>Create Internet Explorer Process\n\n**Most applicable to:** Equipment manufacturers, Anti-malware software vendors\n\nThis metric measures the time that it takes to create the Internet Explorer process. This includes the interval of time from when the operating system begins to load and execute iexplorer.exe, to when Internet Explorer signals that it has begun the Create Frame stage of initialization. Or, the interval of time from when iexplorer.exe is launched (as reported by the Windows kernel) until the Create Frame stage is started (as reported by Internet Explorer).\n\n**Typical Influencing Factors**\n\n-   CPU speed\n\n-   Anti-malware\n\n**Analysis and Remediation Steps**\n\nIf the assessment is consistently reporting that this stage is taking too long, then in-depth analysis in WPA to find the root cause is recommended.\n\n### <a href=\"\" id=\"bkmk-ieframecreate\"></a>Internet Explorer Frame Create\n\n**Most applicable to:** Equipment manufacturers, Anti-malware software vendors, Video driver developers\n\nThis metric measures the time that it takes to fully render a window frame in Internet Explorer, including the interval of time from startup before Internet Explorer creates the first tab and before it loads or initializes any extensions, including creating a top-level window (frame) and initializing Direct3D rendering within that window. The Internet Explorer frame is the parent process and UI container for the tabs in a single top-level Internet Explorer window. Tabs are hosted in a separate process, but the parent process is responsible for emitting the tracing events that are used for assessment analysis.\n\n**Typical Influencing Factors**\n\n-   CPU speed\n\n-   Anti-malware\n\n-   Video driver\n\n**Analysis and Remediation Steps**\n\nIf the assessment is consistently reporting that the duration of Internet Explorer Frame Create is taking too long, follow the WPA further analysis link to see advanced details and find the root cause.\n\n### <a href=\"\" id=\"bkmk-ietabcreate\"></a>Internet Explorer Tab Create\n\n**Most applicable to:** Equipment manufacturers, Antimalware software vendors\n\nThis metric measures the time that it takes to create a new tab in Internet Explorer, including the interval of time for creating and initializing a tab in a frame, as well as creating and initializing all of its extensions. The tab is the process and UI container for a single tab and its content. There is always at least one tab, although multiple tabs may be hosted in the same process. Extensions are created and initialized in the tab’s process.\n\n**Typical Influencing Factors**\n\n-   CPU speed\n\n-   Antimalware\n\n-   Extensions\n\n**Analysis and Remediation Steps**\n\nFor analysis of extension performance, we recommend that you focus on the various extension-related metrics such as Create and Set Site. However, if this stage is consistently being reported as taking too long, but the performance of individual extensions is not being flagged, follow the WPA further analysis link to see advanced details and find the root cause.\n\n### <a href=\"\" id=\"bkmk-createextension\"></a>Create Extensions Addon Count\n\n**Most applicable to:** Equipment manufacturers, Anti-malware software vendors\n\nThis metric enumerates Internet Explorer Add-ons involved in the CreateExtension action. You can expand this metric to see a list of each extension and their corresponding durations. For each, the time that it takes to instantiate an extension using CoCreateInstance() is measured. This also includes the time to load the extension’s DLL and any of its static DLL dependencies. When Internet Explorer initializes an add-on, it first calls the CoCreateInstance() function with the add-on’s CLSID, which in turn invokes the add-on module’s DllGetClassObject() function to create an object in memory. Add-ons do not typically incur a performance delay during this function call. However, it’s important to focus on this function call while optimizing startup performance because slow performance can be related to add-ons.\n\n**Typical Influencing Factors**\n\n-   CPU speed\n\n-   DLL dependencies\n\n-   Synchronous or blocking I/O operations (disk or network)\n\n-   Antimalware\n\n**Analysis and Remediation Steps**\n\nAn extension should not do very much during this stage, therefore any non-trivial amount of time spent here can be an issue. For equipment manufacturers, you may have to uninstall the extension. For extension authors, in-depth analysis in WPA is recommended in addition to a code review of the following areas of the code for the extension:\n\n-   **DllMain**: It is uncommon for the DllMain method to spend a non-trivial amount of time during this stage.\n\n-   **DllGetClassObject**: It is uncommon for the DllGetClassObject method to spend a non-trivial amount of time during this stage.\n\n-   **Class constructor (C++) (or equivalent)**: An extension should not do much during creation, which includes the constructor for the class that is being constructed (the class identified by the CLSID).\n\n-   **Static DLL dependencies**: These are DLLs that have at least one static import demand from the extension DLL. They must be loaded and resolved before Windows will return from the LoadLibrary() call made from Internet Explorer, regardless of whether they are actually used.\n\n    This does not include DLLs that are delay loaded, either by using /DELAYLOAD or LoadLibrary().\n\n    If a specific DLL is only occasionally used, or is not used at startup or during initialization, consider using /DELAYLOAD.\n\n-   **Dynamic DLL dependencies**: If the extension calls the LoadLibrary() API, or calls into a DLL that is in the /DELAYLOAD list, then that usage should be reviewed to determine if it can be deferred until later. If a DLL is delay loaded, but is always used at startup or during initialization, consider removing it from the /DELAYLOAD list.\n\n    **Note**  \n    This should not be done for any Windows APIs that are called depending on which version of Windows is running; those should always be delay loaded. For instance, if an extension uses DirectWrite for text rendering and uses GDI as a fallback, then it should not statically link to dwrite.dll. Doing so can completely prevent it from loading on earlier versions of Windows.\n\n     \n\n**Additional Information**\n\n[MSDN: /DELAYLOAD (Delay Load Import)](http://msdn.microsoft.com/library/yx9zd12s.aspx)\n\n### <a href=\"\" id=\"bkmk-setextension\"></a>Set Site for Extensions\n\n**Most applicable to:** Extension authors, Equipment manufacturers\n\nThis metric enumerates Internet Explorer Addons involved in the SetSite action. You can expand this metric to see a list of each extension and their corresponding durations. For each, the time that it takes for Internet Explorer to call into the extension’s IObjectWithSite::SetSite() method is measured. This method establishes the extension’s ability to communicate with Internet Explorer. Extensions typically perform the bulk of startup/initialization here. This establishes the add-on’s initial communication with Internet Explorer, and is exposed by the IObjectWithSite interface which all Internet Explorer add-ons must implement. Add-ons typically run their initialization routines in this function such as displaying toolbar UI or loading other modules.\n\n**Typical Influencing Factors**\n\nThis is typically influenced only by the extension’s implementation of IObjectWithSite::SetSite(). It is important avoid synchronous/blocking disk or network I/O as much as possible during this method.\n\n**Analysis and Remediation Steps**\n\nFor equipment manufacturers, you may have to uninstall the extension. For extension authors, in-depth analysis with WPA is recommended in addition to a code review of the IObjectWithSite::SetSite() implementation. There could be portions of this code which can be deferred until a later time, or perhaps performed asynchronously so that they can run in parallel with the initialization of other plugins.\n\n**Additional Information**\n\n[MSDN: IObjectWithSite Interface](http://msdn.microsoft.com/library/aa768220.aspx)\n\n### <a href=\"\" id=\"bkmk-extensiontoolbar\"></a>Extension Toolbar Show Docking Window\n\n**Most applicable to:** Extension authors (toolbars and Explorer bars only), Equipment manufacturers\n\nThis metric enumerates Internet Explorer Addons that display a separate toolbar. You can expand this metric to see a list of each extension and their corresponding durations. For each of these, the interval of time that is spent in the IDockingWindow::ShowDW() implementation is measured. If the add-on being initialized is a Toolbar or Explorer Bar, Internet Explorer calls the add-on’s IDockingWindow::ShowDW() function to make the add-on visible on the browser window. Some add-ons choose to run their UI rendering code within this function, therefore it can also affect startup performance.\n\n**Typical Influencing Factors**\n\n-   CPU speed\n\n-   Complexity of the UI being shown or initialized\n\n**Analysis and Remediation Steps**\n\nFor equipment manufacturers, you may have to uninstall the addon. For extension authors, in-depth analysis with WPA is recommended in addition to a code review of the IDockingWindow::ShowDW() implementation.\n\nIf the extension is running UI rendering code, for example WM\\_PAINT, it may be possible to defer it until later, depending on how the extension has been written. If it is not possible or feasible to avoid rendering code (WM\\_PAINT) during this stage, you can try to defer rendering with the following strategy or something similar.\n\n1.  After creating and displaying the main HWND for the extension’s UI, but before you add any child windows to it, use SendMessage to send it a WM\\_SETREDRAW message with wParam equal to FALSE.\n\n    **Warning**  \n    This will temporarily disable all painting for the window. This should be used carefully; if it is used incorrectly, it can cause problems that are difficult to debug.\n\n     \n\n2.  Next, create and add the child windows or content.\n\n3.  Send the window another WM\\_SETREDRAW message with wParam equal to TRUE.\n\n4.  Use InvalidateRect or RedrawWindow to redraw the window.\n\n5.  Return from IDockingWindow::ShowDW().\n\n**Additional Information**\n\n[MSDN: IDockingWindow::ShowDW method](http://msdn.microsoft.com/library/windows/desktop/bb762050.aspx)\n\n[MSDN: WM\\_SETREDRAW message](http://msdn.microsoft.com/library/dd145219%28v=vs.85%29.aspx)\n\n## <a href=\"\" id=\"bkmk-iestartupissues\"></a>Issues\n\n\nThe Internet Explorer Startup Performance assessment performs advanced issue analysis and provides links to Windows® Performance Analyzer (WPA) to troubleshoot the issues that are identified. When WPA opens additional details about disk activity or CPU activity might be available depending on the type of issue identified. For more information about in-depth analysis issues and recommendations see, [Common In-Depth Analysis Issues](common-in-depth-analysis-issues.md).\n\n### The assessment reports an exit code of 0x80050006\n\nThis error occurs when maintenance tasks have been registered on the PC but have not completed before the assessment run. This prevents the assessment from running, as maintenance tasks often impact assessment metrics.\n\nTo resolve this issue, do one of the following:\n\n1.  Ensure that the computer is connected to a network and is running on AC power. Manually initiate pending maintenance tasks with the following command from an elevated prompt:\n\n    `rundll32.exe advapi32.dll,ProcessIdleTasks`\n\n2.  Disable regular and idle maintenance tasks, and stop all maintenance tasks before running the assessment.\n\n## Related topics\n\n\n[Internet Explorer Startup Performance](internet-explorer-startup-performance.md)\n\n[Assessments](assessments.md)\n\n[On/Off Transition Performance](onoff-transition-performance.md)\n\n \n\n \n\n\n\n\n\n\n\n"}