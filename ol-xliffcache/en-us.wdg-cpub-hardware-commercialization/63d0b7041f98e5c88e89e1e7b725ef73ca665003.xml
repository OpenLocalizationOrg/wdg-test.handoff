{"nodes":[{"content":"Microsoft will provide update packages to Windows 10 that need to be installed on your customized Windows images.","pos":[35,148]},{"content":"Add the zero-day package (ZDP) to your existing Windows 10 images to provide your users with the latest updates.","pos":[149,261]},{"content":"Add updates to customized Windows images","pos":[369,409]},{"content":"Add updates to customized Windows images","pos":[417,457]},{"content":"Microsoft will provide update packages to Windows 10 that need to be installed on your customized Windows images.","pos":[460,573]},{"content":"Add the zero-day package (ZDP) to your existing Windows 10 images to provide your users with the latest updates.","pos":[574,686]},{"content":"This topic describes how to install the ZDP to a Windows image, in addition to any other update that Microsoft releases for Windows 10.","pos":[688,823]},{"content":"The ZDP update is a rollup of all of the updates released between Windows 10 build 10240 and today.","pos":[825,924]},{"pos":[926,959],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  As of August 8th, 2015:"},{"content":"Use the Windows PE and Windows RE versions from the ADK build 10240.","pos":[964,1032]},{"content":"Don't update the version of Windows PE or Windows RE unless otherwise instructed.","pos":[1033,1114]},{"content":"Do not use <bpt id=\"p1\">**</bpt>/ResetBase<ept id=\"p1\">**</ept> (DISM /Cleanup-Image /ResetBase) after applying the ZDP offline.","pos":[1119,1209]},{"content":"The ZDP has pending actions, which must be completed before running /ResetBase.","pos":[1210,1289]},{"content":"You can't just add the ZDP into an unattended setup answer file - you must update the entire image before installing it.","pos":[1294,1414]},{"pos":[1579,1611],"content":"Start with your customized image"},{"content":"Start with your existing customized Windows image with Windows 10 build 10240.","pos":[1614,1692]},{"content":"Consider adding language packs before you add the ZDP updates – it may save you time later.","pos":[1694,1785]},{"content":"To learn more, see the notes at the end of this topic and <bpt id=\"p1\">[</bpt>Add Language Packs to Windows<ept id=\"p1\">](add-language-packs-to-windows.md)</ept>.","pos":[1786,1910]},{"pos":[2024,2040],"content":"Download the ZDP"},{"content":"Download the latest updates.","pos":[2043,2071]},{"content":"Note, the ZDP is a cumulative update, so you'll only need to get the latest update package.","pos":[2072,2163]},{"pos":[2169,2244],"content":"Windows 10 64-bit version: <bpt id=\"p1\">&lt;</bpt>http://go.microsoft.com/fwlink/?LinkId=619271<ept id=\"p1\">&gt;</ept>."},{"pos":[2249,2371],"content":"Windows 10 32-bit version: <bpt id=\"p1\">[</bpt>http://go.microsoft.com/fwlink/?LinkId=619272<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=619271)</ept>."},{"pos":[2487,2505],"content":"Update your images"},{"content":"From your technician PC, click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, and type <bpt id=\"p2\">**</bpt>deployment<ept id=\"p2\">**</ept>.","pos":[2512,2578]},{"content":"Right-click <bpt id=\"p1\">**</bpt>Deployment and Imaging Tools Environment<ept id=\"p1\">**</ept> and then select <bpt id=\"p2\">**</bpt>Run as administrator<ept id=\"p2\">**</ept>.","pos":[2579,2677]},{"content":"Create a mount directory for your Windows image (install.wim), and then mount the image.","pos":[2682,2770]},{"content":"Update your Windows images with the latest ZDP.","pos":[2918,2965]},{"content":"Example:","pos":[2966,2974]},{"content":"Where C:<ph id=\"ph1\">\\\\</ph>MSU<ph id=\"ph2\">\\\\</ph>Windows10-KBxxxxxxx-x64.msu is the most recent version of the ZDP available.","pos":[3122,3213]},{"content":"Unmount the Windows image.","pos":[3219,3245]},{"content":"Recommended: Boot the image to complete the update process, and then clean up the image","pos":[3332,3419]},{"content":"Boot a reference device to Windows PE.","pos":[3427,3465]},{"pos":[3470,3534],"content":"Press <bpt id=\"p1\">**</bpt>CTRL+SHIFT+F3<ept id=\"p1\">**</ept> at the OOBE screens to enter audit mode."},{"content":"Open the Command Prompt as an administrator.","pos":[3539,3583]},{"content":"Clean up the Windows image.","pos":[3588,3615]},{"content":"(It's OK to use /ResetBase now that the PC has been booted into audit mode.)","pos":[3616,3692]},{"pos":[3788,3876],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  You won't be able to clean up your Windows image until after you've booted it."},{"content":"Use Sysprep to generalize and shut down the PC.","pos":[3889,3936]},{"content":"Boot the PC to Windows PE.","pos":[4034,4060]},{"content":"If the PC starts rebooting to Windows, you'll need to let it finish booting and then use Sysprep to generalize and shut down the PC again.","pos":[4061,4199]},{"content":"Create a temporary scratch directory for DISM on a physical drive, rather than the default Windows PE virtual drive, to avoid issues related to short file names.","pos":[4204,4365]},{"content":"To prevent capturing the DISM logs in your image, choose a location that’s in your DISM Exclusion list, for example, inside C:<ph id=\"ph1\">\\\\</ph>Recycler.","pos":[4366,4503]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>DISM Configuration List and WimScript.ini Files<ept id=\"p1\">](dism-configuration-list-and-wimscriptini-files-winnext.md)</ept>.","pos":[4504,4632]},{"content":"Recapture the Windows image.","pos":[4689,4717]},{"content":"This captures the applied updates and removes any files that were marked as superseded during DISM /Cleanup-Image.","pos":[4718,4832]},{"content":"Save the file to a location on a USB drive or a network (example: N:<ph id=\"ph1\">\\\\</ph>Images), and give the image a name (example: \"Enterprise<ph id=\"ph2\">\\_</ph>x64 with ZDP KBxxxxxxx\").","pos":[4833,4986]},{"content":"Update Windows Setup bootable media","pos":[5172,5207]},{"content":"Copy your bootable media (DVDs or other bootable media for Windows Setup, Windows Deployment Services (WDS), or System Center) to a writable folder on your PC.","pos":[5215,5374]},{"content":"Mount the file: sources<ph id=\"ph1\">\\\\</ph>boot.wim.","pos":[5440,5474]},{"content":"Add the ZDP.","pos":[5626,5638]},{"content":"Where C:<ph id=\"ph1\">\\\\</ph>MSU<ph id=\"ph2\">\\\\</ph>Windows10-KBxxxxxxx-x64.msu is the most recent version of the ZDP available.","pos":[5796,5887]},{"content":"In Windows Explorer, navigate to the mounted image root folder and sort the list of files by Date modified.","pos":[5893,6000]},{"content":"Copy everything that’s been recently modified (setup.exe, locale.nls, setupplatform.dll, setupplatform.exe, reagent.dll, and anything else that looks recently modified) to the root of the install media.","pos":[6001,6203]},{"content":"Unmount the boot.wim file.","pos":[6208,6234]},{"content":"Create bootable media (DVDs or other bootable media for Windows Setup, Windows Deployment Services (WDS), or System Center) using the files.","pos":[6320,6460]},{"content":"To learn more, see <bpt id=\"p1\">[</bpt>Windows Setup Technical Reference<ept id=\"p1\">](windows-setup-technical-reference.md)</ept>.","pos":[6461,6554]},{"pos":[6802,6864],"content":"Adding languages after adding the ZDP or other rollup packages"},{"content":"Ideally, you'll want to add all of your language packs and components before adding any ZDPs or Windows rollup packages.","pos":[6867,6987]},{"content":"If you need to add language packs or language features on demand after installing the ZDP or other rollup package, you'll need to reapply the ZDP/rollup package afterwards.","pos":[6989,7161]},{"content":"Otherwise, the Windows user experience might not be correctly localized, and users may be prompted to download the language resources from Windows Update.","pos":[7162,7316]},{"pos":[7417,7430],"content":"Sample script"},{"content":"The following sample script modifies a given Windows image by adding all of the updates in a specific folder into the image.","pos":[7433,7557]},{"content":"After adding the image, it cleans up the image.","pos":[7558,7605]}],"content":"---\nauthor: Justinha\nDescription: 'Microsoft will provide update packages to Windows 10 that need to be installed on your customized Windows images. Add the zero-day package (ZDP) to your existing Windows 10 images to provide your users with the latest updates.'\nms.assetid: 3273a638-d635-45e8-b418-ee9c5b06333e\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: Add updates to customized Windows images\n---\n\n# Add updates to customized Windows images\n\n\nMicrosoft will provide update packages to Windows 10 that need to be installed on your customized Windows images. Add the zero-day package (ZDP) to your existing Windows 10 images to provide your users with the latest updates.\n\nThis topic describes how to install the ZDP to a Windows image, in addition to any other update that Microsoft releases for Windows 10.\n\nThe ZDP update is a rollup of all of the updates released between Windows 10 build 10240 and today.\n\n**Note**  As of August 8th, 2015:\n-   Use the Windows PE and Windows RE versions from the ADK build 10240. Don't update the version of Windows PE or Windows RE unless otherwise instructed.\n-   Do not use **/ResetBase** (DISM /Cleanup-Image /ResetBase) after applying the ZDP offline. The ZDP has pending actions, which must be completed before running /ResetBase.\n-   You can't just add the ZDP into an unattended setup answer file - you must update the entire image before installing it.\n\n \n\n## <span id=\"_Start_with_your_customized_image\"></span><span id=\"_start_with_your_customized_image\"></span><span id=\"_START_WITH_YOUR_CUSTOMIZED_IMAGE\"></span> Start with your customized image\n\n\nStart with your existing customized Windows image with Windows 10 build 10240.\n\nConsider adding language packs before you add the ZDP updates – it may save you time later. To learn more, see the notes at the end of this topic and [Add Language Packs to Windows](add-language-packs-to-windows.md).\n\n## <span id=\"_Download_the_ZDP\"></span><span id=\"_download_the_zdp\"></span><span id=\"_DOWNLOAD_THE_ZDP\"></span> Download the ZDP\n\n\nDownload the latest updates. Note, the ZDP is a cumulative update, so you'll only need to get the latest update package.\n\n-   Windows 10 64-bit version: <http://go.microsoft.com/fwlink/?LinkId=619271>.\n-   Windows 10 32-bit version: [http://go.microsoft.com/fwlink/?LinkId=619272](http://go.microsoft.com/fwlink/?LinkId=619271).\n\n## <span id=\"Update_your_images\"></span><span id=\"update_your_images\"></span><span id=\"UPDATE_YOUR_IMAGES\"></span>Update your images\n\n\n1.  From your technician PC, click **Start**, and type **deployment**. Right-click **Deployment and Imaging Tools Environment** and then select **Run as administrator**.\n2.  Create a mount directory for your Windows image (install.wim), and then mount the image.\n\n    ``` syntax\n    md C:\\mount\\Windows\n\n    Dism /Mount-Image /ImageFile:\"C:\\Images\\install.wim\" /Index:1 /MountDir:C:\\mount\\Windows\n    ```\n\n3.  Update your Windows images with the latest ZDP. Example:\n\n    ``` syntax\n    Dism /Add-Package /Image:C:\\mount\\Windows /PackagePath:C:\\MSU\\Windows10-KBxxxxxxx-x64.msu /LogPath:AddPackage.log\n    ```\n\n    Where C:\\\\MSU\\\\Windows10-KBxxxxxxx-x64.msu is the most recent version of the ZDP available.\n\n4.  Unmount the Windows image.\n\n    ``` syntax\n    Dism /Unmount-Image /MountDir:C:\\mount\\Windows /Commit\n    ```\n\n**Recommended: Boot the image to complete the update process, and then clean up the image**\n\n1.  Boot a reference device to Windows PE.\n2.  Press **CTRL+SHIFT+F3** at the OOBE screens to enter audit mode.\n3.  Open the Command Prompt as an administrator.\n4.  Clean up the Windows image. (It's OK to use /ResetBase now that the PC has been booted into audit mode.)\n\n    ``` syntax\n    Dism /Cleanup-Image /Online /StartComponentCleanup /ResetBase\n    ```\n\n    **Note**  You won't be able to clean up your Windows image until after you've booted it.\n\n     \n\n5.  Use Sysprep to generalize and shut down the PC.\n\n    ``` syntax\n    C:\\Windows\\System32\\Sysprep\\sysprep /generalize /shutdown /oobe\n    ```\n\n6.  Boot the PC to Windows PE. If the PC starts rebooting to Windows, you'll need to let it finish booting and then use Sysprep to generalize and shut down the PC again.\n7.  Create a temporary scratch directory for DISM on a physical drive, rather than the default Windows PE virtual drive, to avoid issues related to short file names. To prevent capturing the DISM logs in your image, choose a location that’s in your DISM Exclusion list, for example, inside C:\\\\Recycler. For more info, see [DISM Configuration List and WimScript.ini Files](dism-configuration-list-and-wimscriptini-files-winnext.md).\n\n    ``` syntax\n    md C:\\Recycler\\Scratch\n    ```\n\n8.  Recapture the Windows image. This captures the applied updates and removes any files that were marked as superseded during DISM /Cleanup-Image. Save the file to a location on a USB drive or a network (example: N:\\\\Images), and give the image a name (example: \"Enterprise\\_x64 with ZDP KBxxxxxxx\").\n\n    ``` syntax\n    DISM /Capture-Image /ImageFile:\"N:\\Images\\install_updated.wim\" /CaptureDir:C: /Name: \"Enterprise_x64 with ZDP KBxxxxxxx\" /ScratchDir:C:\\Recycler\\Scratch\n    ```\n\n **Update Windows Setup bootable media**\n\n1.  Copy your bootable media (DVDs or other bootable media for Windows Setup, Windows Deployment Services (WDS), or System Center) to a writable folder on your PC.\n\n    ``` syntax\n    Xcopy D:\\ C:\\InstallMedia /s /h\n    ```\n\n2.  Mount the file: sources\\\\boot.wim.\n\n    ``` syntax\n    md C:\\mount\\boot\n    Dism /Mount-Image /ImageFile:\"C:\\InstallMedia\\sources\\boot.wim\" /Index:1 /MountDir:C:\\mount\\boot\n    ```\n\n3.  Add the ZDP.\n\n    ``` syntax\n    Dism /Add-Package /PackagePath:/PackagePath:C:\\MSU\\Windows10-KBxxxxxxx-x64.msu /Image:C:\\mount\\boot /LogPath:AddPackage.log\n    ```\n\n    Where C:\\\\MSU\\\\Windows10-KBxxxxxxx-x64.msu is the most recent version of the ZDP available.\n\n4.  In Windows Explorer, navigate to the mounted image root folder and sort the list of files by Date modified. Copy everything that’s been recently modified (setup.exe, locale.nls, setupplatform.dll, setupplatform.exe, reagent.dll, and anything else that looks recently modified) to the root of the install media.\n5.  Unmount the boot.wim file.\n\n    ``` syntax\n    Dism /Unmount-Image /MountDir:C:\\mount\\boot /Commit\n    ```\n\n6.  Create bootable media (DVDs or other bootable media for Windows Setup, Windows Deployment Services (WDS), or System Center) using the files. To learn more, see [Windows Setup Technical Reference](windows-setup-technical-reference.md).\n\n## <span id=\"Adding_languages_after_adding_the_ZDP_or_other_rollup_packages\"></span><span id=\"adding_languages_after_adding_the_zdp_or_other_rollup_packages\"></span><span id=\"ADDING_LANGUAGES_AFTER_ADDING_THE_ZDP_OR_OTHER_ROLLUP_PACKAGES\"></span>Adding languages after adding the ZDP or other rollup packages\n\n\nIdeally, you'll want to add all of your language packs and components before adding any ZDPs or Windows rollup packages.\n\nIf you need to add language packs or language features on demand after installing the ZDP or other rollup package, you'll need to reapply the ZDP/rollup package afterwards. Otherwise, the Windows user experience might not be correctly localized, and users may be prompted to download the language resources from Windows Update.\n\n## <span id=\"Sample_script\"></span><span id=\"sample_script\"></span><span id=\"SAMPLE_SCRIPT\"></span>Sample script\n\n\nThe following sample script modifies a given Windows image by adding all of the updates in a specific folder into the image. After adding the image, it cleans up the image.\n\n``` syntax\nREM # InjectPackages.cmd: Adds packages (.cbs, .cab, .msu) to a Windows image\nREM # Usage:   InjectPackages <.WIM file> <Index> <Folder with CBS packages>\nREM # Example: InjectPackages C:\\Images\\install.wim 1 C:\\Packages\\ZDP\nREM #\nREM # Given a Windows image, an index, and a folder with packages (.cbs, .cab, or .msu),\nREM # this injects the packages into the wim offline\nREM #\n\n@echo off\necho %date% - %time%:: starting ,,,\n\nset _dism_log=%~dp0dism_add_packages.log\ndel %_dism_log%\n\nset _input_wim=%1\necho %date% - %time%:: caller gave us a wim: [%_input_wim%]. dir it to verify ,,,\n     dir %_input_wim%\nif not exist %_input_wim% (\n echo fail!!! %_input_wim% not found\n exit /b 2\n)\n\nset _index=%2\necho %date% - %time%:: caller gave us index=[%_index%]. verify it,,,\necho %date% - %time%:: dism /logpath=%_dism_log% /get-imageinfo /imagefile=%_input_wim% /index=%_index%\n     dism /logpath=%_dism_log% /get-imageinfo /imagefile=%_input_wim% /index=%_index%\nif %errorlevel% neq 0 (\n  echo dism failed!!! please verify index [%_index%] is correct.\n  exit /b %errorlevel%\n)\n\n\nset _package_folder=%3\necho %date% - %time%:: caller gave us folder: [%_package_folder%]. dir it to verify ,,,\n     dir %_package_folder%\\\nif not exist %_package_folder%\\ (\n echo fail!!! %_package_folder%\\ not found!\n exit /b 2\n)\n\nif not exist %~dp0mnt\\ (\n mkdir %~dp0mnt\\\n)\n\necho %date% - %time%:: unmount to start clean. you can ignore if this fails.\necho %date% - %time%:: dism /logpath=%_dism_log% /unmount-image /mountdir=%~dp0mnt\\ /discard\n     dism /logpath=%_dism_log% /unmount-image /mountdir=%~dp0mnt\\ /discard\n\necho %date% - %time%:: mount the input wim ,,,\necho dism /logpath=%_dism_log% /mount-image /imagefile=%_input_wim% /index=%_index% /mountdir=%~dp0mnt\\ \n     dism /logpath=%_dism_log% /mount-image /imagefile=%_input_wim% /index=%_index% /mountdir=%~dp0mnt\\ \nif %errorlevel% neq 0 (\n  echo dism failed!!! \n  exit /b %errorlevel%\n)\necho %date% - %time%:: good.\n\necho %date% - %time%:: look for *.msu files ,,,\necho dir %_package_folder%\\*.msu\n     dir %_package_folder%\\*.msu\nfor /r %_package_folder% %%a in (*.msu) do (\n  echo dism /logpath=%_dism_log% /image=%~dp0mnt\\ /add-package=%%a\n       dism /logpath=%_dism_log% /image=%~dp0mnt\\ /add-package=%%a\n  if %errorlevel% neq 0 (\n    echo dism failed!!! \n    exit /b %errorlevel%\n  )\n)\n\necho %date% - %time%:: look for *.cab files ,,,\necho dir %_package_folder%\\*.cab\n     dir %_package_folder%\\*.cab\nfor /r %_package_folder% %%a in (*.cab) do (\n  echo dism /logpath=%_dism_log% /image=%~dp0mnt\\ /add-package=%%a\n       dism /logpath=%_dism_log% /image=%~dp0mnt\\ /add-package=%%a\n  if %errorlevel% neq 0 (\n    echo dism failed!!! \n    exit /b %errorlevel%\n  )\n)\n\necho %date% - %time%:: DONE adding packages.\n\necho %date% - %time%:: run clean up ,,,\n  echo dism /logpath=%_dism_log% /image=%~dp0mnt\\ /cleanup-image /startcomponentcleanup\n       dism /logpath=%_dism_log% /image=%~dp0mnt\\ /cleanup-image /startcomponentcleanup\n  REM ### Do not use /ResetBase. The ZDP has pending actions that must be completed first.##\n\n  if %errorlevel% neq 0 (\n    echo dism failed to clean up. we ignore this for now.\n  )\n\n\n\necho %date% - %time%:: commiting the changes ,,,\necho dism /logpath=%_dism_log% /unmount-image /mountdir=%~dp0mnt\\ /commit\n     dism /logpath=%_dism_log% /unmount-image /mountdir=%~dp0mnt\\ /commit\nif %errorlevel% neq 0 (\n  echo dism failed!!! \n  exit /b %errorlevel%\n)\n\n\necho %date% - %time%:: exporting the wim to reduce size ,,,\necho dism /logpath=%_dism_log% /export-image /sourceimagefile=%_input_wim% /sourceindex=%_index% /destinationimagefile=%_input_wim%_exported.wim\n     dism /logpath=%_dism_log% /export-image /sourceimagefile=%_input_wim% /sourceindex=%_index% /destinationimagefile=%_input_wim%_exported.wim\nif %errorlevel% neq 0 (\n  echo dism failed!!! \n  exit /b %errorlevel%\n)\n\necho %date% - %time%:: ALL DONE.\ndir %_input_wim% \ndir %_input_wim%_exported.wim\necho please use %_input_wim%_exported.wim for further testing.\n```\n\n \n\n \n\n\n\n\n\n"}