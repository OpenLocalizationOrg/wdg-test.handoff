{"nodes":[{"content":"Sysprep (Generalize) a Windows installation","pos":[35,78]},{"content":"Sysprep (Generalize) a Windows installation","pos":[187,230]},{"content":"Sysprep (Generalize) a Windows installation","pos":[239,282]},{"content":"Use <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> to generalize a Windows installation.","pos":[285,338]},{"content":"To deploy a Windows image to different PCs, you must first prepare the image.","pos":[339,416]},{"content":"You can either use the System Preparation (Sysprep) tool or you can specify a setting in an answer file to prepare the image as part of an unattended installation.","pos":[417,580]},{"content":"To prepare the image, you must remove the computer-specific information from the image.","pos":[581,668]},{"content":"This process is called <bpt id=\"p1\">*</bpt>generalizing<ept id=\"p1\">*</ept> the image.","pos":[669,717]},{"content":"In most deployment scenarios, you no longer have to use the <ph id=\"ph1\">`SkipRearm`</ph> answer file setting to reset the Windows Product Activation clock when you run the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> command multiple times on a computer.","pos":[719,923]},{"content":"The <ph id=\"ph1\">`SkipRearm`</ph> setting is used to specify the Windows licensing state.","pos":[924,995]},{"content":"If you specify a retail product key or volume license product key, Windows is automatically activated.","pos":[996,1098]},{"content":"You can run the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> command up to 8 additional times on a single Windows image.","pos":[1099,1186]},{"content":"After running Sysprep 8 times, you must recreate your Windows image.","pos":[1187,1255]},{"content":"For more information about Windows components and settings that you can add to an answer file, see the <bpt id=\"p1\">[</bpt>Unattended Windows Setup Reference<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=206281)</ept>.","pos":[1256,1443]},{"content":"Caution","pos":[1447,1454]},{"content":"Don't use the Windows Store to update your Windows Store apps before running <bpt id=\"p1\">**</bpt>sysprep /generalize<ept id=\"p1\">**</ept>.","pos":[1459,1560]},{"content":"<bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> fails to generalize the image in this scenario.","pos":[1561,1620]},{"content":"This issue also applies to the Windows Store apps (for example, Mail, Maps, Bing Finance, Bing News, and others).","pos":[1621,1734]},{"content":"This can occur when you are customizing your installation in audit mode as the built in administrator, or when using a specific user account.","pos":[1735,1876]},{"content":"The following error appears in the sysprep log files (%WINDIR%<ph id=\"ph1\">\\\\</ph>System32<ph id=\"ph2\">\\\\</ph>Sysprep<ph id=\"ph3\">\\\\</ph>Panther):","pos":[1877,1969]},{"content":"<bpt id=\"p1\">**</bpt>Sysprep /generalize<ept id=\"p1\">**</ept> requires that all apps are provisioned for all users.","pos":[2112,2189]},{"content":"However, when you update an app from the Windows Store, that app becomes non-provisioned and is tied that user account.","pos":[2190,2309]},{"content":"Instead of using the Windows Store to update your apps, you should sideload updates to your line-of-business apps, or have end-users update their apps by using the Windows Store on their destination PCs.","pos":[2311,2514]},{"content":"In managed environments, if Windows Store access is disabled by an IT administrator, you will not be able to update the Windows Store apps.","pos":[2515,2654]},{"pos":[2656,2858],"content":"For more information about sideloading line-of-business Windows Store apps, see <bpt id=\"p1\">[</bpt>Sideload Apps with DISM<ept id=\"p1\">](sideload-apps-with-dism-s14.md)</ept> and <bpt id=\"p2\">[</bpt>Customize the Start Screen<ept id=\"p2\">](customize-the-start-screen.md)</ept>."},{"content":"If your server has Remote Authentication Dial-In User Service (RADIUS) clients or remote RADIUS server groups defined in the Network Policy Server (NPS) configuration, you should remove this information before you deploy it to a different computer.","pos":[2863,3111]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Prepare a Network Policy Server (NPS) for Imaging<ept id=\"p1\">](prepare-a-network-policy-server--nps--for-imaging.md)</ept>.","pos":[3112,3244]},{"content":"In this topic:","pos":[3246,3260]},{"content":"Generalizing an Image","pos":[3267,3288]},{"content":"Generalizing a Virtual Hard Disk","pos":[3305,3337]},{"pos":[3402,3423],"content":"Generalizing an Image"},{"content":"When you generalize a Windows image, Windows Setup processes settings in the <bpt id=\"p1\">[</bpt>generalize<ept id=\"p1\">](generalize.md)</ept> configuration pass.","pos":[3426,3550]},{"content":"You must run the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> command together with the <bpt id=\"p2\">**</bpt>/generalize<ept id=\"p2\">**</ept> option, even if the technician computer and the reference computer have the same hardware configuration.","pos":[3551,3726]},{"content":"The <bpt id=\"p1\">**</bpt>Sysprep /generalize<ept id=\"p1\">**</ept> command removes unique information from a Windows installation so that you can safely reuse that image on a different computer.","pos":[3727,3882]},{"content":"But, you can persist drivers during the generalize configuration pass.","pos":[3883,3953]},{"content":"Important","pos":[3957,3966]},{"content":"When you set up your reference computer, Windows Setup installs drivers for any detected devices.","pos":[3971,4068]},{"content":"By default, Windows Setup removes these drivers when you generalize the system.","pos":[4069,4148]},{"content":"If you're deploying the image to computers that have the same hardware and devices, you'll want Windows Setup to reinstall these same drivers.","pos":[4149,4291]},{"content":"To keep these drivers on the computer during system generalization, set the Microsoft-Windows-PnPSysprep | <ph id=\"ph1\">`PersistAllDeviceInstalls`</ph> setting to <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept>.","pos":[4292,4446]},{"content":"For more information about <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept>-related Windows components that you can add to an answer file, see the <bpt id=\"p2\">[</bpt>Unattended Windows Setup Reference<ept id=\"p2\">](http://go.microsoft.com/fwlink/?LinkId=206281)</ept>.","pos":[4447,4641]},{"content":"Windows replaces only the computer security identifier (SID) on the operating system volume when you run <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept>.","pos":[4646,4763]},{"content":"When <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> generalizes an image, it generalizes only the general partition.","pos":[4764,4845]},{"content":"So if a single computer has multiple operating systems, you must run <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> on each image individually.","pos":[4846,4954]},{"content":"To generalize your image","pos":[4958,4982]},{"content":"Add one of these settings to your answer file:","pos":[4990,5036]},{"content":"Use the Microsoft-Windows-Deployment | <ph id=\"ph1\">`Generalize`</ph> setting.","pos":[5046,5106]},{"content":"Set <ph id=\"ph1\">`Mode`</ph> to <bpt id=\"p1\">**</bpt>OOBE<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Audit<ept id=\"p2\">**</ept>, and set <ph id=\"ph2\">`ForceShutdownNow`</ph> to <bpt id=\"p3\">**</bpt>true<ept id=\"p3\">**</ept>.","pos":[5107,5183]},{"content":"The computer automatically generalizes the image and shuts down.","pos":[5184,5248]},{"content":"-or-","pos":[5258,5262]},{"content":"Add the Microsoft-Windows-Deployment | <ph id=\"ph1\">`Reseal`</ph> setting to the <bpt id=\"p1\">[</bpt>oobeSystem<ept id=\"p1\">](oobesystem.md)</ept> configuration pass.","pos":[5272,5382]},{"content":"Set <ph id=\"ph1\">`Mode`</ph> to <bpt id=\"p1\">**</bpt>Audit<ept id=\"p1\">**</ept>.","pos":[5383,5407]},{"content":"After the computer boots in audit mode and displays the <bpt id=\"p1\">**</bpt>System Preparation Tool<ept id=\"p1\">**</ept> window, use one of these methods:","pos":[5408,5525]},{"content":"In the <bpt id=\"p1\">**</bpt>System Preparation Tool<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>Generalize<ept id=\"p2\">**</ept>, click <bpt id=\"p3\">**</bpt>Shutdown<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>.","pos":[5539,5646]},{"content":"The computer generalizes the image and shuts down.","pos":[5647,5697]},{"content":"-or-","pos":[5711,5715]},{"content":"Close the <bpt id=\"p1\">**</bpt>System Preparation Tool<ept id=\"p1\">**</ept> window, open a Command Prompt window as an administrator, and then move to the <bpt id=\"p2\">**</bpt>%WINDIR%<ph id=\"ph1\">\\\\</ph>system32<ph id=\"ph2\">\\\\</ph>sysprep<ept id=\"p2\">**</ept> directory.","pos":[5729,5888]},{"content":"Use the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> command together with the <bpt id=\"p2\">**</bpt>/generalize<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>/shutdown<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>/oobe<ept id=\"p4\">**</ept> options.","pos":[5889,5989]},{"content":"For example:","pos":[5990,6002]},{"content":"The computer generalizes the image and shuts down.","pos":[6104,6154]},{"content":"After the computer shuts down, use an image-capturing tool to capture your image.","pos":[6160,6241]},{"content":"You can use the <bpt id=\"p1\">**</bpt>Dism /capture-image<ept id=\"p1\">**</ept> command in the Deployment Image Servicing and Management (<bpt id=\"p2\">**</bpt>DISM<ept id=\"p2\">**</ept>) tool for this purpose.","pos":[6242,6372]},{"content":"Deploy this image to a reference computer.","pos":[6378,6420]},{"content":"When the reference computer boots, it displays the Out-Of-Box Experience (OOBE) screen.","pos":[6421,6508]},{"pos":[6510,6646],"content":"For more information, see <bpt id=\"p1\">[</bpt>Settings for Automating OOBE<ept id=\"p1\">](settings-for-automating-oobe.md)</ept> and<bpt id=\"p2\">[</bpt>Configure Oobe.xml<ept id=\"p2\">](configure-oobexml.md)</ept>."},{"content":"If you have additional customizations, you can enter audit mode manually and make those customizations before you generalize and deploy your image.","pos":[6648,6795]},{"content":"Optional: To enter audit mode manually before you generalize your image","pos":[6799,6870]},{"content":"At the OOBE screen, press Ctrl+Shift+F3.","pos":[6878,6918]},{"content":"Windows reboots the computer in audit mode, and the <bpt id=\"p1\">**</bpt>System Preparation Tool<ept id=\"p1\">**</ept> window appears.","pos":[6919,7014]},{"pos":[7020,7232],"content":"**Caution**  \nThe Ctrl+Shift+F3 keyboard shortcut doesn't bypass all parts of the OOBE process, such as running scripts and applying answer-file settings in the [oobeSystem](oobesystem.md) configuration pass.","leadings":["","    "],"nodes":[{"content":"Caution","pos":[2,9]},{"content":"The Ctrl+Shift+F3 keyboard shortcut doesn't bypass all parts of the OOBE process, such as running scripts and applying answer-file settings in the <bpt id=\"p1\">[</bpt>oobeSystem<ept id=\"p1\">](oobesystem.md)</ept> configuration pass.","pos":[14,208]}]},{"content":"Add the customizations that you want to include.","pos":[7245,7293]},{"content":"In the <bpt id=\"p1\">**</bpt>System Preparation Tool<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>Generalize<ept id=\"p2\">**</ept>, click <bpt id=\"p3\">**</bpt>Shutdown<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>.","pos":[7299,7406]},{"content":"The computer generalizes the image and shuts down.","pos":[7407,7457]},{"content":"-or-","pos":[7464,7468]},{"content":"Close the <bpt id=\"p1\">**</bpt>System Preparation Tool<ept id=\"p1\">**</ept> window, open a Command Prompt window as an administrator, and then move to the <bpt id=\"p2\">**</bpt>%WINDIR%<ph id=\"ph1\">\\\\</ph>system32<ph id=\"ph2\">\\\\</ph>sysprep<ept id=\"p2\">**</ept> directory.","pos":[7474,7633]},{"content":"Use the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> command together with the <bpt id=\"p2\">**</bpt>/generalize<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>/shutdown<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>/oobe<ept id=\"p4\">**</ept> options.","pos":[7634,7734]},{"content":"For example:","pos":[7735,7747]},{"content":"The computer generalizes the image and shuts down.","pos":[7817,7867]},{"content":"After the computer shuts down, use an image-capturing tool to capture your image.","pos":[7873,7954]},{"content":"You can use the <bpt id=\"p1\">**</bpt>Dism /capture-image<ept id=\"p1\">**</ept> command in the <bpt id=\"p2\">**</bpt>DISM<ept id=\"p2\">**</ept> tool for this purpose.","pos":[7955,8041]},{"content":"Deploy this image to a reference computer.","pos":[8047,8089]},{"content":"When the reference computer boots, it displays the OOBE screen.","pos":[8090,8153]},{"content":"For more information about audit mode, see:","pos":[8155,8198]},{"content":"Audit Mode Overview","pos":[8205,8224]},{"content":"Boot Windows to Audit Mode or OOBE","pos":[8256,8290]},{"content":"Add a Driver Online in Audit Mode","pos":[8337,8370]},{"content":"Enable and Disable the Built-in Administrator Account","pos":[8416,8469]},{"pos":[8583,8615],"content":"Generalizing a Virtual Hard Disk"},{"content":"You can use <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> VM mode to generalize a VHD that you want to deploy as a VHD on the same virtual machine or hypervisor.","pos":[8618,8745]},{"content":"VM mode supports rapid deployment of virtual machines.","pos":[8746,8800]},{"content":"VM mode is supported only when you run it from inside a virtual machine.","pos":[8801,8873]},{"content":"Additionally, VM mode is available only through the command line.","pos":[8874,8939]},{"content":"You can't use VM mode to prepare a VHD for deployment to any computer.","pos":[8940,9010]},{"content":"To generalize a VHD","pos":[9014,9033]},{"pos":[9041,9169],"content":"In audit mode, open a Command Prompt window as an administrator, and then move to the <bpt id=\"p1\">**</bpt>%WINDIR%<ph id=\"ph1\">\\\\</ph>system32<ph id=\"ph2\">\\\\</ph>sysprep<ept id=\"p1\">**</ept> directory."},{"content":"Use the <bpt id=\"p1\">**</bpt>Sysprep<ept id=\"p1\">**</ept> command together with the <bpt id=\"p2\">**</bpt>/generalize<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>/oobe<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>/mode:vm<ept id=\"p4\">**</ept> options.","pos":[9175,9274]},{"content":"For example:","pos":[9275,9287]},{"content":"The computer generalizes the VHD image.","pos":[9356,9395]},{"content":"Deploy the generalized VHD image on the same virtual machine.","pos":[9401,9462]},{"content":"When the virtual machine reboots, it displays the OOBE screen.","pos":[9463,9525]},{"pos":[9527,9623],"content":"The only additional options that apply to VM mode are <bpt id=\"p1\">**</bpt>/reboot<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>/shutdown<ept id=\"p2\">**</ept>, and <bpt id=\"p3\">**</bpt>/quit<ept id=\"p3\">**</ept>."},{"pos":[9661,9675],"content":"Related topics"},{"content":"Sysprep Process Overview","pos":[9679,9703]},{"content":"Sysprep Command-Line Options","pos":[9736,9764]},{"content":"Sysprep Support for Server Roles","pos":[9801,9833]},{"content":"Work with Product Keys and Activation","pos":[9874,9911]}],"content":"---\nauthor: Justinha\nDescription: 'Sysprep (Generalize) a Windows installation'\nms.assetid: 455fa70e-6c13-45ae-ad4f-5d12e3b844e5\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: 'Sysprep (Generalize) a Windows installation'\n---\n\n# Sysprep (Generalize) a Windows installation\n\n\nUse **Sysprep** to generalize a Windows installation. To deploy a Windows image to different PCs, you must first prepare the image. You can either use the System Preparation (Sysprep) tool or you can specify a setting in an answer file to prepare the image as part of an unattended installation. To prepare the image, you must remove the computer-specific information from the image. This process is called *generalizing* the image.\n\nIn most deployment scenarios, you no longer have to use the `SkipRearm` answer file setting to reset the Windows Product Activation clock when you run the **Sysprep** command multiple times on a computer. The `SkipRearm` setting is used to specify the Windows licensing state. If you specify a retail product key or volume license product key, Windows is automatically activated. You can run the **Sysprep** command up to 8 additional times on a single Windows image. After running Sysprep 8 times, you must recreate your Windows image. For more information about Windows components and settings that you can add to an answer file, see the [Unattended Windows Setup Reference](http://go.microsoft.com/fwlink/?LinkId=206281).\n\n**Caution**  \nDon't use the Windows Store to update your Windows Store apps before running **sysprep /generalize**. **Sysprep** fails to generalize the image in this scenario. This issue also applies to the Windows Store apps (for example, Mail, Maps, Bing Finance, Bing News, and others). This can occur when you are customizing your installation in audit mode as the built in administrator, or when using a specific user account. The following error appears in the sysprep log files (%WINDIR%\\\\System32\\\\Sysprep\\\\Panther):\n\n`<package name> was installed for a user, but not provisioned for all users. This package will not function properly in the sysprep image.`\n\n**Sysprep /generalize** requires that all apps are provisioned for all users. However, when you update an app from the Windows Store, that app becomes non-provisioned and is tied that user account.\n\nInstead of using the Windows Store to update your apps, you should sideload updates to your line-of-business apps, or have end-users update their apps by using the Windows Store on their destination PCs. In managed environments, if Windows Store access is disabled by an IT administrator, you will not be able to update the Windows Store apps.\n\nFor more information about sideloading line-of-business Windows Store apps, see [Sideload Apps with DISM](sideload-apps-with-dism-s14.md) and [Customize the Start Screen](customize-the-start-screen.md).\n\n \n\nIf your server has Remote Authentication Dial-In User Service (RADIUS) clients or remote RADIUS server groups defined in the Network Policy Server (NPS) configuration, you should remove this information before you deploy it to a different computer. For more information, see [Prepare a Network Policy Server (NPS) for Imaging](prepare-a-network-policy-server--nps--for-imaging.md).\n\nIn this topic:\n\n-   [Generalizing an Image](#bkmk-1)\n\n-   [Generalizing a Virtual Hard Disk](#bkmk-2)\n\n## <span id=\"bkmk_1\"></span><span id=\"BKMK_1\"></span>Generalizing an Image\n\n\nWhen you generalize a Windows image, Windows Setup processes settings in the [generalize](generalize.md) configuration pass. You must run the **Sysprep** command together with the **/generalize** option, even if the technician computer and the reference computer have the same hardware configuration. The **Sysprep /generalize** command removes unique information from a Windows installation so that you can safely reuse that image on a different computer. But, you can persist drivers during the generalize configuration pass.\n\n**Important**  \nWhen you set up your reference computer, Windows Setup installs drivers for any detected devices. By default, Windows Setup removes these drivers when you generalize the system. If you're deploying the image to computers that have the same hardware and devices, you'll want Windows Setup to reinstall these same drivers. To keep these drivers on the computer during system generalization, set the Microsoft-Windows-PnPSysprep | `PersistAllDeviceInstalls` setting to **true**. For more information about **Sysprep**-related Windows components that you can add to an answer file, see the [Unattended Windows Setup Reference](http://go.microsoft.com/fwlink/?LinkId=206281).\n\n \n\nWindows replaces only the computer security identifier (SID) on the operating system volume when you run **Sysprep**. When **Sysprep** generalizes an image, it generalizes only the general partition. So if a single computer has multiple operating systems, you must run **Sysprep** on each image individually.\n\n**To generalize your image**\n\n1.  Add one of these settings to your answer file:\n\n    -   Use the Microsoft-Windows-Deployment | `Generalize` setting. Set `Mode` to **OOBE** or **Audit**, and set `ForceShutdownNow` to **true**. The computer automatically generalizes the image and shuts down.\n\n        -or-\n\n    -   Add the Microsoft-Windows-Deployment | `Reseal` setting to the [oobeSystem](oobesystem.md) configuration pass. Set `Mode` to **Audit**. After the computer boots in audit mode and displays the **System Preparation Tool** window, use one of these methods:\n\n        -   In the **System Preparation Tool** window, click **Generalize**, click **Shutdown**, and then click **OK**. The computer generalizes the image and shuts down.\n\n            -or-\n\n        -   Close the **System Preparation Tool** window, open a Command Prompt window as an administrator, and then move to the **%WINDIR%\\\\system32\\\\sysprep** directory. Use the **Sysprep** command together with the **/generalize**, **/shutdown**, and **/oobe** options. For example:\n\n            ``` syntax\n            Sysprep /generalize /shutdown /oobe\n            ```\n\n            The computer generalizes the image and shuts down.\n\n2.  After the computer shuts down, use an image-capturing tool to capture your image. You can use the **Dism /capture-image** command in the Deployment Image Servicing and Management (**DISM**) tool for this purpose.\n\n3.  Deploy this image to a reference computer. When the reference computer boots, it displays the Out-Of-Box Experience (OOBE) screen.\n\nFor more information, see [Settings for Automating OOBE](settings-for-automating-oobe.md) and[Configure Oobe.xml](configure-oobexml.md).\n\nIf you have additional customizations, you can enter audit mode manually and make those customizations before you generalize and deploy your image.\n\n**Optional: To enter audit mode manually before you generalize your image**\n\n1.  At the OOBE screen, press Ctrl+Shift+F3. Windows reboots the computer in audit mode, and the **System Preparation Tool** window appears.\n\n    **Caution**  \n    The Ctrl+Shift+F3 keyboard shortcut doesn't bypass all parts of the OOBE process, such as running scripts and applying answer-file settings in the [oobeSystem](oobesystem.md) configuration pass.\n\n     \n\n2.  Add the customizations that you want to include.\n\n3.  In the **System Preparation Tool** window, click **Generalize**, click **Shutdown**, and then click **OK**. The computer generalizes the image and shuts down.\n\n     -or-\n\n    Close the **System Preparation Tool** window, open a Command Prompt window as an administrator, and then move to the **%WINDIR%\\\\system32\\\\sysprep** directory. Use the **Sysprep** command together with the **/generalize**, **/shutdown**, and **/oobe** options. For example:\n\n    ``` syntax\n    Sysprep /generalize /shutdown /oobe\n    ```\n\n    The computer generalizes the image and shuts down.\n\n4.  After the computer shuts down, use an image-capturing tool to capture your image. You can use the **Dism /capture-image** command in the **DISM** tool for this purpose.\n\n5.  Deploy this image to a reference computer. When the reference computer boots, it displays the OOBE screen.\n\nFor more information about audit mode, see:\n\n-   [Audit Mode Overview](audit-mode-overview.md)\n\n-   [Boot Windows to Audit Mode or OOBE](boot-windows-to-audit-mode-or-oobe.md)\n\n-   [Add a Driver Online in Audit Mode](add-a-driver-online-in-audit-mode.md)\n\n-   [Enable and Disable the Built-in Administrator Account](enable-and-disable-the-built-in-administrator-account.md)\n\n## <span id=\"bkmk_2\"></span><span id=\"BKMK_2\"></span>Generalizing a Virtual Hard Disk\n\n\nYou can use **Sysprep** VM mode to generalize a VHD that you want to deploy as a VHD on the same virtual machine or hypervisor. VM mode supports rapid deployment of virtual machines. VM mode is supported only when you run it from inside a virtual machine. Additionally, VM mode is available only through the command line. You can't use VM mode to prepare a VHD for deployment to any computer.\n\n**To generalize a VHD**\n\n1.  In audit mode, open a Command Prompt window as an administrator, and then move to the **%WINDIR%\\\\system32\\\\sysprep** directory.\n\n2.  Use the **Sysprep** command together with the **/generalize**, **/oobe**, and **/mode:vm** options. For example:\n\n    ``` syntax\n    Sysprep /generalize /oobe /mode:vm\n    ```\n\n    The computer generalizes the VHD image.\n\n3.  Deploy the generalized VHD image on the same virtual machine. When the virtual machine reboots, it displays the OOBE screen.\n\nThe only additional options that apply to VM mode are **/reboot**, **/shutdown**, and **/quit**.\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[Sysprep Process Overview](sysprep-process-overview.md)\n\n[Sysprep Command-Line Options](sysprep-command-line-options.md)\n\n[Sysprep Support for Server Roles](sysprep-support-for-server-roles.md)\n\n[Work with Product Keys and Activation](work-with-product-keys-and-activation-auth-phases.md)\n\n \n\n \n\n\n\n\n\n\n"}