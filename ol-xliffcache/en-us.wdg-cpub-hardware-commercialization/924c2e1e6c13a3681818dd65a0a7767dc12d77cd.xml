{"nodes":[{"content":"Logging Mode","pos":[11,23]},{"content":"Logging Mode","pos":[37,49]},{"content":"Logging Mode","pos":[238,250]},{"content":"When you define a Windows Performance Recorder (WPR) profile, you must select a logging mode from the following options:","pos":[253,373]},{"pos":[379,430],"content":"<bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept>: records logging data to a sequential file"},{"pos":[436,498],"content":"<bpt id=\"p1\">**</bpt>Memory<ept id=\"p1\">**</ept>: records logging data to circular buffers in memory"},{"content":"The logging mode is set to <bpt id=\"p1\">**</bpt>Memory<ept id=\"p1\">**</ept> by default.","pos":[500,549]},{"content":"However, <bpt id=\"p1\">*</bpt>On/off<ept id=\"p1\">*</ept> transitions are always logged to a file.","pos":[550,608]},{"content":"Logging to file is typically used for short recordings for which you can anticipate the events that will be recorded.","pos":[610,727]},{"content":"Logging to memory is typically used to log events that can occur at any time.","pos":[728,805]},{"content":"When WPR logs to memory, buffer size and the level of profile detail determine how long WPR can log data before old events are overwritten.","pos":[806,945]},{"content":"Caution","pos":[949,956]},{"content":"To limit file size, choose <bpt id=\"p1\">**</bpt>Memory<ept id=\"p1\">**</ept>.","pos":[961,999]},{"content":"When logging to file, available disk space is the only limitation to file size.","pos":[1000,1079]},{"content":"If the file is too large, you might not be able to analyze it in Windows Performance Analyzer (WPA).","pos":[1080,1180]},{"content":"When you author custom recording profiles, you must define both a file and a memory version in the same recording profile definition (.wprp) file.","pos":[1185,1331]},{"content":"When you select a profile for a recording, you must select either the file or memory version to use for that recording event.","pos":[1332,1457]},{"content":"For examples of custom profiles, see <bpt id=\"p1\">[</bpt>3. Profile Definitions<ept id=\"p1\">](3-profile-definitions.md)</ept>.","pos":[1458,1546]},{"content":"A .wprp file can have up to four profile definitions: one for each combination of detail level and logging mode.","pos":[1548,1660]},{"content":"The following constraints are enforced:","pos":[1661,1700]},{"pos":[1706,1823],"content":"The profile identifier must be in the following format: <ph id=\"ph1\">&amp;lt;</ph><bpt id=\"p1\">*</bpt>ProfileName<ept id=\"p1\">*</ept><ph id=\"ph2\">&amp;gt;</ph>.<ph id=\"ph3\">&amp;lt;</ph><bpt id=\"p2\">*</bpt>DetailLevel<ept id=\"p2\">*</ept><ph id=\"ph4\">&amp;gt;</ph>.<ph id=\"ph5\">&amp;lt;</ph><bpt id=\"p3\">*</bpt>LoggingMode<ept id=\"p3\">*</ept>"},{"content":"All profiles that exist in a single file must have the same name.","pos":[1833,1898]},{"content":"A .wprp file must contain profiles for both memory and file logging modes.","pos":[1904,1978]},{"content":"When you author a custom profile, you must define the <bpt id=\"p1\">[</bpt>BufferSize<ept id=\"p1\">](buffersize.md)</ept> element and the <bpt id=\"p2\">[</bpt>Buffers<ept id=\"p2\">](buffers.md)</ept> element.","pos":[1980,2108]},{"content":"You can define the total amount of buffer as a fixed number of buffers by using a size that you define in kilobytes (KB), or as a percentage of total memory.","pos":[2109,2266]},{"content":"The default buffer count is 64, and the default buffer size is 128 KB.","pos":[2267,2337]},{"content":"You can use the WPR command-line interface to view the size and number of buffers that each provider uses.","pos":[2339,2445]},{"content":"Note","pos":[2699,2703]},{"content":"WPR supports only single-value <bpt id=\"p1\">*</bpt>NumberOfBuffers<ept id=\"p1\">*</ept>.","pos":[2708,2757]},{"content":"It does not support minimum and maximum buffers.","pos":[2758,2806]},{"content":"General guidelines about how to set buffers are as follows:","pos":[2811,2870]},{"content":"Event stacks require more space compared to events without stacks.","pos":[2876,2942]},{"content":"Therefore, WPR uses more buffers and logs more data for the same amount of time.","pos":[2943,3023]},{"content":"Make sure that your buffers are properly sized.","pos":[3029,3076]},{"content":"If buffers are too large, too much memory is consumed and system performance is impacted.","pos":[3077,3166]},{"content":"If buffers are too small, events can be lost, and the trace becomes useless.","pos":[3167,3243]},{"content":"When logging to memory, buffer size determines how long WPR can log data before old events are overwritten.","pos":[3249,3356]},{"content":"For memory traces, we recommend that you set buffers as a percentage of total memory, such as 1% to 5% of physical memory, depending on the profile.","pos":[3357,3505]},{"content":"Unless the recording profile is unusually verbose, 10% of physical memory should be sufficient.","pos":[3506,3601]},{"content":"Buffers are typically smaller when logging to a file than when logging to memory.","pos":[3607,3688]},{"content":"However, if the buffers are too small, the buffers will flush to disk too often.","pos":[3689,3769]},{"content":"Unless the recording profile is unusually verbose, 10-50 MB of physical memory should be sufficient.","pos":[3770,3870]},{"pos":[3872,3987],"content":"For more guidance about buffers, see <bpt id=\"p1\">[</bpt>Sessions (Windows Drivers)<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?linkid=246706)</ept>."},{"content":"Related topics","pos":[3992,4006]},{"content":"WPR Features","pos":[4010,4022]},{"content":"Detail Level","pos":[4043,4055]},{"content":"3. Profile Definitions","pos":[4076,4098]},{"content":"Change the Logging Mode","pos":[4128,4151]}],"content":"---\ntitle: Logging Mode\ndescription: Logging Mode\nMSHAttr:\n- 'PreferredSiteName:MSDN'\n- 'PreferredLib:/library/windows/hardware'\nms.assetid: 96dc60e4-0550-4cac-b405-9aab923b7435\nms.prod: W10\nms.mktglfcycl: operate\nms.sitesec: msdn\n---\n\n# Logging Mode\n\n\nWhen you define a Windows Performance Recorder (WPR) profile, you must select a logging mode from the following options:\n\n-   **File**: records logging data to a sequential file\n\n-   **Memory**: records logging data to circular buffers in memory\n\nThe logging mode is set to **Memory** by default. However, *On/off* transitions are always logged to a file.\n\nLogging to file is typically used for short recordings for which you can anticipate the events that will be recorded. Logging to memory is typically used to log events that can occur at any time. When WPR logs to memory, buffer size and the level of profile detail determine how long WPR can log data before old events are overwritten.\n\n**Caution**  \nTo limit file size, choose **Memory**. When logging to file, available disk space is the only limitation to file size. If the file is too large, you might not be able to analyze it in Windows Performance Analyzer (WPA).\n\n \n\nWhen you author custom recording profiles, you must define both a file and a memory version in the same recording profile definition (.wprp) file. When you select a profile for a recording, you must select either the file or memory version to use for that recording event. For examples of custom profiles, see [3. Profile Definitions](3-profile-definitions.md).\n\nA .wprp file can have up to four profile definitions: one for each combination of detail level and logging mode. The following constraints are enforced:\n\n-   The profile identifier must be in the following format: &lt;*ProfileName*&gt;.&lt;*DetailLevel*&gt;.&lt;*LoggingMode*&gt;\n\n-   All profiles that exist in a single file must have the same name.\n\n-   A .wprp file must contain profiles for both memory and file logging modes.\n\nWhen you author a custom profile, you must define the [BufferSize](buffersize.md) element and the [Buffers](buffers.md) element. You can define the total amount of buffer as a fixed number of buffers by using a size that you define in kilobytes (KB), or as a percentage of total memory. The default buffer count is 64, and the default buffer size is 128 KB.\n\nYou can use the WPR command-line interface to view the size and number of buffers that each provider uses.\n\n``` syntax\nwpr -profiledetails CPU\n\nMicrosoft Windows Performance Recorder Version 6.2.9200\n\n\nProfile                 : CPU.Verbose.Memory\n\n\nCollector Name          : NT Kernel Logger\nBuffer Size (KB)        : 1024\nNumber of Buffers       : 613\n```\n\n**Note**  \nWPR supports only single-value *NumberOfBuffers*. It does not support minimum and maximum buffers.\n\n \n\nGeneral guidelines about how to set buffers are as follows:\n\n-   Event stacks require more space compared to events without stacks. Therefore, WPR uses more buffers and logs more data for the same amount of time.\n\n-   Make sure that your buffers are properly sized. If buffers are too large, too much memory is consumed and system performance is impacted. If buffers are too small, events can be lost, and the trace becomes useless.\n\n-   When logging to memory, buffer size determines how long WPR can log data before old events are overwritten. For memory traces, we recommend that you set buffers as a percentage of total memory, such as 1% to 5% of physical memory, depending on the profile. Unless the recording profile is unusually verbose, 10% of physical memory should be sufficient.\n\n-   Buffers are typically smaller when logging to a file than when logging to memory. However, if the buffers are too small, the buffers will flush to disk too often. Unless the recording profile is unusually verbose, 10-50 MB of physical memory should be sufficient.\n\nFor more guidance about buffers, see [Sessions (Windows Drivers)](http://go.microsoft.com/fwlink/p/?linkid=246706).\n\n## Related topics\n\n\n[WPR Features](wpr-features.md)\n\n[Detail Level](detail-level.md)\n\n[3. Profile Definitions](3-profile-definitions.md)\n\n[Change the Logging Mode](change-the-logging-mode.md)\n\n \n\n \n\n\n\n\n\n\n\n"}