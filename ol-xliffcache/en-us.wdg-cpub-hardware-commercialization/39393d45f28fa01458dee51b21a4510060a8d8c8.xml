{"nodes":[{"content":"Customizing Spinlock Parameters","pos":[11,42]},{"content":"Customizing Spinlock Parameters","pos":[56,87]},{"content":"Customizing Spinlock Parameters","pos":[276,307]},{"content":"By default, the system logs one spinlock event for every 1000 non-contended acquisitions, and one spinlock event for every contended acquisition.","pos":[310,455]},{"content":"Spinlock data collection supports three parameters that enable you to customize data collection.","pos":[456,552]},{"content":"To set spinlock collection parameters, use the following command.","pos":[553,618]},{"content":"Parameters","pos":[728,738]},{"content":"spin<ph id=\"ph1\">\\_</ph>threshold","pos":[777,792]},{"content":"The spinlock instrumentation provides a capability to trace heavily contended locks.","pos":[796,880]},{"content":"This is achieved by setting a high spin threshold.","pos":[881,931]},{"content":"If a lock spins less than this threshold, no spinlock event will be logged.","pos":[932,1007]},{"content":"For example, if this value is 1, one spinlock event is acquired for each attempt to acquire a lock.","pos":[1008,1107]},{"content":"If this value is 10, one spinlock event is logged for each ten attempts to acquire a lock.","pos":[1108,1198]},{"content":"The default value is 1.","pos":[1199,1222]},{"content":"acquire<ph id=\"ph1\">\\_</ph>sample<ph id=\"ph2\">\\_</ph>rate","pos":[1265,1286]},{"content":"Sample rate at which spinlock events are logged during a trace.","pos":[1290,1353]},{"content":"For example, if this value is 1000, one spinlock event is logged for each 1000 non-collision event acquisitions.","pos":[1354,1466]},{"content":"The default value is 1000.","pos":[1467,1493]},{"content":"contention<ph id=\"ph1\">\\_</ph>sample<ph id=\"ph2\">\\_</ph>rate","pos":[1539,1563]},{"content":"Rate at which spinlock events are logged when collisions occur.","pos":[1567,1630]},{"content":"For example, if this value is 100, one spinlock event is logged for each 100 spinlock collisions.","pos":[1631,1728]},{"content":"The default value is 1.","pos":[1729,1752]},{"content":"Remarks","pos":[1757,1764]},{"content":"Spinlock collection parameters return to the default values when the system reboots.","pos":[1767,1851]},{"content":"To ensure valid data collection, always query or set spinlock parameters before starting event data collection.","pos":[1852,1963]},{"content":"Example","pos":[1968,1975]},{"content":"The following example shows how to query for the current values.","pos":[1978,2042]},{"content":"The following example sets the spin threshold to 1, the acquire sample rate to 1000, and the spinlock contention sample rate to 100.","pos":[2076,2208]},{"content":"This query returns the following result for the values set in the previous example.","pos":[2262,2345]},{"content":"Related topics","pos":[2492,2506]},{"content":"spinlock","pos":[2510,2518]}],"content":"---\ntitle: Customizing Spinlock Parameters\ndescription: Customizing Spinlock Parameters\nMSHAttr:\n- 'PreferredSiteName:MSDN'\n- 'PreferredLib:/library/windows/hardware'\nms.assetid: 16e6e317-659b-4797-a447-db4dcdb3c9c0\nms.prod: W10\nms.mktglfcycl: operate\nms.sitesec: msdn\n---\n\n# Customizing Spinlock Parameters\n\n\nBy default, the system logs one spinlock event for every 1000 non-contended acquisitions, and one spinlock event for every contended acquisition. Spinlock data collection supports three parameters that enable you to customize data collection. To set spinlock collection parameters, use the following command.\n\n``` syntax\nxperf -setspinlocksample [spin_threshold] [acquire_sample_rate] [contention_sample_rate]\n```\n\n## Parameters\n\n\n<a href=\"\" id=\"spin-threshold\"></a>*spin\\_threshold*  \nThe spinlock instrumentation provides a capability to trace heavily contended locks. This is achieved by setting a high spin threshold. If a lock spins less than this threshold, no spinlock event will be logged. For example, if this value is 1, one spinlock event is acquired for each attempt to acquire a lock. If this value is 10, one spinlock event is logged for each ten attempts to acquire a lock. The default value is 1.\n\n<a href=\"\" id=\"acquire-sample-rate\"></a>*acquire\\_sample\\_rate*  \nSample rate at which spinlock events are logged during a trace. For example, if this value is 1000, one spinlock event is logged for each 1000 non-collision event acquisitions. The default value is 1000.\n\n<a href=\"\" id=\"contention-sample-rate\"></a>*contention\\_sample\\_rate*  \nRate at which spinlock events are logged when collisions occur. For example, if this value is 100, one spinlock event is logged for each 100 spinlock collisions. The default value is 1.\n\n## Remarks\n\n\nSpinlock collection parameters return to the default values when the system reboots. To ensure valid data collection, always query or set spinlock parameters before starting event data collection.\n\n## Example\n\n\nThe following example shows how to query for the current values.\n\n``` syntax\nxperf -spinlock\n```\n\nThe following example sets the spin threshold to 1, the acquire sample rate to 1000, and the spinlock contention sample rate to 100.\n\n``` syntax\nxperf -setspinlocksample 1 1000 100\n```\n\nThis query returns the following result for the values set in the previous example.\n\n``` syntax\nCurrent Spinlock Spin Threshold = 1\nCurrent Spinlock Acquire Sample Rate = 1000\nCurrent Spinlock Contention Sample Rate = 100\n```\n\n## Related topics\n\n\n[spinlock](spinlock.md)\n\n \n\n \n\n\n\n\n\n\n\n"}