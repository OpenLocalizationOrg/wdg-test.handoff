{"nodes":[{"content":"Initialize-FirmwareSubmission cmdlet","pos":[35,71]},{"content":"Initialize-FirmwareSubmission cmdlet","pos":[180,216]},{"content":"Initialize-FirmwareSubmission cmdlet","pos":[225,261]},{"content":"Use this standalone cmdlet to prepare a firmware submission.","pos":[264,324]},{"content":"This cmdlet combines the firmware submission into a zip file on the local computer, and does not communicate with partner services.","pos":[325,456]},{"content":"After using this cmdlet, use <bpt id=\"p1\">[</bpt>New-FirmwareSubmission cmdlet<ept id=\"p1\">](new-firmwaresubmission-cmdlet.md)</ept> to upload the zip file that contains the firmware submission.","pos":[458,614]},{"content":"This cmdlet provides only a .NET file object as an output.","pos":[615,673]},{"content":"To submit the zip file that is created from this cmdlet, use the <bpt id=\"p1\">**</bpt>New-FirmwareSubmission<ept id=\"p1\">**</ept> cmdlet.","pos":[674,773]},{"pos":[874,887],"content":"Prerequisites"},{"content":"Create a package using ImgGen.cmd.","pos":[890,924]},{"content":"This creates multiple files, including an UpdateHistory.xml file and a targeting package file, which is named using the following format where <ph id=\"ph1\">&amp;lt;</ph>OEM<ph id=\"ph2\">&amp;gt;</ph> is the name of the OEM and <ph id=\"ph3\">&amp;lt;</ph>Device<ph id=\"ph4\">&amp;gt;</ph> is the name of the device:","pos":[925,1148]},{"content":"OEM<ph id=\"ph1\">&amp;gt;</ph>.<ph id=\"ph2\">&amp;lt;</ph>Device<ph id=\"ph3\">&amp;gt;</ph>.Customizations.MainOS.spkg","pos":[1154,1203]},{"content":"To use the same image for multiple OEMs or devices, add a targeting file (PhoneMetadataDeviceTargetingInfo.xml).","pos":[1205,1317]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>DeviceInfo<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/hardware/mt138322)</ept>.","pos":[1318,1412]},{"pos":[1504,1514],"content":"Parameters"},{"content":"The following are the input parameters for this cmdlet.","pos":[1517,1572]},{"content":"-UpdateHistoryPath (required)","pos":[1719,1748]},{"content":"A string path to the UpdateHistory file.","pos":[1752,1792]},{"content":"-OemInputPath (required)","pos":[1924,1948]},{"content":"A string path to the OEMInput.xml file.","pos":[1952,1991]},{"content":"-TypeOfSubmission (required)","pos":[2135,2163]},{"content":"The submission type.","pos":[2167,2187]},{"content":"The type must be <bpt id=\"p1\">**</bpt>Image<ept id=\"p1\">**</ept>, <bpt id=\"p2\">**</bpt>FfuCatalog<ept id=\"p2\">**</ept>, or <bpt id=\"p3\">**</bpt>PartialImage<ept id=\"p3\">**</ept>.","pos":[2188,2252]},{"content":"-OutputFilePath (required)","pos":[2390,2416]},{"content":"A string path to the resulting output zip file.","pos":[2420,2467]},{"content":"If this parameter does not contain a full path, the output file is saved in the current working directory.","pos":[2468,2574]},{"content":"-TypeOfProduct","pos":[2676,2690]},{"content":"An optional parameter that specifies the target product of the firmware submission.","pos":[2694,2777]},{"content":"The product must be one of WindowsPhoneBlue, WindowsPhoneThreshold and WindowsIoTCoreThreshold.","pos":[2778,2873]},{"content":"Default is WindowsPhoneBlue.","pos":[2874,2902]},{"pos":[2904,2966],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>  Product values may be added or removed periodically."},{"content":"-SignedRemovalPackageFolder","pos":[3110,3137]},{"content":"A string path to a folder that contains removal packages (with file extensions ending in .spkr) to be added to an image.","pos":[3141,3261]},{"content":"-PackagesToRemoveFolder","pos":[3390,3413]},{"content":"A string path to a folder that contains packages (with file extensions ending in .spkg) that will be used to generate removal packages to the image.","pos":[3417,3565]},{"content":"-Baseline","pos":[3652,3661]},{"content":"Declare a firmware submission to be a baseline so it can be used for retail servicing (via Request for Update (RFU)).","pos":[3665,3782]},{"content":"Baseline submissions must be Windows Standard Package Configuration compliant.","pos":[3783,3861]},{"content":"For more info, see <bpt id=\"p1\">[</bpt>Windows Standard Packaging Configuration (WSPC) requirements for retail images<ept id=\"p1\">](https://msdn.microsoft.com/library/dn756781)</ept>.","pos":[3862,4007]},{"pos":[4009,4110],"content":"This flag cannot be used with <bpt id=\"p1\">**</bpt>–TypeOfSubmission FfuCatalog<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>–TypeOfSubmission PartialImage<ept id=\"p2\">**</ept>."},{"pos":[4112,4211],"content":"Also, this flag cannot be used with <bpt id=\"p1\">**</bpt>–SignedRemovalPackageFolder<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>–PackagesToRemoveFolder<ept id=\"p2\">**</ept>."},{"content":"-NonWspcCompliant","pos":[4322,4339]},{"content":"This parameter is deprecated.","pos":[4343,4372]},{"content":"It was originally used to indicate that the submission was meant not to be compliant with the Windows Phone Standard Package Configuration (WSPC).","pos":[4373,4519]},{"content":"The WSPC model has changed and this flag is no longer used.","pos":[4520,4579]},{"pos":[4581,4750],"content":"For more info about WSPC requirements, see <bpt id=\"p1\">[</bpt>Windows Standard Packaging Configuration (WSPC) requirements for retail images<ept id=\"p1\">](https://msdn.microsoft.com/library/dn756781)</ept>."},{"content":"-FfuPath","pos":[4834,4842]},{"content":"Full path to a FFU file that contains the FFU catalog to be submitted to be signed.","pos":[4846,4929]},{"content":"Include this parameter when specifying <bpt id=\"p1\">**</bpt>–TypeOfSubmission FfuCatalog<ept id=\"p1\">**</ept>.","pos":[4930,5002]},{"content":"-PartialImageDirectory","pos":[5128,5150]},{"content":"Full path to a directory that contains a partial image that consists only of SPKG files.","pos":[5154,5242]},{"content":"Include this parameter when specifying <bpt id=\"p1\">**</bpt>–TypeOfSubmission PartialImage<ept id=\"p1\">**</ept>.","pos":[5243,5317]},{"pos":[5478,5511],"content":"Sample Windows PowerShell scripts"},{"content":"The following Windows PowerShell script can be used to submit a FFU catalog to be signed.","pos":[5514,5603]},{"content":"The following Windows PowerShell script can be used to submit a partial image to be signed.","pos":[5766,5857]},{"content":"The following Windows PowerShell script can be used to read validation errors in the output pipeline of this cmdlet, where <ph id=\"ph1\">\\[</ph>path<ph id=\"ph2\">\\]</ph> is replaced with the respective absolute file path.","pos":[6035,6218]},{"pos":[6610,6616],"content":"Errors"},{"content":"If the submission zip isn’t constructed properly, this Windows Powershell cmdlet returns an empty string.","pos":[6619,6724]},{"content":"If the submission zip is constructed but there were validation errors, these errors are captured in the error log in the submission zip.","pos":[6725,6861]},{"content":"In Windows Phone 8.1, a targeting package was required (<ph id=\"ph1\">&amp;lt;</ph>OEM<ph id=\"ph2\">&amp;gt;</ph>.<ph id=\"ph3\">&amp;lt;</ph>Device<ph id=\"ph4\">&amp;gt;</ph>.Customizations.MainOS.spkg).","pos":[6863,6974]},{"content":"If this package isn’t included, an exception will be thrown.","pos":[6975,7035]},{"pos":[7223,7265],"content":"Help documentation from Windows PowerShell"},{"pos":[13468,13482],"content":"Related topics"},{"content":"Windows Standard Packaging Configuration (WSPC) requirements for retail images","pos":[13486,13564]},{"content":"New-FirmwareSubmission cmdlet","pos":[13613,13642]},{"content":"Submit binaries to be retail signed","pos":[13680,13715]}],"content":"---\nauthor: kpacquer\nDescription: 'Initialize-FirmwareSubmission cmdlet'\nms.assetid: f941c3e5-dea6-444b-aebe-41ca07b24377\nMSHAttr: 'PreferredLib:/library/windows/hardware'\ntitle: 'Initialize-FirmwareSubmission cmdlet'\n---\n\n# Initialize-FirmwareSubmission cmdlet\n\n\nUse this standalone cmdlet to prepare a firmware submission. This cmdlet combines the firmware submission into a zip file on the local computer, and does not communicate with partner services.\n\nAfter using this cmdlet, use [New-FirmwareSubmission cmdlet](new-firmwaresubmission-cmdlet.md) to upload the zip file that contains the firmware submission. This cmdlet provides only a .NET file object as an output. To submit the zip file that is created from this cmdlet, use the **New-FirmwareSubmission** cmdlet.\n\n## <span id=\"Prerequisites\"></span><span id=\"prerequisites\"></span><span id=\"PREREQUISITES\"></span>Prerequisites\n\n\nCreate a package using ImgGen.cmd. This creates multiple files, including an UpdateHistory.xml file and a targeting package file, which is named using the following format where &lt;OEM&gt; is the name of the OEM and &lt;Device&gt; is the name of the device:\n\n&lt;OEM&gt;.&lt;Device&gt;.Customizations.MainOS.spkg\n\nTo use the same image for multiple OEMs or devices, add a targeting file (PhoneMetadataDeviceTargetingInfo.xml). For more info, see [DeviceInfo](https://msdn.microsoft.com/library/windows/hardware/mt138322).\n\n## <span id=\"Parameters\"></span><span id=\"parameters\"></span><span id=\"PARAMETERS\"></span>Parameters\n\n\nThe following are the input parameters for this cmdlet.\n\n<span id=\"-UpdateHistoryPath__required_\"></span><span id=\"-updatehistorypath__required_\"></span><span id=\"-UPDATEHISTORYPATH__REQUIRED_\"></span>*-UpdateHistoryPath (required)*  \nA string path to the UpdateHistory file.\n\n<span id=\"-OemInputPath__required_\"></span><span id=\"-oeminputpath__required_\"></span><span id=\"-OEMINPUTPATH__REQUIRED_\"></span>*-OemInputPath (required)*  \nA string path to the OEMInput.xml file.\n\n<span id=\"-TypeOfSubmission__required_\"></span><span id=\"-typeofsubmission__required_\"></span><span id=\"-TYPEOFSUBMISSION__REQUIRED_\"></span>*-TypeOfSubmission (required)*  \nThe submission type. The type must be **Image**, **FfuCatalog**, or **PartialImage**.\n\n<span id=\"-OutputFilePath__required_\"></span><span id=\"-outputfilepath__required_\"></span><span id=\"-OUTPUTFILEPATH__REQUIRED_\"></span>*-OutputFilePath (required)*  \nA string path to the resulting output zip file. If this parameter does not contain a full path, the output file is saved in the current working directory.\n\n<span id=\"-TypeOfProduct\"></span><span id=\"-typeofproduct\"></span><span id=\"-TYPEOFPRODUCT\"></span>*-TypeOfProduct*  \nAn optional parameter that specifies the target product of the firmware submission. The product must be one of WindowsPhoneBlue, WindowsPhoneThreshold and WindowsIoTCoreThreshold. Default is WindowsPhoneBlue.\n\n**Note**  Product values may be added or removed periodically.\n\n \n\n<span id=\"-SignedRemovalPackageFolder\"></span><span id=\"-signedremovalpackagefolder\"></span><span id=\"-SIGNEDREMOVALPACKAGEFOLDER\"></span>*-SignedRemovalPackageFolder*  \nA string path to a folder that contains removal packages (with file extensions ending in .spkr) to be added to an image.\n\n<span id=\"-PackagesToRemoveFolder\"></span><span id=\"-packagestoremovefolder\"></span><span id=\"-PACKAGESTOREMOVEFOLDER\"></span>*-PackagesToRemoveFolder*  \nA string path to a folder that contains packages (with file extensions ending in .spkg) that will be used to generate removal packages to the image.\n\n<span id=\"-Baseline\"></span><span id=\"-baseline\"></span><span id=\"-BASELINE\"></span>*-Baseline*  \nDeclare a firmware submission to be a baseline so it can be used for retail servicing (via Request for Update (RFU)). Baseline submissions must be Windows Standard Package Configuration compliant. For more info, see [Windows Standard Packaging Configuration (WSPC) requirements for retail images](https://msdn.microsoft.com/library/dn756781).\n\nThis flag cannot be used with **–TypeOfSubmission FfuCatalog** or **–TypeOfSubmission PartialImage**.\n\nAlso, this flag cannot be used with **–SignedRemovalPackageFolder** or **–PackagesToRemoveFolder**.\n\n<span id=\"-NonWspcCompliant\"></span><span id=\"-nonwspccompliant\"></span><span id=\"-NONWSPCCOMPLIANT\"></span>*-NonWspcCompliant*  \nThis parameter is deprecated. It was originally used to indicate that the submission was meant not to be compliant with the Windows Phone Standard Package Configuration (WSPC). The WSPC model has changed and this flag is no longer used.\n\nFor more info about WSPC requirements, see [Windows Standard Packaging Configuration (WSPC) requirements for retail images](https://msdn.microsoft.com/library/dn756781).\n\n<span id=\"-FfuPath\"></span><span id=\"-ffupath\"></span><span id=\"-FFUPATH\"></span>*-FfuPath*  \nFull path to a FFU file that contains the FFU catalog to be submitted to be signed. Include this parameter when specifying **–TypeOfSubmission FfuCatalog**.\n\n<span id=\"-PartialImageDirectory\"></span><span id=\"-partialimagedirectory\"></span><span id=\"-PARTIALIMAGEDIRECTORY\"></span>*-PartialImageDirectory*  \nFull path to a directory that contains a partial image that consists only of SPKG files. Include this parameter when specifying **–TypeOfSubmission PartialImage**.\n\n## <span id=\"Sample_Windows_PowerShell_scripts\"></span><span id=\"sample_windows_powershell_scripts\"></span><span id=\"SAMPLE_WINDOWS_POWERSHELL_SCRIPTS\"></span>Sample Windows PowerShell scripts\n\n\nThe following Windows PowerShell script can be used to submit a FFU catalog to be signed.\n\n``` syntax\nInitialize-FirmwareSubmission -TypeOfSubmission FfuCatalog –UpdateHistoryPath [path] –OemInputPath [path] –OutputFilePath [path] –FfuPath [path]\n```\n\nThe following Windows PowerShell script can be used to submit a partial image to be signed.\n\n``` syntax\nInitialize-FirmwareSubmission -TypeOfSubmission PartialImage –UpdateHistoryPath [path] –OemInputPath [path] –OutputFilePath [path] –PartialImageDirectoy [path]\n```\n\nThe following Windows PowerShell script can be used to read validation errors in the output pipeline of this cmdlet, where \\[path\\] is replaced with the respective absolute file path.\n\n``` syntax\ntry \n{\nInitialize-FirmwareSubmission -TypeOfSubmission Image –UpdateHistoryPath [path] –OemInputPath [path] –OutputFilePath [path] –SignedRemovalPackageFolder [path] –PackagesToRemoveFolder [path]\n}\ncatch \n{\n# Assuming exception is a validation error\nWrite-Host $_.Exception.ValidationErrorLog\n}\n```\n\n## <span id=\"Errors\"></span><span id=\"errors\"></span><span id=\"ERRORS\"></span>Errors\n\n\nIf the submission zip isn’t constructed properly, this Windows Powershell cmdlet returns an empty string. If the submission zip is constructed but there were validation errors, these errors are captured in the error log in the submission zip.\n\nIn Windows Phone 8.1, a targeting package was required (&lt;OEM&gt;.&lt;Device&gt;.Customizations.MainOS.spkg). If this package isn’t included, an exception will be thrown.\n\n## <span id=\"Help_documentation_from_Windows_PowerShell\"></span><span id=\"help_documentation_from_windows_powershell\"></span><span id=\"HELP_DOCUMENTATION_FROM_WINDOWS_POWERSHELL\"></span>Help documentation from Windows PowerShell\n\n\n``` syntax\nNAME\n    Initialize-FirmwareSubmission\n\nSYNOPSIS\n\n\nSYNTAX\nInitialize-FirmwareSubmission [[-TypeOfProduct] <String>] [[-TypeOfSubmission] <String>] [-UpdateHistoryPath]\n    <String> [-OemInputPath] <String> -OutputFilePath <String> [-SignedRemovalPackageFolder <String>]\n    [-PackagesToRemoveFolder <String>] [-Baseline] -FfuPath -PartialImageDirectory [<CommonParameters>]]\n\n\nDESCRIPTION\n    This cmdlet is used to prepare a submission .zip for code signing,\n    including packages to be signed and related metadata. This cmdlet only\n    works on an x86 instance of PowerShell.\n\n\nPARAMETERS\n    -TypeOfProduct <String>\n        An optional parameter that specifies the target product of the\n        firmware submission. The product must be one of WindowsPhoneBlue and\n        WindowsPhoneThreshold. Default is WindowsPhoneBlue.\n\n        Required?                    false\n        Position?                    0\n        Default value\n        Accept pipeline input?       true (ByValue, ByPropertyName)\n        Accept wildcard characters?  false\n\n    -TypeOfSubmission <String>\n        Acceptable values are Image, PartialImage, and FfuCatalog.\n        Mandatory parameters for Image submission are: UpdateHistoryPath,\n        OemInputPath, and OutputFilePath. If you forget a mandatory parameter,\n        the cmdlet will prompt you for it.\n\n        Required?                    false\n        Position?                    1\n        Default value\n        Accept pipeline input?       true (ByValue, ByPropertyName)\n        Accept wildcard characters?  false\n\n    -UpdateHistoryPath <String>\n        Full path to UpdateHistory.xml file.\n\n        Required?                    true\n        Position?                    2\n        Default value\n        Accept pipeline input?       true (ByValue, ByPropertyName)\n        Accept wildcard characters?  false\n\n    -OemInputPath <String>\n        Full path to OEMInput.xml file.\n\n        Required?                    true\n        Position?                    3\n        Default value\n        Accept pipeline input?       true (ByValue, ByPropertyName)\n        Accept wildcard characters?  false\n\n    -OutputFilePath <String>\n        Full path to directory which will contain output .zip file.\n\n        Required?                    true\n        Position?                    Named\n        Default value\n        Accept pipeline input?       true (ByValue, ByPropertyName)\n        Accept wildcard characters?  false\n\n    -SignedRemovalPackageFolder <String>\n        Full path to directory containing spkrs available to include in\n        submission .zip.\n\n        Required?                    false\n        Position?                    Named\n        Default value\n        Accept pipeline input?       true (ByValue, ByPropertyName)\n        Accept wildcard characters?  false\n\n    -PackagesToRemoveFolder <String>\n        Full path to directory containing spkgs for which spkrs need to be\n        generated and submitted.\n\n        Required?                    false\n        Position?                    Named\n        Default value\n        Accept pipeline input?       true (ByValue, ByPropertyName)\n        Accept wildcard characters?  false\n\n    -Baseline\n        Indicates that the submission should be marked as baseline, which make this submission eligible for retail\n        servicing updates.\n\n        Required?                    false\n        Position?                    Named\n        Default value\n        Accept pipeline input?       true (ByValue, ByPropertyName)\n        Accept wildcard characters?  false\n\n    -FfuPath <String>\n        Full path to an FFU file that contains the FFU catalog to be submitted\n        for code signing.  This parameter is only used for a FfuCatalog\n        submission.\n\n        Required?                    true\n        Position?                    Named\n        Default value\n        Accept pipeline input?       true (ByValue, ByPropertyName)\n        Accept wildcard characters?  false\n\n    -PartialImageDirectory <String>\n        Full path to a directory containing a partial image that consists of\n        only SPKG files.  This parameter is only used for a PartialImage\n        submission.\n\n        Required?                    true\n        Position?                    Named\n        Default value\n        Accept pipeline input?       true (ByValue, ByPropertyName)\n        Accept wildcard characters?  false\n\n    <CommonParameters>\n        This cmdlet supports the common parameters: Verbose, Debug,\n        ErrorAction, ErrorVariable, WarningAction, WarningVariable,\n        OutBuffer, PipelineVariable, and OutVariable. For more information,\n    see\n        about_CommonParameters\n    (http://go.microsoft.com/fwlink/p/?linkid=113216).\n\nINPUTS\n\n\n\nOUTPUTS\n    .NET FileInfo object.\n\n        .NET FileInfo object contains submission .zip ready to submit for code\n        signing.\n\nNOTES\n    --------------  Non-baseline image submission example.  --------------\n\n    PS C:\\> Initialize-FirmwareSubmission -TypeOfProduct WindowsPhoneBlue -TypeOfSubmission Image -UpdateHistoryPath\n    c:\\input -OemInputPath c:\\input -OutputFilePath c:\\output\n\n\n\n\n\n    --------------  Baseline image submission example.  --------------\n\n    PS C:\\> Initialize-FirmwareSubmission -TypeOfProduct WindowsPhoneThreshold -TypeOfSubmission Image\n    -UpdateHistoryPath c:\\input -OemInputPath c:\\input -OutputFilePath c:\\output -baseline\n\n\n\n\n\n    --------------  FFU catalog submission example.  --------------\n\n    PS C:\\> Initialize-FirmwareSubmission -TypeOfProduct WindowsPhoneThreshold\n            -TypeOfSubmission FfuCatalog -UpdateHistoryPath c:\\input -OemInputPath\n            c:\\input -OutputFilePath c:\\output -FfuPath c:\\input\\flash.ffu\n\n\n\n\n    --------------  Partial image submission example.  --------------\n\n    PS C:\\> Initialize-FirmwareSubmission -TypeOfProduct WindowsPhoneBlue\n            -TypeOfSubmission PartialImage -UpdateHistoryPath c:\\input -OemInputPath\n            c:\\input -OutputFilePath c:\\output -PartialImageDirectory c:\\input\\spkg\n\n\n\n\n    --------------  Print usage text example.  --------------\n\n    PS C:\\> Initialize-FirmwareSubmission\n\n\nRELATED LINKS\n```\n\n## <span id=\"related_topics\"></span>Related topics\n\n\n[Windows Standard Packaging Configuration (WSPC) requirements for retail images](https://msdn.microsoft.com/library/dn756781)\n\n[New-FirmwareSubmission cmdlet](new-firmwaresubmission-cmdlet.md)\n\n[Submit binaries to be retail signed](https://msdn.microsoft.com/library/windows/hardware/dn789223)\n\n \n\n \n\n\n\n\n\n\n"}