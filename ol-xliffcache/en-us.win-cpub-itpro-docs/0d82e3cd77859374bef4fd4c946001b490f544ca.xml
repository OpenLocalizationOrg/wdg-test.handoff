{"nodes":[{"content":"Creating a Windows Virtual PC Image for MED-V","pos":[11,56]},{"content":"Creating a Windows Virtual PC Image for MED-V","pos":[70,115]},{"content":"Creating a Windows Virtual PC Image for MED-V","pos":[278,323]},{"content":"Before you can deliver a MED-V workspace to users, you have to first prepare a virtual hard disk that you use to build the MED-V workspace installer package for Microsoft Enterprise Desktop Virtualization (MED-V) 2.0.","pos":[326,543]},{"content":"To prepare the necessary virtual hard disk, you must create a Windows Virtual PC image that contains the required operating system, updates, and software to let you later deploy applications and URL redirection information to users.","pos":[544,776]},{"content":"This section provides guidance about how to create the virtual hard disk.","pos":[777,850]},{"content":"To create a virtual image for MED-V, you must follow these steps.","pos":[852,917]},{"content":"Create a Windows Virtual PC image","pos":[924,957]},{"content":"Install Windows XP on the image","pos":[1021,1052]},{"content":"Install the .NET Framework on the image","pos":[1094,1133]},{"content":"Apply updates to the image","pos":[1162,1188]},{"content":"Install Integration Components","pos":[1221,1251]},{"pos":[1357,1392],"content":"Creating a Windows Virtual PC Image"},{"content":"To create a Windows Virtual PC image, see the Windows Virtual PC documentation:","pos":[1395,1474]},{"pos":[1480,1606],"content":"<bpt id=\"p1\">[</bpt>Windows Virtual PC Home Page<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=148103)</ept> (http://go.microsoft.com/fwlink/?LinkId=148103)."},{"pos":[1612,1733],"content":"<bpt id=\"p1\">[</bpt>Windows Virtual PC Help<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=182378)</ept> (http://go.microsoft.com/fwlink/?LinkId=182378)."},{"content":"Alternately, if you already have a Windows Imaging (WIM) file that you want to use as the basis for your virtual image, you can convert it to a VHD that you use to build the MED-V workspace.","pos":[1735,1925]},{"content":"For more information about how to convert a WIM to a virtual hard disk, see <bpt id=\"p1\">[</bpt>Native VHD Support in Windows 7<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=195922)</ept> (http://go.microsoft.com/fwlink/?LinkId=195922).","pos":[1926,2131]},{"content":"Important","pos":[2135,2144]},{"content":"MED-V only supports one virtual hard disk per virtual machine and only one partition on each virtual disk.","pos":[2149,2255]},{"content":"After you have created your virtual hard disk, install Windows XP on the image.","pos":[2260,2339]},{"pos":[2396,2447],"content":"Installing Windows XP on a Windows Virtual PC Image"},{"content":"MED-V requires that Windows XP SP3 is installed on the Windows Virtual PC image before you build the MED-V workspace.","pos":[2450,2567]},{"pos":[2569,2786],"content":"For more information about how to install Windows XP, see <bpt id=\"p1\">[</bpt>Create a virtual machine and install a guest operating system<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=182379)</ept> (http://go.microsoft.com/fwlink/?LinkId=182379)."},{"pos":[2830,2897],"content":"Installing the .NET Framework 3.5 SP1 on a Windows Virtual PC Image"},{"content":"You must manually install the .NET Framework 3.5 SP1 and the update KB959209 into the Windows Virtual PC image that you prepare for use with MED-V.","pos":[2900,3047]},{"content":"The update <bpt id=\"p1\">[</bpt>KB959209<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=204950)</ept> (http://go.microsoft.com/fwlink/?LinkId=204950) addresses several known application compatibility issues.","pos":[3048,3222]},{"pos":[3270,3318],"content":"Applying Updates to the Windows Virtual PC Image"},{"content":"After you have installed Windows XP on your virtual machine, install any required Windows XP updates on the image, such as SP3.","pos":[3321,3448]},{"content":"You can also install certain optional updates for better performance.","pos":[3449,3518]},{"content":"Important","pos":[3522,3531]},{"content":"MED-V requires that Windows XP SP3 be running on the guest operating system.","pos":[3536,3612]},{"content":"Warning","pos":[3619,3626]},{"content":"When you install updates to Windows XP, make sure that you remain on the version of Internet Explorer in the guest that you intend to use in the MED-V workspace.","pos":[3631,3792]},{"content":"For example, if you intend to run Internet Explorer 6 in the MED-V workspace, make sure that any updates that you install now do not include Internet Explorer 7 or Internet Explorer 8.","pos":[3793,3977]},{"content":"In addition, we recommend that you configure the registry to prevent automatic updates from upgrading Internet Explorer.","pos":[3978,4098]},{"content":"Installing an Optional Performance Update","pos":[4107,4148]},{"content":"Although it is optional, we recommend that you install the following update for <bpt id=\"p1\">[</bpt>hotfix KB972435<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=201077)</ept> (http://go.microsoft.com/fwlink/?LinkId=201077).","pos":[4150,4343]},{"content":"This update increases the performance of shared folders in a Terminal Services session:","pos":[4344,4431]},{"content":"Note","pos":[4435,4439]},{"content":"The update is publically available.","pos":[4444,4479]},{"content":"However, you might be prompted to accept an agreement for Microsoft Services.","pos":[4480,4557]},{"content":"Follow the prompts on the successive webpages to retrieve this hotfix.","pos":[4558,4628]},{"content":"Configuring a Group Policy Performance Update","pos":[4637,4682]},{"content":"By default, Group Policy is downloaded to a computer one byte at a time.","pos":[4684,4756]},{"content":"This causes delays while MED-V is being joined to the domain.","pos":[4757,4818]},{"content":"To increase the performance of Group Policy, set the following registry key value to the registry:","pos":[4819,4917]},{"content":"Registry subkey: HKEY<ph id=\"ph1\">\\_</ph>LOCAL<ph id=\"ph2\">\\_</ph>MACHINE<ph id=\"ph3\">\\\\</ph>SOFTWARE<ph id=\"ph4\">\\\\</ph>Microsoft<ph id=\"ph5\">\\\\</ph>Windows NT<ph id=\"ph6\">\\\\</ph>CurrentVersion<ph id=\"ph7\">\\\\</ph>Winlogon","pos":[4919,5015]},{"content":"Entry: BufferPolicyReads","pos":[5017,5041]},{"content":"Type: DWORD","pos":[5043,5054]},{"content":"Value: 1","pos":[5056,5064]},{"pos":[5113,5146],"content":"Installing Integration Components"},{"content":"Windows Virtual PC includes the Integration Components package.","pos":[5149,5212]},{"content":"This provides features that improve the interaction between the virtual environment and the physical computer.","pos":[5213,5323]},{"content":"For example, the Integration Components package lets your mouse move between the host and the guest computers.","pos":[5324,5434]},{"content":"Important","pos":[5438,5447]},{"content":"MED-V requires the installation of the Integration Components package.","pos":[5452,5522]},{"content":"When you configure the virtual image to work with MED-V, you must manually install the Integration Components package on the guest operating system to make the integration features that are available.","pos":[5527,5727]},{"content":"For more information about how to install and use the Integration Components package, see the following:","pos":[5729,5833]},{"pos":[5839,5990],"content":"<bpt id=\"p1\">[</bpt>Install or Upgrade the Integration Components Package<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=195923)</ept> (http://go.microsoft.com/fwlink/?LinkId=195923)."},{"pos":[5996,6120],"content":"<bpt id=\"p1\">[</bpt>About Integration Features<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=195924)</ept> (http://go.microsoft.com/fwlink/?LinkId=195924)."},{"content":"Installing RemoteApp Update","pos":[6126,6153]},{"content":"After you install the Integration Components package, you are prompted to install the following update: \"Update for Windows XP SP3 to enable RemoteApp.\"","pos":[6155,6307]},{"content":"This is a required component for MED-V.","pos":[6308,6347]},{"content":"Important","pos":[6351,6360]},{"content":"If you are not prompted to install the RemoteApp update, you must download and install it manually.","pos":[6365,6464]},{"content":"For more information and instructions about how to download this update, see <bpt id=\"p1\">[</bpt>Update for Windows XP SP3 to enable RemoteApp<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=195925)</ept> (http://go.microsoft.com/fwlink/?LinkId=195925).","pos":[6465,6685]},{"content":"Enabling Remote Desktop","pos":[6694,6717]},{"content":"By default, Remote Desktop is enabled after you install the Integration Components package.","pos":[6719,6810]},{"content":"For MED-V to be operational, ensure that Remote Desktop is enabled, and do not distribute any Group Policy that disables it.","pos":[6811,6935]},{"pos":[6937,7123],"content":"For information about how to enable Remote Desktop, see <bpt id=\"p1\">[</bpt>Enable or disable Remote Desktop<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=201162)</ept> (http://go.microsoft.com/fwlink/?LinkId=201162)."},{"content":"Customizing Internet Explorer by Using the Internet Explorer Administration Kit","pos":[7128,7207]},{"content":"If you want, you can use the Internet Explorer Administration Kit to customize Internet Explorer on the guest operating system.","pos":[7210,7337]},{"content":"For more information, see the <bpt id=\"p1\">[</bpt>Internet Explorer 6 Administration Kit and Deployment Guide<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=200007)</ept> (http:// go.microsoft.com/fwlink/?LinkId=200007).","pos":[7338,7526]},{"content":"Warning","pos":[7530,7537]},{"content":"You should consider security concerns associated with customizing Internet Explorer in the MED-V workspace.","pos":[7542,7649]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Security Best Practices for MED-V Operations<ept id=\"p1\">](security-best-practices-for-med-v-operations.md)</ept>.","pos":[7650,7772]},{"content":"After your virtual hard disk is installed with an up-to-date guest operating system, you can install applications on the image.","pos":[7777,7904]},{"content":"Related topics","pos":[7909,7923]},{"content":"Installing Applications on a Windows Virtual PC Image","pos":[7927,7980]},{"content":"Configuring a Windows Virtual PC Image for MED-V","pos":[8042,8090]}],"content":"---\ntitle: Creating a Windows Virtual PC Image for MED-V\ndescription: Creating a Windows Virtual PC Image for MED-V\nauthor: jamiejdt\nms.assetid: fd7c0b1a-0769-4e7b-ad1a-dad19cca081f\nms.pagetype: mdop, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w7\n---\n\n\n# Creating a Windows Virtual PC Image for MED-V\n\n\nBefore you can deliver a MED-V workspace to users, you have to first prepare a virtual hard disk that you use to build the MED-V workspace installer package for Microsoft Enterprise Desktop Virtualization (MED-V) 2.0. To prepare the necessary virtual hard disk, you must create a Windows Virtual PC image that contains the required operating system, updates, and software to let you later deploy applications and URL redirection information to users. This section provides guidance about how to create the virtual hard disk.\n\nTo create a virtual image for MED-V, you must follow these steps.\n\n1.  [Create a Windows Virtual PC image](#bkmk-creatingavirtualmachinebyusingmicrosoftvirtualpc)\n\n2.  [Install Windows XP on the image](#bkmk-installingwindowsxpontovpc)\n\n3.  [Install the .NET Framework on the image](#bkmk-installingnet)\n\n4.  [Apply updates to the image](#bkmk-applypatchestovpc)\n\n5.  [Install Integration Components](#bkmk-installintegration)\n\n## <a href=\"\" id=\"bkmk-creatingavirtualmachinebyusingmicrosoftvirtualpc\"></a>Creating a Windows Virtual PC Image\n\n\nTo create a Windows Virtual PC image, see the Windows Virtual PC documentation:\n\n-   [Windows Virtual PC Home Page](http://go.microsoft.com/fwlink/?LinkId=148103) (http://go.microsoft.com/fwlink/?LinkId=148103).\n\n-   [Windows Virtual PC Help](http://go.microsoft.com/fwlink/?LinkId=182378) (http://go.microsoft.com/fwlink/?LinkId=182378).\n\nAlternately, if you already have a Windows Imaging (WIM) file that you want to use as the basis for your virtual image, you can convert it to a VHD that you use to build the MED-V workspace. For more information about how to convert a WIM to a virtual hard disk, see [Native VHD Support in Windows 7](http://go.microsoft.com/fwlink/?LinkId=195922) (http://go.microsoft.com/fwlink/?LinkId=195922).\n\n**Important**  \nMED-V only supports one virtual hard disk per virtual machine and only one partition on each virtual disk.\n\n \n\nAfter you have created your virtual hard disk, install Windows XP on the image.\n\n## <a href=\"\" id=\"bkmk-installingwindowsxpontovpc\"></a>Installing Windows XP on a Windows Virtual PC Image\n\n\nMED-V requires that Windows XP SP3 is installed on the Windows Virtual PC image before you build the MED-V workspace.\n\nFor more information about how to install Windows XP, see [Create a virtual machine and install a guest operating system](http://go.microsoft.com/fwlink/?LinkId=182379) (http://go.microsoft.com/fwlink/?LinkId=182379).\n\n## <a href=\"\" id=\"bkmk-installingnet\"></a>Installing the .NET Framework 3.5 SP1 on a Windows Virtual PC Image\n\n\nYou must manually install the .NET Framework 3.5 SP1 and the update KB959209 into the Windows Virtual PC image that you prepare for use with MED-V. The update [KB959209](http://go.microsoft.com/fwlink/?LinkId=204950) (http://go.microsoft.com/fwlink/?LinkId=204950) addresses several known application compatibility issues.\n\n## <a href=\"\" id=\"bkmk-applypatchestovpc\"></a>Applying Updates to the Windows Virtual PC Image\n\n\nAfter you have installed Windows XP on your virtual machine, install any required Windows XP updates on the image, such as SP3. You can also install certain optional updates for better performance.\n\n**Important**  \nMED-V requires that Windows XP SP3 be running on the guest operating system.\n\n \n\n**Warning**  \nWhen you install updates to Windows XP, make sure that you remain on the version of Internet Explorer in the guest that you intend to use in the MED-V workspace. For example, if you intend to run Internet Explorer 6 in the MED-V workspace, make sure that any updates that you install now do not include Internet Explorer 7 or Internet Explorer 8. In addition, we recommend that you configure the registry to prevent automatic updates from upgrading Internet Explorer.\n\n \n\n### Installing an Optional Performance Update\n\nAlthough it is optional, we recommend that you install the following update for [hotfix KB972435](http://go.microsoft.com/fwlink/?LinkId=201077) (http://go.microsoft.com/fwlink/?LinkId=201077). This update increases the performance of shared folders in a Terminal Services session:\n\n**Note**  \nThe update is publically available. However, you might be prompted to accept an agreement for Microsoft Services. Follow the prompts on the successive webpages to retrieve this hotfix.\n\n \n\n### Configuring a Group Policy Performance Update\n\nBy default, Group Policy is downloaded to a computer one byte at a time. This causes delays while MED-V is being joined to the domain. To increase the performance of Group Policy, set the following registry key value to the registry:\n\nRegistry subkey: HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\n\nEntry: BufferPolicyReads\n\nType: DWORD\n\nValue: 1\n\n## <a href=\"\" id=\"bkmk-installintegration\"></a>Installing Integration Components\n\n\nWindows Virtual PC includes the Integration Components package. This provides features that improve the interaction between the virtual environment and the physical computer. For example, the Integration Components package lets your mouse move between the host and the guest computers.\n\n**Important**  \nMED-V requires the installation of the Integration Components package.\n\n \n\nWhen you configure the virtual image to work with MED-V, you must manually install the Integration Components package on the guest operating system to make the integration features that are available.\n\nFor more information about how to install and use the Integration Components package, see the following:\n\n-   [Install or Upgrade the Integration Components Package](http://go.microsoft.com/fwlink/?LinkId=195923) (http://go.microsoft.com/fwlink/?LinkId=195923).\n\n-   [About Integration Features](http://go.microsoft.com/fwlink/?LinkId=195924) (http://go.microsoft.com/fwlink/?LinkId=195924).\n\n### Installing RemoteApp Update\n\nAfter you install the Integration Components package, you are prompted to install the following update: \"Update for Windows XP SP3 to enable RemoteApp.\" This is a required component for MED-V.\n\n**Important**  \nIf you are not prompted to install the RemoteApp update, you must download and install it manually. For more information and instructions about how to download this update, see [Update for Windows XP SP3 to enable RemoteApp](http://go.microsoft.com/fwlink/?LinkId=195925) (http://go.microsoft.com/fwlink/?LinkId=195925).\n\n \n\n### Enabling Remote Desktop\n\nBy default, Remote Desktop is enabled after you install the Integration Components package. For MED-V to be operational, ensure that Remote Desktop is enabled, and do not distribute any Group Policy that disables it.\n\nFor information about how to enable Remote Desktop, see [Enable or disable Remote Desktop](http://go.microsoft.com/fwlink/?LinkId=201162) (http://go.microsoft.com/fwlink/?LinkId=201162).\n\n## Customizing Internet Explorer by Using the Internet Explorer Administration Kit\n\n\nIf you want, you can use the Internet Explorer Administration Kit to customize Internet Explorer on the guest operating system. For more information, see the [Internet Explorer 6 Administration Kit and Deployment Guide](http://go.microsoft.com/fwlink/?LinkId=200007) (http:// go.microsoft.com/fwlink/?LinkId=200007).\n\n**Warning**  \nYou should consider security concerns associated with customizing Internet Explorer in the MED-V workspace. For more information, see [Security Best Practices for MED-V Operations](security-best-practices-for-med-v-operations.md).\n\n \n\nAfter your virtual hard disk is installed with an up-to-date guest operating system, you can install applications on the image.\n\n## Related topics\n\n\n[Installing Applications on a Windows Virtual PC Image](installing-applications-on-a-windows-virtual-pc-image.md)\n\n[Configuring a Windows Virtual PC Image for MED-V](configuring-a-windows-virtual-pc-image-for-med-v.md)\n\n \n\n \n\n\n\n\n\n"}