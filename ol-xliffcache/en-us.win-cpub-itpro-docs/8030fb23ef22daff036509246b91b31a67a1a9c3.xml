{"nodes":[{"content":"How to Set Up Script Actions","pos":[11,39]},{"content":"How to Set Up Script Actions","pos":[53,81]},{"content":"How to Set Up Script Actions","pos":[244,272]},{"content":"The script actions editor allows the administrator to create actions to be performed during MED-V workspace setup, as well as to define the order in which they are performed.","pos":[275,449]},{"content":"The following is a list of actions that can be added to the domain setup script:","pos":[451,531]},{"pos":[537,573],"content":"<bpt id=\"p1\">**</bpt>Restart Windows<ept id=\"p1\">**</ept>—Restart Windows."},{"pos":[579,758],"content":"<bpt id=\"p1\">**</bpt>Join Domain<ept id=\"p1\">**</ept>—If joining a domain, include this action and configure the user name, password, fully qualified domain name, NetBIOS domain name, and organization unit (optional)."},{"pos":[764,918],"content":"<bpt id=\"p1\">**</bpt>Check Connectivity<ept id=\"p1\">**</ept>—Configure a server to connect to and verify that the MED-V workspace can connect to a network resource (such as the domain server)."},{"pos":[924,1071],"content":"<bpt id=\"p1\">**</bpt>Command Line<ept id=\"p1\">**</ept>—Configure a script in the MED-V workspace, and enter a command line that includes the path of the script and the script arguments."},{"pos":[1077,1163],"content":"<bpt id=\"p1\">**</bpt>Rename Computer<ept id=\"p1\">**</ept>—Rename the virtual machine computer based on the defined settings."},{"content":"<bpt id=\"p1\">**</bpt>Disable Auto-Logon<ept id=\"p1\">**</ept>—Disable Windows Auto-Logon.","pos":[1169,1219]},{"content":"This action should be added at the end of scripts that add the computer to the domain.","pos":[1220,1306]},{"pos":[1361,1389],"content":"How to Set Up Script Actions"},{"content":"To set up script actions","pos":[1394,1418]},{"pos":[1426,1475],"content":"On the <bpt id=\"p1\">**</bpt>VM Setup<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>Script Editor<ept id=\"p2\">**</ept>."},{"pos":[1481,1580],"content":"In the <bpt id=\"p1\">**</bpt>Script Actions<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>, and on the submenu, click the desired actions."},{"content":"Configure the actions as described in the following tables.","pos":[1586,1645]},{"pos":[1651,1872],"content":"**Note**  \n**Rename Computer** is configured in the **VM Settings** tab. For more information, see [How to Configure VM Computer Name Pattern Properties](how-to-configure-vm-computer-name-pattern-propertiesmedvv2.md).","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"**Rename Computer** is configured in the **VM Settings** tab. For more information, see [How to Configure VM Computer Name Pattern Properties](how-to-configure-vm-computer-name-pattern-propertiesmedvv2.md).","pos":[11,217],"nodes":[{"content":"<bpt id=\"p1\">**</bpt>Rename Computer<ept id=\"p1\">**</ept> is configured in the <bpt id=\"p2\">**</bpt>VM Settings<ept id=\"p2\">**</ept> tab.","pos":[0,61]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to Configure VM Computer Name Pattern Properties<ept id=\"p1\">](how-to-configure-vm-computer-name-pattern-propertiesmedvv2.md)</ept>.","pos":[62,206]}]}]},{"pos":[1885,2034],"content":"**Note**  \nTo rename a computer, Windows must be restarted. It is recommended to add a Restart Windows action following a Rename Computer action.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"To rename a computer, Windows must be restarted. It is recommended to add a Restart Windows action following a Rename Computer action.","pos":[11,145],"nodes":[{"content":"To rename a computer, Windows must be restarted.","pos":[0,48]},{"content":"It is recommended to add a Restart Windows action following a Rename Computer action.","pos":[49,134]}]}]},{"pos":[2047,2131],"content":"Set the order of the actions by selecting an action and clicking <bpt id=\"p1\">**</bpt>Up<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Down<ept id=\"p2\">**</ept>."},{"pos":[2137,2150],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"Note","pos":[2154,2158]},{"content":"When running the Join Domain script, for the script to work, the user logged into the MED-V workspace virtual machine must have local administrator rights.","pos":[2163,2318]},{"content":"Note","pos":[2325,2329]},{"content":"When running the Disable Auto-Logon script, it is recommended to disable the local guest account used for the auto-logon once the initial setup is complete.","pos":[2334,2490]},{"content":"Join Domain Properties","pos":[2549,2571]},{"content":"Property","pos":[2691,2699]},{"content":"Description","pos":[2722,2733]},{"content":"Credentials to use when joining the VM to the domain","pos":[2799,2851]},{"content":"Select one of the following credentials to use when joining the VM to the domain:","pos":[2881,2962]},{"content":"Use MED-V credentials<ph id=\"ph1\">&lt;/strong&gt;</ph>—The end-user credentials.","pos":[2987,3043]},{"content":"Use the following credentials<ph id=\"ph1\">&lt;/strong&gt;</ph>—The credentials specified; enter a user name and password in the corresponding fields.","pos":[3068,3193]},{"content":"Note","pos":[3237,3241]},{"content":"The credentials you enter are visible to all MED-V workspace users.","pos":[3256,3323]},{"content":"It is not recommended to provide domain administrator credentials.","pos":[3324,3390]},{"content":"Domain to join","pos":[3466,3480]},{"content":"Select one of the following:","pos":[3510,3538]},{"content":"Use the domain name utilized in starting the Workspace<ph id=\"ph1\">&lt;/strong&gt;</ph>—Join the domain entered by the end user when logging into the MED-V client.","pos":[3563,3702]},{"content":"To define the mapping from NetBIOS to fully qualified domain names, click <ph id=\"ph1\">&lt;strong&gt;</ph>Global domain mapping table<ph id=\"ph2\">&lt;/strong&gt;</ph>.","pos":[3710,3829]},{"content":"In the global domain mapping table, click <ph id=\"ph1\">&lt;strong&gt;</ph>Add<ph id=\"ph2\">&lt;/strong&gt;</ph>, enter a <ph id=\"ph3\">&lt;strong&gt;</ph>NetBIOS domain name<ph id=\"ph4\">&lt;/strong&gt;</ph> and a <ph id=\"ph5\">&lt;strong&gt;</ph>Fully qualified domain name<ph id=\"ph6\">&lt;/strong&gt;</ph>, and click <ph id=\"ph7\">&lt;strong&gt;</ph>OK<ph id=\"ph8\">&lt;/strong&gt;</ph>.","pos":[3830,4021]},{"content":"Use the following domain name<ph id=\"ph1\">&lt;/strong&gt;</ph>—Join the domain specified; enter a domain name and NetBIOS domain name in the corresponding fields.","pos":[4046,4184]},{"content":"Organization Unit","pos":[4248,4265]},{"content":"An organization unit (OU) may be specified to join the computer to a specific OU.","pos":[4295,4376]},{"content":"The format must follow an OU distinguished name: OU=<ph id=\"ph1\">&amp;lt;</ph>Organization Unit<ph id=\"ph2\">&amp;gt;</ph>,<ph id=\"ph3\">&amp;lt;</ph>Domain Controller<ph id=\"ph4\">&amp;gt;</ph> (for example, OU=QATest, DC=il, DC=MED-V, DC=com).","pos":[4377,4531]},{"content":"Warning","pos":[4564,4571]},{"content":"Only a single level OU is supported as is shown in the example above.","pos":[4586,4655]},{"content":"Check Connectivity Properties","pos":[4776,4805]},{"content":"Property","pos":[4925,4933]},{"content":"Description","pos":[4956,4967]},{"content":"IP Address","pos":[5033,5043]},{"content":"The IP Address of the server that you are verifying connection to.","pos":[5073,5139]},{"content":"Port","pos":[5193,5197]},{"content":"The port of the server that you are verifying connection to.","pos":[5227,5287]},{"content":"Timeout","pos":[5340,5347]},{"content":"The number of seconds to wait for a response before timing out.","pos":[5377,5440]},{"content":"Command-Line Properties","pos":[5533,5556]},{"content":"Property","pos":[5676,5684]},{"content":"Description","pos":[5707,5718]},{"content":"Path","pos":[5784,5788]},{"content":"The path of the command line.","pos":[5818,5847]},{"content":"Arguments","pos":[5901,5910]},{"content":"Command-line arguments.","pos":[5940,5963]},{"content":"Wait for exit","pos":[6016,6029]},{"content":"Select the check box to wait for a return before continuing with the script actions.","pos":[6059,6143]},{"content":"Fail on error","pos":[6197,6210]},{"content":"Select this check box if the return is anything but the value specified.","pos":[6240,6312]},{"content":"Enter the value that will indicate the command as a success.","pos":[6320,6380]},{"content":"Default: <ph id=\"ph1\">&lt;strong&gt;</ph>0","pos":[6388,6406]},{"content":"Perform only once","pos":[6468,6485]},{"content":"Select this check box to run the command line only once.","pos":[6515,6571]},{"content":"If the script fails or is canceled, this command will not be performed again.","pos":[6572,6649]},{"content":"This command line causes a restart of Windows in the Workspace","pos":[6703,6765]},{"content":"Select this check box if the command line causes a restart after completion.","pos":[6795,6871]},{"content":"Allow interaction","pos":[6924,6941]},{"content":"Select this check box if the command will require user interaction.","pos":[6971,7038]},{"content":"Progress message","pos":[7092,7108]},{"content":"Message to be displayed to the user while the command is running.","pos":[7138,7203]},{"content":"Failure message","pos":[7256,7271]},{"content":"Message to be displayed to the user if the command fails.","pos":[7301,7358]},{"content":"When configuring the command-line action, several variables can be used as defined in the following table.","pos":[7396,7502]},{"content":"Parameter","pos":[7640,7649]},{"content":"Value","pos":[7672,7677]},{"content":"Description","pos":[7700,7711]},{"content":"%MEDVUser%","pos":[7777,7787]},{"content":"An authenticated user name.","pos":[7817,7844]},{"content":"MED-V authenticated user name.","pos":[7874,7904]},{"content":"The user name and password can be used in the join domain VM setup script.","pos":[7905,7979]},{"content":"%MEDVPassword%","pos":[8033,8047]},{"content":"An authenticated password.","pos":[8077,8103]},{"content":"MED-V authenticated password.","pos":[8133,8162]},{"content":"The user name and password can be used in the join domain VM setup script.","pos":[8163,8237]},{"content":"%MEDVDomain%","pos":[8290,8302]},{"content":"Configured domain.","pos":[8332,8350]},{"content":"The domain configured in the MED-V authentication.","pos":[8380,8430]},{"content":"It can be used on the VM setup script.","pos":[8431,8469]},{"content":"%DesiredMachineName%","pos":[8523,8543]},{"content":"Computer name.","pos":[8573,8587]},{"content":"The unique computer name configured in the management application.","pos":[8617,8683]},{"content":"It can be used in the VM setup script.","pos":[8684,8722]},{"content":"Related topics","pos":[8763,8777]},{"content":"How to Configure the Virtual Machine Setup for a MED-V Workspace","pos":[8781,8845]},{"content":"How to Configure VM Computer Name Pattern Properties","pos":[8924,8976]}],"content":"---\ntitle: How to Set Up Script Actions\ndescription: How to Set Up Script Actions\nauthor: jamiejdt\nms.assetid: 367e28f1-d8c2-4845-a01b-2fff9128ccfd\nms.pagetype: mdop, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w7\n---\n\n\n# How to Set Up Script Actions\n\n\nThe script actions editor allows the administrator to create actions to be performed during MED-V workspace setup, as well as to define the order in which they are performed.\n\nThe following is a list of actions that can be added to the domain setup script:\n\n-   **Restart Windows**—Restart Windows.\n\n-   **Join Domain**—If joining a domain, include this action and configure the user name, password, fully qualified domain name, NetBIOS domain name, and organization unit (optional).\n\n-   **Check Connectivity**—Configure a server to connect to and verify that the MED-V workspace can connect to a network resource (such as the domain server).\n\n-   **Command Line**—Configure a script in the MED-V workspace, and enter a command line that includes the path of the script and the script arguments.\n\n-   **Rename Computer**—Rename the virtual machine computer based on the defined settings.\n\n-   **Disable Auto-Logon**—Disable Windows Auto-Logon. This action should be added at the end of scripts that add the computer to the domain.\n\n## <a href=\"\" id=\"how-to-set-up-script-actions-\"></a>How to Set Up Script Actions\n\n\n**To set up script actions**\n\n1.  On the **VM Setup** tab, click **Script Editor**.\n\n2.  In the **Script Actions** dialog box, click **Add**, and on the submenu, click the desired actions.\n\n3.  Configure the actions as described in the following tables.\n\n    **Note**  \n    **Rename Computer** is configured in the **VM Settings** tab. For more information, see [How to Configure VM Computer Name Pattern Properties](how-to-configure-vm-computer-name-pattern-propertiesmedvv2.md).\n\n     \n\n    **Note**  \n    To rename a computer, Windows must be restarted. It is recommended to add a Restart Windows action following a Rename Computer action.\n\n     \n\n4.  Set the order of the actions by selecting an action and clicking **Up** or **Down**.\n\n5.  Click **OK**.\n\n**Note**  \nWhen running the Join Domain script, for the script to work, the user logged into the MED-V workspace virtual machine must have local administrator rights.\n\n \n\n**Note**  \nWhen running the Disable Auto-Logon script, it is recommended to disable the local guest account used for the auto-logon once the initial setup is complete.\n\n \n\n### <a href=\"\" id=\"bkmk-joindomainproperties\"></a>\n\n**Join Domain Properties**\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Property</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Credentials to use when joining the VM to the domain</p></td>\n<td align=\"left\"><p>Select one of the following credentials to use when joining the VM to the domain:</p>\n<ul>\n<li><p><strong>Use MED-V credentials</strong>—The end-user credentials.</p></li>\n<li><p><strong>Use the following credentials</strong>—The credentials specified; enter a user name and password in the corresponding fields.</p></li>\n</ul>\n<div class=\"alert\">\n<strong>Note</strong>  \n<p>The credentials you enter are visible to all MED-V workspace users. It is not recommended to provide domain administrator credentials.</p>\n</div>\n<div>\n \n</div></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Domain to join</p></td>\n<td align=\"left\"><p>Select one of the following:</p>\n<ul>\n<li><p><strong>Use the domain name utilized in starting the Workspace</strong>—Join the domain entered by the end user when logging into the MED-V client.</p>\n<p>To define the mapping from NetBIOS to fully qualified domain names, click <strong>Global domain mapping table</strong>. In the global domain mapping table, click <strong>Add</strong>, enter a <strong>NetBIOS domain name</strong> and a <strong>Fully qualified domain name</strong>, and click <strong>OK</strong>.</p></li>\n<li><p><strong>Use the following domain name</strong>—Join the domain specified; enter a domain name and NetBIOS domain name in the corresponding fields.</p></li>\n</ul></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Organization Unit</p></td>\n<td align=\"left\"><p>An organization unit (OU) may be specified to join the computer to a specific OU. The format must follow an OU distinguished name: OU=&lt;Organization Unit&gt;,&lt;Domain Controller&gt; (for example, OU=QATest, DC=il, DC=MED-V, DC=com).</p>\n<div class=\"alert\">\n<strong>Warning</strong>  \n<p>Only a single level OU is supported as is shown in the example above.</p>\n</div>\n<div>\n \n</div></td>\n</tr>\n</tbody>\n</table>\n\n \n\n### <a href=\"\" id=\"bkmk-checkconnectivityproperties\"></a>\n\n**Check Connectivity Properties**\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Property</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>IP Address</p></td>\n<td align=\"left\"><p>The IP Address of the server that you are verifying connection to.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Port</p></td>\n<td align=\"left\"><p>The port of the server that you are verifying connection to.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Timeout</p></td>\n<td align=\"left\"><p>The number of seconds to wait for a response before timing out.</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n### <a href=\"\" id=\"bkmk-commandlineproperties\"></a>\n\n**Command-Line Properties**\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Property</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Path</p></td>\n<td align=\"left\"><p>The path of the command line.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Arguments</p></td>\n<td align=\"left\"><p>Command-line arguments.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Wait for exit</p></td>\n<td align=\"left\"><p>Select the check box to wait for a return before continuing with the script actions.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Fail on error</p></td>\n<td align=\"left\"><p>Select this check box if the return is anything but the value specified.</p>\n<p>Enter the value that will indicate the command as a success.</p>\n<p>Default: <strong>0</strong></p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Perform only once</p></td>\n<td align=\"left\"><p>Select this check box to run the command line only once. If the script fails or is canceled, this command will not be performed again.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>This command line causes a restart of Windows in the Workspace</p></td>\n<td align=\"left\"><p>Select this check box if the command line causes a restart after completion.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Allow interaction</p></td>\n<td align=\"left\"><p>Select this check box if the command will require user interaction.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Progress message</p></td>\n<td align=\"left\"><p>Message to be displayed to the user while the command is running.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Failure message</p></td>\n<td align=\"left\"><p>Message to be displayed to the user if the command fails.</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\nWhen configuring the command-line action, several variables can be used as defined in the following table.\n\n<table>\n<colgroup>\n<col width=\"33%\" />\n<col width=\"33%\" />\n<col width=\"33%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Parameter</th>\n<th align=\"left\">Value</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>%MEDVUser%</p></td>\n<td align=\"left\"><p>An authenticated user name.</p></td>\n<td align=\"left\"><p>MED-V authenticated user name. The user name and password can be used in the join domain VM setup script.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>%MEDVPassword%</p></td>\n<td align=\"left\"><p>An authenticated password.</p></td>\n<td align=\"left\"><p>MED-V authenticated password. The user name and password can be used in the join domain VM setup script.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>%MEDVDomain%</p></td>\n<td align=\"left\"><p>Configured domain.</p></td>\n<td align=\"left\"><p>The domain configured in the MED-V authentication. It can be used on the VM setup script.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>%DesiredMachineName%</p></td>\n<td align=\"left\"><p>Computer name.</p></td>\n<td align=\"left\"><p>The unique computer name configured in the management application. It can be used in the VM setup script.</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n## Related topics\n\n\n[How to Configure the Virtual Machine Setup for a MED-V Workspace](how-to-configure-the-virtual-machine-setup-for-a-med-v-workspacemedvv2.md)\n\n[How to Configure VM Computer Name Pattern Properties](how-to-configure-vm-computer-name-pattern-propertiesmedvv2.md)\n\n \n\n \n\n\n\n\n\n"}