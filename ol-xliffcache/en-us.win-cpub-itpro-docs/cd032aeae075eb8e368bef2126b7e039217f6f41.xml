{"nodes":[{"content":"Step-by-Step Guide for Microsoft Advanced Group Policy Management 4.0","pos":[11,80]},{"content":"Step-by-Step Guide for Microsoft Advanced Group Policy Management 4.0","pos":[94,163]},{"content":"Step-by-Step Guide for Microsoft Advanced Group Policy Management 4.0","pos":[311,380]},{"content":"This step-by-step guide demonstrates advanced techniques for Group Policy management that use the Group Policy Management Console (GPMC) and Microsoft Advanced Group Policy Management (AGPM).","pos":[383,574]},{"content":"AGPM increases the capabilities of the GPMC, providing:","pos":[575,630]},{"content":"Standard roles for delegating permissions to manage Group Policy Objects (GPOs) to multiple Group Policy administrators, in addition to the ability to delegate access to GPOs in the production environment.","pos":[636,841]},{"content":"An archive to enable Group Policy administrators to create and modify GPOs offline before the GPOs are deployed into a production environment.","pos":[847,989]},{"content":"The ability to roll back to any earlier version of a GPO in the archive and to limit the number of versions stored in the archive.","pos":[995,1125]},{"content":"Check-in and check-out capability for GPOs to make sure that Group Policy administrators do not unintentionally overwrite each other's work.","pos":[1131,1271]},{"content":"The ability to search for GPOs with specific attributes and to filter the list of GPOs displayed.","pos":[1277,1374]},{"content":"AGPM scenario overview","pos":[1379,1401]},{"content":"For this scenario, you will use a separate user account for each role in AGPM to demonstrate how Group Policy can be managed in an environment that has multiple Group Policy administrators who have different levels of permissions.","pos":[1404,1634]},{"content":"Specifically, you will perform the following tasks:","pos":[1635,1686]},{"content":"Using an account that is a member of the Domain Admins group, install AGPM Server and assign the AGPM Administrator role to an account or group.","pos":[1692,1836]},{"content":"Using accounts to which you will assign AGPM roles, install AGPM Client.","pos":[1842,1914]},{"content":"Using an account that has the AGPM Administrator role, configure AGPM and delegate access to GPOs by assigning roles to other accounts.","pos":[1920,2055]},{"content":"From an account that has the Editor role, request that a new GPO be created that you then approve by using an account that has the Approver role.","pos":[2061,2206]},{"content":"Use the Editor account to check the GPO out of the archive, edit the GPO, check the GPO into the archive, and then request deployment.","pos":[2207,2341]},{"content":"Using an account that has the Approver role, review the GPO and deploy it to your production environment.","pos":[2347,2452]},{"content":"Using an account that has the Editor role, create a GPO template and use it as a starting point to create a new GPO.","pos":[2458,2574]},{"content":"Using an account that has the Approver role, delete and restore a GPO.","pos":[2580,2650]},{"content":"group policy object development process","pos":[2654,2693]},{"content":"Requirements","pos":[2748,2760]},{"content":"Computers on which you want to install AGPM must meet the following requirements, and you must create accounts for use in this scenario.","pos":[2763,2899]},{"content":"Note","pos":[2903,2907]},{"content":"If you have AGPM 2.5 installed and are upgrading from Windows Server® 2003 to Windows Server 2008 R2 or Windows Server 2008, or are upgrading from Windows Vista with no service packs installed to Windows 7 or Windows Vista® with Service Pack 1 (SP1), you must upgrade the operating system before you can upgrade to AGPM 4.0.","pos":[2912,3236]},{"content":"If you have AGPM 3.0 installed, you do not have to upgrade the operating system before you upgrade to AGPM 4.0","pos":[3238,3348]},{"content":"In a mixed environment that includes both newer and older operating systems, there are some limitations to functionality, as indicated in the following table.","pos":[3353,3511]},{"content":"Operating system on which AGPM Server 4.0 runs","pos":[3649,3695]},{"content":"Operating system on which AGPM Client 4.0 runs","pos":[3718,3764]},{"content":"Status of AGPM 4.0 support","pos":[3787,3813]},{"content":"Windows Server 2008 R2 or Windows 7","pos":[3879,3914]},{"content":"Windows Server 2008 R2 or Windows 7","pos":[3944,3979]},{"content":"Supported","pos":[4009,4018]},{"content":"Windows Server 2008 R2 or Windows 7","pos":[4072,4107]},{"content":"Windows Server 2008 or Windows Vista with SP1","pos":[4137,4182]},{"content":"Supported, but cannot edit policy settings or preference items that exist only in Windows Server 2008 R2 or Windows 7","pos":[4212,4329]},{"content":"Windows Server 2008 or Windows Vista with SP1","pos":[4382,4427]},{"content":"Windows Server 2008 R2 or Windows 7","pos":[4457,4492]},{"content":"Unsupported","pos":[4522,4533]},{"content":"Windows Server 2008 or Windows Vista with SP1","pos":[4587,4632]},{"content":"Windows Server 2008 or Windows Vista with SP1","pos":[4662,4707]},{"content":"Supported, but cannot report or edit policy settings or preference items that exist only in Windows Server 2008 R2 or Windows 7","pos":[4737,4864]},{"content":"AGPM Server requirements","pos":[4906,4930]},{"content":"AGPM Server 4.0 requires Windows Server 2008 R2, Windows Server 2008, Windows 7 and the GPMC from Remote Server Administration Tools (RSAT), or Windows Vista with SP1 and the GPMC from RSAT installed.","pos":[4932,5132]},{"content":"Both 32-bit and 64-bit versions are supported.","pos":[5133,5179]},{"content":"Before you install AGPM Server, you must be a member of the Domain Admins group and the following Windows features must be present unless otherwise noted:","pos":[5181,5335]},{"content":"GPMC","pos":[5341,5345]},{"content":"Windows Server 2008 R2 or Windows Server 2008: If the GPMC is not present, it is automatically installed by AGPM.","pos":[5355,5468]},{"content":"Windows 7: You must install the GPMC from RSAT before you install AGPM.","pos":[5478,5549]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Remote Server Administration Tools for Windows 7<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=131280)</ept> (http://go.microsoft.com/fwlink/?LinkID=131280).","pos":[5550,5722]},{"content":"Windows Vista with SP1: You must install the GPMC from RSAT before you install AGPM.","pos":[5732,5816]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Remote Server Administration Tools for Windows Vista with Service Pack 1<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=116179)</ept> (http://go.microsoft.com/fwlink/?LinkID=116179).","pos":[5817,6013]},{"content":"The .NET Framework 3.5 or later versions","pos":[6019,6059]},{"content":"Windows Server 2008 R2 or Windows 7: If the .NET Framework 3.5 or later version is not present, the .NET Framework 3.5 is automatically installed by AGPM.","pos":[6069,6223]},{"content":"Windows Server 2008 or Windows Vista with SP1: You must install the .NET Framework 3.5 or a later version before you install AGPM.","pos":[6233,6363]},{"content":"The following Windows features are required by AGPM Server and will be automatically installed if they are not present:","pos":[6365,6484]},{"content":"WCF Activation; Non-HTTP Activation","pos":[6490,6525]},{"content":"Windows Process Activation Service","pos":[6531,6565]},{"content":"Process Model","pos":[6575,6588]},{"content":"The .NET Environment","pos":[6598,6618]},{"content":"Configuration APIs","pos":[6628,6646]},{"content":"AGPM Client requirements","pos":[6652,6676]},{"content":"AGPM Client 4.0 requires Windows Server 2008 R2, Windows Server 2008, Windows 7 and the GPMC from RSAT, or Windows Vista with SP1 and the GPMC from RSAT installed.","pos":[6678,6841]},{"content":"Both 32-bit and 64-bit versions are supported.","pos":[6842,6888]},{"content":"AGPM Client can be installed on a computer that is running AGPM Server.","pos":[6889,6960]},{"content":"The following Windows features are required by AGPM Client and unless otherwise noted are automatically installed if they are not present:","pos":[6962,7100]},{"content":"GPMC","pos":[7106,7110]},{"content":"Windows Server 2008 R2 or Windows Server 2008: If the GPMC is not present, it is automatically installed by AGPM.","pos":[7120,7233]},{"content":"Windows 7: You must install the GPMC from RSAT before you install AGPM.","pos":[7243,7314]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Remote Server Administration Tools for Windows 7<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=131280)</ept> (http://go.microsoft.com/fwlink/?LinkID=131280).","pos":[7315,7487]},{"content":"Windows Vista with SP1: You must install the GPMC from RSAT before you install AGPM.","pos":[7497,7581]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Remote Server Administration Tools for Windows Vista with Service Pack 1<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkID=116179)</ept> (http://go.microsoft.com/fwlink/?LinkID=116179).","pos":[7582,7778]},{"content":"The .NET Framework 3.0 or later version","pos":[7784,7823]},{"content":"Windows Server 2008 R2 or Windows 7: If the .NET Framework 3.0 or later version is not present, the .NET Framework 3.5 is automatically installed by AGPM.","pos":[7833,7987]},{"content":"Windows Server 2008 or Windows Vista with SP1: If the .NET Framework 3.0 or later version is not present, the .NET Framework 3.0 is automatically installed by AGPM.","pos":[7997,8161]},{"content":"Scenario requirements","pos":[8167,8188]},{"content":"Before you begin this scenario, create four user accounts.","pos":[8190,8248]},{"content":"During the scenario, you will assign one of the following AGPM roles to each of these accounts: AGPM Administrator (Full Control), Approver, Editor, and Reviewer.","pos":[8249,8411]},{"content":"These accounts must be able to send and receive e-mail messages.","pos":[8412,8476]},{"content":"Assign <bpt id=\"p1\">**</bpt>Link GPOs<ept id=\"p1\">**</ept> permission to the accounts that have the AGPM Administrator, Approver, and (optionally) Editor roles.","pos":[8477,8599]},{"content":"Note","pos":[8603,8607]},{"content":"<bpt id=\"p1\">**</bpt>Link GPOs<ept id=\"p1\">**</ept> permission is assigned to members of Domain Administrators and Enterprise Administrators by default.","pos":[8612,8726]},{"content":"To assign <bpt id=\"p1\">**</bpt>Link GPOs<ept id=\"p1\">**</ept> permission to additional users or groups (such as accounts that have the roles of AGPM Administrator or Approver), click the node for the domain and then click the <bpt id=\"p2\">**</bpt>Delegation<ept id=\"p2\">**</ept> tab, select <bpt id=\"p3\">**</bpt>Link GPOs<ept id=\"p3\">**</ept>, click <bpt id=\"p4\">**</bpt>Add<ept id=\"p4\">**</ept>, and select users or groups to which you want to assign the permission.","pos":[8727,9042]},{"content":"Steps for installing and configuring AGPM","pos":[9050,9091]},{"content":"You must complete the following steps to install and configure AGPM.","pos":[9094,9162]},{"content":"Step 1: Install AGPM Server","pos":[9165,9192]},{"content":"Step 2: Install AGPM Client","pos":[9211,9238]},{"content":"Step 3: Configure an AGPM Server connection","pos":[9257,9300]},{"content":"Step 4: Configure e-mail notification","pos":[9319,9356]},{"content":"Step 5: Delegate access","pos":[9375,9398]},{"pos":[9453,9480],"content":"Step 1: Install AGPM Server"},{"content":"In this step, you install AGPM Server on the member server or domain controller that will run the AGPM Service, and you configure the archive.","pos":[9482,9624]},{"content":"All AGPM operations are managed through this Windows service and are executed with the service's credentials.","pos":[9625,9734]},{"content":"The archive managed by an AGPM Server can be hosted on that server or on another server in the same forest.","pos":[9735,9842]},{"content":"To install AGPM Server on the computer that will host the AGPM Service","pos":[9846,9916]},{"content":"Log on with an account that is a member of the Domain Admins group.","pos":[9924,9991]},{"pos":[9997,10140],"content":"Start the Microsoft Desktop Optimization Pack CD and follow the instructions on screen to select <bpt id=\"p1\">**</bpt>Advanced Group Policy Management - Server<ept id=\"p1\">**</ept>."},{"pos":[10146,10192],"content":"In the <bpt id=\"p1\">**</bpt>Welcome<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"pos":[10198,10295],"content":"In the <bpt id=\"p1\">**</bpt>Microsoft Software License Terms<ept id=\"p1\">**</ept> dialog box, accept the terms and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Application Path<ept id=\"p1\">**</ept> dialog box, select a location in which to install AGPM Server.","pos":[10301,10391]},{"content":"The computer on which AGPM Server is installed will host the AGPM Service and manage the archive.","pos":[10392,10489]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[10490,10505]},{"content":"In the <bpt id=\"p1\">**</bpt>Archive Path<ept id=\"p1\">**</ept> dialog box, select a location for the archive in relation to the AGPM Server.","pos":[10511,10612]},{"content":"The archive path can point to a folder on the AGPM Server or elsewhere.","pos":[10613,10684]},{"content":"However, you should select a location with sufficient space to store all GPOs and history data managed by this AGPM Server.","pos":[10685,10808]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[10809,10824]},{"pos":[10830,10961],"content":"In the <bpt id=\"p1\">**</bpt>AGPM Service Account<ept id=\"p1\">**</ept> dialog box, select a service account under which the AGPM Service will run and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"content":"This account must be a member of the either the Domain Admins group or, for a least-privilege configuration, the following groups in each domain managed by the AGPM Server:","pos":[10967,11139]},{"content":"Group Policy Creator Owners","pos":[11149,11176]},{"content":"Backup Operators","pos":[11186,11202]},{"content":"Additionally, this account requires Full Control permission for the following folders:","pos":[11208,11294]},{"content":"The AGPM archive folder, for which this permission is automatically granted during the installation of AGPM Server if it is installed on a local drive.","pos":[11304,11455]},{"content":"The local system temp folder, typically %windir%<ph id=\"ph1\">\\\\</ph>temp.","pos":[11465,11520]},{"content":"In the <bpt id=\"p1\">**</bpt>Archive Owner<ept id=\"p1\">**</ept> dialog box, select an account or group to which you assign the AGPM Administrator (Full Control) role.","pos":[11526,11653]},{"content":"AGPM Administrators can assign AGPM roles and permissions to other Group Policy administrators, so that later you can assign the role of AGPM Administrator to additional Group Policy administrators.","pos":[11654,11852]},{"content":"For this scenario, select the account to serve in the AGPM Administrator role.","pos":[11853,11931]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[11932,11947]},{"content":"In the <bpt id=\"p1\">**</bpt>Port Configuration<ept id=\"p1\">**</ept> dialog box, type a port on which the AGPM Service should listen.","pos":[11953,12047]},{"content":"Do not clear the <bpt id=\"p1\">**</bpt>Add port exception to firewall<ept id=\"p1\">**</ept> check box unless you manually configure port exceptions or use rules to configure port exceptions.","pos":[12048,12198]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[12199,12214]},{"pos":[12220,12317],"content":"In the <bpt id=\"p1\">**</bpt>Languages<ept id=\"p1\">**</ept> dialog box, select one or more display languages to install for AGPM Server."},{"pos":[12323,12393],"content":"Click <bpt id=\"p1\">**</bpt>Install<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept> to exit the Setup Wizard."},{"pos":[12399,12699],"content":"**Caution**  \nDo not change settings for the AGPM Service through **Administrative Tools** and **Services** in the operating system. Doing this can prevent the AGPM Service from starting. For information about how to change settings for the service, see Help for Advanced Group Policy Management.","leadings":["","    "],"nodes":[{"content":"Caution","pos":[2,9]},{"content":"Do not change settings for the AGPM Service through **Administrative Tools** and **Services** in the operating system. Doing this can prevent the AGPM Service from starting. For information about how to change settings for the service, see Help for Advanced Group Policy Management.","pos":[14,296],"nodes":[{"content":"Do not change settings for the AGPM Service through <bpt id=\"p1\">**</bpt>Administrative Tools<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Services<ept id=\"p2\">**</ept> in the operating system.","pos":[0,118]},{"content":"Doing this can prevent the AGPM Service from starting.","pos":[119,173]},{"content":"For information about how to change settings for the service, see Help for Advanced Group Policy Management.","pos":[174,282]}]}]},{"pos":[12745,12772],"content":"Step 2: Install AGPM Client"},{"content":"Each Group Policy administrator—anyone who creates, edits, deploys, reviews, or deletes GPOs—must have AGPM Client installed on computers that they use to manage GPOs.","pos":[12774,12941]},{"content":"The Change Control node, which you use to perform many of the GPO management tasks, appears in the Group Policy Management Console only if you install the AGPM Client.","pos":[12942,13109]},{"content":"For this scenario, you install AGPM Client on at least one computer.","pos":[13110,13178]},{"content":"You do not need to install AGPM Client on the computers of end users who do not perform Group Policy administration.","pos":[13179,13295]},{"content":"To install AGPM Client on the computer of a Group Policy administrator","pos":[13299,13369]},{"pos":[13377,13520],"content":"Start the Microsoft Desktop Optimization Pack CD and follow the instructions on screen to select <bpt id=\"p1\">**</bpt>Advanced Group Policy Management - Client<ept id=\"p1\">**</ept>."},{"pos":[13526,13572],"content":"In the <bpt id=\"p1\">**</bpt>Welcome<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"pos":[13578,13675],"content":"In the <bpt id=\"p1\">**</bpt>Microsoft Software License Terms<ept id=\"p1\">**</ept> dialog box, accept the terms and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Application Path<ept id=\"p1\">**</ept> dialog box, select a location in which to install AGPM Client.","pos":[13681,13771]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[13772,13787]},{"content":"In the <bpt id=\"p1\">**</bpt>AGPM Server<ept id=\"p1\">**</ept> dialog box, type the DNS name or IP address for the AGPM Server and the port to which you want to connect.","pos":[13793,13922]},{"content":"The default port for the AGPM Service is 4600.","pos":[13923,13969]},{"content":"Do not clear the <bpt id=\"p1\">**</bpt>Allow Microsoft Management Console through the firewall<ept id=\"p1\">**</ept> check box unless you manually configure port exceptions or use rules to configure port exceptions.","pos":[13970,14145]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[14146,14161]},{"pos":[14167,14264],"content":"In the <bpt id=\"p1\">**</bpt>Languages<ept id=\"p1\">**</ept> dialog box, select one or more display languages to install for AGPM Client."},{"pos":[14270,14340],"content":"Click <bpt id=\"p1\">**</bpt>Install<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept> to exit the Setup Wizard."},{"pos":[14379,14422],"content":"Step 3: Configure an AGPM Server connection"},{"content":"AGPM stores all versions of each controlled Group Policy Object (GPO), that is, each GPO for which AGPM provides change control, in a central archive.","pos":[14424,14574]},{"content":"This lets Group Policy administrators view and change GPOs offline without immediately affecting the deployed version of each GPO.","pos":[14575,14705]},{"content":"In this step, you configure an AGPM Server connection and ensure that all Group Policy administrators connect to the same AGPM Server.","pos":[14707,14841]},{"content":"(For information about how to configure multiple AGPM Servers, see Help for Advanced Group Policy Management.)","pos":[14842,14952]},{"content":"To configure an AGPM Server connection for all Group Policy administrators","pos":[14956,15030]},{"content":"On a computer on which you have installed AGPM Client, log on with the user account that you selected as the Archive Owner.","pos":[15038,15161]},{"content":"This user has the role of AGPM Administrator (Full Control).","pos":[15162,15222]},{"pos":[15228,15340],"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, point to <bpt id=\"p2\">**</bpt>Administrative Tools<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Group Policy Management<ept id=\"p3\">**</ept> to open the GPMC."},{"content":"Edit a GPO that is applied to all Group Policy administrators.","pos":[15346,15408]},{"pos":[15414,15582],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Editor<ept id=\"p1\">**</ept> window, double-click <bpt id=\"p2\">**</bpt>User Configuration<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Policies<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Administrative Templates<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>Windows Components<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>AGPM<ept id=\"p6\">**</ept>."},{"pos":[15588,15674],"content":"In the details pane, double-click <bpt id=\"p1\">**</bpt>AGPM: Specify default AGPM Server (all domains)<ept id=\"p1\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, select <bpt id=\"p2\">**</bpt>Enabled<ept id=\"p2\">**</ept> and type the DNS name or IP address and port (for example, <bpt id=\"p3\">**</bpt>server.contoso.com:4600<ept id=\"p3\">**</ept>) for the server hosting the archive.","pos":[15680,15852]},{"content":"By default, the AGPM Service uses port 4600.","pos":[15853,15897]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>, and then close the <bpt id=\"p2\">**</bpt>Group Policy Management Editor<ept id=\"p2\">**</ept> window.","pos":[15903,15978]},{"content":"When Group Policy is updated, the AGPM Server connection is configured for each Group Policy administrator.","pos":[15979,16086]},{"pos":[16125,16162],"content":"Step 4: Configure e-mail notification"},{"content":"As an AGPM Administrator (Full Control), you designate the e-mail addresses of Approvers and AGPM Administrators to whom an e-mail message that contains a request is sent when an Editor tries to create, deploy, or delete a GPO.","pos":[16164,16391]},{"content":"You also determine the alias from which these messages are sent.","pos":[16392,16456]},{"content":"To configure e-mail notification for AGPM","pos":[16460,16501]},{"pos":[16509,16566],"content":"In the details pane, click the <bpt id=\"p1\">**</bpt>Domain Delegation<ept id=\"p1\">**</ept> tab."},{"pos":[16572,16681],"content":"In the <bpt id=\"p1\">**</bpt>From e-mail address<ept id=\"p1\">**</ept> field, type the e-mail alias for AGPM from which notifications should be sent."},{"pos":[16687,16816],"content":"In the <bpt id=\"p1\">**</bpt>To e-mail address<ept id=\"p1\">**</ept> field, type the e-mail address for the user account to which you intend to assign the Approver role."},{"pos":[16822,16882],"content":"In the <bpt id=\"p1\">**</bpt>SMTP server<ept id=\"p1\">**</ept> field, type a valid SMTP mail server."},{"content":"In the <bpt id=\"p1\">**</bpt>User name<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Password<ept id=\"p2\">**</ept> fields, type the credentials of a user who has access to the SMTP service.","pos":[16888,17000]},{"content":"Click <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept>.","pos":[17001,17017]},{"pos":[17056,17079],"content":"Step 5: Delegate access"},{"content":"As an AGPM Administrator (Full Control), you delegate domain-level access to GPOs, assigning roles to the account of each Group Policy administrator.","pos":[17081,17230]},{"content":"Note","pos":[17234,17238]},{"content":"You can also delegate access at the GPO level instead of the domain level.","pos":[17243,17317]},{"content":"For more information, see Help for Advanced Group Policy Management.","pos":[17318,17386]},{"content":"Important","pos":[17393,17402]},{"content":"You should restrict membership in the Group Policy Creator Owners group so that it cannot be used to circumvent AGPM management of access to GPOs.","pos":[17407,17553]},{"content":"(In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Group Policy Objects<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs, click <bpt id=\"p3\">**</bpt>Delegation<ept id=\"p3\">**</ept>, and then configure the settings to meet the needs of your organization.)","pos":[17554,17783]},{"content":"To delegate access to all GPOs throughout a domain","pos":[17790,17840]},{"pos":[17848,18010],"content":"On the <bpt id=\"p1\">**</bpt>Domain Delegation<ept id=\"p1\">**</ept> tab, click the <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> button, select the user account of the Group Policy administrator to serve as Approver, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Add Group or User<ept id=\"p1\">**</ept> dialog box, select the <bpt id=\"p2\">**</bpt>Approver<ept id=\"p2\">**</ept> role to assign that role to the account, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","pos":[18016,18144]},{"content":"(This role includes the Reviewer role.)","pos":[18145,18184]},{"pos":[18190,18316],"content":"Click the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> button, select the user account of the Group Policy administrator to serve as Editor, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Add Group or User<ept id=\"p1\">**</ept> dialog box, select the <bpt id=\"p2\">**</bpt>Editor<ept id=\"p2\">**</ept> role to assign that role to the account, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","pos":[18322,18448]},{"content":"(This role includes the Reviewer role.)","pos":[18449,18488]},{"pos":[18494,18622],"content":"Click the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> button, select the user account of the Group Policy administrator to serve as Reviewer, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>."},{"pos":[18628,18738],"content":"In the <bpt id=\"p1\">**</bpt>Add Group or User<ept id=\"p1\">**</ept> dialog box, select the <bpt id=\"p2\">**</bpt>Reviewer<ept id=\"p2\">**</ept> role to assign only that role to the account."},{"content":"Steps for managing GPOs","pos":[18743,18766]},{"content":"You must complete the following steps to create, edit, review, and deploy GPOs by using AGPM.","pos":[18769,18862]},{"content":"Additionally, you will create a template, delete a GPO, and restore a deleted GPO.","pos":[18863,18945]},{"content":"Step 1: Create a GPO","pos":[18948,18968]},{"content":"Step 2: Edit a GPO","pos":[18987,19005]},{"content":"Step 3: Review and deploy a GPO","pos":[19024,19055]},{"content":"Step 4: Use a template to create a GPO","pos":[19074,19112]},{"content":"Step 5: Delete and restore a GPO","pos":[19131,19163]},{"pos":[19218,19238],"content":"Step 1: Create a GPO"},{"content":"In an environment that has multiple Group Policy administrators, those with the Editor role can request that new GPOs be created.","pos":[19240,19369]},{"content":"However, that request must be approved by someone with the Approver role.","pos":[19370,19443]},{"content":"In this step, you use an account that has the Editor role to request that a new GPO be created.","pos":[19445,19540]},{"content":"Using an account that has the Approver role, you approve this request to create the GPO.","pos":[19541,19629]},{"content":"To request that a new GPO be created and managed through AGPM","pos":[19633,19694]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that is assigned the Editor role in AGPM.","pos":[19702,19825]},{"pos":[19831,19963],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[19969,20048],"content":"Right-click the <bpt id=\"p1\">**</bpt>Change Control<ept id=\"p1\">**</ept> node, and then click <bpt id=\"p2\">**</bpt>New Controlled GPO<ept id=\"p2\">**</ept>."},{"pos":[20054,20095],"content":"In the <bpt id=\"p1\">**</bpt>New Controlled GPO<ept id=\"p1\">**</ept> dialog box:"},{"pos":[20105,20184],"content":"To receive a copy of the request, type your e-mail address in the <bpt id=\"p1\">**</bpt>Cc<ept id=\"p1\">**</ept> field."},{"pos":[20194,20237],"content":"Type <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept> as the name for the new GPO."},{"content":"Type a comment for the new GPO.","pos":[20247,20278]},{"content":"Click <bpt id=\"p1\">**</bpt>Create live<ept id=\"p1\">**</ept> so that the new GPO will be deployed to the production environment immediately upon approval.","pos":[20288,20403]},{"content":"Click <bpt id=\"p1\">**</bpt>Submit<ept id=\"p1\">**</ept>.","pos":[20404,20421]},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[20427,20522]},{"content":"The new GPO is displayed on the <bpt id=\"p1\">**</bpt>Pending<ept id=\"p1\">**</ept> tab.","pos":[20523,20571]},{"content":"To approve the pending request to create a GPO","pos":[20575,20621]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that has the role of Approver in AGPM.","pos":[20629,20749]},{"content":"Open the e-mail inbox for the account, and notice that you have received an e-mail message from the AGPM alias with the Editor's request to create a GPO.","pos":[20755,20908]},{"pos":[20914,21046],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[21052,21131],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab, click the <bpt id=\"p2\">**</bpt>Pending<ept id=\"p2\">**</ept> tab to display the pending GPOs."},{"pos":[21137,21187],"content":"Right-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Approve<ept id=\"p2\">**</ept>."},{"pos":[21193,21270],"content":"Click <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept> to confirm approval and move the GPO to the <bpt id=\"p2\">**</bpt>Controlled<ept id=\"p2\">**</ept> tab."},{"pos":[21309,21327],"content":"Step 2: Edit a GPO"},{"content":"You can use GPOs to configure computer or user settings and deploy them to many computers or users.","pos":[21329,21428]},{"content":"In this step, you use an account that has the Editor role to check out a GPO from the archive, edit the GPO offline, check the edited GPO into the archive, and request deployment of the GPO to the production environment.","pos":[21429,21649]},{"content":"For this scenario, you configure a setting in the GPO to require that the password be at least eight characters long.","pos":[21650,21767]},{"content":"To check the GPO out from the archive for editing","pos":[21771,21820]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that has the role of Editor in AGPM.","pos":[21828,21946]},{"pos":[21952,22084],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[22090,22195],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab in the details pane, click the <bpt id=\"p2\">**</bpt>Controlled<ept id=\"p2\">**</ept> tab to display the controlled GPOs."},{"pos":[22201,22253],"content":"Right-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Check Out<ept id=\"p2\">**</ept>."},{"pos":[22259,22363],"content":"Type a comment to be displayed in the history of the GPO while it is checked out, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[22369,22464]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, the state of the GPO is identified as <bpt id=\"p2\">**</bpt>Checked Out<ept id=\"p2\">**</ept>.","pos":[22465,22546]},{"content":"To edit the GPO offline and configure the minimum password length","pos":[22550,22615]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, right-click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept> to open the <bpt id=\"p4\">**</bpt>Group Policy Management Editor<ept id=\"p4\">**</ept> window and change an offline copy of the GPO.","pos":[22623,22789]},{"content":"For this scenario, configure the minimum password length:","pos":[22790,22847]},{"pos":[22857,23009],"content":"Under <bpt id=\"p1\">**</bpt>Computer Configuration<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>Policies<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Windows Settings<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Security Settings<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>Account Policies<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>Password Policy<ept id=\"p6\">**</ept>."},{"pos":[23019,23081],"content":"In the details pane, double-click <bpt id=\"p1\">**</bpt>Minimum password length<ept id=\"p1\">**</ept>."},{"pos":[23091,23231],"content":"In the properties window, select the <bpt id=\"p1\">**</bpt>Define this policy setting<ept id=\"p1\">**</ept> check box, set the number of characters to <bpt id=\"p2\">**</bpt>8<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"pos":[23237,23289],"content":"Close the <bpt id=\"p1\">**</bpt>Group Policy Management Editor<ept id=\"p1\">**</ept> window."},{"content":"To check the GPO into the archive","pos":[23293,23326]},{"pos":[23334,23411],"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, right-click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Check In<ept id=\"p3\">**</ept>."},{"pos":[23417,23455],"content":"Type a comment, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[23461,23556]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, the state of the GPO is identified as <bpt id=\"p2\">**</bpt>Checked In<ept id=\"p2\">**</ept>.","pos":[23557,23637]},{"content":"To request the deployment of the GPO to the production environment","pos":[23641,23707]},{"pos":[23715,23790],"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, right-click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Deploy<ept id=\"p3\">**</ept>."},{"content":"Because this account is not an Approver or AGPM Administrator, you must submit a request for deployment.","pos":[23796,23900]},{"content":"To receive a copy of the request, type your e-mail address in the <bpt id=\"p1\">**</bpt>Cc<ept id=\"p1\">**</ept> field.","pos":[23901,23980]},{"content":"Type a comment to be displayed in the history of the GPO, and then click <bpt id=\"p1\">**</bpt>Submit<ept id=\"p1\">**</ept>.","pos":[23981,24065]},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[24071,24166]},{"content":"<bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept> is displayed on the list of GPOs on the <bpt id=\"p2\">**</bpt>Pending<ept id=\"p2\">**</ept> tab.","pos":[24167,24233]},{"pos":[24272,24303],"content":"Step 3: Review and deploy a GPO"},{"content":"In this step, you act as an Approver, creating reports and analyzing the settings and changes to settings in the GPO to determine whether you should approve them.","pos":[24305,24467]},{"content":"After you evaluate the GPO, you deploy it to the production environment and link the GPO to a domain or an organizational unit (OU).","pos":[24468,24600]},{"content":"The GPO takes effect when Group Policy is refreshed for computers in that domain or OU.","pos":[24601,24688]},{"content":"To review settings in the GPO","pos":[24692,24721]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that is assigned the role of Approver in AGPM.","pos":[24729,24857]},{"content":"Any Group Policy administrator with the Reviewer role, which is included in all of the other roles, can review the settings in a GPO.","pos":[24858,24991]},{"content":"Open the e-mail inbox for the account and notice that you have received an e-mail message from the AGPM alias with an Editor's request to deploy a GPO.","pos":[24997,25148]},{"pos":[25154,25286],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[25292,25363],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab in the details pane, click the <bpt id=\"p2\">**</bpt>Pending<ept id=\"p2\">**</ept> tab."},{"pos":[25369,25415],"content":"Double-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept> to display its history."},{"content":"Review the settings in the most recent version of MyGPO:","pos":[25421,25477]},{"pos":[25487,25669],"content":"In the <bpt id=\"p1\">**</bpt>History<ept id=\"p1\">**</ept> window, right-click the GPO version with the most recent time stamp, click <bpt id=\"p2\">**</bpt>Settings<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>HTML Report<ept id=\"p3\">**</ept> to display a summary of the GPO's settings."},{"content":"In the Web browser, click <bpt id=\"p1\">**</bpt>show all<ept id=\"p1\">**</ept> to display all the settings in the GPO.","pos":[25679,25757]},{"content":"Close the browser.","pos":[25758,25776]},{"content":"Compare the most recent version of MyGPO to the first version checked in to the archive:","pos":[25782,25870]},{"content":"In the <bpt id=\"p1\">**</bpt>History<ept id=\"p1\">**</ept> window, click the GPO version with the most recent time stamp.","pos":[25880,25961]},{"content":"Press CTRL and then click the oldest GPO version for which the <bpt id=\"p1\">**</bpt>Computer Version<ept id=\"p1\">**</ept> is not <bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\*</ph><ept id=\"p2\">**</ept>.","pos":[25962,26060]},{"content":"Click the <bpt id=\"p1\">**</bpt>Differences<ept id=\"p1\">**</ept> button.","pos":[26070,26103]},{"content":"The <bpt id=\"p1\">**</bpt>Account Policies/Password Policy<ept id=\"p1\">**</ept> section is highlighted in green and preceded by <bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\[+\\]</ph><ept id=\"p2\">**</ept>.","pos":[26104,26203]},{"content":"This indicates that the setting is configured only in the latter version of the GPO.","pos":[26204,26288]},{"content":"Click <bpt id=\"p1\">**</bpt>Account Policies/Password Policy<ept id=\"p1\">**</ept>.","pos":[26298,26341]},{"content":"The <bpt id=\"p1\">**</bpt>Minimum password length<ept id=\"p1\">**</ept> setting is also highlighted in green and preceded by <bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\[+\\]</ph><ept id=\"p2\">**</ept>, indicating that it is configured only in the latter version of the GPO.","pos":[26342,26509]},{"content":"Close the Web browser.","pos":[26519,26541]},{"content":"To deploy the GPO to the production environment","pos":[26545,26592]},{"pos":[26600,26673],"content":"On the <bpt id=\"p1\">**</bpt>Pending<ept id=\"p1\">**</ept> tab, right-click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Approve<ept id=\"p3\">**</ept>."},{"content":"Type a comment to include in the history of the GPO.","pos":[26679,26731]},{"content":"Click <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept>.","pos":[26737,26751]},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[26752,26847]},{"content":"The GPO is deployed to the production environment.","pos":[26848,26898]},{"content":"To link the GPO to a domain or organizational unit","pos":[26902,26952]},{"pos":[26960,27130],"content":"In the GPMC, right-click either the domain or an organizational unit (OU) to which you want to apply the GPO that you configured, and then click <bpt id=\"p1\">**</bpt>Link an Existing GPO<ept id=\"p1\">**</ept>."},{"pos":[27136,27209],"content":"In the <bpt id=\"p1\">**</bpt>Select GPO<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"pos":[27248,27286],"content":"Step 4: Use a template to create a GPO"},{"content":"In this step, you use an account that has the Editor role to create and use a template.","pos":[27288,27375]},{"content":"That template is a static version of a GPO for use as a starting point for creating new GPOs.","pos":[27376,27469]},{"content":"Although you cannot edit a template, you can create a new GPO based on a template.","pos":[27470,27552]},{"content":"Templates are useful for quickly creating multiple GPOs that include many of the same policy settings.","pos":[27553,27655]},{"content":"To create a template based on an existing GPO","pos":[27659,27704]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that is assigned the role of Editor in AGPM.","pos":[27712,27838]},{"pos":[27844,27976],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[27982,28056],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab in the details pane, click the <bpt id=\"p2\">**</bpt>Controlled<ept id=\"p2\">**</ept> tab."},{"pos":[28062,28188],"content":"Right-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Save as Template<ept id=\"p2\">**</ept> to create a template incorporating all settings currently in MyGPO."},{"pos":[28194,28280],"content":"Type <bpt id=\"p1\">**</bpt>MyTemplate<ept id=\"p1\">**</ept> as the name for the template and a comment, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[28286,28381]},{"content":"The new template appears on the <bpt id=\"p1\">**</bpt>Templates<ept id=\"p1\">**</ept> tab.","pos":[28382,28432]},{"content":"To request that a new GPO be created and managed through AGPM","pos":[28436,28497]},{"pos":[28505,28534],"content":"Click the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab."},{"pos":[28540,28619],"content":"Right-click the <bpt id=\"p1\">**</bpt>Change Control<ept id=\"p1\">**</ept> node, and then click <bpt id=\"p2\">**</bpt>New Controlled GPO<ept id=\"p2\">**</ept>."},{"pos":[28625,28666],"content":"In the <bpt id=\"p1\">**</bpt>New Controlled GPO<ept id=\"p1\">**</ept> dialog box:"},{"pos":[28676,28755],"content":"To receive a copy of the request, type your e-mail address in the <bpt id=\"p1\">**</bpt>Cc<ept id=\"p1\">**</ept> field."},{"pos":[28765,28813],"content":"Type <bpt id=\"p1\">**</bpt>MyOtherGPO<ept id=\"p1\">**</ept> as the name for the new GPO."},{"content":"Type a comment for the new GPO.","pos":[28823,28854]},{"pos":[28864,28979],"content":"Click <bpt id=\"p1\">**</bpt>Create live<ept id=\"p1\">**</ept> so that the new GPO will be deployed to the production environment immediately upon approval."},{"content":"For <bpt id=\"p1\">**</bpt>From GPO template<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>MyTemplate<ept id=\"p2\">**</ept>.","pos":[28989,29038]},{"content":"Click <bpt id=\"p1\">**</bpt>Submit<ept id=\"p1\">**</ept>.","pos":[29039,29056]},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[29062,29157]},{"content":"The new GPO is displayed on the <bpt id=\"p1\">**</bpt>Pending<ept id=\"p1\">**</ept> tab.","pos":[29158,29206]},{"content":"Use an account that is assigned the role of Approver to approve the pending request to create the GPO as you did in <bpt id=\"p1\">[</bpt>Step 1: Create a GPO<ept id=\"p1\">](#bkmk-manage1)</ept>.","pos":[29208,29362]},{"content":"MyTemplate incorporates all the settings that you configured in MyGPO.","pos":[29363,29433]},{"content":"Because MyOtherGPO was created using MyTemplate, it at first contains all the settings that MyGPO contained at the time that MyTemplate was created.","pos":[29434,29582]},{"content":"You can confirm this by generating a difference report to compare MyOtherGPO to MyTemplate.","pos":[29583,29674]},{"content":"To check the GPO out from the archive for editing","pos":[29678,29727]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that is assigned the role of Editor in AGPM.","pos":[29735,29861]},{"pos":[29867,29924],"content":"Right-click <bpt id=\"p1\">**</bpt>MyOtherGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Check Out<ept id=\"p2\">**</ept>."},{"pos":[29930,30034],"content":"Type a comment to be displayed in the history of the GPO while it is checked out, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[30040,30135]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, the state of the GPO is identified as <bpt id=\"p2\">**</bpt>Checked Out<ept id=\"p2\">**</ept>.","pos":[30136,30217]},{"content":"To edit the GPO offline and configure the account lockout duration","pos":[30221,30287]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, right-click <bpt id=\"p2\">**</bpt>MyOtherGPO<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept> to open the <bpt id=\"p4\">**</bpt>Group Policy Management Editor<ept id=\"p4\">**</ept> window and change an offline copy of the GPO.","pos":[30295,30466]},{"content":"For this scenario, configure the minimum password length:","pos":[30467,30524]},{"pos":[30534,30693],"content":"Under <bpt id=\"p1\">**</bpt>Computer Configuration<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>Policies<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Windows Settings<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Security Settings<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>Account Policies<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>Account Lockout Policy<ept id=\"p6\">**</ept>."},{"pos":[30703,30766],"content":"In the details pane, double-click <bpt id=\"p1\">**</bpt>Account lockout duration<ept id=\"p1\">**</ept>."},{"pos":[30776,30898],"content":"In the properties window, check <bpt id=\"p1\">**</bpt>Define this policy setting<ept id=\"p1\">**</ept>, set the duration to <bpt id=\"p2\">**</bpt>30<ept id=\"p2\">**</ept> minutes, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"pos":[30904,30956],"content":"Close the <bpt id=\"p1\">**</bpt>Group Policy Management Editor<ept id=\"p1\">**</ept> window."},{"content":"Check MyOtherGPO into the archive and request deployment as you did for MyGPO in <bpt id=\"p1\">[</bpt>Step 2: Edit a GPO<ept id=\"p1\">](#bkmk-manage2)</ept>.","pos":[30958,31075]},{"content":"You can compare MyOtherGPO to MyGPO or to MyTemplate by using difference reports.","pos":[31076,31157]},{"content":"Any account that includes the Reviewer role (AGPM Administrator <ph id=\"ph1\">\\[</ph>Full Control<ph id=\"ph2\">\\]</ph>, Approver, Editor, or Reviewer) can generate reports.","pos":[31158,31292]},{"content":"To compare a GPO to another GPO and to a template","pos":[31296,31345]},{"content":"To compare MyGPO and MyOtherGPO:","pos":[31353,31385]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept>.","pos":[31395,31438]},{"content":"Press CTRL and then click <bpt id=\"p1\">**</bpt>MyOtherGPO<ept id=\"p1\">**</ept>.","pos":[31439,31480]},{"pos":[31490,31575],"content":"Right-click <bpt id=\"p1\">**</bpt>MyOtherGPO<ept id=\"p1\">**</ept>, point to <bpt id=\"p2\">**</bpt>Differences<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>HTML Report<ept id=\"p3\">**</ept>."},{"content":"To compare MyOtherGPO and MyTemplate:","pos":[31581,31618]},{"pos":[31628,31676],"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>MyOtherGPO<ept id=\"p2\">**</ept>."},{"pos":[31686,31768],"content":"Right-click <bpt id=\"p1\">**</bpt>MyOtherGPO<ept id=\"p1\">**</ept>, point to <bpt id=\"p2\">**</bpt>Differences<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Template<ept id=\"p3\">**</ept>."},{"pos":[31778,31843],"content":"Select <bpt id=\"p1\">**</bpt>MyTemplate<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>HTML Report<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"pos":[31882,31914],"content":"Step 5: Delete and restore a GPO"},{"content":"In this step, you act as an Approver to delete a GPO.","pos":[31916,31969]},{"content":"To delete a GPO","pos":[31973,31988]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that is assigned the role of Approver.","pos":[31996,32116]},{"pos":[32122,32254],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[32260,32345],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab, click the <bpt id=\"p2\">**</bpt>Controlled<ept id=\"p2\">**</ept> tab to display the controlled GPOs."},{"content":"Right-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Delete<ept id=\"p2\">**</ept>.","pos":[32351,32400]},{"content":"Click <bpt id=\"p1\">**</bpt>Delete GPO from archive and production<ept id=\"p1\">**</ept> to delete both the version in the archive and the deployed version of the GPO in the production environment.","pos":[32401,32558]},{"pos":[32564,32649],"content":"Type a comment to be displayed in the audit trail for the GPO, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[32655,32750]},{"content":"The GPO is removed from the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab and is displayed on the <bpt id=\"p2\">**</bpt>Recycle Bin<ept id=\"p2\">**</ept> tab, where it can be restored or destroyed.","pos":[32751,32881]},{"content":"Occasionally you may discover after you delete a GPO that it is still needed.","pos":[32883,32960]},{"content":"In this step, you act as an Approver to restore a GPO that was deleted.","pos":[32961,33032]},{"content":"To restore a deleted GPO","pos":[33036,33060]},{"pos":[33068,33147],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab, click the <bpt id=\"p2\">**</bpt>Recycle Bin<ept id=\"p2\">**</ept> tab to display deleted GPOs."},{"pos":[33153,33203],"content":"Right-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Restore<ept id=\"p2\">**</ept>."},{"pos":[33209,33289],"content":"Type a comment to be displayed in the history of the GPO, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[33295,33390]},{"content":"The GPO is removed from the <bpt id=\"p1\">**</bpt>Recycle Bin<ept id=\"p1\">**</ept> tab and is displayed on the <bpt id=\"p2\">**</bpt>Controlled<ept id=\"p2\">**</ept> tab.","pos":[33391,33482]},{"pos":[33488,33719],"content":"**Note**  \nRestoring a GPO to the archive does not automatically redeploy it to the production environment. To return the GPO to the production environment, deploy the GPO as in [Step 3: Review and deploy a GPO](#bkmk-manage3).","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"Restoring a GPO to the archive does not automatically redeploy it to the production environment. To return the GPO to the production environment, deploy the GPO as in [Step 3: Review and deploy a GPO](#bkmk-manage3).","pos":[11,227],"nodes":[{"content":"Restoring a GPO to the archive does not automatically redeploy it to the production environment.","pos":[0,96]},{"content":"To return the GPO to the production environment, deploy the GPO as in <bpt id=\"p1\">[</bpt>Step 3: Review and deploy a GPO<ept id=\"p1\">](#bkmk-manage3)</ept>.","pos":[97,216]}]}]},{"content":"After editing and deploying a GPO, you may discover that recent changes to the GPO are causing a problem.","pos":[33728,33833]},{"content":"In this step, you act as an Approver to roll back to an earlier version of the GPO.","pos":[33834,33917]},{"content":"You can roll back to any version in the history of the GPO.","pos":[33918,33977]},{"content":"You can use comments and labels to identify known good versions and when specific changes were made.","pos":[33978,34078]},{"content":"To roll back to an earlier version of a GPO","pos":[34082,34125]},{"pos":[34133,34218],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab, click the <bpt id=\"p2\">**</bpt>Controlled<ept id=\"p2\">**</ept> tab to display the controlled GPOs."},{"pos":[34224,34270],"content":"Double-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept> to display its history."},{"pos":[34276,34357],"content":"Right-click the version to be deployed, click <bpt id=\"p1\">**</bpt>Deploy<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[34363,34453]},{"content":"In the <bpt id=\"p1\">**</bpt>History<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[34454,34497]},{"pos":[34503,34803],"content":"**Note**  \nTo verify that the version that was redeployed is the version intended, examine a difference report for the two versions. In the **History** window for the GPO, select the two versions, right-click them, point to **Difference**, and then click either **HTML Report** or **XML Report**.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"To verify that the version that was redeployed is the version intended, examine a difference report for the two versions. In the **History** window for the GPO, select the two versions, right-click them, point to **Difference**, and then click either **HTML Report** or **XML Report**.","pos":[11,296],"nodes":[{"content":"To verify that the version that was redeployed is the version intended, examine a difference report for the two versions.","pos":[0,121]},{"content":"In the <bpt id=\"p1\">**</bpt>History<ept id=\"p1\">**</ept> window for the GPO, select the two versions, right-click them, point to <bpt id=\"p2\">**</bpt>Difference<ept id=\"p2\">**</ept>, and then click either <bpt id=\"p3\">**</bpt>HTML Report<ept id=\"p3\">**</ept> or <bpt id=\"p4\">**</bpt>XML Report<ept id=\"p4\">**</ept>.","pos":[122,285]}]}]}],"content":"---\ntitle: Step-by-Step Guide for Microsoft Advanced Group Policy Management 4.0\ndescription: Step-by-Step Guide for Microsoft Advanced Group Policy Management 4.0\nauthor: jamiejdt\nms.assetid: dc6f9b16-b1d4-48f3-88bb-f29301f0131c\nms.pagetype: mdop\nms.mktglfcycl: manage\nms.sitesec: library\nms.prod: w10\n---\n\n\n# Step-by-Step Guide for Microsoft Advanced Group Policy Management 4.0\n\n\nThis step-by-step guide demonstrates advanced techniques for Group Policy management that use the Group Policy Management Console (GPMC) and Microsoft Advanced Group Policy Management (AGPM). AGPM increases the capabilities of the GPMC, providing:\n\n-   Standard roles for delegating permissions to manage Group Policy Objects (GPOs) to multiple Group Policy administrators, in addition to the ability to delegate access to GPOs in the production environment.\n\n-   An archive to enable Group Policy administrators to create and modify GPOs offline before the GPOs are deployed into a production environment.\n\n-   The ability to roll back to any earlier version of a GPO in the archive and to limit the number of versions stored in the archive.\n\n-   Check-in and check-out capability for GPOs to make sure that Group Policy administrators do not unintentionally overwrite each other's work.\n\n-   The ability to search for GPOs with specific attributes and to filter the list of GPOs displayed.\n\n## AGPM scenario overview\n\n\nFor this scenario, you will use a separate user account for each role in AGPM to demonstrate how Group Policy can be managed in an environment that has multiple Group Policy administrators who have different levels of permissions. Specifically, you will perform the following tasks:\n\n-   Using an account that is a member of the Domain Admins group, install AGPM Server and assign the AGPM Administrator role to an account or group.\n\n-   Using accounts to which you will assign AGPM roles, install AGPM Client.\n\n-   Using an account that has the AGPM Administrator role, configure AGPM and delegate access to GPOs by assigning roles to other accounts.\n\n-   From an account that has the Editor role, request that a new GPO be created that you then approve by using an account that has the Approver role. Use the Editor account to check the GPO out of the archive, edit the GPO, check the GPO into the archive, and then request deployment.\n\n-   Using an account that has the Approver role, review the GPO and deploy it to your production environment.\n\n-   Using an account that has the Editor role, create a GPO template and use it as a starting point to create a new GPO.\n\n-   Using an account that has the Approver role, delete and restore a GPO.\n\n![group policy object development process](images/ab77a1f3-f430-4e7d-be58-ee8f9bd1140e.gif)\n\n## Requirements\n\n\nComputers on which you want to install AGPM must meet the following requirements, and you must create accounts for use in this scenario.\n\n**Note**  \nIf you have AGPM 2.5 installed and are upgrading from Windows Server® 2003 to Windows Server 2008 R2 or Windows Server 2008, or are upgrading from Windows Vista with no service packs installed to Windows 7 or Windows Vista® with Service Pack 1 (SP1), you must upgrade the operating system before you can upgrade to AGPM 4.0.\n\nIf you have AGPM 3.0 installed, you do not have to upgrade the operating system before you upgrade to AGPM 4.0\n\n \n\nIn a mixed environment that includes both newer and older operating systems, there are some limitations to functionality, as indicated in the following table.\n\n<table>\n<colgroup>\n<col width=\"33%\" />\n<col width=\"33%\" />\n<col width=\"33%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Operating system on which AGPM Server 4.0 runs</th>\n<th align=\"left\">Operating system on which AGPM Client 4.0 runs</th>\n<th align=\"left\">Status of AGPM 4.0 support</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Windows Server 2008 R2 or Windows 7</p></td>\n<td align=\"left\"><p>Windows Server 2008 R2 or Windows 7</p></td>\n<td align=\"left\"><p>Supported</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Windows Server 2008 R2 or Windows 7</p></td>\n<td align=\"left\"><p>Windows Server 2008 or Windows Vista with SP1</p></td>\n<td align=\"left\"><p>Supported, but cannot edit policy settings or preference items that exist only in Windows Server 2008 R2 or Windows 7</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Windows Server 2008 or Windows Vista with SP1</p></td>\n<td align=\"left\"><p>Windows Server 2008 R2 or Windows 7</p></td>\n<td align=\"left\"><p>Unsupported</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Windows Server 2008 or Windows Vista with SP1</p></td>\n<td align=\"left\"><p>Windows Server 2008 or Windows Vista with SP1</p></td>\n<td align=\"left\"><p>Supported, but cannot report or edit policy settings or preference items that exist only in Windows Server 2008 R2 or Windows 7</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n### AGPM Server requirements\n\nAGPM Server 4.0 requires Windows Server 2008 R2, Windows Server 2008, Windows 7 and the GPMC from Remote Server Administration Tools (RSAT), or Windows Vista with SP1 and the GPMC from RSAT installed. Both 32-bit and 64-bit versions are supported.\n\nBefore you install AGPM Server, you must be a member of the Domain Admins group and the following Windows features must be present unless otherwise noted:\n\n-   GPMC\n\n    -   Windows Server 2008 R2 or Windows Server 2008: If the GPMC is not present, it is automatically installed by AGPM.\n\n    -   Windows 7: You must install the GPMC from RSAT before you install AGPM. For more information, see [Remote Server Administration Tools for Windows 7](http://go.microsoft.com/fwlink/?LinkID=131280) (http://go.microsoft.com/fwlink/?LinkID=131280).\n\n    -   Windows Vista with SP1: You must install the GPMC from RSAT before you install AGPM. For more information, see [Remote Server Administration Tools for Windows Vista with Service Pack 1](http://go.microsoft.com/fwlink/?LinkID=116179) (http://go.microsoft.com/fwlink/?LinkID=116179).\n\n-   The .NET Framework 3.5 or later versions\n\n    -   Windows Server 2008 R2 or Windows 7: If the .NET Framework 3.5 or later version is not present, the .NET Framework 3.5 is automatically installed by AGPM.\n\n    -   Windows Server 2008 or Windows Vista with SP1: You must install the .NET Framework 3.5 or a later version before you install AGPM.\n\nThe following Windows features are required by AGPM Server and will be automatically installed if they are not present:\n\n-   WCF Activation; Non-HTTP Activation\n\n-   Windows Process Activation Service\n\n    -   Process Model\n\n    -   The .NET Environment\n\n    -   Configuration APIs\n\n### AGPM Client requirements\n\nAGPM Client 4.0 requires Windows Server 2008 R2, Windows Server 2008, Windows 7 and the GPMC from RSAT, or Windows Vista with SP1 and the GPMC from RSAT installed. Both 32-bit and 64-bit versions are supported. AGPM Client can be installed on a computer that is running AGPM Server.\n\nThe following Windows features are required by AGPM Client and unless otherwise noted are automatically installed if they are not present:\n\n-   GPMC\n\n    -   Windows Server 2008 R2 or Windows Server 2008: If the GPMC is not present, it is automatically installed by AGPM.\n\n    -   Windows 7: You must install the GPMC from RSAT before you install AGPM. For more information, see [Remote Server Administration Tools for Windows 7](http://go.microsoft.com/fwlink/?LinkID=131280) (http://go.microsoft.com/fwlink/?LinkID=131280).\n\n    -   Windows Vista with SP1: You must install the GPMC from RSAT before you install AGPM. For more information, see [Remote Server Administration Tools for Windows Vista with Service Pack 1](http://go.microsoft.com/fwlink/?LinkID=116179) (http://go.microsoft.com/fwlink/?LinkID=116179).\n\n-   The .NET Framework 3.0 or later version\n\n    -   Windows Server 2008 R2 or Windows 7: If the .NET Framework 3.0 or later version is not present, the .NET Framework 3.5 is automatically installed by AGPM.\n\n    -   Windows Server 2008 or Windows Vista with SP1: If the .NET Framework 3.0 or later version is not present, the .NET Framework 3.0 is automatically installed by AGPM.\n\n### Scenario requirements\n\nBefore you begin this scenario, create four user accounts. During the scenario, you will assign one of the following AGPM roles to each of these accounts: AGPM Administrator (Full Control), Approver, Editor, and Reviewer. These accounts must be able to send and receive e-mail messages. Assign **Link GPOs** permission to the accounts that have the AGPM Administrator, Approver, and (optionally) Editor roles.\n\n**Note**  \n**Link GPOs** permission is assigned to members of Domain Administrators and Enterprise Administrators by default. To assign **Link GPOs** permission to additional users or groups (such as accounts that have the roles of AGPM Administrator or Approver), click the node for the domain and then click the **Delegation** tab, select **Link GPOs**, click **Add**, and select users or groups to which you want to assign the permission.\n\n \n\n## Steps for installing and configuring AGPM\n\n\nYou must complete the following steps to install and configure AGPM.\n\n[Step 1: Install AGPM Server](#bkmk-config1)\n\n[Step 2: Install AGPM Client](#bkmk-config2)\n\n[Step 3: Configure an AGPM Server connection](#bkmk-config3)\n\n[Step 4: Configure e-mail notification](#bkmk-config4)\n\n[Step 5: Delegate access](#bkmk-config5)\n\n### <a href=\"\" id=\"bkmk-config1\"></a>Step 1: Install AGPM Server\n\nIn this step, you install AGPM Server on the member server or domain controller that will run the AGPM Service, and you configure the archive. All AGPM operations are managed through this Windows service and are executed with the service's credentials. The archive managed by an AGPM Server can be hosted on that server or on another server in the same forest.\n\n**To install AGPM Server on the computer that will host the AGPM Service**\n\n1.  Log on with an account that is a member of the Domain Admins group.\n\n2.  Start the Microsoft Desktop Optimization Pack CD and follow the instructions on screen to select **Advanced Group Policy Management - Server**.\n\n3.  In the **Welcome** dialog box, click **Next**.\n\n4.  In the **Microsoft Software License Terms** dialog box, accept the terms and then click **Next**.\n\n5.  In the **Application Path** dialog box, select a location in which to install AGPM Server. The computer on which AGPM Server is installed will host the AGPM Service and manage the archive. Click **Next**.\n\n6.  In the **Archive Path** dialog box, select a location for the archive in relation to the AGPM Server. The archive path can point to a folder on the AGPM Server or elsewhere. However, you should select a location with sufficient space to store all GPOs and history data managed by this AGPM Server. Click **Next**.\n\n7.  In the **AGPM Service Account** dialog box, select a service account under which the AGPM Service will run and then click **Next**.\n\n    This account must be a member of the either the Domain Admins group or, for a least-privilege configuration, the following groups in each domain managed by the AGPM Server:\n\n    -   Group Policy Creator Owners\n\n    -   Backup Operators\n\n    Additionally, this account requires Full Control permission for the following folders:\n\n    -   The AGPM archive folder, for which this permission is automatically granted during the installation of AGPM Server if it is installed on a local drive.\n\n    -   The local system temp folder, typically %windir%\\\\temp.\n\n8.  In the **Archive Owner** dialog box, select an account or group to which you assign the AGPM Administrator (Full Control) role. AGPM Administrators can assign AGPM roles and permissions to other Group Policy administrators, so that later you can assign the role of AGPM Administrator to additional Group Policy administrators. For this scenario, select the account to serve in the AGPM Administrator role. Click **Next**.\n\n9.  In the **Port Configuration** dialog box, type a port on which the AGPM Service should listen. Do not clear the **Add port exception to firewall** check box unless you manually configure port exceptions or use rules to configure port exceptions. Click **Next**.\n\n10. In the **Languages** dialog box, select one or more display languages to install for AGPM Server.\n\n11. Click **Install**, and then click **Finish** to exit the Setup Wizard.\n\n    **Caution**  \n    Do not change settings for the AGPM Service through **Administrative Tools** and **Services** in the operating system. Doing this can prevent the AGPM Service from starting. For information about how to change settings for the service, see Help for Advanced Group Policy Management.\n\n     \n\n### <a href=\"\" id=\"bkmk-config2\"></a>Step 2: Install AGPM Client\n\nEach Group Policy administrator—anyone who creates, edits, deploys, reviews, or deletes GPOs—must have AGPM Client installed on computers that they use to manage GPOs. The Change Control node, which you use to perform many of the GPO management tasks, appears in the Group Policy Management Console only if you install the AGPM Client. For this scenario, you install AGPM Client on at least one computer. You do not need to install AGPM Client on the computers of end users who do not perform Group Policy administration.\n\n**To install AGPM Client on the computer of a Group Policy administrator**\n\n1.  Start the Microsoft Desktop Optimization Pack CD and follow the instructions on screen to select **Advanced Group Policy Management - Client**.\n\n2.  In the **Welcome** dialog box, click **Next**.\n\n3.  In the **Microsoft Software License Terms** dialog box, accept the terms and then click **Next**.\n\n4.  In the **Application Path** dialog box, select a location in which to install AGPM Client. Click **Next**.\n\n5.  In the **AGPM Server** dialog box, type the DNS name or IP address for the AGPM Server and the port to which you want to connect. The default port for the AGPM Service is 4600. Do not clear the **Allow Microsoft Management Console through the firewall** check box unless you manually configure port exceptions or use rules to configure port exceptions. Click **Next**.\n\n6.  In the **Languages** dialog box, select one or more display languages to install for AGPM Client.\n\n7.  Click **Install**, and then click **Finish** to exit the Setup Wizard.\n\n### <a href=\"\" id=\"bkmk-config3\"></a>Step 3: Configure an AGPM Server connection\n\nAGPM stores all versions of each controlled Group Policy Object (GPO), that is, each GPO for which AGPM provides change control, in a central archive. This lets Group Policy administrators view and change GPOs offline without immediately affecting the deployed version of each GPO.\n\nIn this step, you configure an AGPM Server connection and ensure that all Group Policy administrators connect to the same AGPM Server. (For information about how to configure multiple AGPM Servers, see Help for Advanced Group Policy Management.)\n\n**To configure an AGPM Server connection for all Group Policy administrators**\n\n1.  On a computer on which you have installed AGPM Client, log on with the user account that you selected as the Archive Owner. This user has the role of AGPM Administrator (Full Control).\n\n2.  Click **Start**, point to **Administrative Tools**, and then click **Group Policy Management** to open the GPMC.\n\n3.  Edit a GPO that is applied to all Group Policy administrators.\n\n4.  In the **Group Policy Management Editor** window, double-click **User Configuration**, **Policies**, **Administrative Templates**, **Windows Components**, and **AGPM**.\n\n5.  In the details pane, double-click **AGPM: Specify default AGPM Server (all domains)**.\n\n6.  In the **Properties** window, select **Enabled** and type the DNS name or IP address and port (for example, **server.contoso.com:4600**) for the server hosting the archive. By default, the AGPM Service uses port 4600.\n\n7.  Click **OK**, and then close the **Group Policy Management Editor** window. When Group Policy is updated, the AGPM Server connection is configured for each Group Policy administrator.\n\n### <a href=\"\" id=\"bkmk-config4\"></a>Step 4: Configure e-mail notification\n\nAs an AGPM Administrator (Full Control), you designate the e-mail addresses of Approvers and AGPM Administrators to whom an e-mail message that contains a request is sent when an Editor tries to create, deploy, or delete a GPO. You also determine the alias from which these messages are sent.\n\n**To configure e-mail notification for AGPM**\n\n1.  In the details pane, click the **Domain Delegation** tab.\n\n2.  In the **From e-mail address** field, type the e-mail alias for AGPM from which notifications should be sent.\n\n3.  In the **To e-mail address** field, type the e-mail address for the user account to which you intend to assign the Approver role.\n\n4.  In the **SMTP server** field, type a valid SMTP mail server.\n\n5.  In the **User name** and **Password** fields, type the credentials of a user who has access to the SMTP service. Click **Apply**.\n\n### <a href=\"\" id=\"bkmk-config5\"></a>Step 5: Delegate access\n\nAs an AGPM Administrator (Full Control), you delegate domain-level access to GPOs, assigning roles to the account of each Group Policy administrator.\n\n**Note**  \nYou can also delegate access at the GPO level instead of the domain level. For more information, see Help for Advanced Group Policy Management.\n\n \n\n**Important**  \nYou should restrict membership in the Group Policy Creator Owners group so that it cannot be used to circumvent AGPM management of access to GPOs. (In the **Group Policy Management Console**, click **Group Policy Objects** in the forest and domain in which you want to manage GPOs, click **Delegation**, and then configure the settings to meet the needs of your organization.)\n\n \n\n**To delegate access to all GPOs throughout a domain**\n\n1.  On the **Domain Delegation** tab, click the **Add** button, select the user account of the Group Policy administrator to serve as Approver, and then click **OK**.\n\n2.  In the **Add Group or User** dialog box, select the **Approver** role to assign that role to the account, and then click **OK**. (This role includes the Reviewer role.)\n\n3.  Click the **Add** button, select the user account of the Group Policy administrator to serve as Editor, and then click **OK**.\n\n4.  In the **Add Group or User** dialog box, select the **Editor** role to assign that role to the account, and then click **OK**. (This role includes the Reviewer role.)\n\n5.  Click the **Add** button, select the user account of the Group Policy administrator to serve as Reviewer, and then click **OK**.\n\n6.  In the **Add Group or User** dialog box, select the **Reviewer** role to assign only that role to the account.\n\n## Steps for managing GPOs\n\n\nYou must complete the following steps to create, edit, review, and deploy GPOs by using AGPM. Additionally, you will create a template, delete a GPO, and restore a deleted GPO.\n\n[Step 1: Create a GPO](#bkmk-manage1)\n\n[Step 2: Edit a GPO](#bkmk-manage2)\n\n[Step 3: Review and deploy a GPO](#bkmk-manage3)\n\n[Step 4: Use a template to create a GPO](#bkmk-manage4)\n\n[Step 5: Delete and restore a GPO](#bkmk-manage5)\n\n### <a href=\"\" id=\"bkmk-manage1\"></a>Step 1: Create a GPO\n\nIn an environment that has multiple Group Policy administrators, those with the Editor role can request that new GPOs be created. However, that request must be approved by someone with the Approver role.\n\nIn this step, you use an account that has the Editor role to request that a new GPO be created. Using an account that has the Approver role, you approve this request to create the GPO.\n\n**To request that a new GPO be created and managed through AGPM**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that is assigned the Editor role in AGPM.\n\n2.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n3.  Right-click the **Change Control** node, and then click **New Controlled GPO**.\n\n4.  In the **New Controlled GPO** dialog box:\n\n    1.  To receive a copy of the request, type your e-mail address in the **Cc** field.\n\n    2.  Type **MyGPO** as the name for the new GPO.\n\n    3.  Type a comment for the new GPO.\n\n    4.  Click **Create live** so that the new GPO will be deployed to the production environment immediately upon approval. Click **Submit**.\n\n5.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The new GPO is displayed on the **Pending** tab.\n\n**To approve the pending request to create a GPO**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that has the role of Approver in AGPM.\n\n2.  Open the e-mail inbox for the account, and notice that you have received an e-mail message from the AGPM alias with the Editor's request to create a GPO.\n\n3.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n4.  On the **Contents** tab, click the **Pending** tab to display the pending GPOs.\n\n5.  Right-click **MyGPO**, and then click **Approve**.\n\n6.  Click **Yes** to confirm approval and move the GPO to the **Controlled** tab.\n\n### <a href=\"\" id=\"bkmk-manage2\"></a>Step 2: Edit a GPO\n\nYou can use GPOs to configure computer or user settings and deploy them to many computers or users. In this step, you use an account that has the Editor role to check out a GPO from the archive, edit the GPO offline, check the edited GPO into the archive, and request deployment of the GPO to the production environment. For this scenario, you configure a setting in the GPO to require that the password be at least eight characters long.\n\n**To check the GPO out from the archive for editing**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that has the role of Editor in AGPM.\n\n2.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n3.  On the **Contents** tab in the details pane, click the **Controlled** tab to display the controlled GPOs.\n\n4.  Right-click **MyGPO**, and then click **Check Out**.\n\n5.  Type a comment to be displayed in the history of the GPO while it is checked out, and then click **OK**.\n\n6.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. On the **Controlled** tab, the state of the GPO is identified as **Checked Out**.\n\n**To edit the GPO offline and configure the minimum password length**\n\n1.  On the **Controlled** tab, right-click **MyGPO**, and then click **Edit** to open the **Group Policy Management Editor** window and change an offline copy of the GPO. For this scenario, configure the minimum password length:\n\n    1.  Under **Computer Configuration**, double-click **Policies**, **Windows Settings**, **Security Settings**, **Account Policies**, and **Password Policy**.\n\n    2.  In the details pane, double-click **Minimum password length**.\n\n    3.  In the properties window, select the **Define this policy setting** check box, set the number of characters to **8**, and then click **OK**.\n\n2.  Close the **Group Policy Management Editor** window.\n\n**To check the GPO into the archive**\n\n1.  On the **Controlled** tab, right-click **MyGPO** and then click **Check In**.\n\n2.  Type a comment, and then click **OK**.\n\n3.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. On the **Controlled** tab, the state of the GPO is identified as **Checked In**.\n\n**To request the deployment of the GPO to the production environment**\n\n1.  On the **Controlled** tab, right-click **MyGPO** and then click **Deploy**.\n\n2.  Because this account is not an Approver or AGPM Administrator, you must submit a request for deployment. To receive a copy of the request, type your e-mail address in the **Cc** field. Type a comment to be displayed in the history of the GPO, and then click **Submit**.\n\n3.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. **MyGPO** is displayed on the list of GPOs on the **Pending** tab.\n\n### <a href=\"\" id=\"bkmk-manage3\"></a>Step 3: Review and deploy a GPO\n\nIn this step, you act as an Approver, creating reports and analyzing the settings and changes to settings in the GPO to determine whether you should approve them. After you evaluate the GPO, you deploy it to the production environment and link the GPO to a domain or an organizational unit (OU). The GPO takes effect when Group Policy is refreshed for computers in that domain or OU.\n\n**To review settings in the GPO**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that is assigned the role of Approver in AGPM. Any Group Policy administrator with the Reviewer role, which is included in all of the other roles, can review the settings in a GPO.\n\n2.  Open the e-mail inbox for the account and notice that you have received an e-mail message from the AGPM alias with an Editor's request to deploy a GPO.\n\n3.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n4.  On the **Contents** tab in the details pane, click the **Pending** tab.\n\n5.  Double-click **MyGPO** to display its history.\n\n6.  Review the settings in the most recent version of MyGPO:\n\n    1.  In the **History** window, right-click the GPO version with the most recent time stamp, click **Settings**, and then click **HTML Report** to display a summary of the GPO's settings.\n\n    2.  In the Web browser, click **show all** to display all the settings in the GPO. Close the browser.\n\n7.  Compare the most recent version of MyGPO to the first version checked in to the archive:\n\n    1.  In the **History** window, click the GPO version with the most recent time stamp. Press CTRL and then click the oldest GPO version for which the **Computer Version** is not **\\***.\n\n    2.  Click the **Differences** button. The **Account Policies/Password Policy** section is highlighted in green and preceded by **\\[+\\]**. This indicates that the setting is configured only in the latter version of the GPO.\n\n    3.  Click **Account Policies/Password Policy**. The **Minimum password length** setting is also highlighted in green and preceded by **\\[+\\]**, indicating that it is configured only in the latter version of the GPO.\n\n    4.  Close the Web browser.\n\n**To deploy the GPO to the production environment**\n\n1.  On the **Pending** tab, right-click **MyGPO** and then click **Approve**.\n\n2.  Type a comment to include in the history of the GPO.\n\n3.  Click **Yes**. When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The GPO is deployed to the production environment.\n\n**To link the GPO to a domain or organizational unit**\n\n1.  In the GPMC, right-click either the domain or an organizational unit (OU) to which you want to apply the GPO that you configured, and then click **Link an Existing GPO**.\n\n2.  In the **Select GPO** dialog box, click **MyGPO**, and then click **OK**.\n\n### <a href=\"\" id=\"bkmk-manage4\"></a>Step 4: Use a template to create a GPO\n\nIn this step, you use an account that has the Editor role to create and use a template. That template is a static version of a GPO for use as a starting point for creating new GPOs. Although you cannot edit a template, you can create a new GPO based on a template. Templates are useful for quickly creating multiple GPOs that include many of the same policy settings.\n\n**To create a template based on an existing GPO**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that is assigned the role of Editor in AGPM.\n\n2.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n3.  On the **Contents** tab in the details pane, click the **Controlled** tab.\n\n4.  Right-click **MyGPO**, and then click **Save as Template** to create a template incorporating all settings currently in MyGPO.\n\n5.  Type **MyTemplate** as the name for the template and a comment, and then click **OK**.\n\n6.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The new template appears on the **Templates** tab.\n\n**To request that a new GPO be created and managed through AGPM**\n\n1.  Click the **Controlled** tab.\n\n2.  Right-click the **Change Control** node, and then click **New Controlled GPO**.\n\n3.  In the **New Controlled GPO** dialog box:\n\n    1.  To receive a copy of the request, type your e-mail address in the **Cc** field.\n\n    2.  Type **MyOtherGPO** as the name for the new GPO.\n\n    3.  Type a comment for the new GPO.\n\n    4.  Click **Create live** so that the new GPO will be deployed to the production environment immediately upon approval.\n\n    5.  For **From GPO template**, select **MyTemplate**. Click **Submit**.\n\n4.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The new GPO is displayed on the **Pending** tab.\n\nUse an account that is assigned the role of Approver to approve the pending request to create the GPO as you did in [Step 1: Create a GPO](#bkmk-manage1). MyTemplate incorporates all the settings that you configured in MyGPO. Because MyOtherGPO was created using MyTemplate, it at first contains all the settings that MyGPO contained at the time that MyTemplate was created. You can confirm this by generating a difference report to compare MyOtherGPO to MyTemplate.\n\n**To check the GPO out from the archive for editing**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that is assigned the role of Editor in AGPM.\n\n2.  Right-click **MyOtherGPO**, and then click **Check Out**.\n\n3.  Type a comment to be displayed in the history of the GPO while it is checked out, and then click **OK**.\n\n4.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. On the **Controlled** tab, the state of the GPO is identified as **Checked Out**.\n\n**To edit the GPO offline and configure the account lockout duration**\n\n1.  On the **Controlled** tab, right-click **MyOtherGPO**, and then click **Edit** to open the **Group Policy Management Editor** window and change an offline copy of the GPO. For this scenario, configure the minimum password length:\n\n    1.  Under **Computer Configuration**, double-click **Policies**, **Windows Settings**, **Security Settings**, **Account Policies**, and **Account Lockout Policy**.\n\n    2.  In the details pane, double-click **Account lockout duration**.\n\n    3.  In the properties window, check **Define this policy setting**, set the duration to **30** minutes, and then click **OK**.\n\n2.  Close the **Group Policy Management Editor** window.\n\nCheck MyOtherGPO into the archive and request deployment as you did for MyGPO in [Step 2: Edit a GPO](#bkmk-manage2). You can compare MyOtherGPO to MyGPO or to MyTemplate by using difference reports. Any account that includes the Reviewer role (AGPM Administrator \\[Full Control\\], Approver, Editor, or Reviewer) can generate reports.\n\n**To compare a GPO to another GPO and to a template**\n\n1.  To compare MyGPO and MyOtherGPO:\n\n    1.  On the **Controlled** tab, click **MyGPO**. Press CTRL and then click **MyOtherGPO**.\n\n    2.  Right-click **MyOtherGPO**, point to **Differences**, and then click **HTML Report**.\n\n2.  To compare MyOtherGPO and MyTemplate:\n\n    1.  On the **Controlled** tab, click **MyOtherGPO**.\n\n    2.  Right-click **MyOtherGPO**, point to **Differences**, and then click **Template**.\n\n    3.  Select **MyTemplate** and **HTML Report**, and then click **OK**.\n\n### <a href=\"\" id=\"bkmk-manage5\"></a>Step 5: Delete and restore a GPO\n\nIn this step, you act as an Approver to delete a GPO.\n\n**To delete a GPO**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that is assigned the role of Approver.\n\n2.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n3.  On the **Contents** tab, click the **Controlled** tab to display the controlled GPOs.\n\n4.  Right-click **MyGPO**, and then click **Delete**. Click **Delete GPO from archive and production** to delete both the version in the archive and the deployed version of the GPO in the production environment.\n\n5.  Type a comment to be displayed in the audit trail for the GPO, and then click **OK**.\n\n6.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The GPO is removed from the **Controlled** tab and is displayed on the **Recycle Bin** tab, where it can be restored or destroyed.\n\nOccasionally you may discover after you delete a GPO that it is still needed. In this step, you act as an Approver to restore a GPO that was deleted.\n\n**To restore a deleted GPO**\n\n1.  On the **Contents** tab, click the **Recycle Bin** tab to display deleted GPOs.\n\n2.  Right-click **MyGPO**, and then click **Restore**.\n\n3.  Type a comment to be displayed in the history of the GPO, and then click **OK**.\n\n4.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The GPO is removed from the **Recycle Bin** tab and is displayed on the **Controlled** tab.\n\n    **Note**  \n    Restoring a GPO to the archive does not automatically redeploy it to the production environment. To return the GPO to the production environment, deploy the GPO as in [Step 3: Review and deploy a GPO](#bkmk-manage3).\n\n     \n\nAfter editing and deploying a GPO, you may discover that recent changes to the GPO are causing a problem. In this step, you act as an Approver to roll back to an earlier version of the GPO. You can roll back to any version in the history of the GPO. You can use comments and labels to identify known good versions and when specific changes were made.\n\n**To roll back to an earlier version of a GPO**\n\n1.  On the **Contents** tab, click the **Controlled** tab to display the controlled GPOs.\n\n2.  Double-click **MyGPO** to display its history.\n\n3.  Right-click the version to be deployed, click **Deploy**, and then click **Yes**.\n\n4.  When the **Progress** window indicates that overall progress is complete, click **Close**. In the **History** window, click **Close**.\n\n    **Note**  \n    To verify that the version that was redeployed is the version intended, examine a difference report for the two versions. In the **History** window for the GPO, select the two versions, right-click them, point to **Difference**, and then click either **HTML Report** or **XML Report**.\n\n     \n\n \n\n \n\n\n\n\n\n"}