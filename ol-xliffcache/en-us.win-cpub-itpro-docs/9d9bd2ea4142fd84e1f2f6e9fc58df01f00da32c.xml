{"nodes":[{"content":"Add multiple apps to your enterprise data protection (EDP) Protected Apps list (Windows 10)","pos":[11,102]},{"content":"Add multiple apps to your enterprise data protection (EDP) Protected Apps list at the same time, by using the Microsoft Intune Custom URI functionality and the AppLocker.","pos":[116,286]},{"content":"Add multiple apps to your enterprise data protection (EDP) Protected Apps list","pos":[518,596]},{"content":"Applies to:","pos":[599,610]},{"content":"Windows 10 Insider Preview","pos":[618,644]},{"content":"Windows 10 Mobile Preview","pos":[649,674]},{"content":"[Some information relates to pre-released product, which may be substantially modified before it's commercially released.","pos":[705,826]},{"content":"Microsoft makes no warranties, express or implied, with respect to the information provided here.]","pos":[827,925]},{"content":"Add multiple apps to your enterprise data protection (EDP) <bpt id=\"p1\">**</bpt>Protected Apps<ept id=\"p1\">**</ept> list at the same time, by using the Microsoft Intune Custom URI functionality and AppLocker.","pos":[934,1104]},{"content":"For more info about how to create a custom URI using Intune, see <bpt id=\"p1\">[</bpt>Windows 10 custom policy settings in Microsoft Intune<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=691330)</ept>.","pos":[1105,1275]},{"content":"Important","pos":[1279,1288]},{"content":"Results can be unpredictable if you configure your policy using both the UI and the Custom URI method together.","pos":[1293,1404]},{"content":"We recommend using a single method for each policy.","pos":[1405,1456]},{"pos":[1458,1656],"content":"If you only want to add one app at a time, you can follow the instructions in the <bpt id=\"p1\">[</bpt>Create an enterprise data protection (EDP) policy using Microsoft Intune<ept id=\"p1\">](create-edp-policy-using-intune.md)</ept> topic."},{"content":"To add Universal Windows Platform (UWP) apps","pos":[1660,1704]},{"content":"Go to the AppLocker UI by opening a command line window and running secpol.msc.","pos":[1712,1791]},{"content":"The local security policy MMC snap-in opens showing the <bpt id=\"p1\">**</bpt>Security Settings<ept id=\"p1\">**</ept>.","pos":[1792,1870]},{"content":"Double-click <bpt id=\"p1\">**</bpt>Application Control Policies<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>AppLocker<ept id=\"p2\">**</ept>, right-click <bpt id=\"p3\">**</bpt>Packaged app Rules<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>Automatically Generate Rules<ept id=\"p4\">**</ept>.","pos":[1876,2035]},{"content":"The <bpt id=\"p1\">**</bpt>Automatically Generate Packaged app Rules<ept id=\"p1\">**</ept> wizard opens, letting you create EDP-protected app polices for all of the installed apps on the device or for packaged apps within a specific folder.","pos":[2039,2238]},{"content":"In the <bpt id=\"p1\">**</bpt>Folder and Permissions<ept id=\"p1\">**</ept> screen, keep the default value of <bpt id=\"p2\">**</bpt>Everyone<ept id=\"p2\">**</ept> in the <bpt id=\"p3\">**</bpt>User or security group that the rules will apply to<ept id=\"p3\">**</ept> box.","pos":[2244,2392]},{"content":"You want to keep this value because your EDP policy needs to apply to the device being managed, not a single user or group of users.","pos":[2396,2528]},{"content":"Type the name you’ll use to tag the rules into the <bpt id=\"p1\">**</bpt>Name to identify this set of rules<ept id=\"p1\">**</ept> box, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","pos":[2534,2653]},{"content":"This name should be easily recognizable, such as <bpt id=\"p1\">*</bpt>EDP_UniversalApps_Rules<ept id=\"p1\">*</ept>.","pos":[2657,2732]},{"content":"In the <bpt id=\"p1\">**</bpt>Rules Preferences<ept id=\"p1\">**</ept> screen, keep the default settings, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to start generating the rules.","pos":[2738,2856]},{"content":"Important","pos":[2862,2871]},{"content":"You can also use <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> rules instead of the <bpt id=\"p2\">**</bpt>File hash<ept id=\"p2\">**</ept> if you have concerns about unsigned files potentially changing the hash value if they're updated in the future.","pos":[2877,3049]},{"content":"Note","pos":[3055,3059]},{"content":"We recommend that you use <bpt id=\"p1\">**</bpt>Publisher<ept id=\"p1\">**</ept> rules because they only work with apps you've specifically defined and they can be configured to not require updating simply because a new version came out.","pos":[3065,3261]},{"content":"If you can't use <bpt id=\"p1\">**</bpt>Publisher<ept id=\"p1\">**</ept> rules, we then recommend that you use <bpt id=\"p2\">**</bpt>File hash<ept id=\"p2\">**</ept> rules.","pos":[3264,3353]},{"content":"<bpt id=\"p1\">**</bpt>File hash<ept id=\"p1\">**</ept> rules are a secure alternative that can be used on unsigned code.","pos":[3354,3433]},{"content":"The primary disadvantage to <bpt id=\"p1\">**</bpt>File hash<ept id=\"p1\">**</ept> is that every time a binary changes (such as, through servicing updates or upgrades), you'll need to create a new rule.","pos":[3434,3595]},{"content":"Finally, there's <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> rules.","pos":[3598,3630]},{"content":"<bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> rules are easier to set up and maintain, but can let apps bypass enterprise data protection (EDP) by simply renaming and moving an unallowed file to match one of the apps on the <bpt id=\"p2\">**</bpt>Protected App<ept id=\"p2\">**</ept> list.","pos":[3631,3841]},{"content":"For example, if your <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> rule says to allow <ph id=\"ph1\">`%PROGRAMFILES%/NOTEPAD.EXE`</ph>, it becomes possible to rename DisallowedApp.exe to Notepad.exe, move it into the specified path above, and have it suddenly be allowed.","pos":[3842,4056]},{"pos":[4062,4209],"content":"In the <bpt id=\"p1\">**</bpt>Review Rules<ept id=\"p1\">**</ept> screen, look over your rules to make sure they’re right, and then click <bpt id=\"p2\">**</bpt>Create<ept id=\"p2\">**</ept> to add them to your collection of rules."},{"content":"In the left pane, right-click <bpt id=\"p1\">**</bpt>AppLocker<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Export Policies<ept id=\"p2\">**</ept>, go to where you want to save the XML file and type a file name, click <bpt id=\"p3\">**</bpt>Save<ept id=\"p3\">**</ept>, and then clear your AppLocker rules.","pos":[4215,4403]},{"content":"Important","pos":[4409,4418]},{"content":"Be aware that what you're saving are the actual AppLocker rules using your local policy.","pos":[4424,4512]},{"content":"You don't want to apply these rules to your employee devices, you just want to use them to create and export the XML content.","pos":[4513,4638]},{"content":"You must delete the AppLocker rules before you apply your policy.","pos":[4639,4704]},{"pos":[4710,5009],"content":"Open the Intune administration console, and go to the <bpt id=\"p1\">**</bpt>Policy<ept id=\"p1\">**</ept> node, click <bpt id=\"p2\">**</bpt>Add Policy<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Tasks<ept id=\"p3\">**</ept> area, go to <bpt id=\"p4\">**</bpt>Windows<ept id=\"p4\">**</ept>, click the <bpt id=\"p5\">**</bpt>Custom Configuration (Windows 10 Desktop and Mobile and later)<ept id=\"p5\">**</ept> policy, click <bpt id=\"p6\">**</bpt>Create and Deploy a Custom Policy<ept id=\"p6\">**</ept>, and then click <bpt id=\"p7\">**</bpt>Create Policy<ept id=\"p7\">**</ept>."},{"pos":[5015,5126],"content":"Type a name (required) and an optional description for your policy into the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Description<ept id=\"p2\">**</ept> boxes."},{"pos":[5132,5241],"content":"In the <bpt id=\"p1\">**</bpt>Add one or more OMA-URI settings that control functionality on Windows devices<ept id=\"p1\">**</ept> box, click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>."},{"pos":[5247,5373],"content":"Type your new <bpt id=\"p1\">**</bpt>Setting Name<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Description<ept id=\"p2\">**</ept> into the associated boxes, keeping the default <bpt id=\"p3\">**</bpt>Data Type<ept id=\"p3\">**</ept> of <bpt id=\"p4\">**</bpt>String<ept id=\"p4\">**</ept>."},{"pos":[5379,5407],"content":"In the <bpt id=\"p1\">**</bpt>OMA-URI<ept id=\"p1\">**</ept> box, type"},{"content":"Open File Explorer, go to the location where you saved your new XML file, and open it using an XML editor, such as Notepad.","pos":[5500,5623]},{"content":"Copy the text that has a <bpt id=\"p1\">**</bpt>Type<ept id=\"p1\">**</ept> of Appx, within the <bpt id=\"p2\">**</bpt>RuleCollection<ept id=\"p2\">**</ept> tags, and then go back to Intune and paste the text into the <bpt id=\"p3\">**</bpt>Value<ept id=\"p3\">**</ept> box of the <bpt id=\"p4\">**</bpt>Add or edit OMA-URI Setting<ept id=\"p4\">**</ept> box.","pos":[5629,5820]},{"content":"For example:","pos":[5821,5833]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to close the <bpt id=\"p2\">**</bpt>Add or edit OMA-URI Setting<ept id=\"p2\">**</ept> box, and then click <bpt id=\"p3\">**</bpt>Save Policy<ept id=\"p3\">**</ept>.","pos":[5953,6047]},{"content":"After saving the policy, you’ll need to deploy it to your employee’s devices.","pos":[6051,6128]},{"content":"For more info, see the <bpt id=\"p1\">[</bpt>Deploy your enterprise data protection (EDP) policy<ept id=\"p1\">](deploy-edp-policy-using-intune.md)</ept> topic.","pos":[6129,6247]},{"content":"To add Classic Windows applications","pos":[6251,6286]},{"content":"Go to the AppLocker UI by opening a command line window and running secpol.msc.","pos":[6294,6373]},{"content":"The local security policy MMC snap-in opens showing the <bpt id=\"p1\">**</bpt>Security Settings<ept id=\"p1\">**</ept>.","pos":[6374,6452]},{"content":"Double-click <bpt id=\"p1\">**</bpt>Application Control Policies<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>AppLocker<ept id=\"p2\">**</ept>, right-click <bpt id=\"p3\">**</bpt>Executable Rules<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>Automatically Generate Rules<ept id=\"p4\">**</ept>.","pos":[6458,6615]},{"content":"The <bpt id=\"p1\">**</bpt>Automatically Generate Executable Rules<ept id=\"p1\">**</ept> wizard opens, letting you create EDP-protected app polices by analyzing the files within a specific folder.","pos":[6619,6774]},{"content":"In the <bpt id=\"p1\">**</bpt>Folder and Permissions<ept id=\"p1\">**</ept> screen, keep the default value of <bpt id=\"p2\">**</bpt>Everyone<ept id=\"p2\">**</ept> in the <bpt id=\"p3\">**</bpt>User or security group that the rules will apply to<ept id=\"p3\">**</ept> box.","pos":[6780,6928]},{"content":"You want to keep this value because your EDP policy needs to apply to the device being managed, not a single user or group of users.","pos":[6932,7064]},{"content":"Type the name you’ll use to tag the rules into the <bpt id=\"p1\">**</bpt>Name to identify this set of rules<ept id=\"p1\">**</ept> box, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","pos":[7070,7189]},{"content":"This name should be easily recognizable, such as <bpt id=\"p1\">*</bpt>EDP_ClassicApps_Rules<ept id=\"p1\">*</ept>.","pos":[7193,7266]},{"content":"In the <bpt id=\"p1\">**</bpt>Rules Preferences<ept id=\"p1\">**</ept> screen, keep the default settings, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to start generating the rules.","pos":[7272,7390]},{"content":"Important","pos":[7396,7405]},{"content":"You can also use <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> rules instead of the <bpt id=\"p2\">**</bpt>File hash<ept id=\"p2\">**</ept> if you have concerns about unsigned files potentially changing the hash value if they're updated in the future.","pos":[7411,7583]},{"content":"Note","pos":[7589,7593]},{"content":"We recommend that you use <bpt id=\"p1\">**</bpt>Publisher<ept id=\"p1\">**</ept> rules because they only work with apps you've specifically defined and they can be configured to not require updating simply because a new version came out.","pos":[7599,7795]},{"content":"If you can't use <bpt id=\"p1\">**</bpt>Publisher<ept id=\"p1\">**</ept> rules, we then recommend that you use <bpt id=\"p2\">**</bpt>File hash<ept id=\"p2\">**</ept> rules.","pos":[7798,7887]},{"content":"<bpt id=\"p1\">**</bpt>File hash<ept id=\"p1\">**</ept> rules are a secure alternative that can be used on unsigned code.","pos":[7888,7967]},{"content":"The primary disadvantage to <bpt id=\"p1\">**</bpt>File hash<ept id=\"p1\">**</ept> is that every time a binary changes (such as, through servicing updates or upgrades), you'll need to create a new rule.","pos":[7968,8129]},{"content":"Finally, there's <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> rules.","pos":[8132,8164]},{"content":"<bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> rules are easier to set up and maintain, but can let apps bypass enterprise data protection (EDP) by simply renaming and moving an unallowed file to match one of the apps on the <bpt id=\"p2\">**</bpt>Protected App<ept id=\"p2\">**</ept> list.","pos":[8165,8375]},{"content":"For example, if your <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> rule says to allow <ph id=\"ph1\">`%PROGRAMFILES%/NOTEPAD.EXE`</ph>, it becomes possible to rename DisallowedApp.exe to Notepad.exe, move it into the specified path above, and have it suddenly be allowed.","pos":[8376,8590]},{"pos":[8596,8743],"content":"In the <bpt id=\"p1\">**</bpt>Review Rules<ept id=\"p1\">**</ept> screen, look over your rules to make sure they’re right, and then click <bpt id=\"p2\">**</bpt>Create<ept id=\"p2\">**</ept> to add them to your collection of rules."},{"content":"In the left pane, right-click <bpt id=\"p1\">**</bpt>AppLocker<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Export Policies<ept id=\"p2\">**</ept>, go to where you want to save the XML file and type a file name, click <bpt id=\"p3\">**</bpt>Save<ept id=\"p3\">**</ept>, and then clear your AppLocker rules.","pos":[8749,8937]},{"content":"Important","pos":[8943,8952]},{"content":"Be aware that what you're saving are the actual AppLocker rules using your local policy.","pos":[8958,9046]},{"content":"You don't want to apply these rules to your employee devices, you just want to use them to create and export the XML content.","pos":[9047,9172]},{"content":"You must delete the AppLocker rules before you apply your policy.","pos":[9173,9238]},{"pos":[9244,9543],"content":"Open the Intune administration console, and go to the <bpt id=\"p1\">**</bpt>Policy<ept id=\"p1\">**</ept> node, click <bpt id=\"p2\">**</bpt>Add Policy<ept id=\"p2\">**</ept> from the <bpt id=\"p3\">**</bpt>Tasks<ept id=\"p3\">**</ept> area, go to <bpt id=\"p4\">**</bpt>Windows<ept id=\"p4\">**</ept>, click the <bpt id=\"p5\">**</bpt>Custom Configuration (Windows 10 Desktop and Mobile and later)<ept id=\"p5\">**</ept> policy, click <bpt id=\"p6\">**</bpt>Create and Deploy a Custom Policy<ept id=\"p6\">**</ept>, and then click <bpt id=\"p7\">**</bpt>Create Policy<ept id=\"p7\">**</ept>."},{"pos":[9549,9660],"content":"Type a name (required) and an optional description for your policy into the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Description<ept id=\"p2\">**</ept> boxes."},{"pos":[9666,9775],"content":"In the <bpt id=\"p1\">**</bpt>Add one or more OMA-URI settings that control functionality on Windows devices<ept id=\"p1\">**</ept> box, click <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept>."},{"pos":[9781,9907],"content":"Type your new <bpt id=\"p1\">**</bpt>Setting Name<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Description<ept id=\"p2\">**</ept> into the associated boxes, keeping the default <bpt id=\"p3\">**</bpt>Data Type<ept id=\"p3\">**</ept> of <bpt id=\"p4\">**</bpt>String<ept id=\"p4\">**</ept>."},{"pos":[9913,9941],"content":"In the <bpt id=\"p1\">**</bpt>OMA-URI<ept id=\"p1\">**</ept> box, type"},{"content":"Open File Explorer, go to the location where you saved your new XML file, and open it using an XML editor, such as Notepad.","pos":[10025,10148]},{"content":"Copy the text that has a <bpt id=\"p1\">**</bpt>Type<ept id=\"p1\">**</ept> of EXE, within in the <bpt id=\"p2\">**</bpt>RuleCollection<ept id=\"p2\">**</ept> tags, and then go back to Intune and paste the text into the <bpt id=\"p3\">**</bpt>Value<ept id=\"p3\">**</ept> box of the <bpt id=\"p4\">**</bpt>Add or edit OMA-URI Setting<ept id=\"p4\">**</ept> box.","pos":[10154,10347]},{"content":"For example:","pos":[10348,10360]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to close the <bpt id=\"p2\">**</bpt>Add or edit OMA-URI Setting<ept id=\"p2\">**</ept> box, and then click <bpt id=\"p3\">**</bpt>Save Policy<ept id=\"p3\">**</ept>.","pos":[10480,10574]},{"content":"After saving the policy, you’ll need to deploy it to your employee’s devices.","pos":[10578,10655]},{"content":"For more info, see the <bpt id=\"p1\">[</bpt>Deploy your enterprise data protection (EDP) policy<ept id=\"p1\">](deploy-edp-policy-using-intune.md)</ept> topic.","pos":[10656,10774]},{"content":"Related topics","pos":[10778,10792]},{"content":"Create an enterprise data protection (EDP) policy using Microsoft Intune","pos":[10796,10868]},{"content":"Deploy your enterprise data protection (EDP) policy","pos":[10908,10959]},{"content":"Create and deploy a VPN policy for enterprise data protection (EDP) using Microsoft Intune","pos":[10999,11089]}],"content":"---\ntitle: Add multiple apps to your enterprise data protection (EDP) Protected Apps list (Windows 10)\ndescription: Add multiple apps to your enterprise data protection (EDP) Protected Apps list at the same time, by using the Microsoft Intune Custom URI functionality and the AppLocker.\nms.assetid: b50db35d-a2a9-4b78-a95d-a1b066e66880\nkeywords: EDP, Enterprise Data Protection, protected apps, protected app list\nms.prod: w10\nms.mktglfcycl: explore\nms.pagetype: security\nms.sitesec: library\nauthor: eross-msft\n---\n\n# Add multiple apps to your enterprise data protection (EDP) Protected Apps list\n**Applies to:**\n\n-   Windows 10 Insider Preview\n-   Windows 10 Mobile Preview\n\n<span style=\"color:#ED1C24;\">[Some information relates to pre-released product, which may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.]</span>\n\nAdd multiple apps to your enterprise data protection (EDP) **Protected Apps** list at the same time, by using the Microsoft Intune Custom URI functionality and AppLocker. For more info about how to create a custom URI using Intune, see [Windows 10 custom policy settings in Microsoft Intune](http://go.microsoft.com/fwlink/p/?LinkID=691330).\n\n**Important**  \nResults can be unpredictable if you configure your policy using both the UI and the Custom URI method together. We recommend using a single method for each policy.\n\nIf you only want to add one app at a time, you can follow the instructions in the [Create an enterprise data protection (EDP) policy using Microsoft Intune](create-edp-policy-using-intune.md) topic.\n\n**To add Universal Windows Platform (UWP) apps**\n\n1.  Go to the AppLocker UI by opening a command line window and running secpol.msc. The local security policy MMC snap-in opens showing the **Security Settings**.\n\n2.  Double-click **Application Control Policies**, double-click **AppLocker**, right-click **Packaged app Rules**, and then click **Automatically Generate Rules**.<p>\nThe **Automatically Generate Packaged app Rules** wizard opens, letting you create EDP-protected app polices for all of the installed apps on the device or for packaged apps within a specific folder.\n\n3.  In the **Folder and Permissions** screen, keep the default value of **Everyone** in the **User or security group that the rules will apply to** box.<p>\nYou want to keep this value because your EDP policy needs to apply to the device being managed, not a single user or group of users.\n\n4.  Type the name you’ll use to tag the rules into the **Name to identify this set of rules** box, and then click **Next**.<p>\nThis name should be easily recognizable, such as *EDP_UniversalApps_Rules*.\n\n5.  In the **Rules Preferences** screen, keep the default settings, and then click **Next** to start generating the rules.<p>\n**Important**<br>You can also use **Path** rules instead of the **File hash** if you have concerns about unsigned files potentially changing the hash value if they're updated in the future.<p>\n**Note**<br>We recommend that you use **Publisher** rules because they only work with apps you've specifically defined and they can be configured to not require updating simply because a new version came out.<p>If you can't use **Publisher** rules, we then recommend that you use **File hash** rules. **File hash** rules are a secure alternative that can be used on unsigned code. The primary disadvantage to **File hash** is that every time a binary changes (such as, through servicing updates or upgrades), you'll need to create a new rule.<p>Finally, there's **Path** rules. **Path** rules are easier to set up and maintain, but can let apps bypass enterprise data protection (EDP) by simply renaming and moving an unallowed file to match one of the apps on the **Protected App** list. For example, if your **Path** rule says to allow `%PROGRAMFILES%/NOTEPAD.EXE`, it becomes possible to rename DisallowedApp.exe to Notepad.exe, move it into the specified path above, and have it suddenly be allowed.\n\n6.  In the **Review Rules** screen, look over your rules to make sure they’re right, and then click **Create** to add them to your collection of rules.\n\n7.  In the left pane, right-click **AppLocker**, click **Export Policies**, go to where you want to save the XML file and type a file name, click **Save**, and then clear your AppLocker rules.<p>\n**Important**<br>Be aware that what you're saving are the actual AppLocker rules using your local policy. You don't want to apply these rules to your employee devices, you just want to use them to create and export the XML content. You must delete the AppLocker rules before you apply your policy.\n\n8.  Open the Intune administration console, and go to the **Policy** node, click **Add Policy** from the **Tasks** area, go to **Windows**, click the **Custom Configuration (Windows 10 Desktop and Mobile and later)** policy, click **Create and Deploy a Custom Policy**, and then click **Create Policy**.\n\n9.  Type a name (required) and an optional description for your policy into the **Name** and **Description** boxes.\n\n10. In the **Add one or more OMA-URI settings that control functionality on Windows devices** box, click **Add**.\n\n11. Type your new **Setting Name** and **Description** into the associated boxes, keeping the default **Data Type** of **String**.\n\n12. In the **OMA-URI** box, type `./Vendor/MSFT/AppLocker/EnterpriseDataProtection/<your_enterprise_name>/StoreApp EXE`\n\n13. Open File Explorer, go to the location where you saved your new XML file, and open it using an XML editor, such as Notepad.\n\n14. Copy the text that has a **Type** of Appx, within the **RuleCollection** tags, and then go back to Intune and paste the text into the **Value** box of the **Add or edit OMA-URI Setting** box. For example:\n\n    ```\n    <RuleCollection Type=\"Appx\" EnforcementMode=\"Enabled\"><your_xml_rules_here></RuleCollection>\n    ```\n\n15. Click **OK** to close the **Add or edit OMA-URI Setting** box, and then click **Save Policy**.<p>\nAfter saving the policy, you’ll need to deploy it to your employee’s devices. For more info, see the [Deploy your enterprise data protection (EDP) policy](deploy-edp-policy-using-intune.md) topic.\n\n**To add Classic Windows applications**\n\n1.  Go to the AppLocker UI by opening a command line window and running secpol.msc. The local security policy MMC snap-in opens showing the **Security Settings**.\n\n2.  Double-click **Application Control Policies**, double-click **AppLocker**, right-click **Executable Rules**, and then click **Automatically Generate Rules**.<p>\nThe **Automatically Generate Executable Rules** wizard opens, letting you create EDP-protected app polices by analyzing the files within a specific folder.\n\n3.  In the **Folder and Permissions** screen, keep the default value of **Everyone** in the **User or security group that the rules will apply to** box.<p>\nYou want to keep this value because your EDP policy needs to apply to the device being managed, not a single user or group of users.\n\n4.  Type the name you’ll use to tag the rules into the **Name to identify this set of rules** box, and then click **Next**.<p>\nThis name should be easily recognizable, such as *EDP_ClassicApps_Rules*.\n\n5.  In the **Rules Preferences** screen, keep the default settings, and then click **Next** to start generating the rules.<p>\n**Important**<br>You can also use **Path** rules instead of the **File hash** if you have concerns about unsigned files potentially changing the hash value if they're updated in the future.<p>\n**Note**<br>We recommend that you use **Publisher** rules because they only work with apps you've specifically defined and they can be configured to not require updating simply because a new version came out.<p>If you can't use **Publisher** rules, we then recommend that you use **File hash** rules. **File hash** rules are a secure alternative that can be used on unsigned code. The primary disadvantage to **File hash** is that every time a binary changes (such as, through servicing updates or upgrades), you'll need to create a new rule.<p>Finally, there's **Path** rules. **Path** rules are easier to set up and maintain, but can let apps bypass enterprise data protection (EDP) by simply renaming and moving an unallowed file to match one of the apps on the **Protected App** list. For example, if your **Path** rule says to allow `%PROGRAMFILES%/NOTEPAD.EXE`, it becomes possible to rename DisallowedApp.exe to Notepad.exe, move it into the specified path above, and have it suddenly be allowed.\n\n6.  In the **Review Rules** screen, look over your rules to make sure they’re right, and then click **Create** to add them to your collection of rules.\n\n7.  In the left pane, right-click **AppLocker**, click **Export Policies**, go to where you want to save the XML file and type a file name, click **Save**, and then clear your AppLocker rules.<p>\n**Important**<br>Be aware that what you're saving are the actual AppLocker rules using your local policy. You don't want to apply these rules to your employee devices, you just want to use them to create and export the XML content. You must delete the AppLocker rules before you apply your policy.\n\n8.  Open the Intune administration console, and go to the **Policy** node, click **Add Policy** from the **Tasks** area, go to **Windows**, click the **Custom Configuration (Windows 10 Desktop and Mobile and later)** policy, click **Create and Deploy a Custom Policy**, and then click **Create Policy**.\n\n9.  Type a name (required) and an optional description for your policy into the **Name** and **Description** boxes.\n\n10. In the **Add one or more OMA-URI settings that control functionality on Windows devices** box, click **Add**.\n\n11. Type your new **Setting Name** and **Description** into the associated boxes, keeping the default **Data Type** of **String**.\n\n12. In the **OMA-URI** box, type `./Vendor/MSFT/AppLocker/EnterpriseDataProtection/<your_enterprise_name>/EXE`\n\n13. Open File Explorer, go to the location where you saved your new XML file, and open it using an XML editor, such as Notepad.\n\n14. Copy the text that has a **Type** of EXE, within in the **RuleCollection** tags, and then go back to Intune and paste the text into the **Value** box of the **Add or edit OMA-URI Setting** box. For example:\n\n    ``` \n    <RuleCollection Type=\"Exe\" EnforcementMode=\"Enabled\"><your_xml_rules_here></RuleCollection>\n    ```\n\n15. Click **OK** to close the **Add or edit OMA-URI Setting** box, and then click **Save Policy**.<p>\nAfter saving the policy, you’ll need to deploy it to your employee’s devices. For more info, see the [Deploy your enterprise data protection (EDP) policy](deploy-edp-policy-using-intune.md) topic.\n\n##Related topics\n- [Create an enterprise data protection (EDP) policy using Microsoft Intune](create-edp-policy-using-intune.md)\n- [Deploy your enterprise data protection (EDP) policy](deploy-edp-policy-using-intune.md)\n- [Create and deploy a VPN policy for enterprise data protection (EDP) using Microsoft Intune](create-vpn-and-edp-policy-using-intune.md)\n\n\n \n\n \n\n\n\n\n\n"}