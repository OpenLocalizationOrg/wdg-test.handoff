{"nodes":[{"content":"Generate security audits (Windows 10)","pos":[11,48]},{"content":"Describes the best practices, location, values, policy management, and security considerations for the Generate security audits security policy setting.","pos":[62,214]},{"content":"Generate security audits","pos":[370,394]},{"content":"Applies to","pos":[398,408]},{"content":"Windows 10","pos":[415,425]},{"pos":[427,583],"content":"Describes the best practices, location, values, policy management, and security considerations for the <bpt id=\"p1\">**</bpt>Generate security audits<ept id=\"p1\">**</ept> security policy setting."},{"content":"Reference","pos":[588,597]},{"content":"This policy setting determines which accounts can be used by a process to generate audit records in the security event log.","pos":[599,722]},{"content":"The Local Security Authority Subsystem Service (LSASS) writes events to the log.","pos":[723,803]},{"content":"You can use the information in the security event log to trace unauthorized device access.","pos":[804,894]},{"content":"Constant: SeAuditPrivilege","pos":[896,922]},{"content":"Possible values","pos":[928,943]},{"content":"User-defined list of accounts","pos":[949,978]},{"content":"Local Service","pos":[983,996]},{"content":"Network Service","pos":[1001,1016]},{"content":"Best practices","pos":[1022,1036]},{"pos":[1042,1260],"content":"Because the audit log can potentially be an attack vector if an account is compromised, ensure that only the Local Service and Network Service accounts have the <bpt id=\"p1\">**</bpt>Generate security audits<ept id=\"p1\">**</ept> user right assigned to them."},{"content":"Location","pos":[1266,1274]},{"content":"Computer Configuration<ph id=\"ph1\">\\\\</ph>Windows Settings<ph id=\"ph2\">\\\\</ph>Security Settings<ph id=\"ph3\">\\\\</ph>Local Policies<ph id=\"ph4\">\\\\</ph>User Rights Assignment","pos":[1276,1375]},{"content":"Default values","pos":[1381,1395]},{"content":"By default, this setting is Local Service and Network Service on domain controllers and stand-alone servers.","pos":[1397,1505]},{"content":"The following table lists the actual and effective default policy values for the most recent supported versions of Windows.","pos":[1507,1630]},{"content":"Default values are also listed on the policy’s property page.","pos":[1631,1692]},{"content":"Server type or GPO","pos":[1696,1714]},{"content":"Default value","pos":[1717,1730]},{"content":"Default Domain Policy","pos":[1745,1766]},{"content":"Not defined","pos":[1768,1779]},{"content":"Default Domain Controller Policy","pos":[1784,1816]},{"content":"Local Service","pos":[1819,1832]},{"content":"Network Service","pos":[1837,1852]},{"content":"Stand-Alone Server Default Settings","pos":[1857,1892]},{"content":"Local Service","pos":[1895,1908]},{"content":"Network Service","pos":[1913,1928]},{"content":"Domain Controller Effective Default Settings","pos":[1933,1977]},{"content":"Local Service","pos":[1980,1993]},{"content":"Network Service","pos":[1998,2013]},{"content":"Member Server Effective Default Settings","pos":[2018,2058]},{"content":"Local Service","pos":[2061,2074]},{"content":"Network Service","pos":[2079,2094]},{"content":"Client Computer Effective Default Settings","pos":[2099,2141]},{"content":"Local Service","pos":[2144,2157]},{"content":"Network Service","pos":[2162,2177]},{"content":"Policy management","pos":[2185,2202]},{"content":"This section describes features, tools, and guidance to help you manage this policy.","pos":[2204,2288]},{"content":"A restart of the computer is not required for this policy setting to be effective.","pos":[2290,2372]},{"content":"Any change to the user rights assignment for an account becomes effective the next time the owner of the account logs on.","pos":[2374,2495]},{"pos":[2497,2840],"content":"Misuse of this user right can result in the generation of many auditing events, potentially hiding evidence of an attack or causing a denial-of-service (DoS) if the <bpt id=\"p1\">[</bpt>Audit: Shut down system immediately if unable to log security audits<ept id=\"p1\">](audit-shut-down-system-immediately-if-unable-to-log-security-audits.md)</ept> security policy setting is enabled."},{"content":"Group Policy","pos":[2846,2858]},{"content":"Settings are applied in the following order through a Group Policy Object (GPO), which will overwrite settings on the local computer at the next Group Policy update:","pos":[2860,3025]},{"content":"Local policy settings","pos":[3031,3052]},{"content":"Site policy settings","pos":[3057,3077]},{"content":"Domain policy settings","pos":[3082,3104]},{"content":"OU policy settings","pos":[3109,3127]},{"content":"When a local setting is greyed out, it indicates that a GPO currently controls that setting.","pos":[3129,3221]},{"content":"Security considerations","pos":[3226,3249]},{"content":"This section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.","pos":[3251,3445]},{"content":"Vulnerability","pos":[3451,3464]},{"content":"A malicious user could use accounts that can write to the Security log to fill that log with meaningless events.","pos":[3466,3578]},{"content":"If the computer is configured to overwrite events as needed, malicious users could use this method to remove evidence of their unauthorized activities.","pos":[3579,3730]},{"content":"If the computer is configured to shut down when it is unable to write to the Security log, and it is not configured to automatically back up the log files, this method could be used to create a DoS condition.","pos":[3731,3939]},{"content":"Countermeasure","pos":[3945,3959]},{"pos":[3961,4091],"content":"Ensure that only the Local Service and Network Service accounts have the <bpt id=\"p1\">**</bpt>Generate security audits<ept id=\"p1\">**</ept> user right assigned to them."},{"content":"Potential impact","pos":[4097,4113]},{"content":"None.","pos":[4115,4120]},{"content":"Restricting the <bpt id=\"p1\">**</bpt>Generate security audits<ept id=\"p1\">**</ept> user right to the Local Service and Network Service accounts is the default configuration.","pos":[4121,4256]},{"content":"Related topics","pos":[4261,4275]},{"content":"User Rights Assignment","pos":[4280,4302]}],"content":"---\ntitle: Generate security audits (Windows 10)\ndescription: Describes the best practices, location, values, policy management, and security considerations for the Generate security audits security policy setting.\nms.assetid: c0e1cd80-840e-4c74-917c-5c2349de885f\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Generate security audits\n\n**Applies to**\n-   Windows 10\n\nDescribes the best practices, location, values, policy management, and security considerations for the **Generate security audits** security policy setting.\n\n## Reference\n\nThis policy setting determines which accounts can be used by a process to generate audit records in the security event log. The Local Security Authority Subsystem Service (LSASS) writes events to the log. You can use the information in the security event log to trace unauthorized device access.\n\nConstant: SeAuditPrivilege\n\n### Possible values\n\n-   User-defined list of accounts\n-   Local Service\n-   Network Service\n\n### Best practices\n\n-   Because the audit log can potentially be an attack vector if an account is compromised, ensure that only the Local Service and Network Service accounts have the **Generate security audits** user right assigned to them.\n\n### Location\n\nComputer Configuration\\\\Windows Settings\\\\Security Settings\\\\Local Policies\\\\User Rights Assignment\n\n### Default values\n\nBy default, this setting is Local Service and Network Service on domain controllers and stand-alone servers.\n\nThe following table lists the actual and effective default policy values for the most recent supported versions of Windows. Default values are also listed on the policy’s property page.\n\n| Server type or GPO | Default value |\n| - | - |\n| Default Domain Policy| Not defined| \n| Default Domain Controller Policy | Local Service<br/>Network Service| \n| Stand-Alone Server Default Settings | Local Service<br/>Network Service| \n| Domain Controller Effective Default Settings | Local Service<br/>Network Service| \n| Member Server Effective Default Settings | Local Service<br/>Network Service| \n| Client Computer Effective Default Settings | Local Service<br/>Network Service| \n \n## Policy management\n\nThis section describes features, tools, and guidance to help you manage this policy.\n\nA restart of the computer is not required for this policy setting to be effective.\n\nAny change to the user rights assignment for an account becomes effective the next time the owner of the account logs on.\n\nMisuse of this user right can result in the generation of many auditing events, potentially hiding evidence of an attack or causing a denial-of-service (DoS) if the [Audit: Shut down system immediately if unable to log security audits](audit-shut-down-system-immediately-if-unable-to-log-security-audits.md) security policy setting is enabled.\n\n### Group Policy\n\nSettings are applied in the following order through a Group Policy Object (GPO), which will overwrite settings on the local computer at the next Group Policy update:\n\n1.  Local policy settings\n2.  Site policy settings\n3.  Domain policy settings\n4.  OU policy settings\n\nWhen a local setting is greyed out, it indicates that a GPO currently controls that setting.\n\n## Security considerations\n\nThis section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.\n\n### Vulnerability\n\nA malicious user could use accounts that can write to the Security log to fill that log with meaningless events. If the computer is configured to overwrite events as needed, malicious users could use this method to remove evidence of their unauthorized activities. If the computer is configured to shut down when it is unable to write to the Security log, and it is not configured to automatically back up the log files, this method could be used to create a DoS condition.\n\n### Countermeasure\n\nEnsure that only the Local Service and Network Service accounts have the **Generate security audits** user right assigned to them.\n\n### Potential impact\n\nNone. Restricting the **Generate security audits** user right to the Local Service and Network Service accounts is the default configuration.\n\n## Related topics\n\n- [User Rights Assignment](user-rights-assignment.md)\n"}