{"nodes":[{"content":"Extract Files from a Compressed USMT Migration Store (Windows 10)","pos":[11,76]},{"content":"Extract Files from a Compressed USMT Migration Store","pos":[90,142]},{"content":"Extract Files from a Compressed USMT Migration Store","pos":[275,327]},{"content":"When you migrate files and settings during a typical PC-refresh migration, you usually create a compressed migration store file on the intermediate store.","pos":[330,484]},{"content":"This migration store is a single image file that contains all files being migrated as well as a catalog file.","pos":[485,594]},{"content":"To protect the compressed file, you can encrypt it by using different encryption algorithms.","pos":[595,687]},{"content":"When you migrate the file back to the source computer after the operating system is installed, you can run the <bpt id=\"p1\">**</bpt>Usmtutils<ept id=\"p1\">**</ept> command with the <bpt id=\"p2\">**</bpt>/extract<ept id=\"p2\">**</ept> option to recover the files from the compressed migration store.","pos":[688,907]},{"content":"You can also use the <bpt id=\"p1\">**</bpt>Usmtutils<ept id=\"p1\">**</ept> command with the <bpt id=\"p2\">**</bpt>/extract<ept id=\"p2\">**</ept> option any time you need to recover data from a migration store.","pos":[908,1037]},{"pos":[1039,1093],"content":"Options used with the <bpt id=\"p1\">**</bpt>/extract<ept id=\"p1\">**</ept> option can specify:"},{"content":"The cryptographic algorithm that was used to create the migration store.","pos":[1099,1171]},{"content":"The encryption key or the text file that contains the encryption key.","pos":[1177,1246]},{"content":"Include and exclude patterns for selective data extraction.","pos":[1252,1311]},{"content":"In addition, you can specify the file patterns that you want to extract by using the <bpt id=\"p1\">**</bpt>/i<ept id=\"p1\">**</ept> option to include file patterns or the <bpt id=\"p2\">**</bpt>/e<ept id=\"p2\">**</ept> option to exclude file patterns.","pos":[1313,1483]},{"content":"When both the <bpt id=\"p1\">**</bpt>/i<ept id=\"p1\">**</ept> option and the <bpt id=\"p2\">**</bpt>/e<ept id=\"p2\">**</ept> option are used in the same command, include patterns take precedence over exclude patterns.","pos":[1484,1619]},{"content":"Note that this is different from the include and exclude rules used in the ScanState and LoadState tools.","pos":[1620,1725]},{"content":"In this topic","pos":[1730,1743]},{"content":"To run the USMTutils tool with the /extract option","pos":[1751,1801]},{"content":"To extract all files from a compressed migration store","pos":[1830,1884]},{"content":"To extract specific file types from an encrypted compressed migration store","pos":[1915,1990]},{"content":"To extract all but one, or more, file types from an encrypted compressed migration store","pos":[2026,2114]},{"content":"To extract file types using the include pattern and the exclude pattern","pos":[2148,2219]},{"pos":[2292,2342],"content":"To run the USMTutils tool with the /extract option"},{"content":"To extract files from the compressed migration store onto the destination computer, use the following USMTutils syntax:","pos":[2344,2463]},{"content":"Cd /d <ph id=\"ph1\">&amp;lt;</ph>USMTpath<ph id=\"ph2\">&amp;gt;</ph> usmtutils /extract <ph id=\"ph3\">&amp;lt;</ph>filePath<ph id=\"ph4\">&amp;gt;</ph> <ph id=\"ph5\">&amp;lt;</ph>destinationPath<ph id=\"ph6\">&amp;gt;</ph> <ph id=\"ph7\">\\[</ph>/i:<ph id=\"ph8\">&amp;lt;</ph>includePattern<ph id=\"ph9\">&amp;gt;\\]</ph> <ph id=\"ph10\">\\[</ph>/e:<ph id=\"ph11\">&amp;lt;</ph>excludePattern<ph id=\"ph12\">&amp;gt;\\]</ph> <ph id=\"ph13\">\\[</ph>/l:<ph id=\"ph14\">&amp;lt;</ph>logfile<ph id=\"ph15\">&amp;gt;\\]</ph> <ph id=\"ph16\">\\[</ph>/decrypt<ph id=\"ph17\">\\[</ph>:<ph id=\"ph18\">&amp;lt;</ph>AlgID<ph id=\"ph19\">&amp;gt;\\]</ph> {/key:<ph id=\"ph20\">&amp;lt;</ph>keystring<ph id=\"ph21\">&amp;gt;</ph> | /keyfile:<ph id=\"ph22\">&amp;lt;</ph>filename<ph id=\"ph23\">&amp;gt;</ph>}<ph id=\"ph24\">\\]</ph> <ph id=\"ph25\">\\[</ph>/o","pos":[2465,2719]},{"content":"Where the placeholders have the following values:","pos":[2723,2772]},{"pos":[2778,2859],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>USMTpath<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the location where you have saved the USMT files and tools."},{"pos":[2865,2923],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>filePath<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the location of the migration store."},{"pos":[2929,3069],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>destination path<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the location of the file where you want the <bpt id=\"p2\">**</bpt>/extract<ept id=\"p2\">**</ept> option to put the extracted migration store contents."},{"pos":[3075,3165],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>includePattern<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> specifies the pattern for the files to include in the extraction."},{"pos":[3171,3260],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>excludePattern<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> specifies the pattern for the files to omit from the extraction."},{"pos":[3266,3391],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>AlgID<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the cryptographic algorithm that was used to create the migration store on the <bpt id=\"p2\">**</bpt>ScanState<ept id=\"p2\">**</ept> command line."},{"pos":[3397,3456],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>logfile<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the location and name of the log file."},{"pos":[3462,3549],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>keystring<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the encryption key that was used to encrypt the migration store."},{"pos":[3555,3649],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>filename<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the location and name of the text file that contains the encryption key."},{"pos":[3696,3750],"content":"To extract all files from a compressed migration store"},{"content":"To extract everything from a compressed migration store to a file on the C:<ph id=\"ph1\">\\\\</ph> drive, type:","pos":[3752,3842]},{"pos":[3982,4057],"content":"To extract specific file types from an encrypted compressed migration store"},{"content":"To extract specific files, such as .txt and .pdf files, from an encrypted compressed migration store, type:","pos":[4059,4166]},{"content":"In this example, the file is encrypted and the encryption key is located in a text file called encryptionKey.","pos":[4312,4421]},{"pos":[4471,4559],"content":"To extract all but one, or more, file types from an encrypted compressed migration store"},{"content":"To extract all files except for one file type, such as .exe files, from an encrypted compressed migration store, type:","pos":[4561,4679]},{"pos":[4881,4952],"content":"To extract file types using the include pattern and the exclude pattern"},{"content":"To extract files from a compressed migration store, and to exclude files of one type (such as .exe files) while including only specific files, use both the include pattern and the exclude pattern, as in this example:","pos":[4954,5170]},{"content":"In this example, if there is a myProject.exe file, it will also be extracted because the include pattern option takes precedence over the exclude pattern option.","pos":[5287,5448]},{"content":"Related topics","pos":[5453,5467]},{"content":"UsmtUtils Syntax","pos":[5471,5487]},{"content":"Return Codes","pos":[5510,5522]},{"content":"Verify the Condition of a Compressed Migration Store","pos":[5548,5600]}],"content":"---\ntitle: Extract Files from a Compressed USMT Migration Store (Windows 10)\ndescription: Extract Files from a Compressed USMT Migration Store\nms.assetid: ad9fbd6e-f89e-4444-8538-9b11566b1f33\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: greg-lindsay\n---\n\n# Extract Files from a Compressed USMT Migration Store\n\n\nWhen you migrate files and settings during a typical PC-refresh migration, you usually create a compressed migration store file on the intermediate store. This migration store is a single image file that contains all files being migrated as well as a catalog file. To protect the compressed file, you can encrypt it by using different encryption algorithms. When you migrate the file back to the source computer after the operating system is installed, you can run the **Usmtutils** command with the **/extract** option to recover the files from the compressed migration store. You can also use the **Usmtutils** command with the **/extract** option any time you need to recover data from a migration store.\n\nOptions used with the **/extract** option can specify:\n\n-   The cryptographic algorithm that was used to create the migration store.\n\n-   The encryption key or the text file that contains the encryption key.\n\n-   Include and exclude patterns for selective data extraction.\n\nIn addition, you can specify the file patterns that you want to extract by using the **/i** option to include file patterns or the **/e** option to exclude file patterns. When both the **/i** option and the **/e** option are used in the same command, include patterns take precedence over exclude patterns. Note that this is different from the include and exclude rules used in the ScanState and LoadState tools.\n\n## In this topic\n\n\n-   [To run the USMTutils tool with the /extract option](#bkmk-extractsyntax)\n\n-   [To extract all files from a compressed migration store](#bkmk-extractallfiles)\n\n-   [To extract specific file types from an encrypted compressed migration store](#bkmk-extractspecificfiles)\n\n-   [To extract all but one, or more, file types from an encrypted compressed migration store](#bkmk-excludefilepattern)\n\n-   [To extract file types using the include pattern and the exclude pattern](#bkmk-includeexcludefiles)\n\n### <a href=\"\" id=\"bkmk-extractsyntax\"></a>To run the USMTutils tool with the /extract option\n\nTo extract files from the compressed migration store onto the destination computer, use the following USMTutils syntax:\n\nCd /d &lt;USMTpath&gt; usmtutils /extract &lt;filePath&gt; &lt;destinationPath&gt; \\[/i:&lt;includePattern&gt;\\] \\[/e:&lt;excludePattern&gt;\\] \\[/l:&lt;logfile&gt;\\] \\[/decrypt\\[:&lt;AlgID&gt;\\] {/key:&lt;keystring&gt; | /keyfile:&lt;filename&gt;}\\] \\[/o\\]\n\nWhere the placeholders have the following values:\n\n-   *&lt;USMTpath&gt;* is the location where you have saved the USMT files and tools.\n\n-   *&lt;filePath&gt;* is the location of the migration store.\n\n-   *&lt;destination path&gt;* is the location of the file where you want the **/extract** option to put the extracted migration store contents.\n\n-   *&lt;includePattern&gt;* specifies the pattern for the files to include in the extraction.\n\n-   *&lt;excludePattern&gt;* specifies the pattern for the files to omit from the extraction.\n\n-   *&lt;AlgID&gt;* is the cryptographic algorithm that was used to create the migration store on the **ScanState** command line.\n\n-   *&lt;logfile&gt;* is the location and name of the log file.\n\n-   *&lt;keystring&gt;* is the encryption key that was used to encrypt the migration store.\n\n-   *&lt;filename&gt;* is the location and name of the text file that contains the encryption key.\n\n### <a href=\"\" id=\"bkmk-extractallfiles\"></a>To extract all files from a compressed migration store\n\nTo extract everything from a compressed migration store to a file on the C:\\\\ drive, type:\n\n``` syntax\nusmtutils /extract D:\\MyMigrationStore\\USMT\\store.mig C:\\ExtractedStore\n```\n\n### <a href=\"\" id=\"bkmk-extractspecificfiles\"></a>To extract specific file types from an encrypted compressed migration store\n\nTo extract specific files, such as .txt and .pdf files, from an encrypted compressed migration store, type:\n\n``` syntax\nusmtutils /extract D:\\MyMigrationStore\\USMT\\store.mig /i:\"*.txt,*.pdf\" C:\\ExtractedStore /decrypt /keyfile:D:\\encryptionKey.txt\n```\n\nIn this example, the file is encrypted and the encryption key is located in a text file called encryptionKey.\n\n### <a href=\"\" id=\"bkmk-excludefilepattern\"></a>To extract all but one, or more, file types from an encrypted compressed migration store\n\nTo extract all files except for one file type, such as .exe files, from an encrypted compressed migration store, type:\n\n``` syntax\nusmtutils /extract D:\\MyMigrationStore\\USMT\\store.mig /e:*.exe C:\\ExtractedStore /decrypt:AES_128 /key:password /l:C:\\usmtutilslog.txt\n```\n\n### <a href=\"\" id=\"bkmk-includeexcludefiles\"></a>To extract file types using the include pattern and the exclude pattern\n\nTo extract files from a compressed migration store, and to exclude files of one type (such as .exe files) while including only specific files, use both the include pattern and the exclude pattern, as in this example:\n\n``` syntax\nusmtutils /extract D:\\MyMigrationStore\\USMT\\store.mig /i:myProject.* /e:*.exe C:\\ExtractedStore /o\n```\n\nIn this example, if there is a myProject.exe file, it will also be extracted because the include pattern option takes precedence over the exclude pattern option.\n\n## Related topics\n\n\n[UsmtUtils Syntax](usmt-utilities.md)\n\n[Return Codes](usmt-return-codes.md)\n\n[Verify the Condition of a Compressed Migration Store](verify-the-condition-of-a-compressed-migration-store.md)\n\n \n\n \n\n\n\n\n\n"}