{"nodes":[{"content":"Configure the AGPM Server Connection","pos":[11,47]},{"content":"Configure the AGPM Server Connection","pos":[61,97]},{"content":"Configure the AGPM Server Connection","pos":[245,281]},{"content":"Advanced Group Policy Management (AGPM) stores all versions of each controlled Group Policy object (GPO) in a central archive, so Group Policy administrators can view and modify GPOs offline without immediately impacting the deployed version of each GPO.","pos":[284,538]},{"content":"A user account with the AGPM Administrator (Full Control) role, the user account of the Approver who created the GPO used in these procedures, or a user account with the necessary permissions in Advanced Group Policy Management is required to complete these procedures for centrally configuring archive locations for all Group Policy administrators.","pos":[540,889]},{"content":"Review the details in \"Additional considerations\" in this topic.","pos":[890,954]},{"content":"Configuring the AGPM Server connection","pos":[959,997]},{"content":"As an AGPM Administrator (Full Control), you can ensure that all Group Policy administrators connect to the same AGPM Server by centrally configuring the setting.","pos":[1000,1162]},{"content":"If your environment requires separate AGPM Servers for some or all domains, configure those additional AGPM Servers as exceptions to the default.","pos":[1163,1308]},{"content":"If you do not centrally configure AGPM Server connections, each Group Policy administrator must manually configure the AGPM Server to be displayed for each domain.","pos":[1309,1472]},{"content":"Configure an AGPM Server for all Group Policy administrators","pos":[1479,1539]},{"content":"Configure additional AGPM Servers for all Group Policy administrators","pos":[1572,1641]},{"content":"Manually configure an AGPM Server for your account","pos":[1677,1727]},{"content":"To configure an AGPM Server for all Group Policy administrators","pos":[1816,1879]},{"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, edit a GPO that is applied to all Group Policy administrators.","pos":[1887,1998]},{"content":"(For more information, see <bpt id=\"p1\">[</bpt>Editing a GPO<ept id=\"p1\">](editing-a-gpo.md)</ept>.)","pos":[1999,2061]},{"pos":[2067,2193],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Object Editor<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>User Configuration<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Administrative Templates<ept id=\"p3\">**</ept>, and <bpt id=\"p4\">**</bpt>Windows Components<ept id=\"p4\">**</ept>."},{"pos":[2199,2254],"content":"If <bpt id=\"p1\">**</bpt>AGPM<ept id=\"p1\">**</ept> is not listed under <bpt id=\"p2\">**</bpt>Windows Components<ept id=\"p2\">**</ept>:"},{"pos":[2264,2340],"content":"Right-click <bpt id=\"p1\">**</bpt>Administrative Templates<ept id=\"p1\">**</ept> and click <bpt id=\"p2\">**</bpt>Add/Remove Templates<ept id=\"p2\">**</ept>."},{"pos":[2350,2444],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>agpm.admx<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>agpm.adm<ept id=\"p3\">**</ept>, click <bpt id=\"p4\">**</bpt>Open<ept id=\"p4\">**</ept>, and then click <bpt id=\"p5\">**</bpt>Close<ept id=\"p5\">**</ept>."},{"pos":[2450,2502],"content":"Under <bpt id=\"p1\">**</bpt>Windows Components<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>AGPM<ept id=\"p2\">**</ept>."},{"pos":[2508,2572],"content":"In the details pane, double-click <bpt id=\"p1\">**</bpt>AGPM Server (all domains)<ept id=\"p1\">**</ept>."},{"pos":[2578,2759],"content":"In the <bpt id=\"p1\">**</bpt>AGPM Server (all domains) Properties<ept id=\"p1\">**</ept> window, select the <bpt id=\"p2\">**</bpt>Enabled<ept id=\"p2\">**</ept> check box, and type the fully-qualified computer name and port (for example, server.contoso.com:4600)."},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>.","pos":[2765,2778]},{"content":"Unless you want to configure additional AGPM Server connections, close the <bpt id=\"p1\">**</bpt>Group Policy Object Editor<ept id=\"p1\">**</ept> and deploy the GPO.","pos":[2779,2904]},{"content":"(For more information, see <bpt id=\"p1\">[</bpt>Deploy a GPO<ept id=\"p1\">](deploy-a-gpo.md)</ept>.) When Group Policy is updated, the AGPM Server connection is configured for all Group Policy administrators.","pos":[2905,3073]},{"content":"To configure additional AGPM Servers for all Group Policy administrators","pos":[3129,3201]},{"content":"If no AGPM Server connection has been configured, follow the preceding procedure to configure a default AGPM Server for all domains.","pos":[3209,3341]},{"content":"To configure separate AGPM Servers for some or all domains (overriding the default AGPM Server), in the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, edit a GPO that is applied to all Group Policy administrators.","pos":[3347,3555]},{"content":"(For more information, see <bpt id=\"p1\">[</bpt>Editing a GPO<ept id=\"p1\">](editing-a-gpo.md)</ept>.)","pos":[3556,3618]},{"pos":[3624,3777],"content":"Under <bpt id=\"p1\">**</bpt>User Configuration<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>Group Policy Object Editor<ept id=\"p2\">**</ept>, double-click <bpt id=\"p3\">**</bpt>Administrative Templates<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Windows Components<ept id=\"p4\">**</ept>, and then <bpt id=\"p5\">**</bpt>AGPM<ept id=\"p5\">**</ept>."},{"pos":[3783,3833],"content":"In the details pane, double-click <bpt id=\"p1\">**</bpt>AGPM Server<ept id=\"p1\">**</ept>."},{"pos":[3839,3934],"content":"In the <bpt id=\"p1\">**</bpt>AGPM Server Properties<ept id=\"p1\">**</ept> window, select the <bpt id=\"p2\">**</bpt>Enabled<ept id=\"p2\">**</ept> check box, and click <bpt id=\"p3\">**</bpt>Show<ept id=\"p3\">**</ept>."},{"pos":[3940,3972],"content":"In the <bpt id=\"p1\">**</bpt>Show Contents<ept id=\"p1\">**</ept> window:"},{"pos":[3982,3996],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>."},{"pos":[4006,4082],"content":"For <bpt id=\"p1\">**</bpt>Value Name<ept id=\"p1\">**</ept>, type the domain name (for example, server1.contoso.com)."},{"content":"For <bpt id=\"p1\">**</bpt>Value<ept id=\"p1\">**</ept>, type the AGPM Server name and port to use for this domain (for example, server2.contoso.com:4600), and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>.","pos":[4092,4228]},{"content":"(By default, the AGPM Service listens on port 4600.","pos":[4229,4280]},{"content":"To use a different port, see <bpt id=\"p1\">[</bpt>Modify the Port on Which the AGPM Service Listens<ept id=\"p1\">](modify-the-port-on-which-the-agpm-service-listens.md)</ept>.)","pos":[4281,4417]},{"content":"Repeat for each domain not using the default AGPM Server.","pos":[4427,4484]},{"pos":[4490,4573],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to close the <bpt id=\"p2\">**</bpt>Show Contents<ept id=\"p2\">**</ept> and <bpt id=\"p3\">**</bpt>AGPM Server Properties<ept id=\"p3\">**</ept> windows."},{"content":"Close the <bpt id=\"p1\">**</bpt>Group Policy Object Editor<ept id=\"p1\">**</ept>.","pos":[4579,4620]},{"content":"(For more information, see <bpt id=\"p1\">[</bpt>Deploy a GPO<ept id=\"p1\">](deploy-a-gpo.md)</ept>.) When Group Policy is updated, the new AGPM Server connections are configured for all Group Policy administrators.","pos":[4621,4795]},{"content":"If you have centrally configured the AGPM Server connection, the option to manually it is unavailable for all Group Policy administrators.","pos":[4856,4994]},{"content":"To manually configure the AGPM Server to display for your account","pos":[4998,5063]},{"pos":[5071,5203],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[5209,5260],"content":"In the details pane, click the <bpt id=\"p1\">**</bpt>AGPM Server<ept id=\"p1\">**</ept> tab."},{"content":"Enter the fully-qualified computer name for the AGPM Server that manages the archive used for this domain (for example, server.contoso.com) and the port on which the AGPM Service listens (by default, port 4600).","pos":[5266,5477]},{"pos":[5483,5530],"content":"Click <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept>, then click <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept> to confirm."},{"content":"Additional considerations","pos":[5536,5561]},{"content":"You must be able to edit and deploy a GPO to perform the procedures for centrally configuring AGPM Server connections for all Group Policy administrators.","pos":[5567,5721]},{"content":"See <bpt id=\"p1\">[</bpt>Editing a GPO<ept id=\"p1\">](editing-a-gpo.md)</ept> and <bpt id=\"p2\">[</bpt>Deploy a GPO<ept id=\"p2\">](deploy-a-gpo.md)</ept> for additional detail.","pos":[5722,5818]},{"content":"The AGPM Server selected determines which GPOs are displayed on the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab and to what location the <bpt id=\"p2\">**</bpt>Domain Delegation<ept id=\"p2\">**</ept> tab settings are applied.","pos":[5824,5981]},{"content":"If not centrally managed through the Administrative Template, each Group Policy administrator must configure this setting to point to the AGPM Server for the domain.","pos":[5982,6147]},{"content":"Membership in the Group Policy Creator Owners group should be restricted so that it is not used to circumvent the management of access to GPOs by AGPM.","pos":[6153,6304]},{"content":"(In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Group Policy Objects<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs, click <bpt id=\"p3\">**</bpt>Delegation<ept id=\"p3\">**</ept>, and then configure the settings to meet the needs of your organization.)","pos":[6305,6534]},{"content":"Additional references","pos":[6540,6561]},{"content":"Performing AGPM Administrator Tasks","pos":[6568,6603]}],"content":"---\ntitle: Configure the AGPM Server Connection\ndescription: Configure the AGPM Server Connection\nauthor: jamiejdt\nms.assetid: 9a42b5bc-41be-44ef-a6e2-6f56e2cf1996\nms.pagetype: mdop\nms.mktglfcycl: manage\nms.sitesec: library\nms.prod: w10\n---\n\n\n# Configure the AGPM Server Connection\n\n\nAdvanced Group Policy Management (AGPM) stores all versions of each controlled Group Policy object (GPO) in a central archive, so Group Policy administrators can view and modify GPOs offline without immediately impacting the deployed version of each GPO.\n\nA user account with the AGPM Administrator (Full Control) role, the user account of the Approver who created the GPO used in these procedures, or a user account with the necessary permissions in Advanced Group Policy Management is required to complete these procedures for centrally configuring archive locations for all Group Policy administrators. Review the details in \"Additional considerations\" in this topic.\n\n## Configuring the AGPM Server connection\n\n\nAs an AGPM Administrator (Full Control), you can ensure that all Group Policy administrators connect to the same AGPM Server by centrally configuring the setting. If your environment requires separate AGPM Servers for some or all domains, configure those additional AGPM Servers as exceptions to the default. If you do not centrally configure AGPM Server connections, each Group Policy administrator must manually configure the AGPM Server to be displayed for each domain.\n\n-   [Configure an AGPM Server for all Group Policy administrators](#bkmk-defaultarchiveloc)\n\n-   [Configure additional AGPM Servers for all Group Policy administrators](#bkmk-additionalarchiveloc)\n\n-   [Manually configure an AGPM Server for your account](#bkmk-manuallyconfigurearchiveloc)\n\n### <a href=\"\" id=\"bkmk-defaultarchiveloc\"></a>\n\n**To configure an AGPM Server for all Group Policy administrators**\n\n1.  In the **Group Policy Management Console** tree, edit a GPO that is applied to all Group Policy administrators. (For more information, see [Editing a GPO](editing-a-gpo.md).)\n\n2.  In the **Group Policy Object Editor**, click **User Configuration**, **Administrative Templates**, and **Windows Components**.\n\n3.  If **AGPM** is not listed under **Windows Components**:\n\n    1.  Right-click **Administrative Templates** and click **Add/Remove Templates**.\n\n    2.  Click **Add**, select **agpm.admx** or **agpm.adm**, click **Open**, and then click **Close**.\n\n4.  Under **Windows Components**, double-click **AGPM**.\n\n5.  In the details pane, double-click **AGPM Server (all domains)**.\n\n6.  In the **AGPM Server (all domains) Properties** window, select the **Enabled** check box, and type the fully-qualified computer name and port (for example, server.contoso.com:4600).\n\n7.  Click **OK**. Unless you want to configure additional AGPM Server connections, close the **Group Policy Object Editor** and deploy the GPO. (For more information, see [Deploy a GPO](deploy-a-gpo.md).) When Group Policy is updated, the AGPM Server connection is configured for all Group Policy administrators.\n\n### <a href=\"\" id=\"bkmk-additionalarchiveloc\"></a>\n\n**To configure additional AGPM Servers for all Group Policy administrators**\n\n1.  If no AGPM Server connection has been configured, follow the preceding procedure to configure a default AGPM Server for all domains.\n\n2.  To configure separate AGPM Servers for some or all domains (overriding the default AGPM Server), in the **Group Policy Management Console** tree, edit a GPO that is applied to all Group Policy administrators. (For more information, see [Editing a GPO](editing-a-gpo.md).)\n\n3.  Under **User Configuration** in the **Group Policy Object Editor**, double-click **Administrative Templates**, **Windows Components**, and then **AGPM**.\n\n4.  In the details pane, double-click **AGPM Server**.\n\n5.  In the **AGPM Server Properties** window, select the **Enabled** check box, and click **Show**.\n\n6.  In the **Show Contents** window:\n\n    1.  Click **Add**.\n\n    2.  For **Value Name**, type the domain name (for example, server1.contoso.com).\n\n    3.  For **Value**, type the AGPM Server name and port to use for this domain (for example, server2.contoso.com:4600), and then click **OK**. (By default, the AGPM Service listens on port 4600. To use a different port, see [Modify the Port on Which the AGPM Service Listens](modify-the-port-on-which-the-agpm-service-listens.md).)\n\n    4.  Repeat for each domain not using the default AGPM Server.\n\n7.  Click **OK** to close the **Show Contents** and **AGPM Server Properties** windows.\n\n8.  Close the **Group Policy Object Editor**. (For more information, see [Deploy a GPO](deploy-a-gpo.md).) When Group Policy is updated, the new AGPM Server connections are configured for all Group Policy administrators.\n\n### <a href=\"\" id=\"bkmk-manuallyconfigurearchiveloc\"></a>\n\nIf you have centrally configured the AGPM Server connection, the option to manually it is unavailable for all Group Policy administrators.\n\n**To manually configure the AGPM Server to display for your account**\n\n1.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n2.  In the details pane, click the **AGPM Server** tab.\n\n3.  Enter the fully-qualified computer name for the AGPM Server that manages the archive used for this domain (for example, server.contoso.com) and the port on which the AGPM Service listens (by default, port 4600).\n\n4.  Click **Apply**, then click **Yes** to confirm.\n\n### Additional considerations\n\n-   You must be able to edit and deploy a GPO to perform the procedures for centrally configuring AGPM Server connections for all Group Policy administrators. See [Editing a GPO](editing-a-gpo.md) and [Deploy a GPO](deploy-a-gpo.md) for additional detail.\n\n-   The AGPM Server selected determines which GPOs are displayed on the **Contents** tab and to what location the **Domain Delegation** tab settings are applied. If not centrally managed through the Administrative Template, each Group Policy administrator must configure this setting to point to the AGPM Server for the domain.\n\n-   Membership in the Group Policy Creator Owners group should be restricted so that it is not used to circumvent the management of access to GPOs by AGPM. (In the **Group Policy Management Console**, click **Group Policy Objects** in the forest and domain in which you want to manage GPOs, click **Delegation**, and then configure the settings to meet the needs of your organization.)\n\n### Additional references\n\n-   [Performing AGPM Administrator Tasks](performing-agpm-administrator-tasks.md)\n\n \n\n \n\n\n\n\n\n"}