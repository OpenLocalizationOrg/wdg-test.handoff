{"nodes":[{"content":"4930(S, F) An Active Directory replica source naming context was modified.","pos":[11,85]},{"content":"(Windows 10)","pos":[86,98]},{"content":"Describes security event 4930(S, F) An Active Directory replica source naming context was modified.","pos":[112,211]},{"content":"4930(S, F): An Active Directory replica source naming context was modified.","pos":[311,386]},{"content":"Applies to","pos":[390,400]},{"content":"Windows 10","pos":[407,417]},{"content":"Windows Server 2016","pos":[422,441]},{"pos":[561,680],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit Detailed Directory Service Replication<ept id=\"p2\">](audit-detailed-directory-service-replication.md)</ept>"},{"content":"Event Description:","pos":[685,703]},{"content":"This event generates every time Active Directory replica source naming context was modified.","pos":[708,800]},{"pos":[802,868],"content":"Failure event generates if an error occurs (<bpt id=\"p1\">**</bpt>Status Code<ept id=\"p1\">**</ept> != 0)."},{"content":"It is not possible to understand what exactly was modified from this event.","pos":[870,945]},{"pos":[949,1085],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For recommendations, see <bpt id=\"p2\">[</bpt>Security Monitoring Recommendations<ept id=\"p2\">](#security-monitoring-recommendations)</ept> for this event."},{"content":"Event XML:","pos":[1108,1118]},{"pos":[2188,2252],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> Active Directory domain controller."},{"pos":[2254,2300],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008."},{"pos":[2302,2326],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Field Descriptions:","pos":[2331,2350]},{"pos":[2359,2464],"content":"<bpt id=\"p1\">**</bpt>Destination DRA<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: destination directory replication agent distinguished name."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The <bpt id=\"p2\">**</bpt>Directory Replication Agent (DRA)<ept id=\"p2\">**</ept> handles replication between domain controllers.","pos":[2468,2577]},{"content":"The Directory Replication Agent uses the connection objects in the topology map to find out those partners that are relevant when replicating changes to directory partitions.","pos":[2578,2752]},{"content":"The DRA sends a replication request to the partners of a domain controller when the domain controller needs to update its copy of Active Directory.","pos":[2753,2900]},{"content":"<bpt id=\"p1\">**</bpt>Source DRA<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: source directory replication agent distinguished name.","pos":[2906,3001]},{"content":"Typically equals “<bpt id=\"p1\">**</bpt><ph id=\"ph1\">-</ph><ept id=\"p1\">**</ept>“ for this event.","pos":[3002,3042]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The LDAP API references an LDAP object by its <bpt id=\"p2\">**</bpt>distinguished name (DN)<ept id=\"p2\">**</ept>.","pos":[3046,3140]},{"content":"A DN is a sequence of relative distinguished names (RDN) connected by commas.","pos":[3141,3218]},{"content":"An RDN is an attribute with an associated value in the form attribute=value; .","pos":[3222,3300]},{"content":"These are examples of RDNs attributes:","pos":[3301,3339]},{"content":"• DC - domainComponent","pos":[3343,3365]},{"content":"• CN - commonName","pos":[3369,3386]},{"content":"• OU - organizationalUnitName","pos":[3390,3419]},{"content":"• O - organizationName","pos":[3423,3445]},{"pos":[3451,3568],"content":"<bpt id=\"p1\">**</bpt>Source Address<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: DNS record of computer from which the modification request was received."},{"pos":[3574,3657],"content":"<bpt id=\"p1\">**</bpt>Naming Context<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> naming context which was modified."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The Directory Tree of Active Directory tree is partitioned to allow sections to be distributed (replicated) to domain controllers in different domains within the forest.","pos":[3661,3850]},{"content":"Each domain controller stores a copy of a specific part of the directory tree, called a <bpt id=\"p1\">**</bpt>Naming Context<ept id=\"p1\">**</ept> also known as Directory Partition.","pos":[3851,3992]},{"content":"<bpt id=\"p1\">**</bpt>Naming Context<ept id=\"p1\">**</ept> is replicated as a unit to other domain controllers in the forest that contain a replica of the same sub tree.","pos":[3993,4122]},{"content":"A <bpt id=\"p1\">**</bpt>Naming Context<ept id=\"p1\">**</ept> is also called a Directory Partition.","pos":[4123,4181]},{"pos":[4187,4305],"content":"<bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UInt32<ph id=\"ph2\">\\]</ph>: decimal value of <bpt id=\"p2\">[</bpt>DRS Options<ept id=\"p2\">](https://msdn.microsoft.com/en-us/library/cc228477.aspx)</ept>."},{"content":"<bpt id=\"p1\">**</bpt>Status Code<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UInt32<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> if there are no issues or errors, the status code will be 0.","pos":[4311,4410]},{"content":"If an error happened, you will receive Failure event and Status Code will not be equal to “<bpt id=\"p1\">**</bpt>0<ept id=\"p1\">**</ept>”.","pos":[4411,4509]},{"content":"You can check error code meaning here: <bpt id=\"p1\">&lt;</bpt>https://msdn.microsoft.com/en-us/library/windows/desktop/ms681381(v=vs.85).aspx<ept id=\"p1\">&gt;</ept>","pos":[4510,4630]},{"content":"Security Monitoring Recommendations","pos":[4635,4670]},{"content":"For 4930(S, F): An Active Directory replica source naming context was modified.","pos":[4672,4751]},{"content":"Monitor for <bpt id=\"p1\">**</bpt>Source Address<ept id=\"p1\">**</ept> field, because the source of the request must be authorized for this action.","pos":[4757,4864]},{"content":"If you find any unauthorized DRA you should trigger an event.","pos":[4865,4926]},{"content":"This event is typically used for Active Directory replication troubleshooting.","pos":[4932,5010]}],"content":"---\ntitle: 4930(S, F) An Active Directory replica source naming context was modified. (Windows 10)\ndescription: Describes security event 4930(S, F) An Active Directory replica source naming context was modified.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 4930(S, F): An Active Directory replica source naming context was modified.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\n<img src=\"images/event-4930.png\" alt=\"Event 4930 illustration\" width=\"448\" height=\"333\" hspace=\"10\" align=\"left\" />\n\n***Subcategory:***&nbsp;[Audit Detailed Directory Service Replication](audit-detailed-directory-service-replication.md)\n\n***Event Description:***\n\nThis event generates every time Active Directory replica source naming context was modified.\n\nFailure event generates if an error occurs (**Status Code** != 0).\n\nIt is not possible to understand what exactly was modified from this event.\n\n> **Note**&nbsp;&nbsp;For recommendations, see [Security Monitoring Recommendations](#security-monitoring-recommendations) for this event.\n\n<br clear=\"all\">\n\n***Event XML:***\n```\n- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n- <System>\n <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> \n <EventID>4930</EventID> \n <Version>0</Version> \n <Level>0</Level> \n <Task>14083</Task> \n <Opcode>0</Opcode> \n <Keywords>0x8020000000000000</Keywords> \n <TimeCreated SystemTime=\"2015-08-27T18:56:51.474057400Z\" /> \n <EventRecordID>1564</EventRecordID> \n <Correlation /> \n <Execution ProcessID=\"504\" ThreadID=\"1280\" /> \n <Channel>Security</Channel> \n <Computer>Win2012r2.corp.contoso.local</Computer> \n <Security /> \n </System>\n- <EventData>\n <Data Name=\"DestinationDRA\">CN=NTDS Settings,CN=WIN2012R2,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=contoso,DC=local</Data> \n <Data Name=\"SourceDRA\">-</Data> \n <Data Name=\"SourceAddr\">edf0bef9-1f73-4df3-8991-f6ec2d4ef3ae</Data> \n <Data Name=\"NamingContext\">CN=Schema,CN=Configuration,DC=contoso,DC=local</Data> \n <Data Name=\"Options\">0</Data> \n <Data Name=\"StatusCode\">0</Data> \n </EventData>\n </Event>\n\n```\n\n***Required Server Roles:*** Active Directory domain controller.\n\n***Minimum OS Version:*** Windows Server 2008.\n\n***Event Versions:*** 0.\n\n***Field Descriptions:***\n\n-   **Destination DRA** \\[Type = UnicodeString\\]: destination directory replication agent distinguished name.\n\n> **Note**&nbsp;&nbsp;The **Directory Replication Agent (DRA)** handles replication between domain controllers. The Directory Replication Agent uses the connection objects in the topology map to find out those partners that are relevant when replicating changes to directory partitions. The DRA sends a replication request to the partners of a domain controller when the domain controller needs to update its copy of Active Directory.\n\n-   **Source DRA** \\[Type = UnicodeString\\]: source directory replication agent distinguished name. Typically equals “**-**“ for this event.\n\n> **Note**&nbsp;&nbsp;The LDAP API references an LDAP object by its **distinguished name (DN)**. A DN is a sequence of relative distinguished names (RDN) connected by commas.\n\n> An RDN is an attribute with an associated value in the form attribute=value; . These are examples of RDNs attributes:\n\n> • DC - domainComponent\n\n> • CN - commonName\n\n> • OU - organizationalUnitName\n\n> • O - organizationName\n\n-   **Source Address** \\[Type = UnicodeString\\]: DNS record of computer from which the modification request was received.\n\n-   **Naming Context** \\[Type = UnicodeString\\]**:** naming context which was modified.\n\n> **Note**&nbsp;&nbsp;The Directory Tree of Active Directory tree is partitioned to allow sections to be distributed (replicated) to domain controllers in different domains within the forest. Each domain controller stores a copy of a specific part of the directory tree, called a **Naming Context** also known as Directory Partition. **Naming Context** is replicated as a unit to other domain controllers in the forest that contain a replica of the same sub tree. A **Naming Context** is also called a Directory Partition.\n\n-   **Options** \\[Type = UInt32\\]: decimal value of [DRS Options](https://msdn.microsoft.com/en-us/library/cc228477.aspx).\n\n-   **Status Code** \\[Type = UInt32\\]**:** if there are no issues or errors, the status code will be 0. If an error happened, you will receive Failure event and Status Code will not be equal to “**0**”. You can check error code meaning here: <https://msdn.microsoft.com/en-us/library/windows/desktop/ms681381(v=vs.85).aspx>\n\n## Security Monitoring Recommendations\n\nFor 4930(S, F): An Active Directory replica source naming context was modified.\n\n-   Monitor for **Source Address** field, because the source of the request must be authorized for this action. If you find any unauthorized DRA you should trigger an event.\n\n-   This event is typically used for Active Directory replication troubleshooting.\n\n"}