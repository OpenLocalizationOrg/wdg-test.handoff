{"nodes":[{"content":"Manage TPM lockout (Windows 10)","pos":[11,42]},{"content":"This topic for the IT professional describes how to manage the lockout feature for the Trusted Platform Module (TPM) in Windows.","pos":[56,184]},{"content":"Manage TPM lockout","pos":[339,357]},{"content":"Applies to","pos":[361,371]},{"content":"Windows 10","pos":[378,388]},{"content":"This topic for the IT professional describes how to manage the lockout feature for the Trusted Platform Module (TPM) in Windows.","pos":[390,518]},{"pos":[557,574],"content":"About TPM lockout"},{"content":"The TPM will lock itself to prevent tampering or malicious attacks.","pos":[576,643]},{"content":"TPM lockout often lasts for a variable amount of time or until the computer is turned off.","pos":[644,734]},{"content":"While the TPM is in lockout mode, it generally returns an error message when it receives commands that require an authorization value.","pos":[735,869]},{"content":"One exception is that the TPM always allows the owner at least one attempt to reset the TPM lockout when it is in lockout mode.","pos":[870,997]},{"content":"TPM ownership is commonly taken the first time BitLocker Drive Encryption is turned on for the computer.","pos":[999,1103]},{"content":"In this case, the TPM owner authorization password is saved with the BitLocker recovery key.","pos":[1104,1196]},{"content":"When the BitLocker recovery key is saved to a file, BitLocker also saves a TPM owner password file (.tpm) with the TPM owner password hash value.","pos":[1197,1342]},{"content":"When the BitLocker recovery key is printed, the TPM owner password is printed at the same time.","pos":[1343,1438]},{"content":"You can also save your TPM owner password hash value to Active Directory Domain Services (AD DS) if your organization's Group Policy settings are configured to do so.","pos":[1439,1605]},{"content":"In some cases, encryption keys are protected by a TPM by requiring a valid authorization value to access the key.","pos":[1607,1720]},{"content":"A common example is configuring BitLocker Drive Encryption to use the TPM plus PIN key protector.","pos":[1721,1818]},{"content":"In this scenario, the user must type the correct PIN during the boot process to access the volume encryption key protected by the TPM.","pos":[1819,1953]},{"content":"To prevent malicious users or software from discovering authorization values, TPMs implement protection logic.","pos":[1954,2064]},{"content":"The protection logic is designed to slow or stop responses from the TPM if it detects that an entity might be trying to guess authorization values.","pos":[2065,2212]},{"content":"The industry standards from the Trusted Computing Group (TCG) specify that TPM manufacturers must implement some form of protection logic in TPM 1.2 and TPM 2.0 chips.","pos":[2214,2381]},{"content":"TPM manufacturers implement different protection mechanisms and behavior.","pos":[2382,2455]},{"content":"The general guidance is for the TPM chip to take exponentially longer to respond if incorrect authorization values are sent to the TPM.","pos":[2456,2591]},{"content":"Some TPM chips may not store failed attempts over time.","pos":[2592,2647]},{"content":"Other TPM chips may store every failed attempt indefinitely.","pos":[2648,2708]},{"content":"Therefore, some users may experience increasingly longer delays when they mistype an authorization value that is sent to the TPM.","pos":[2709,2838]},{"content":"This can prevent them from using the TPM for a period of time.","pos":[2839,2901]},{"content":"If your TPM has entered lockout mode or is responding slowly to commands, you can reset the lockout value by using the following procedures.","pos":[2903,3043]},{"content":"Resetting the TPM lockout requires the TPM ownerâ€™s authorization.","pos":[3044,3109]},{"content":"Reset the TPM lockout by using the TPM MMC","pos":[3114,3156]},{"content":"The following procedure explains the steps to reset the TPM lockout by using the TPM MMC.","pos":[3158,3247]},{"content":"To reset the TPM lockout","pos":[3251,3275]},{"content":"Open the TPM MMC (tpm.msc).","pos":[3283,3310]},{"pos":[3315,3405],"content":"In the <bpt id=\"p1\">**</bpt>Action<ept id=\"p1\">**</ept> pane, click <bpt id=\"p2\">**</bpt>Reset TPM Lockout<ept id=\"p2\">**</ept> to start the Reset TPM Lockout Wizard."},{"content":"Choose one of the following methods to enter the TPM owner password:","pos":[3410,3478]},{"pos":[3487,3671],"content":"If you saved your TPM owner password to a .tpm file, click <bpt id=\"p1\">**</bpt>I have the owner password file<ept id=\"p1\">**</ept>, and then type the path to the file, or click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> to navigate to the file location."},{"pos":[3680,3833],"content":"If you want to manually enter your TPM owner password, click <bpt id=\"p1\">**</bpt>I want to enter the owner password<ept id=\"p1\">**</ept>, and then type the password in the text box provided."},{"pos":[3844,4039],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  If you enabled BitLocker and your TPM at the same time, and you printed your BitLocker recovery password when you turned on BitLocker, your TPM owner password may have printed with it."},{"content":"Use Group Policy to manage TPM lockout settings","pos":[4053,4100]},{"content":"The TPM Group Policy settings in the following list are located at:","pos":[4102,4169]},{"content":"Computer Configuration<ph id=\"ph1\">\\\\</ph>Administrative Templates<ph id=\"ph2\">\\\\</ph>System<ph id=\"ph3\">\\\\</ph>Trusted Platform Module Services","pos":[4173,4263]},{"content":"Standard User Lockout Duration","pos":[4274,4304]},{"content":"This policy setting allows you to manage the duration in minutes for counting standard user authorization failures for TPM commands that require authorization.","pos":[4386,4545]},{"content":"An authorization failure occurs each time a user sends a command to the TPM and receives an error message that indicates an authorization failure occurred.","pos":[4546,4701]},{"content":"Authorization failures that are older than the duration you set are ignored.","pos":[4702,4778]},{"content":"If the number of TPM commands with an authorization failure within the lockout duration equals a threshold, the user is prevented from sending commands to the TPM that require authorization.","pos":[4779,4969]},{"content":"Standard User Individual Lockout Threshold","pos":[4976,5018]},{"content":"This policy setting allows you to manage the maximum number of authorization failures for the TPM for each user.","pos":[5100,5212]},{"content":"This value is the maximum number of authorization failures that each user can have before the user is not allowed to send commands to the TPM that require authorization.","pos":[5213,5382]},{"content":"If the number of authorization failures equals the duration that is set for the policy setting, the user is prevented from sending commands to the TPM that require authorization.","pos":[5383,5561]},{"content":"Standard User Total Lockout Threshold","pos":[5568,5605]},{"content":"This policy setting allows you to manage the maximum number of authorization failures for the TPM for all standard users.","pos":[5686,5807]},{"content":"If the total number of authorization failures for all users equals the duration that is set for the policy, all users are prevented from sending commands to the TPM that require authorization.","pos":[5808,6000]},{"pos":[6002,6150],"content":"For information about mitigating dictionary attacks that use the lockout settings, see <bpt id=\"p1\">[</bpt>TPM fundamentals<ept id=\"p1\">](tpm-fundamentals.md#bkmk-howtpmmitigates)</ept>."},{"pos":[6191,6210],"content":"Use the TPM cmdlets"},{"content":"If you are using Windows PowerShell to manage your computers, you can also manage the TPM by using Windows PowerShell.","pos":[6212,6330]},{"content":"To install the TPM cmdlets, type the following command:","pos":[6331,6386]},{"content":"dism /online /enable-feature /FeatureName:tpm-psh-cmdlets","pos":[6390,6447]},{"pos":[6451,6585],"content":"For details about the individual cmdlets, see <bpt id=\"p1\">[</bpt>TPM Cmdlets in Windows PowerShell<ept id=\"p1\">](http://technet.microsoft.com/library/jj603116.aspx)</ept>."},{"content":"Additional resources","pos":[6590,6610]},{"pos":[6612,6729],"content":"For more info about TPM, see <bpt id=\"p1\">[</bpt>TPM technology overview<ept id=\"p1\">](trusted-platform-module-overview.md#bkmk-additionalresources)</ept>."}],"content":"---\ntitle: Manage TPM lockout (Windows 10)\ndescription: This topic for the IT professional describes how to manage the lockout feature for the Trusted Platform Module (TPM) in Windows.\nms.assetid: bf27adbe-404c-4691-a644-29ec722a3f7b\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n# Manage TPM lockout\n\n**Applies to**\n-   Windows 10\n\nThis topic for the IT professional describes how to manage the lockout feature for the Trusted Platform Module (TPM) in Windows.\n\n## <a href=\"\" id=\"bkmk-lockout1\"></a>About TPM lockout\n\nThe TPM will lock itself to prevent tampering or malicious attacks. TPM lockout often lasts for a variable amount of time or until the computer is turned off. While the TPM is in lockout mode, it generally returns an error message when it receives commands that require an authorization value. One exception is that the TPM always allows the owner at least one attempt to reset the TPM lockout when it is in lockout mode.\n\nTPM ownership is commonly taken the first time BitLocker Drive Encryption is turned on for the computer. In this case, the TPM owner authorization password is saved with the BitLocker recovery key. When the BitLocker recovery key is saved to a file, BitLocker also saves a TPM owner password file (.tpm) with the TPM owner password hash value. When the BitLocker recovery key is printed, the TPM owner password is printed at the same time. You can also save your TPM owner password hash value to Active Directory Domain Services (AD DS) if your organization's Group Policy settings are configured to do so.\n\nIn some cases, encryption keys are protected by a TPM by requiring a valid authorization value to access the key. A common example is configuring BitLocker Drive Encryption to use the TPM plus PIN key protector. In this scenario, the user must type the correct PIN during the boot process to access the volume encryption key protected by the TPM. To prevent malicious users or software from discovering authorization values, TPMs implement protection logic. The protection logic is designed to slow or stop responses from the TPM if it detects that an entity might be trying to guess authorization values.\n\nThe industry standards from the Trusted Computing Group (TCG) specify that TPM manufacturers must implement some form of protection logic in TPM 1.2 and TPM 2.0 chips. TPM manufacturers implement different protection mechanisms and behavior. The general guidance is for the TPM chip to take exponentially longer to respond if incorrect authorization values are sent to the TPM. Some TPM chips may not store failed attempts over time. Other TPM chips may store every failed attempt indefinitely. Therefore, some users may experience increasingly longer delays when they mistype an authorization value that is sent to the TPM. This can prevent them from using the TPM for a period of time.\n\nIf your TPM has entered lockout mode or is responding slowly to commands, you can reset the lockout value by using the following procedures. Resetting the TPM lockout requires the TPM ownerâ€™s authorization.\n\n## Reset the TPM lockout by using the TPM MMC\n\nThe following procedure explains the steps to reset the TPM lockout by using the TPM MMC.\n\n**To reset the TPM lockout**\n\n1.  Open the TPM MMC (tpm.msc).\n2.  In the **Action** pane, click **Reset TPM Lockout** to start the Reset TPM Lockout Wizard.\n3.  Choose one of the following methods to enter the TPM owner password:\n    -   If you saved your TPM owner password to a .tpm file, click **I have the owner password file**, and then type the path to the file, or click **Browse** to navigate to the file location.\n    -   If you want to manually enter your TPM owner password, click **I want to enter the owner password**, and then type the password in the text box provided.\n\n        >**Note:**  If you enabled BitLocker and your TPM at the same time, and you printed your BitLocker recovery password when you turned on BitLocker, your TPM owner password may have printed with it.\n         \n## Use Group Policy to manage TPM lockout settings\n\nThe TPM Group Policy settings in the following list are located at:\n\n**Computer Configuration\\\\Administrative Templates\\\\System\\\\Trusted Platform Module Services\\\\**\n\n-   [Standard User Lockout Duration](trusted-platform-module-services-group-policy-settings.md#bkmk-individual)\n\n    This policy setting allows you to manage the duration in minutes for counting standard user authorization failures for TPM commands that require authorization. An authorization failure occurs each time a user sends a command to the TPM and receives an error message that indicates an authorization failure occurred. Authorization failures that are older than the duration you set are ignored. If the number of TPM commands with an authorization failure within the lockout duration equals a threshold, the user is prevented from sending commands to the TPM that require authorization.\n\n-   [Standard User Individual Lockout Threshold](trusted-platform-module-services-group-policy-settings.md#bkmk-tpmgp-suld)\n\n    This policy setting allows you to manage the maximum number of authorization failures for the TPM for each user. This value is the maximum number of authorization failures that each user can have before the user is not allowed to send commands to the TPM that require authorization. If the number of authorization failures equals the duration that is set for the policy setting, the user is prevented from sending commands to the TPM that require authorization.\n\n-   [Standard User Total Lockout Threshold](trusted-platform-module-services-group-policy-settings.md#bkmk-total)\n    \n    This policy setting allows you to manage the maximum number of authorization failures for the TPM for all standard users. If the total number of authorization failures for all users equals the duration that is set for the policy, all users are prevented from sending commands to the TPM that require authorization.\n\nFor information about mitigating dictionary attacks that use the lockout settings, see [TPM fundamentals](tpm-fundamentals.md#bkmk-howtpmmitigates).\n\n## <a href=\"\" id=\"bkmk-tpmcmdlets\"></a>Use the TPM cmdlets\n\nIf you are using Windows PowerShell to manage your computers, you can also manage the TPM by using Windows PowerShell. To install the TPM cmdlets, type the following command:\n\n**dism /online /enable-feature /FeatureName:tpm-psh-cmdlets**\n\nFor details about the individual cmdlets, see [TPM Cmdlets in Windows PowerShell](http://technet.microsoft.com/library/jj603116.aspx).\n\n## Additional resources\n\nFor more info about TPM, see [TPM technology overview](trusted-platform-module-overview.md#bkmk-additionalresources)."}