{"nodes":[{"content":"Network security Restrict NTLM Audit incoming NTLM traffic (Windows 10)","pos":[11,82]},{"content":"Describes the best practices, location, values, management aspects, and security considerations for the Network Security Restrict NTLM Audit incoming NTLM traffic security policy setting.","pos":[96,283]},{"content":"Network security: Restrict NTLM: Audit incoming NTLM traffic","pos":[439,499]},{"content":"Applies to","pos":[503,513]},{"content":"Windows 10","pos":[520,530]},{"pos":[532,725],"content":"Describes the best practices, location, values, management aspects, and security considerations for the <bpt id=\"p1\">**</bpt>Network Security: Restrict NTLM: Audit incoming NTLM traffic<ept id=\"p1\">**</ept> security policy setting."},{"content":"Reference","pos":[730,739]},{"pos":[741,867],"content":"The <bpt id=\"p1\">**</bpt>Network Security: Restrict NTLM: Audit incoming NTLM traffic<ept id=\"p1\">**</ept> policy setting allows you to audit incoming NTLM traffic."},{"content":"When this audit policy is enabled within Group Policy, it is enforced on any server where that Group Policy is distributed.","pos":[869,992]},{"content":"The events will be recorded in the operational event log located in <bpt id=\"p1\">**</bpt>Applications and Services Log<ph id=\"ph1\">\\\\</ph>Microsoft<ph id=\"ph2\">\\\\</ph>Windows<ph id=\"ph3\">\\\\</ph>NTLM<ept id=\"p1\">**</ept>.","pos":[993,1121]},{"content":"Using an audit event collection system can help you collect the events for analysis more efficiently.","pos":[1122,1223]},{"content":"When you enable this policy on a server, only authentication traffic to that server will be logged.","pos":[1225,1324]},{"content":"When you enable this audit policy, it functions in the same way as the <bpt id=\"p1\">[</bpt>Network Security: Restrict NTLM: Incoming NTLM traffic<ept id=\"p1\">](network-security-restrict-ntlm-incoming-ntlm-traffic.md)</ept> policy, but it does not actually block any traffic.","pos":[1326,1562]},{"content":"Therefore, you can use it effectively to understand the authentication traffic in your environment, and when you are ready to block that traffic, you can enable the Network Security: Restrict NTLM: Incoming NTLM traffic policy setting and select <bpt id=\"p1\">**</bpt>Deny all accounts<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Deny all domain accounts<ept id=\"p2\">**</ept>.","pos":[1563,1864]},{"content":"Possible values","pos":[1870,1885]},{"content":"Disable","pos":[1891,1898]},{"content":"The server on which this policy is set will not log events for incoming NTLM traffic.","pos":[1904,1989]},{"content":"Enable auditing for domain accounts","pos":[1995,2030]},{"pos":[2036,2368],"content":"The server on which this policy is set will log events for NTLM pass-through authentication requests only for accounts in the domain that would be blocked when the <bpt id=\"p1\">[</bpt>Network Security: Restrict NTLM: Incoming NTLM traffic<ept id=\"p1\">](network-security-restrict-ntlm-incoming-ntlm-traffic.md)</ept> policy setting is set to <bpt id=\"p2\">**</bpt>Deny all domain accounts<ept id=\"p2\">**</ept>."},{"content":"Enable auditing for all accounts","pos":[2374,2406]},{"pos":[2412,2696],"content":"The server on which this policy is set will log events for all NTLM authentication requests that would be blocked when the <bpt id=\"p1\">[</bpt>Network Security: Restrict NTLM: Incoming NTLM traffic<ept id=\"p1\">](network-security-restrict-ntlm-incoming-ntlm-traffic.md)</ept> policy setting is set to <bpt id=\"p2\">**</bpt>Deny all accounts<ept id=\"p2\">**</ept>."},{"content":"Not defined","pos":[2702,2713]},{"pos":[2719,2798],"content":"This is the same as <bpt id=\"p1\">**</bpt>Disable<ept id=\"p1\">**</ept>, and it results in no auditing of NTLM traffic."},{"content":"Best practices","pos":[2804,2818]},{"content":"Depending on your environment and the duration of your testing, monitor the log size regularly.","pos":[2820,2915]},{"content":"Location","pos":[2921,2929]},{"content":"Computer Configuration<ph id=\"ph1\">\\\\</ph>Windows Settings<ph id=\"ph2\">\\\\</ph>Security Settings<ph id=\"ph3\">\\\\</ph>Local Policies<ph id=\"ph4\">\\\\</ph>Security Options","pos":[2931,3024]},{"content":"Default values","pos":[3030,3044]},{"content":"Server type or GPO","pos":[3048,3066]},{"content":"Default value","pos":[3069,3082]},{"content":"Default domain policy","pos":[3097,3118]},{"content":"Not defined","pos":[3120,3131]},{"content":"Default domain controller policy","pos":[3136,3168]},{"content":"Not defined","pos":[3171,3182]},{"content":"Stand-alone server default settings","pos":[3187,3222]},{"content":"Not defined","pos":[3225,3236]},{"content":"Domain controller effective default settings","pos":[3241,3285]},{"content":"Not defined","pos":[3288,3299]},{"content":"Member server effective default settings","pos":[3304,3344]},{"content":"Not defined","pos":[3347,3358]},{"content":"Client computer effective default settings","pos":[3363,3405]},{"content":"Not defined","pos":[3408,3419]},{"content":"Policy management","pos":[3427,3444]},{"content":"This section describes different features and tools available to help you manage this policy.","pos":[3446,3539]},{"content":"Restart requirement","pos":[3545,3564]},{"content":"None.","pos":[3566,3571]},{"content":"Changes to this policy become effective without a restart when saved locally or distributed through Group Policy.","pos":[3572,3685]},{"content":"Group Policy","pos":[3691,3703]},{"content":"Setting and deploying this policy using Group Policy takes precedence over the setting on the local device.","pos":[3705,3812]},{"content":"If the Group Policy is set to <bpt id=\"p1\">**</bpt>Not Configured<ept id=\"p1\">**</ept>, local settings will apply.","pos":[3813,3889]},{"content":"Auditing","pos":[3895,3903]},{"content":"View the operational event log to see if this policy is functioning as intended.","pos":[3905,3985]},{"content":"Audit and block events are recorded on this computer in the operational event log located in <bpt id=\"p1\">**</bpt>Applications and Services Log<ph id=\"ph1\">\\\\</ph>Microsoft<ph id=\"ph2\">\\\\</ph>Windows<ph id=\"ph3\">\\\\</ph>NTLM<ept id=\"p1\">**</ept>.","pos":[3986,4139]},{"content":"Using an audit event collection system can help you collect the events for analysis more efficiently.","pos":[4140,4241]},{"content":"There are no security audit event policies that can be configured to view output from this policy.","pos":[4243,4341]},{"content":"Security considerations","pos":[4346,4369]},{"content":"This section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.","pos":[4371,4565]},{"content":"NTLM and NTLMv2 authentication is vulnerable to a variety of malicious attacks, including SMB relay, man-in-the-middle attacks, and brute force attacks.","pos":[4567,4719]},{"content":"Reducing and eliminating NTLM authentication from your environment forces the Windows operating system to use more secure protocols, such as the Kerberos version 5 protocol, or different authentication mechanisms, such as smart cards.","pos":[4720,4954]},{"content":"Vulnerability","pos":[4960,4973]},{"content":"Enabling this policy setting will reveal through logging which servers and client computers within your network or domain handle NTLM traffic.","pos":[4975,5117]},{"content":"The identity of these devices can be used in malicious ways if NTLM authentication traffic is compromised.","pos":[5118,5224]},{"content":"The policy setting does not prevent or mitigate any vulnerability because it is for audit purposes only.","pos":[5225,5329]},{"content":"Countermeasure","pos":[5335,5349]},{"content":"Restrict access to the log files when this policy setting is enabled in your production environment.","pos":[5351,5451]},{"content":"Potential impact","pos":[5457,5473]},{"content":"If you do not enable or configure this policy setting, no NTLM authentication traffic information will be logged.","pos":[5475,5588]},{"content":"If you do enable this policy setting, only auditing functions will occur; no security enhancements will be implemented.","pos":[5589,5708]},{"content":"Related topics","pos":[5713,5727]},{"content":"Security Options","pos":[5732,5748]}],"content":"---\ntitle: Network security Restrict NTLM Audit incoming NTLM traffic (Windows 10)\ndescription: Describes the best practices, location, values, management aspects, and security considerations for the Network Security Restrict NTLM Audit incoming NTLM traffic security policy setting.\nms.assetid: 37e380c2-22e1-44cd-9993-e12815b845cf\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Network security: Restrict NTLM: Audit incoming NTLM traffic\n\n**Applies to**\n-   Windows 10\n\nDescribes the best practices, location, values, management aspects, and security considerations for the **Network Security: Restrict NTLM: Audit incoming NTLM traffic** security policy setting.\n\n## Reference\n\nThe **Network Security: Restrict NTLM: Audit incoming NTLM traffic** policy setting allows you to audit incoming NTLM traffic.\n\nWhen this audit policy is enabled within Group Policy, it is enforced on any server where that Group Policy is distributed. The events will be recorded in the operational event log located in **Applications and Services Log\\\\Microsoft\\\\Windows\\\\NTLM**. Using an audit event collection system can help you collect the events for analysis more efficiently.\n\nWhen you enable this policy on a server, only authentication traffic to that server will be logged.\n\nWhen you enable this audit policy, it functions in the same way as the [Network Security: Restrict NTLM: Incoming NTLM traffic](network-security-restrict-ntlm-incoming-ntlm-traffic.md) policy, but it does not actually block any traffic. Therefore, you can use it effectively to understand the \nauthentication traffic in your environment, and when you are ready to block that traffic, you can enable the Network Security: Restrict NTLM: Incoming NTLM traffic policy setting and select **Deny all accounts** or **Deny all domain accounts**.\n\n### Possible values\n\n-   Disable\n\n    The server on which this policy is set will not log events for incoming NTLM traffic.\n\n-   Enable auditing for domain accounts\n\n    The server on which this policy is set will log events for NTLM pass-through authentication requests only for accounts in the domain that would be blocked when the [Network Security: Restrict NTLM: Incoming NTLM traffic](network-security-restrict-ntlm-incoming-ntlm-traffic.md) policy setting is set to **Deny all domain accounts**.\n\n-   Enable auditing for all accounts\n\n    The server on which this policy is set will log events for all NTLM authentication requests that would be blocked when the [Network Security: Restrict NTLM: Incoming NTLM traffic](network-security-restrict-ntlm-incoming-ntlm-traffic.md) policy setting is set to **Deny all accounts**.\n\n-   Not defined\n\n    This is the same as **Disable**, and it results in no auditing of NTLM traffic.\n\n### Best practices\n\nDepending on your environment and the duration of your testing, monitor the log size regularly.\n\n### Location\n\nComputer Configuration\\\\Windows Settings\\\\Security Settings\\\\Local Policies\\\\Security Options\n\n### Default values\n\n| Server type or GPO | Default value |\n| - | - |\n| Default domain policy| Not defined| \n| Default domain controller policy | Not defined| \n| Stand-alone server default settings | Not defined| \n| Domain controller effective default settings | Not defined| \n| Member server effective default settings | Not defined| \n| Client computer effective default settings | Not defined| \n \n## Policy management\n\nThis section describes different features and tools available to help you manage this policy.\n\n### Restart requirement\n\nNone. Changes to this policy become effective without a restart when saved locally or distributed through Group Policy.\n\n### Group Policy\n\nSetting and deploying this policy using Group Policy takes precedence over the setting on the local device. If the Group Policy is set to **Not Configured**, local settings will apply.\n\n### Auditing\n\nView the operational event log to see if this policy is functioning as intended. Audit and block events are recorded on this computer in the operational event log located in **Applications and Services Log\\\\Microsoft\\\\Windows\\\\NTLM**. Using an audit event collection system can help you collect the events for analysis more efficiently.\n\nThere are no security audit event policies that can be configured to view output from this policy.\n\n## Security considerations\n\nThis section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.\n\nNTLM and NTLMv2 authentication is vulnerable to a variety of malicious attacks, including SMB relay, man-in-the-middle attacks, and brute force attacks. Reducing and eliminating NTLM authentication from your environment forces the Windows operating system to use more secure protocols, such as the Kerberos version 5 protocol, or different authentication mechanisms, such as smart cards.\n\n### Vulnerability\n\nEnabling this policy setting will reveal through logging which servers and client computers within your network or domain handle NTLM traffic. The identity of these devices can be used in malicious ways if NTLM authentication traffic is compromised. The policy setting does not prevent or mitigate any vulnerability because it is for audit purposes only.\n\n### Countermeasure\n\nRestrict access to the log files when this policy setting is enabled in your production environment.\n\n### Potential impact\n\nIf you do not enable or configure this policy setting, no NTLM authentication traffic information will be logged. If you do enable this policy setting, only auditing functions will occur; no security enhancements will be implemented.\n\n## Related topics\n\n- [Security Options](security-options.md)\n"}