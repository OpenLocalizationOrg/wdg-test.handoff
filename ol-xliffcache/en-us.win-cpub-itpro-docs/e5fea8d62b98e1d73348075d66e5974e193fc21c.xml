{"nodes":[{"content":"Plan for AppLocker policy management (Windows 10)","pos":[11,60]},{"content":"This topic for describes the decisions you need to make to establish the processes for managing and maintaining AppLocker policies.","pos":[74,205]},{"content":"Plan for AppLocker policy management","pos":[361,397]},{"content":"Applies to","pos":[401,411]},{"content":"Windows 10","pos":[418,428]},{"content":"This topic for describes the decisions you need to make to establish the processes for managing and maintaining AppLocker policies.","pos":[430,561]},{"content":"Policy management","pos":[566,583]},{"content":"Before you begin the deployment process, consider how the AppLocker rules will be managed.","pos":[585,675]},{"content":"Developing a process for managing AppLocker rules helps assure that AppLocker continues to effectively control how applications are allowed to run in your organization.","pos":[676,844]},{"content":"Application and user support policy","pos":[850,885]},{"content":"Developing a process for managing AppLocker rules helps assure that AppLocker continues to effectively control how applications are allowed to run in your organization.","pos":[887,1055]},{"content":"Considerations include:","pos":[1056,1079]},{"content":"What type of end-user support is provided for blocked applications?","pos":[1085,1152]},{"content":"How are new rules added to the policy?","pos":[1157,1195]},{"content":"How are existing rules updated?","pos":[1200,1231]},{"content":"Are events forwarded for review?","pos":[1236,1268]},{"content":"Help desk support","pos":[1272,1289]},{"content":"If your organization has an established help desk support department in place, consider the following when deploying AppLocker policies:","pos":[1293,1429]},{"content":"What documentation does your support department require for new policy deployments?","pos":[1435,1518]},{"content":"What are the critical processes in each business group both in work flow and timing that will be affected by application control policies and how could they affect your support department's workload?","pos":[1523,1722]},{"content":"Who are the contacts in the support department?","pos":[1727,1774]},{"content":"How will the support department resolve application control issues between the end user and those who maintain the AppLocker rules?","pos":[1779,1910]},{"content":"End-user support","pos":[1914,1930]},{"content":"Because AppLocker is preventing unapproved apps from running, it is important that your organization carefully plan how to provide end-user support.","pos":[1934,2082]},{"content":"Considerations include:","pos":[2083,2106]},{"content":"Do you want to use an intranet site as a first line of support for users who have tried to run a blocked app?","pos":[2112,2221]},{"content":"How do you want to support exceptions to the policy?","pos":[2226,2278]},{"content":"Will you allow users to run a script to temporarily allow access to a blocked app?","pos":[2279,2361]},{"content":"Using an intranet site","pos":[2365,2387]},{"content":"AppLocker can be configured to display the default message but with a custom URL.","pos":[2391,2472]},{"content":"You can use this URL to redirect users to a support site that contains information about why the user received the error and which applications are allowed.","pos":[2473,2629]},{"content":"If you do not display a custom URL for the message when an app is blocked, the default URL is used.","pos":[2630,2729]},{"content":"The following image shows an example of the error message for a blocked app.","pos":[2731,2807]},{"content":"You can use the <bpt id=\"p1\">**</bpt>Set a support web link<ept id=\"p1\">**</ept> policy setting to customize the <bpt id=\"p2\">**</bpt>More information<ept id=\"p2\">**</ept> link.","pos":[2808,2909]},{"content":"applocker blocked application error message","pos":[2913,2956]},{"pos":[2985,3184],"content":"For steps to display a custom URL for the message, see <bpt id=\"p1\">[</bpt>Display a custom URL message when users try to run a blocked app<ept id=\"p1\">](display-a-custom-url-message-when-users-try-to-run-a-blocked-application.md)</ept>."},{"content":"AppLocker event management","pos":[3188,3214]},{"content":"Each time that a process requests permission to run, AppLocker creates an event in the AppLocker event log.","pos":[3218,3325]},{"content":"The event details which file tried to run, the attributes of that file, the user that initiated the request, and the rule GUID that was used to make the AppLocker execution decision.","pos":[3326,3508]},{"content":"The AppLocker event log is located in the following path: <bpt id=\"p1\">**</bpt>Applications and Services Logs<ph id=\"ph1\">\\\\</ph>Microsoft<ph id=\"ph2\">\\\\</ph>Windows<ph id=\"ph3\">\\\\</ph>AppLocker<ept id=\"p1\">**</ept>.","pos":[3509,3634]},{"content":"The AppLocker log includes three logs:","pos":[3635,3673]},{"content":"<bpt id=\"p1\">**</bpt>EXE and DLL<ept id=\"p1\">**</ept>.","pos":[3679,3695]},{"content":"Contains events for all files affected by the executable and DLL rule collections (.exe, .com, .dll, and .ocx).","pos":[3696,3807]},{"content":"<bpt id=\"p1\">**</bpt>MSI and Script<ept id=\"p1\">**</ept>.","pos":[3812,3831]},{"content":"Contains events for all files affected by the Windows Installer and script rule collections (.msi, .msp, .ps1, .bat, .cmd, .vbs, and .js).","pos":[3832,3970]},{"pos":[3975,4159],"content":"<bpt id=\"p1\">**</bpt>Packaged app-Deployment<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Packaged app-Execution<ept id=\"p2\">**</ept>, contains events for all Universal Windows apps affected by the packaged app and packed app installer rule collection (.appx)."},{"content":"Collecting these events in a central location can help you maintain your AppLocker policy and troubleshoot rule configuration problems.","pos":[4161,4296]},{"content":"Event collection technologies such as those available in Windows allow administrators to subscribe to specific event channels and have the events from source computers aggregated into a forwarded event log on a Windows Server operating system collector.","pos":[4297,4550]},{"content":"For more info about setting up an event subscription, see <bpt id=\"p1\">[</bpt>Configure Computers to Collect and Forward Events<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=145012)</ept>.","pos":[4551,4710]},{"content":"Policy maintenance","pos":[4716,4734]},{"content":"As new apps are deployed or existing apps are updated by the software publisher, you will need to make revisions to your rule collections to ensure that the policy is current.","pos":[4736,4911]},{"content":"You can edit an AppLocker policy by adding, changing, or removing rules.","pos":[4913,4985]},{"content":"However, you cannot specify a version for the policy by importing additional rules.","pos":[4986,5069]},{"content":"To ensure version control when modifying an AppLocker policy, use Group Policy management software that allows you to create versions of Group Policy Objects (GPOs).","pos":[5070,5235]},{"content":"An example of this type of software is the Advanced Group Policy Management feature from the Microsoft Desktop Optimization Pack.","pos":[5236,5365]},{"content":"For more info about Advanced Group Policy Management, see <bpt id=\"p1\">[</bpt>Advanced Group Policy Management Overview<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=145013)</ept> (http://go.microsoft.com/fwlink/p/?LinkId=145013).","pos":[5366,5567]},{"content":"<bpt id=\"p1\">**</bpt>Caution:<ept id=\"p1\">**</ept>  You should not edit an AppLocker rule collection while it is being enforced in Group Policy.","pos":[5570,5676]},{"content":"Because AppLocker controls what files are allowed to run, making changes to a live policy can create unexpected behavior.","pos":[5677,5798]},{"content":"New version of a supported app","pos":[5803,5833]},{"content":"When a new version of an app is deployed in the organization, you need to determine whether to continue to support the previous version of that app.","pos":[5837,5985]},{"content":"To add the new version, you might only need to create a new rule for each file that is associated with the app.","pos":[5986,6097]},{"content":"If you are using publisher conditions and the version is not specified, then the existing rule or rules might be sufficient to allow the updated file to run.","pos":[6098,6255]},{"content":"You must ensure, however, that the updated app has not altered the file names or added files to support new functionality.","pos":[6256,6378]},{"content":"If so, then you must modify the existing rules or create new rules.","pos":[6379,6446]},{"content":"To continue to reuse a publisher-based rule without a specific file version, you must also ensure that the file's digital signature is still identical to the previous version—the publisher, product name, and file name (if configured in your rule) must all match for the rule to be correctly applied.","pos":[6447,6746]},{"content":"To determine whether a file has been modified during an app update, review the publisher's release details provided with the update package.","pos":[6748,6888]},{"content":"You can also review the publisher's web page to retrieve this information.","pos":[6889,6963]},{"content":"Each file can also be inspected to determine the version.","pos":[6964,7021]},{"content":"For files that are allowed or denied with file hash conditions, you must retrieve the new file hash.","pos":[7023,7123]},{"content":"To add support for a new version and maintain support for the older version, you can either create a new file hash rule for the new version or edit the existing rule and add the new file hash to the list of conditions.","pos":[7124,7342]},{"content":"For files with path conditions, you should verify that the installation path has not changed from what is stated in the rule.","pos":[7344,7469]},{"content":"If the path has changed, you need to update the rule before installing the new version of the app","pos":[7470,7567]},{"content":"Recently deployed app","pos":[7571,7592]},{"content":"To support a new app, you must add one or more rules to the existing AppLocker policy.","pos":[7596,7682]},{"content":"App is no longer supported","pos":[7686,7712]},{"content":"If your organization has determined that it will no longer support an application that has AppLocker rules associated with it, the easiest way to prevent users from running the app is to delete these rules.","pos":[7716,7922]},{"content":"App is blocked but should be allowed","pos":[7926,7962]},{"content":"A file could be blocked for three reasons:","pos":[7966,8008]},{"content":"The most common reason is that no rule exists to allow the app to run.","pos":[8014,8084]},{"content":"There may be an existing rule that was created for the file that is too restrictive.","pos":[8089,8173]},{"content":"A deny rule, which cannot be overridden, is explicitly blocking the file.","pos":[8178,8251]},{"content":"Before editing the rule collection, first determine what rule is preventing the file from running.","pos":[8253,8351]},{"content":"You can troubleshoot the problem by using the <bpt id=\"p1\">**</bpt>Test-AppLockerPolicy<ept id=\"p1\">**</ept> Windows PowerShell cmdlet.","pos":[8352,8449]},{"content":"For more info about troubleshooting an AppLocker policy, see <bpt id=\"p1\">[</bpt>Testing and Updating an AppLocker Policy<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=160269)</ept> (http://go.microsoft.com/fwlink/p/?LinkId=160269).","pos":[8450,8653]},{"content":"Next steps","pos":[8658,8668]},{"content":"After deciding how your organization will manage your AppLocker policy, record your findings.","pos":[8670,8763]},{"content":"End-user support policy.","pos":[8771,8795]},{"content":"Document the process that you will use for handling calls from users who have attempted to run a blocked app, and ensure that support personnel have clear escalation steps so that the administrator can update the AppLocker policy, if necessary.","pos":[8798,9042]},{"content":"Event processing.","pos":[9049,9066]},{"content":"Document whether events will be collected in a central location called a store, how that store will be archived, and whether the events will be processed for analysis.","pos":[9069,9236]},{"content":"Policy maintenance.","pos":[9243,9262]},{"content":"Detail how rules will be added to the policy and in which GPO the rules are defined.","pos":[9265,9349]},{"pos":[9351,9529],"content":"For information and steps how to document your processes, see <bpt id=\"p1\">[</bpt>Document your application control management processes<ept id=\"p1\">](document-your-application-control-management-processes.md)</ept>."}],"content":"---\ntitle: Plan for AppLocker policy management (Windows 10)\ndescription: This topic for describes the decisions you need to make to establish the processes for managing and maintaining AppLocker policies.\nms.assetid: dccc196f-6ae0-4ae4-853a-a3312b18751b\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Plan for AppLocker policy management\n\n**Applies to**\n-   Windows 10\n\nThis topic for describes the decisions you need to make to establish the processes for managing and maintaining AppLocker policies.\n\n## Policy management\n\nBefore you begin the deployment process, consider how the AppLocker rules will be managed. Developing a process for managing AppLocker rules helps assure that AppLocker continues to effectively control how applications are allowed to run in your organization.\n\n### Application and user support policy\n\nDeveloping a process for managing AppLocker rules helps assure that AppLocker continues to effectively control how applications are allowed to run in your organization. Considerations include:\n\n-   What type of end-user support is provided for blocked applications?\n-   How are new rules added to the policy?\n-   How are existing rules updated?\n-   Are events forwarded for review?\n\n**Help desk support**\n\nIf your organization has an established help desk support department in place, consider the following when deploying AppLocker policies:\n\n-   What documentation does your support department require for new policy deployments?\n-   What are the critical processes in each business group both in work flow and timing that will be affected by application control policies and how could they affect your support department's workload?\n-   Who are the contacts in the support department?\n-   How will the support department resolve application control issues between the end user and those who maintain the AppLocker rules?\n\n**End-user support**\n\nBecause AppLocker is preventing unapproved apps from running, it is important that your organization carefully plan how to provide end-user support. Considerations include:\n\n-   Do you want to use an intranet site as a first line of support for users who have tried to run a blocked app?\n-   How do you want to support exceptions to the policy? Will you allow users to run a script to temporarily allow access to a blocked app?\n\n**Using an intranet site**\n\nAppLocker can be configured to display the default message but with a custom URL. You can use this URL to redirect users to a support site that contains information about why the user received the error and which applications are allowed. If you do not display a custom URL for the message when an app is blocked, the default URL is used.\n\nThe following image shows an example of the error message for a blocked app. You can use the **Set a support web link** policy setting to customize the **More information** link.\n\n![applocker blocked application error message](images/blockedappmsg.gif)\n\nFor steps to display a custom URL for the message, see [Display a custom URL message when users try to run a blocked app](display-a-custom-url-message-when-users-try-to-run-a-blocked-application.md).\n\n**AppLocker event management**\n\nEach time that a process requests permission to run, AppLocker creates an event in the AppLocker event log. The event details which file tried to run, the attributes of that file, the user that initiated the request, and the rule GUID that was used to make the AppLocker execution decision. The \nAppLocker event log is located in the following path: **Applications and Services Logs\\\\Microsoft\\\\Windows\\\\AppLocker**. The AppLocker log includes three logs:\n\n1.  **EXE and DLL**. Contains events for all files affected by the executable and DLL rule collections (.exe, .com, .dll, and .ocx).\n2.  **MSI and Script**. Contains events for all files affected by the Windows Installer and script rule collections (.msi, .msp, .ps1, .bat, .cmd, .vbs, and .js).\n3.  **Packaged app-Deployment** or **Packaged app-Execution**, contains events for all Universal Windows apps affected by the packaged app and packed app installer rule collection (.appx).\n\nCollecting these events in a central location can help you maintain your AppLocker policy and troubleshoot rule configuration problems. Event collection technologies such as those available in Windows allow administrators to subscribe to specific event channels and have the events from source computers aggregated into a forwarded event log on a Windows Server operating system collector. For more info about setting up an event subscription, see [Configure Computers to Collect and Forward Events](http://go.microsoft.com/fwlink/p/?LinkId=145012).\n\n### Policy maintenance\n\nAs new apps are deployed or existing apps are updated by the software publisher, you will need to make revisions to your rule collections to ensure that the policy is current.\n\nYou can edit an AppLocker policy by adding, changing, or removing rules. However, you cannot specify a version for the policy by importing additional rules. To ensure version control when modifying an AppLocker policy, use Group Policy management software that allows you to create versions of Group Policy Objects (GPOs). An example of this type of software is the Advanced Group Policy Management feature from the Microsoft Desktop Optimization Pack. For more info about Advanced Group Policy Management, see [Advanced Group Policy Management Overview](http://go.microsoft.com/fwlink/p/?LinkId=145013) (http://go.microsoft.com/fwlink/p/?LinkId=145013).\n\n>**Caution:**  You should not edit an AppLocker rule collection while it is being enforced in Group Policy. Because AppLocker controls what files are allowed to run, making changes to a live policy can create unexpected behavior.\n \n**New version of a supported app**\n\nWhen a new version of an app is deployed in the organization, you need to determine whether to continue to support the previous version of that app. To add the new version, you might only need to create a new rule for each file that is associated with the app. If you are using publisher conditions and the version is not specified, then the existing rule or rules might be sufficient to allow the updated file to run. You must ensure, however, that the updated app has not altered the file names or added files to support new functionality. If so, then you must modify the existing rules or create new rules. To continue to reuse a publisher-based rule without a specific file version, you must also ensure that the file's digital signature is still identical to the previous version—the publisher, product name, and file name (if configured in your rule) must all match for the rule to be correctly applied.\n\nTo determine whether a file has been modified during an app update, review the publisher's release details provided with the update package. You can also review the publisher's web page to retrieve this information. Each file can also be inspected to determine the version.\n\nFor files that are allowed or denied with file hash conditions, you must retrieve the new file hash. To add support for a new version and maintain support for the older version, you can either create a new file hash rule for the new version or edit the existing rule and add the new file hash to the list of conditions.\n\nFor files with path conditions, you should verify that the installation path has not changed from what is stated in the rule. If the path has changed, you need to update the rule before installing the new version of the app\n\n**Recently deployed app**\n\nTo support a new app, you must add one or more rules to the existing AppLocker policy.\n\n**App is no longer supported**\n\nIf your organization has determined that it will no longer support an application that has AppLocker rules associated with it, the easiest way to prevent users from running the app is to delete these rules.\n\n**App is blocked but should be allowed**\n\nA file could be blocked for three reasons:\n\n-   The most common reason is that no rule exists to allow the app to run.\n-   There may be an existing rule that was created for the file that is too restrictive.\n-   A deny rule, which cannot be overridden, is explicitly blocking the file.\n\nBefore editing the rule collection, first determine what rule is preventing the file from running. You can troubleshoot the problem by using the **Test-AppLockerPolicy** Windows PowerShell cmdlet. For more info about troubleshooting an AppLocker policy, see [Testing and Updating an AppLocker Policy](http://go.microsoft.com/fwlink/p/?LinkId=160269) (http://go.microsoft.com/fwlink/p/?LinkId=160269).\n\n## Next steps\n\nAfter deciding how your organization will manage your AppLocker policy, record your findings.\n\n-   **End-user support policy.** Document the process that you will use for handling calls from users who have attempted to run a blocked app, and ensure that support personnel have clear escalation steps so that the administrator can update the AppLocker policy, if necessary.\n-   **Event processing.** Document whether events will be collected in a central location called a store, how that store will be archived, and whether the events will be processed for analysis.\n-   **Policy maintenance.** Detail how rules will be added to the policy and in which GPO the rules are defined.\n\nFor information and steps how to document your processes, see [Document your application control management processes](document-your-application-control-management-processes.md).\n"}