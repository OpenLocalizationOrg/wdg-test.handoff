{"nodes":[{"content":"4946(S) A change has been made to Windows Firewall exception list.","pos":[11,77]},{"content":"A rule was added.","pos":[78,95]},{"content":"(Windows 10)","pos":[96,108]},{"content":"Describes security event 4946(S) A change has been made to Windows Firewall exception list.","pos":[122,213]},{"content":"A rule was added.","pos":[214,231]},{"content":"4946(S): A change has been made to Windows Firewall exception list.","pos":[331,398]},{"content":"A rule was added.","pos":[399,416]},{"content":"Applies to","pos":[420,430]},{"content":"Windows 10","pos":[437,447]},{"content":"Windows Server 2016","pos":[452,471]},{"pos":[591,696],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit MPSSVC Rule-Level Policy Change<ept id=\"p2\">](audit-mpssvc-rule-level-policy-change.md)</ept>"},{"content":"Event Description:","pos":[701,719]},{"content":"This event generates when new rule was locally added to Windows Firewall.","pos":[724,797]},{"content":"This event doesn't generate when new rule was added via Group Policy.","pos":[799,868]},{"pos":[872,1008],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For recommendations, see <bpt id=\"p2\">[</bpt>Security Monitoring Recommendations<ept id=\"p2\">](#security-monitoring-recommendations)</ept> for this event."},{"content":"Event XML:","pos":[1031,1041]},{"pos":[1853,1887],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> None."},{"pos":[1889,1950],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008, Windows Vista."},{"pos":[1952,1976],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Field Descriptions:","pos":[1981,2000]},{"content":"<bpt id=\"p1\">**</bpt>Profile Changed<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the list of profiles to which new rule was applied.","pos":[2005,2106]},{"content":"Examples:","pos":[2107,2116]},{"content":"All","pos":[2122,2125]},{"content":"Domain,Public","pos":[2131,2144]},{"content":"Domain,Private","pos":[2150,2164]},{"content":"Private,Public","pos":[2170,2184]},{"content":"Public","pos":[2190,2196]},{"content":"Domain","pos":[2202,2208]},{"content":"Private","pos":[2214,2221]},{"content":"Added Rule:","pos":[2225,2236]},{"pos":[2244,2322],"content":"<bpt id=\"p1\">**</bpt>Rule ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the unique new firewall rule identifier."},{"pos":[2328,2604],"content":"To see the unique ID of the rule you need to navigate to “<bpt id=\"p1\">**</bpt>HKEY<ph id=\"ph1\">\\_</ph>LOCAL<ph id=\"ph2\">\\_</ph>MACHINE<ph id=\"ph3\">\\\\</ph>SYSTEM<ph id=\"ph4\">\\\\</ph>CurrentControlSet<ph id=\"ph5\">\\\\</ph>Services<ph id=\"ph6\">\\\\</ph>SharedAccess<ph id=\"ph7\">\\\\</ph>Parameters<ph id=\"ph8\">\\\\</ph>FirewallPolicy<ph id=\"ph9\">\\\\</ph>FirewallRules”<ept id=\"p1\">**</ept> registry key and you will see the list of Windows Firewall rule IDs (Name column) with parameters:"},{"content":"<bpt id=\"p1\">**</bpt>Rule Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the name of the rule which was added.","pos":[2745,2822]},{"content":"You can see the name of Windows Firewall rule using Windows Firewall with Advanced Security management console (<bpt id=\"p1\">**</bpt>wf.msc<ept id=\"p1\">**</ept>), check “Name” column:","pos":[2823,2968]},{"content":"Security Monitoring Recommendations","pos":[3124,3159]},{"content":"For 4946(S): A change has been made to Windows Firewall exception list.","pos":[3161,3232]},{"content":"A rule was added.","pos":[3233,3250]},{"content":"This event can be helpful in case you want to monitor all creations of new Firewall rules which were done locally.","pos":[3256,3370]}],"content":"---\ntitle: 4946(S) A change has been made to Windows Firewall exception list. A rule was added. (Windows 10)\ndescription: Describes security event 4946(S) A change has been made to Windows Firewall exception list. A rule was added.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 4946(S): A change has been made to Windows Firewall exception list. A rule was added.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\n<img src=\"images/event-4946.png\" alt=\"Event 4946 illustration\" width=\"449\" height=\"350\" hspace=\"10\" align=\"left\" />\n\n***Subcategory:***&nbsp;[Audit MPSSVC Rule-Level Policy Change](audit-mpssvc-rule-level-policy-change.md)\n\n***Event Description:***\n\nThis event generates when new rule was locally added to Windows Firewall.\n\nThis event doesn't generate when new rule was added via Group Policy.\n\n> **Note**&nbsp;&nbsp;For recommendations, see [Security Monitoring Recommendations](#security-monitoring-recommendations) for this event.\n\n<br clear=\"all\">\n\n***Event XML:***\n```\n- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n- <System>\n <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> \n <EventID>4946</EventID> \n <Version>0</Version> \n <Level>0</Level> \n <Task>13571</Task> \n <Opcode>0</Opcode> \n <Keywords>0x8020000000000000</Keywords> \n <TimeCreated SystemTime=\"2015-10-03T20:05:42.078367200Z\" /> \n <EventRecordID>1050893</EventRecordID> \n <Correlation /> \n <Execution ProcessID=\"500\" ThreadID=\"528\" /> \n <Channel>Security</Channel> \n <Computer>DC01.contoso.local</Computer> \n <Security /> \n </System>\n- <EventData>\n <Data Name=\"ProfileChanged\">All</Data> \n <Data Name=\"RuleId\">{F2649D59-1355-4E3C-B886-CDD08B683199}</Data> \n <Data Name=\"RuleName\">Allow All Rule</Data> \n </EventData>\n </Event>\n\n```\n\n***Required Server Roles:*** None.\n\n***Minimum OS Version:*** Windows Server 2008, Windows Vista.\n\n***Event Versions:*** 0.\n\n***Field Descriptions:***\n\n**Profile Changed** \\[Type = UnicodeString\\]**:** the list of profiles to which new rule was applied. Examples:\n\n-   All\n\n-   Domain,Public\n\n-   Domain,Private\n\n-   Private,Public\n\n-   Public\n\n-   Domain\n\n-   Private\n\n**Added Rule:**\n\n-   **Rule ID** \\[Type = UnicodeString\\]: the unique new firewall rule identifier.\n\n    To see the unique ID of the rule you need to navigate to “**HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\FirewallRules”** registry key and you will see the list of Windows Firewall rule IDs (Name column) with parameters:\n\n<img src=\"images/registry-editor-firewallrules.png\" alt=\"Registry Editor FirewallRules key illustration\" width=\"1412\" height=\"422\" />\n\n-   **Rule Name** \\[Type = UnicodeString\\]: the name of the rule which was added. You can see the name of Windows Firewall rule using Windows Firewall with Advanced Security management console (**wf.msc**), check “Name” column:\n\n<img src=\"images/windows-firewall-with-advanced-security.png\" alt=\"Windows Firewall with Advanced Security illustration\" width=\"1082\" height=\"363\" />\n\n## Security Monitoring Recommendations\n\nFor 4946(S): A change has been made to Windows Firewall exception list. A rule was added.\n\n-   This event can be helpful in case you want to monitor all creations of new Firewall rules which were done locally.\n\n"}