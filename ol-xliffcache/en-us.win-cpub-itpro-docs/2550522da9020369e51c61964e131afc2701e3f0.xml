{"nodes":[{"content":"Step-by-Step Guide for Microsoft Advanced Group Policy Management 3.0","pos":[11,80]},{"content":"Step-by-Step Guide for Microsoft Advanced Group Policy Management 3.0","pos":[94,163]},{"content":"Step-by-Step Guide for Microsoft Advanced Group Policy Management 3.0","pos":[311,380]},{"content":"This step-by-step guide demonstrates advanced techniques for Group Policy management using the Group Policy Management Console (GPMC) and Microsoft Advanced Group Policy Management (AGPM).","pos":[383,571]},{"content":"AGPM increases the capabilities of the GPMC, providing:","pos":[572,627]},{"content":"Standard roles for delegating permissions to manage Group Policy objects (GPOs) to multiple Group Policy administrators, as well as the ability to delegate access to GPOs in the production environment.","pos":[633,834]},{"content":"An archive to enable Group Policy administrators to create and modify GPOs offline before deploying them to a production environment.","pos":[840,973]},{"content":"The ability to roll back to any previous version of a GPO in the archive and to limit the number of versions stored in the archive.","pos":[979,1110]},{"content":"Check-in/check-out capability for GPOs to ensure that Group Policy administrators do not inadvertently overwrite each other's work.","pos":[1116,1247]},{"content":"AGPM scenario overview","pos":[1252,1274]},{"content":"For this scenario, you will use a separate user account for each role in AGPM to demonstrate how Group Policy can be managed in an environment with multiple Group Policy administrators who have different levels of permissions.","pos":[1277,1503]},{"content":"Specifically, you will perform the following tasks:","pos":[1504,1555]},{"content":"Using an account that is a member of the Domain Admins group, install AGPM Server and assign the AGPM Administrator role to an account or group.","pos":[1561,1705]},{"content":"Using accounts to which you will assign AGPM roles, install AGPM Client.","pos":[1711,1783]},{"content":"Using an account with the AGPM Administrator role, configure AGPM and delegate access to GPOs by assigning roles to other accounts.","pos":[1789,1920]},{"content":"Using an account with the Editor role, request the creation of a GPO, which you then approve using an account with the Approver role.","pos":[1926,2059]},{"content":"With the Editor account, check the GPO out of the archive, edit the GPO, check the GPO into the archive, and request deployment.","pos":[2060,2188]},{"content":"Using an account with the Approver role, review the GPO and deploy it to your production environment.","pos":[2194,2295]},{"content":"Using an account with the Editor role, create a GPO template and use it as a starting point to create a new GPO.","pos":[2301,2413]},{"content":"Using an account with the Approver role, delete and restore a GPO.","pos":[2419,2485]},{"content":"group policy object development process","pos":[2489,2528]},{"content":"Requirements","pos":[2583,2595]},{"content":"Computers on which you want to install AGPM must meet the following requirements, and you must create accounts for use in this scenario.","pos":[2598,2734]},{"content":"Note","pos":[2738,2742]},{"content":"If you have AGPM 2.5 installed and are upgrading from Windows Server® 2003 to Windows Server 2008 or Windows Vista® with no service packs installed to Windows Vista with Service Pack 1, you must upgrade the operating system before you can upgrade to AGPM 3.0.","pos":[2747,3006]},{"content":"AGPM Server requirements","pos":[3015,3039]},{"content":"AGPM Server 3.0 requires Windows Server 2008 or Windows Vista with Service Pack 1 and the GPMC from Remote Server Administration Tools (RSAT) installed.","pos":[3041,3193]},{"content":"Both 32-bit and 64-bit versions are supported.","pos":[3194,3240]},{"content":"Before you install AGPM Server, you must be a member of the Domain Admins group and the following Windows features must be present unless otherwise noted:","pos":[3242,3396]},{"content":"GPMC","pos":[3402,3406]},{"content":"Windows Server 2008: The GPMC is automatically installed by AGPM if not present.","pos":[3416,3496]},{"content":"Windows Vista: You must install the GPMC from RSAT before you install AGPM.","pos":[3506,3581]},{"content":"For more information, see <bpt id=\"p1\">&lt;</bpt>http://go.microsoft.com/fwlink/?LinkID=116179<ept id=\"p1\">&gt;</ept>.","pos":[3582,3656]},{"content":".NET Framework 3.5","pos":[3662,3680]},{"content":"The following Windows features are required by AGPM Server and will be automatically installed if not present:","pos":[3682,3792]},{"content":"WCF Activation; Non-HTTP Activation","pos":[3798,3833]},{"content":"Windows Process Activation Service","pos":[3839,3873]},{"content":"Process Model","pos":[3883,3896]},{"content":".NET Environment","pos":[3906,3922]},{"content":"Configuration APIs","pos":[3932,3950]},{"content":"AGPM Client requirements","pos":[3956,3980]},{"content":"AGPM Client 3.0 requires Windows Server 2008 or Windows Vista with Service Pack 1 and the GPMC from Remote Server Administration Tools (RSAT) installed.","pos":[3982,4134]},{"content":"Both 32-bit and 64-bit versions are supported.","pos":[4135,4181]},{"content":"AGPM Client can be installed on a computer running AGPM Server.","pos":[4182,4245]},{"content":"The following Windows features are required by AGPM Client and will be automatically installed if not present unless otherwise noted:","pos":[4247,4380]},{"content":"GPMC","pos":[4386,4390]},{"content":"Windows Server 2008: The GPMC is automatically installed by AGPM if not present.","pos":[4400,4480]},{"content":"Windows Vista: You must install the GPMC from RSAT before you install AGPM.","pos":[4490,4565]},{"content":"For more information, see <bpt id=\"p1\">&lt;</bpt>http://go.microsoft.com/fwlink/?LinkID=116179<ept id=\"p1\">&gt;</ept>.","pos":[4566,4640]},{"content":".NET Framework 3.0","pos":[4646,4664]},{"content":"Scenario requirements","pos":[4670,4691]},{"content":"Before you begin this scenario, create four user accounts.","pos":[4693,4751]},{"content":"During the scenario, you will assign one of the following AGPM roles to each of these accounts: AGPM Administrator (Full Control), Approver, Editor, and Reviewer.","pos":[4752,4914]},{"content":"These accounts must be able to send and receive e-mail messages.","pos":[4915,4979]},{"content":"Assign <bpt id=\"p1\">**</bpt>Link GPOs<ept id=\"p1\">**</ept> permission to the accounts with the AGPM Administrator, Approver, and (optionally) Editor roles.","pos":[4980,5097]},{"content":"Note","pos":[5101,5105]},{"content":"<bpt id=\"p1\">**</bpt>Link GPOs<ept id=\"p1\">**</ept> permission is assigned to members of Domain Administrators and Enterprise Administrators by default.","pos":[5110,5224]},{"content":"To assign <bpt id=\"p1\">**</bpt>Link GPOs<ept id=\"p1\">**</ept> permission to additional users or groups (such as accounts with the roles of AGPM Administrator or Approver), click the node for the domain and then click the <bpt id=\"p2\">**</bpt>Delegation<ept id=\"p2\">**</ept> tab, select <bpt id=\"p3\">**</bpt>Link GPOs<ept id=\"p3\">**</ept>, click <bpt id=\"p4\">**</bpt>Add<ept id=\"p4\">**</ept>, and select users or groups to which to assign the permission.","pos":[5225,5526]},{"content":"Steps for installing and configuring AGPM","pos":[5534,5575]},{"content":"You must complete the following steps to install and configure AGPM.","pos":[5578,5646]},{"content":"Step 1: Install AGPM Server","pos":[5649,5676]},{"content":"Step 2: Install AGPM Client","pos":[5695,5722]},{"content":"Step 3: Configure an AGPM Server connection","pos":[5741,5784]},{"content":"Step 4: Configure e-mail notification","pos":[5803,5840]},{"content":"Step 5: Delegate access","pos":[5859,5882]},{"pos":[5937,5964],"content":"Step 1: Install AGPM Server"},{"content":"In this step, you install AGPM Server on the member server or domain controller that will run the AGPM Service, and you configure the archive.","pos":[5966,6108]},{"content":"All AGPM operations are managed through this Windows service and are executed with the service's credentials.","pos":[6109,6218]},{"content":"The archive managed by an AGPM Server can be hosted on that server or on another server in the same forest.","pos":[6219,6326]},{"content":"To install AGPM Server on the computer that will host the AGPM Service","pos":[6330,6400]},{"content":"Log on with an account that is a member of the Domain Admins group.","pos":[6408,6475]},{"pos":[6481,6624],"content":"Start the Microsoft Desktop Optimization Pack CD and follow the instructions on screen to select <bpt id=\"p1\">**</bpt>Advanced Group Policy Management - Server<ept id=\"p1\">**</ept>."},{"pos":[6630,6676],"content":"In the <bpt id=\"p1\">**</bpt>Welcome<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"pos":[6682,6774],"content":"In the <bpt id=\"p1\">**</bpt>Microsoft Software License Terms<ept id=\"p1\">**</ept> dialog box, accept the terms and click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Application Path<ept id=\"p1\">**</ept> dialog box, select a location in which to install AGPM Server.","pos":[6780,6870]},{"content":"The computer on which AGPM Server is installed will host the AGPM Service and manage the archive.","pos":[6871,6968]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[6969,6984]},{"content":"In the <bpt id=\"p1\">**</bpt>Archive Path<ept id=\"p1\">**</ept> dialog box, select a location for the archive relative to the AGPM Server.","pos":[6990,7088]},{"content":"The archive path can point to a folder on the AGPM Server or elsewhere, but you should select a location with sufficient space to store all GPOs and history data managed by this AGPM Server.","pos":[7089,7279]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[7280,7295]},{"pos":[7301,7432],"content":"In the <bpt id=\"p1\">**</bpt>AGPM Service Account<ept id=\"p1\">**</ept> dialog box, select a service account under which the AGPM Service will run and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Archive Owner<ept id=\"p1\">**</ept> dialog box, select an account or group to which to initially assign the AGPM Administrator (Full Control) role.","pos":[7438,7574]},{"content":"This AGPM Administrator can assign AGPM roles and permissions to other Group Policy administrators (including the role of AGPM Administrator).","pos":[7575,7717]},{"content":"For this scenario, select the account to serve in the AGPM Administrator role.","pos":[7718,7796]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[7797,7812]},{"content":"In the <bpt id=\"p1\">**</bpt>Port Configuration<ept id=\"p1\">**</ept> dialog box, type a port on which the AGPM Service should listen.","pos":[7818,7912]},{"content":"Do not clear the <bpt id=\"p1\">**</bpt>Add port exception to firewall<ept id=\"p1\">**</ept> check box unless you manually configure port exceptions or use rules to configure port exceptions.","pos":[7913,8063]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[8064,8079]},{"pos":[8085,8182],"content":"In the <bpt id=\"p1\">**</bpt>Languages<ept id=\"p1\">**</ept> dialog box, select one or more display languages to install for AGPM Server."},{"pos":[8188,8258],"content":"Click <bpt id=\"p1\">**</bpt>Install<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept> to exit the Setup Wizard."},{"pos":[8264,8559],"content":"**Caution**  \nDo not modify settings for the AGPM Service through **Administrative Tools** and **Services** in the operating system. Doing so can prevent the AGPM Service from starting. For information on how to modify settings for the service, see Help for Advanced Group Policy Management.","leadings":["","    "],"nodes":[{"content":"Caution","pos":[2,9]},{"content":"Do not modify settings for the AGPM Service through **Administrative Tools** and **Services** in the operating system. Doing so can prevent the AGPM Service from starting. For information on how to modify settings for the service, see Help for Advanced Group Policy Management.","pos":[14,291],"nodes":[{"content":"Do not modify settings for the AGPM Service through <bpt id=\"p1\">**</bpt>Administrative Tools<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Services<ept id=\"p2\">**</ept> in the operating system.","pos":[0,118]},{"content":"Doing so can prevent the AGPM Service from starting.","pos":[119,171]},{"content":"For information on how to modify settings for the service, see Help for Advanced Group Policy Management.","pos":[172,277]}]}]},{"pos":[8605,8632],"content":"Step 2: Install AGPM Client"},{"content":"Each Group Policy administrator—anyone who creates, edits, deploys, reviews, or deletes GPOs—must have AGPM Client installed on computers that they use to manage GPOs.","pos":[8634,8801]},{"content":"For this scenario, you install AGPM Client on at least one computer.","pos":[8802,8870]},{"content":"You do not need to install AGPM Client on the computers of end users who do not perform Group Policy administration.","pos":[8871,8987]},{"content":"To install AGPM Client on the computer of a Group Policy administrator","pos":[8991,9061]},{"pos":[9069,9212],"content":"Start the Microsoft Desktop Optimization Pack CD and follow the instructions on screen to select <bpt id=\"p1\">**</bpt>Advanced Group Policy Management - Client<ept id=\"p1\">**</ept>."},{"pos":[9218,9264],"content":"In the <bpt id=\"p1\">**</bpt>Welcome<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"pos":[9270,9362],"content":"In the <bpt id=\"p1\">**</bpt>Microsoft Software License Terms<ept id=\"p1\">**</ept> dialog box, accept the terms and click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Application Path<ept id=\"p1\">**</ept> dialog box, select a location in which to install AGPM Client.","pos":[9368,9458]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[9459,9474]},{"content":"In the <bpt id=\"p1\">**</bpt>AGPM Server<ept id=\"p1\">**</ept> dialog box, type the fully-qualified computer name for the AGPM Server and the port to which to connect.","pos":[9480,9607]},{"content":"The default port for the AGPM Service is 4600.","pos":[9608,9654]},{"content":"Do not clear the <bpt id=\"p1\">**</bpt>Allow Microsoft Management Console through the firewall<ept id=\"p1\">**</ept> check box unless you manually configure port exceptions or use rules to configure port exceptions.","pos":[9655,9830]},{"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[9831,9846]},{"pos":[9852,9949],"content":"In the <bpt id=\"p1\">**</bpt>Languages<ept id=\"p1\">**</ept> dialog box, select one or more display languages to install for AGPM Client."},{"pos":[9955,10025],"content":"Click <bpt id=\"p1\">**</bpt>Install<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept> to exit the Setup Wizard."},{"pos":[10064,10107],"content":"Step 3: Configure an AGPM Server connection"},{"content":"AGPM stores all versions of each controlled Group Policy object (GPO)—a GPO for which AGPM provides change control—in a central archive, so Group Policy administrators can view and modify GPOs offline without immediately impacting the deployed version of each GPO.","pos":[10109,10373]},{"content":"In this step, you configure an AGPM Server connection and ensure that all Group Policy administrators connect to the same AGPM Server.","pos":[10375,10509]},{"content":"(For information about configuring multiple AGPM Servers, see Help for Advanced Group Policy Management.)","pos":[10510,10615]},{"content":"To configure an AGPM Server connection for all Group Policy administrators","pos":[10619,10693]},{"content":"On a computer on which you have installed AGPM Client, log on with the user account that you selected as the Archive Owner.","pos":[10701,10824]},{"content":"This user has the role of AGPM Administrator (Full Control).","pos":[10825,10885]},{"pos":[10891,10998],"content":"Click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, point to <bpt id=\"p2\">**</bpt>Administrative Tools<ept id=\"p2\">**</ept>, and click <bpt id=\"p3\">**</bpt>Group Policy Management<ept id=\"p3\">**</ept> to open the GPMC."},{"content":"Edit a GPO that is applied to all Group Policy administrators.","pos":[11004,11066]},{"pos":[11072,11240],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Editor<ept id=\"p1\">**</ept> window, double-click <bpt id=\"p2\">**</bpt>User Configuration<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Policies<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Administrative Templates<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>Windows Components<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>AGPM<ept id=\"p6\">**</ept>."},{"pos":[11246,11332],"content":"In the details pane, double-click <bpt id=\"p1\">**</bpt>AGPM: Specify default AGPM Server (all domains)<ept id=\"p1\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> window, select <bpt id=\"p2\">**</bpt>Enabled<ept id=\"p2\">**</ept> and type the fully-qualified computer name and port (for example, <bpt id=\"p3\">**</bpt>server.contoso.com:4600<ept id=\"p3\">**</ept>) for the server hosting the archive.","pos":[11338,11517]},{"content":"By default, the AGPM Service uses port 4600.","pos":[11518,11562]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>, and then close the <bpt id=\"p2\">**</bpt>Group Policy Management Editor<ept id=\"p2\">**</ept> window.","pos":[11568,11643]},{"content":"When Group Policy is updated, the AGPM Server connection is configured for each Group Policy administrator.","pos":[11644,11751]},{"pos":[11790,11827],"content":"Step 4: Configure e-mail notification"},{"content":"As an AGPM Administrator (Full Control), you designate the e-mail addresses of Approvers and AGPM Administrators to whom an e-mail message containing a request is sent when an Editor attempts to create, deploy, or delete a GPO.","pos":[11829,12056]},{"content":"You also determine the alias from which these messages are sent.","pos":[12057,12121]},{"content":"To configure e-mail notification for AGPM","pos":[12125,12166]},{"pos":[12174,12231],"content":"In the details pane, click the <bpt id=\"p1\">**</bpt>Domain Delegation<ept id=\"p1\">**</ept> tab."},{"pos":[12237,12346],"content":"In the <bpt id=\"p1\">**</bpt>From e-mail address<ept id=\"p1\">**</ept> field, type the e-mail alias for AGPM from which notifications should be sent."},{"pos":[12352,12481],"content":"In the <bpt id=\"p1\">**</bpt>To e-mail address<ept id=\"p1\">**</ept> field, type the e-mail address for the user account to which you intend to assign the Approver role."},{"pos":[12487,12547],"content":"In the <bpt id=\"p1\">**</bpt>SMTP server<ept id=\"p1\">**</ept> field, type a valid SMTP mail server."},{"content":"In the <bpt id=\"p1\">**</bpt>User name<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Password<ept id=\"p2\">**</ept> fields, type the credentials of a user with access to the SMTP service.","pos":[12553,12662]},{"content":"Click <bpt id=\"p1\">**</bpt>Apply<ept id=\"p1\">**</ept>.","pos":[12663,12679]},{"pos":[12718,12741],"content":"Step 5: Delegate access"},{"content":"As an AGPM Administrator (Full Control), you delegate domain-level access to GPOs, assigning roles to the account of each Group Policy administrator.","pos":[12743,12892]},{"content":"Note","pos":[12896,12900]},{"content":"You can also delegate access at the GPO level rather than the domain level.","pos":[12905,12980]},{"content":"For details, see Help for Advanced Group Policy Management.","pos":[12981,13040]},{"content":"Important","pos":[13047,13056]},{"content":"You should restrict membership in the Group Policy Creator Owners group, so it cannot be used to circumvent AGPM management of access to GPOs.","pos":[13061,13203]},{"content":"(In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept>, click <bpt id=\"p2\">**</bpt>Group Policy Objects<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs, click <bpt id=\"p3\">**</bpt>Delegation<ept id=\"p3\">**</ept>, and then configure the settings to meet the needs of your organization.)","pos":[13204,13433]},{"content":"To delegate access to all GPOs throughout a domain","pos":[13440,13490]},{"pos":[13498,13660],"content":"On the <bpt id=\"p1\">**</bpt>Domain Delegation<ept id=\"p1\">**</ept> tab, click the <bpt id=\"p2\">**</bpt>Add<ept id=\"p2\">**</ept> button, select the user account of the Group Policy administrator to serve as Approver, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Add Group or User<ept id=\"p1\">**</ept> dialog box, select the <bpt id=\"p2\">**</bpt>Approver<ept id=\"p2\">**</ept> role to assign that role to the account, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","pos":[13666,13794]},{"content":"(This role includes the Reviewer role.)","pos":[13795,13834]},{"pos":[13840,13966],"content":"Click the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> button, select the user account of the Group Policy administrator to serve as Editor, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Add Group or User<ept id=\"p1\">**</ept> dialog box, select the <bpt id=\"p2\">**</bpt>Editor<ept id=\"p2\">**</ept> role to assign that role to the account, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>.","pos":[13972,14098]},{"content":"(This role includes the Reviewer role.)","pos":[14099,14138]},{"pos":[14144,14272],"content":"Click the <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept> button, select the user account of the Group Policy administrator to serve as Reviewer, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>."},{"pos":[14278,14388],"content":"In the <bpt id=\"p1\">**</bpt>Add Group or User<ept id=\"p1\">**</ept> dialog box, select the <bpt id=\"p2\">**</bpt>Reviewer<ept id=\"p2\">**</ept> role to assign only that role to the account."},{"content":"Steps for managing GPOs","pos":[14393,14416]},{"content":"You must complete the following steps to create, edit, review, and deploy GPOs using AGPM.","pos":[14419,14509]},{"content":"Additionally, you will create a template, delete a GPO, and restore a deleted GPO.","pos":[14510,14592]},{"content":"Step 1: Create a GPO","pos":[14595,14615]},{"content":"Step 2: Edit a GPO","pos":[14634,14652]},{"content":"Step 3: Review and deploy a GPO","pos":[14671,14702]},{"content":"Step 4: Use a template to create a GPO","pos":[14721,14759]},{"content":"Step 5: Delete and restore a GPO","pos":[14778,14810]},{"pos":[14865,14885],"content":"Step 1: Create a GPO"},{"content":"In an environment with multiple Group Policy administrators, those with the Editor role have the ability to request the creation of new GPOs, but such a request must be approved by someone with the Approver role because the creation of a new GPO impacts the production environment.","pos":[14887,15168]},{"content":"In this step, you use an account with the Editor role to request the creation of a new GPO.","pos":[15170,15261]},{"content":"Using an account with the Approver role, you approve this request and complete the creation of a GPO.","pos":[15262,15363]},{"content":"To request the creation of a new GPO managed through AGPM","pos":[15367,15424]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the Editor role in AGPM.","pos":[15432,15561]},{"pos":[15567,15699],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[15705,15784],"content":"Right-click the <bpt id=\"p1\">**</bpt>Change Control<ept id=\"p1\">**</ept> node, and then click <bpt id=\"p2\">**</bpt>New Controlled GPO<ept id=\"p2\">**</ept>."},{"pos":[15790,15831],"content":"In the <bpt id=\"p1\">**</bpt>New Controlled GPO<ept id=\"p1\">**</ept> dialog box:"},{"pos":[15841,15920],"content":"To receive a copy of the request, type your e-mail address in the <bpt id=\"p1\">**</bpt>Cc<ept id=\"p1\">**</ept> field."},{"pos":[15930,15973],"content":"Type <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept> as the name for the new GPO."},{"content":"Type a comment for the new GPO.","pos":[15983,16014]},{"content":"Click <bpt id=\"p1\">**</bpt>Create live<ept id=\"p1\">**</ept> so the new GPO will be deployed to the production environment immediately upon approval.","pos":[16024,16134]},{"content":"Click <bpt id=\"p1\">**</bpt>Submit<ept id=\"p1\">**</ept>.","pos":[16135,16152]},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[16158,16253]},{"content":"The new GPO is displayed on the <bpt id=\"p1\">**</bpt>Pending<ept id=\"p1\">**</ept> tab.","pos":[16254,16302]},{"content":"To approve the pending request to create a GPO","pos":[16306,16352]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Approver in AGPM.","pos":[16360,16494]},{"content":"Open the e-mail inbox for the account, and note that you have received an e-mail message from the AGPM alias with the Editor's request to create a GPO.","pos":[16500,16651]},{"pos":[16657,16789],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[16795,16874],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab, click the <bpt id=\"p2\">**</bpt>Pending<ept id=\"p2\">**</ept> tab to display the pending GPOs."},{"pos":[16880,16930],"content":"Right-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Approve<ept id=\"p2\">**</ept>."},{"content":"Click <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept> to confirm approval of the creation of the GPO.","pos":[16936,16997]},{"content":"The GPO is moved to the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab.","pos":[16998,17041]},{"pos":[17080,17098],"content":"Step 2: Edit a GPO"},{"content":"You can use GPOs to configure computer or user settings and deploy them to many computers or users.","pos":[17100,17199]},{"content":"In this step, you use an account with the Editor role to check out a GPO from the archive, edit the GPO offline, check the edited GPO into the archive, and request deployment of the GPO to the production environment.","pos":[17200,17416]},{"content":"For this scenario, you configure a setting in the GPO to require that the password be at least eight characters in length.","pos":[17417,17539]},{"content":"To check the GPO out from the archive for editing","pos":[17543,17592]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Editor in AGPM.","pos":[17600,17732]},{"pos":[17738,17870],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[17876,17981],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab in the details pane, click the <bpt id=\"p2\">**</bpt>Controlled<ept id=\"p2\">**</ept> tab to display the controlled GPOs."},{"pos":[17987,18039],"content":"Right-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Check Out<ept id=\"p2\">**</ept>."},{"pos":[18045,18149],"content":"Type a comment to be displayed in the history of the GPO while it is checked out, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[18155,18250]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, the state of the GPO is identified as <bpt id=\"p2\">**</bpt>Checked Out<ept id=\"p2\">**</ept>.","pos":[18251,18332]},{"content":"To edit the GPO offline and configure the minimum password length","pos":[18336,18401]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, right-click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept> to open the <bpt id=\"p4\">**</bpt>Group Policy Management Editor<ept id=\"p4\">**</ept> window and make changes to an offline copy of the GPO.","pos":[18409,18584]},{"content":"For this scenario, configure the minimum password length:","pos":[18585,18642]},{"pos":[18652,18804],"content":"Under <bpt id=\"p1\">**</bpt>Computer Configuration<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>Policies<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Windows Settings<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Security Settings<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>Account Policies<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>Password Policy<ept id=\"p6\">**</ept>."},{"pos":[18814,18876],"content":"In the details pane, double-click <bpt id=\"p1\">**</bpt>Minimum password length<ept id=\"p1\">**</ept>."},{"pos":[18886,19026],"content":"In the properties window, select the <bpt id=\"p1\">**</bpt>Define this policy setting<ept id=\"p1\">**</ept> check box, set the number of characters to <bpt id=\"p2\">**</bpt>8<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"pos":[19032,19084],"content":"Close the <bpt id=\"p1\">**</bpt>Group Policy Management Editor<ept id=\"p1\">**</ept> window."},{"content":"To check the GPO into the archive","pos":[19088,19121]},{"pos":[19129,19206],"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, right-click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Check In<ept id=\"p3\">**</ept>."},{"pos":[19212,19250],"content":"Type a comment, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[19256,19351]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, the state of the GPO is identified as <bpt id=\"p2\">**</bpt>Checked In<ept id=\"p2\">**</ept>.","pos":[19352,19432]},{"content":"To request the deployment of the GPO to the production environment","pos":[19436,19502]},{"pos":[19510,19585],"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, right-click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Deploy<ept id=\"p3\">**</ept>."},{"content":"Because this account is not an Approver or AGPM Administrator, you must submit a request for deployment.","pos":[19591,19695]},{"content":"To receive a copy of the request, type your e-mail address in the <bpt id=\"p1\">**</bpt>Cc<ept id=\"p1\">**</ept> field.","pos":[19696,19775]},{"content":"Type a comment to be displayed in the history of the GPO, and then click <bpt id=\"p1\">**</bpt>Submit<ept id=\"p1\">**</ept>.","pos":[19776,19860]},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[19866,19961]},{"content":"<bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept> is displayed on the list of GPOs on the <bpt id=\"p2\">**</bpt>Pending<ept id=\"p2\">**</ept> tab.","pos":[19962,20028]},{"pos":[20067,20098],"content":"Step 3: Review and deploy a GPO"},{"content":"In this step, you act as an Approver, creating reports and analyzing the settings and changes to settings in the GPO to determine whether you should approve them.","pos":[20100,20262]},{"content":"After evaluating the GPO, you deploy it to the production environment and link it to a domain or an organizational unit (OU) so that it takes effect when Group Policy is refreshed for computers in that domain or OU.","pos":[20263,20478]},{"content":"To review settings in the GPO","pos":[20482,20511]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Approver in AGPM.","pos":[20519,20653]},{"content":"(Any Group Policy administrator with the Reviewer role, which is included in all of the other roles, can review the settings in a GPO.)","pos":[20654,20789]},{"content":"Open the e-mail inbox for the account and note that you have received an e-mail message from the AGPM alias with an Editor's request to deploy a GPO.","pos":[20795,20944]},{"pos":[20950,21082],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[21088,21159],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab in the details pane, click the <bpt id=\"p2\">**</bpt>Pending<ept id=\"p2\">**</ept> tab."},{"pos":[21165,21211],"content":"Double-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept> to display its history."},{"content":"Review the settings in the most recent version of MyGPO:","pos":[21217,21273]},{"pos":[21283,21464],"content":"In the <bpt id=\"p1\">**</bpt>History<ept id=\"p1\">**</ept> window, right-click the GPO version with the most recent timestamp, click <bpt id=\"p2\">**</bpt>Settings<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>HTML Report<ept id=\"p3\">**</ept> to display a summary of the GPO's settings."},{"content":"In the Web browser, click <bpt id=\"p1\">**</bpt>show all<ept id=\"p1\">**</ept> to display all of the settings in the GPO.","pos":[21474,21555]},{"content":"Close the browser.","pos":[21556,21574]},{"content":"Compare the most recent version of MyGPO to the first version checked in to the archive:","pos":[21580,21668]},{"content":"In the <bpt id=\"p1\">**</bpt>History<ept id=\"p1\">**</ept> window, click the GPO version with the most recent time stamp.","pos":[21678,21759]},{"content":"Press CTRL and click the oldest GPO version for which the <bpt id=\"p1\">**</bpt>Computer Version<ept id=\"p1\">**</ept> is not <bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\*</ph><ept id=\"p2\">**</ept>.","pos":[21760,21853]},{"content":"Click the <bpt id=\"p1\">**</bpt>Differences<ept id=\"p1\">**</ept> button.","pos":[21863,21896]},{"content":"The <bpt id=\"p1\">**</bpt>Account Policies/Password Policy<ept id=\"p1\">**</ept> section is highlighted in green and preceded by <bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\[+\\]</ph><ept id=\"p2\">**</ept>, indicating that this setting is configured only in the latter version of the GPO.","pos":[21897,22078]},{"content":"Click <bpt id=\"p1\">**</bpt>Account Policies/Password Policy<ept id=\"p1\">**</ept>.","pos":[22088,22131]},{"content":"The <bpt id=\"p1\">**</bpt>Minimum password length<ept id=\"p1\">**</ept> setting is also highlighted in green and preceded by <bpt id=\"p2\">**</bpt><ph id=\"ph1\">\\[+\\]</ph><ept id=\"p2\">**</ept>, indicating that it is configured only in the latter version of the GPO.","pos":[22132,22299]},{"content":"Close the Web browser.","pos":[22309,22331]},{"content":"To deploy the GPO to the production environment","pos":[22335,22382]},{"pos":[22390,22463],"content":"On the <bpt id=\"p1\">**</bpt>Pending<ept id=\"p1\">**</ept> tab, right-click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept> and then click <bpt id=\"p3\">**</bpt>Approve<ept id=\"p3\">**</ept>."},{"content":"Type a comment to include in the history of the GPO.","pos":[22469,22521]},{"content":"Click <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept>.","pos":[22527,22541]},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[22542,22637]},{"content":"The GPO is deployed to the production environment.","pos":[22638,22688]},{"content":"To link the GPO to a domain or organizational unit","pos":[22692,22742]},{"pos":[22750,22882],"content":"In the GPMC, right-click the domain or an OU to which to apply the GPO that you configured, and then click <bpt id=\"p1\">**</bpt>Link an Existing GPO<ept id=\"p1\">**</ept>."},{"pos":[22888,22961],"content":"In the <bpt id=\"p1\">**</bpt>Select GPO<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"pos":[23000,23038],"content":"Step 4: Use a template to create a GPO"},{"content":"In this step, you use an account with the Editor role to create a template—an uneditable, static version of a GPO for use as a starting point for creating new GPOs—and then create a new GPO based upon that template.","pos":[23040,23255]},{"content":"Templates are useful for quickly creating multiple GPOs that include many of the same settings.","pos":[23256,23351]},{"content":"To create a template based on an existing GPO","pos":[23355,23400]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Editor in AGPM.","pos":[23408,23540]},{"pos":[23546,23678],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[23684,23758],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab in the details pane, click the <bpt id=\"p2\">**</bpt>Controlled<ept id=\"p2\">**</ept> tab."},{"pos":[23764,23890],"content":"Right-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Save as Template<ept id=\"p2\">**</ept> to create a template incorporating all settings currently in MyGPO."},{"pos":[23896,23982],"content":"Type <bpt id=\"p1\">**</bpt>MyTemplate<ept id=\"p1\">**</ept> as the name for the template and a comment, and then click <bpt id=\"p2\">**</bpt>OK<ept id=\"p2\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[23988,24083]},{"content":"The new template appears on the <bpt id=\"p1\">**</bpt>Templates<ept id=\"p1\">**</ept> tab.","pos":[24084,24134]},{"content":"To request the creation of a new GPO managed through AGPM","pos":[24138,24195]},{"pos":[24203,24232],"content":"Click the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab."},{"pos":[24238,24317],"content":"Right-click the <bpt id=\"p1\">**</bpt>Change Control<ept id=\"p1\">**</ept> node, and then click <bpt id=\"p2\">**</bpt>New Controlled GPO<ept id=\"p2\">**</ept>."},{"pos":[24323,24364],"content":"In the <bpt id=\"p1\">**</bpt>New Controlled GPO<ept id=\"p1\">**</ept> dialog box:"},{"pos":[24374,24453],"content":"To receive a copy of the request, type your e-mail address in the <bpt id=\"p1\">**</bpt>Cc<ept id=\"p1\">**</ept> field."},{"pos":[24463,24511],"content":"Type <bpt id=\"p1\">**</bpt>MyOtherGPO<ept id=\"p1\">**</ept> as the name for the new GPO."},{"content":"Type a comment for the new GPO.","pos":[24521,24552]},{"pos":[24562,24673],"content":"Click <bpt id=\"p1\">**</bpt>Create live<ept id=\"p1\">**</ept>, so the new GPO will be deployed to the production environment immediately upon approval."},{"content":"For <bpt id=\"p1\">**</bpt>From GPO template<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>MyTemplate<ept id=\"p2\">**</ept>.","pos":[24683,24732]},{"content":"Click <bpt id=\"p1\">**</bpt>Submit<ept id=\"p1\">**</ept>.","pos":[24733,24750]},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[24756,24851]},{"content":"The new GPO is displayed on the <bpt id=\"p1\">**</bpt>Pending<ept id=\"p1\">**</ept> tab.","pos":[24852,24900]},{"content":"Use an account that has been assigned the role of Approver to approve the pending request to create the GPO as you did in <bpt id=\"p1\">[</bpt>Step 1: Create a GPO<ept id=\"p1\">](#bkmk-manage1)</ept>.","pos":[24902,25062]},{"content":"MyTemplate incorporates all of the settings that you configured in MyGPO.","pos":[25063,25136]},{"content":"Because MyOtherGPO was created using MyTemplate, it initially contains all of the settings that MyGPO contained at the time that MyTemplate was created.","pos":[25137,25289]},{"content":"You can confirm this by generating a difference report to compare MyOtherGPO to MyTemplate.","pos":[25290,25381]},{"content":"To check the GPO out from the archive for editing","pos":[25385,25434]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Editor in AGPM.","pos":[25442,25574]},{"pos":[25580,25637],"content":"Right-click <bpt id=\"p1\">**</bpt>MyOtherGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Check Out<ept id=\"p2\">**</ept>."},{"pos":[25643,25747],"content":"Type a comment to be displayed in the history of the GPO while it is checked out, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[25753,25848]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, the state of the GPO is identified as <bpt id=\"p2\">**</bpt>Checked Out<ept id=\"p2\">**</ept>.","pos":[25849,25930]},{"content":"To edit the GPO offline and configure the account lockout duration","pos":[25934,26000]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, right-click <bpt id=\"p2\">**</bpt>MyOtherGPO<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Edit<ept id=\"p3\">**</ept> to open the <bpt id=\"p4\">**</bpt>Group Policy Management Editor<ept id=\"p4\">**</ept> window and make changes to an offline copy of the GPO.","pos":[26008,26188]},{"content":"For this scenario, configure the minimum password length:","pos":[26189,26246]},{"pos":[26256,26415],"content":"Under <bpt id=\"p1\">**</bpt>Computer Configuration<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>Policies<ept id=\"p2\">**</ept>, <bpt id=\"p3\">**</bpt>Windows Settings<ept id=\"p3\">**</ept>, <bpt id=\"p4\">**</bpt>Security Settings<ept id=\"p4\">**</ept>, <bpt id=\"p5\">**</bpt>Account Policies<ept id=\"p5\">**</ept>, and <bpt id=\"p6\">**</bpt>Account Lockout Policy<ept id=\"p6\">**</ept>."},{"pos":[26425,26488],"content":"In the details pane, double-click <bpt id=\"p1\">**</bpt>Account lockout duration<ept id=\"p1\">**</ept>."},{"pos":[26498,26620],"content":"In the properties window, check <bpt id=\"p1\">**</bpt>Define this policy setting<ept id=\"p1\">**</ept>, set the duration to <bpt id=\"p2\">**</bpt>30<ept id=\"p2\">**</ept> minutes, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"pos":[26626,26678],"content":"Close the <bpt id=\"p1\">**</bpt>Group Policy Management Editor<ept id=\"p1\">**</ept> window."},{"content":"Check MyOtherGPO into the archive and request deployment as you did for MyGPO in <bpt id=\"p1\">[</bpt>Step 2: Edit a GPO<ept id=\"p1\">](#bkmk-manage2)</ept>.","pos":[26680,26797]},{"content":"You can compare MyOtherGPO to MyGPO or to MyTemplate using difference reports.","pos":[26798,26876]},{"content":"Any account that includes the Reviewer role (AGPM Administrator <ph id=\"ph1\">\\[</ph>Full Control<ph id=\"ph2\">\\]</ph>, Approver, Editor, or Reviewer) can generate reports.","pos":[26877,27011]},{"content":"To compare a GPO to another GPO and to a template","pos":[27015,27064]},{"content":"To compare MyGPO and MyOtherGPO:","pos":[27072,27104]},{"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>MyGPO<ept id=\"p2\">**</ept>.","pos":[27114,27157]},{"content":"Press CTRL and then click <bpt id=\"p1\">**</bpt>MyOtherGPO<ept id=\"p1\">**</ept>.","pos":[27158,27199]},{"pos":[27209,27289],"content":"Right-click <bpt id=\"p1\">**</bpt>MyOtherGPO<ept id=\"p1\">**</ept>, point to <bpt id=\"p2\">**</bpt>Differences<ept id=\"p2\">**</ept>, and click <bpt id=\"p3\">**</bpt>HTML Report<ept id=\"p3\">**</ept>."},{"content":"To compare MyOtherGPO and MyTemplate:","pos":[27295,27332]},{"pos":[27342,27390],"content":"On the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab, click <bpt id=\"p2\">**</bpt>MyOtherGPO<ept id=\"p2\">**</ept>."},{"pos":[27400,27477],"content":"Right-click <bpt id=\"p1\">**</bpt>MyOtherGPO<ept id=\"p1\">**</ept>, point to <bpt id=\"p2\">**</bpt>Differences<ept id=\"p2\">**</ept>, and click <bpt id=\"p3\">**</bpt>Template<ept id=\"p3\">**</ept>."},{"pos":[27487,27552],"content":"Select <bpt id=\"p1\">**</bpt>MyTemplate<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>HTML Report<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"pos":[27591,27623],"content":"Step 5: Delete and restore a GPO"},{"content":"In this step, you act as an Approver to delete a GPO.","pos":[27625,27678]},{"content":"To delete a GPO","pos":[27682,27697]},{"content":"On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Approver.","pos":[27705,27831]},{"pos":[27837,27969],"content":"In the <bpt id=\"p1\">**</bpt>Group Policy Management Console<ept id=\"p1\">**</ept> tree, click <bpt id=\"p2\">**</bpt>Change Control<ept id=\"p2\">**</ept> in the forest and domain in which you want to manage GPOs."},{"pos":[27975,28060],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab, click the <bpt id=\"p2\">**</bpt>Controlled<ept id=\"p2\">**</ept> tab to display the controlled GPOs."},{"content":"Right-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Delete<ept id=\"p2\">**</ept>.","pos":[28066,28115]},{"content":"Click <bpt id=\"p1\">**</bpt>Delete GPO from archive and production<ept id=\"p1\">**</ept> to delete both the version in the archive as well as the deployed version of the GPO in the production environment.","pos":[28116,28280]},{"pos":[28286,28371],"content":"Type a comment to be displayed in the audit trail for the GPO, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[28377,28472]},{"content":"The GPO is removed from the <bpt id=\"p1\">**</bpt>Controlled<ept id=\"p1\">**</ept> tab and is displayed on the <bpt id=\"p2\">**</bpt>Recycle Bin<ept id=\"p2\">**</ept> tab, where it can be restored or destroyed.","pos":[28473,28603]},{"content":"Occasionally you may discover after deleting a GPO that it is still needed.","pos":[28605,28680]},{"content":"In this step, you act as an Approver to restore a GPO that has been deleted.","pos":[28681,28757]},{"content":"To restore a deleted GPO","pos":[28761,28785]},{"pos":[28793,28872],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab, click the <bpt id=\"p2\">**</bpt>Recycle Bin<ept id=\"p2\">**</ept> tab to display deleted GPOs."},{"pos":[28878,28928],"content":"Right-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Restore<ept id=\"p2\">**</ept>."},{"pos":[28934,29014],"content":"Type a comment to be displayed in the history of the GPO, and then click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>AGPM Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[29020,29115]},{"content":"The GPO is removed from the <bpt id=\"p1\">**</bpt>Recycle Bin<ept id=\"p1\">**</ept> tab and is displayed on the <bpt id=\"p2\">**</bpt>Controlled<ept id=\"p2\">**</ept> tab.","pos":[29116,29207]},{"pos":[29213,29444],"content":"**Note**  \nRestoring a GPO to the archive does not automatically redeploy it to the production environment. To return the GPO to the production environment, deploy the GPO as in [Step 3: Review and deploy a GPO](#bkmk-manage3).","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"Restoring a GPO to the archive does not automatically redeploy it to the production environment. To return the GPO to the production environment, deploy the GPO as in [Step 3: Review and deploy a GPO](#bkmk-manage3).","pos":[11,227],"nodes":[{"content":"Restoring a GPO to the archive does not automatically redeploy it to the production environment.","pos":[0,96]},{"content":"To return the GPO to the production environment, deploy the GPO as in <bpt id=\"p1\">[</bpt>Step 3: Review and deploy a GPO<ept id=\"p1\">](#bkmk-manage3)</ept>.","pos":[97,216]}]}]},{"content":"After editing and deploying a GPO, you may discover that recent changes to the GPO are causing a problem.","pos":[29453,29558]},{"content":"In this step, you act as an Approver to roll back to a previous version of the GPO.","pos":[29559,29642]},{"content":"You can roll back to any version in the history of the GPO.","pos":[29643,29702]},{"content":"You can use comments and labels to identify known good versions and when specific changes were made.","pos":[29703,29803]},{"content":"To roll back to a previous version of a GPO","pos":[29807,29850]},{"pos":[29858,29943],"content":"On the <bpt id=\"p1\">**</bpt>Contents<ept id=\"p1\">**</ept> tab, click the <bpt id=\"p2\">**</bpt>Controlled<ept id=\"p2\">**</ept> tab to display the controlled GPOs."},{"pos":[29949,29995],"content":"Double-click <bpt id=\"p1\">**</bpt>MyGPO<ept id=\"p1\">**</ept> to display its history."},{"pos":[30001,30082],"content":"Right-click the version to be deployed, click <bpt id=\"p1\">**</bpt>Deploy<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept>."},{"content":"When the <bpt id=\"p1\">**</bpt>Progress<ept id=\"p1\">**</ept> window indicates that overall progress is complete, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[30088,30178]},{"content":"In the <bpt id=\"p1\">**</bpt>History<ept id=\"p1\">**</ept> window, click <bpt id=\"p2\">**</bpt>Close<ept id=\"p2\">**</ept>.","pos":[30179,30222]},{"pos":[30228,30533],"content":"**Note**  \nTo verify that the version that has been redeployed is the version intended, examine a difference report for the two versions. In the **History** window for the GPO, select the two versions, right-click them, point to **Difference**, and then click either **HTML Report** or **XML Report**.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"To verify that the version that has been redeployed is the version intended, examine a difference report for the two versions. In the **History** window for the GPO, select the two versions, right-click them, point to **Difference**, and then click either **HTML Report** or **XML Report**.","pos":[11,301],"nodes":[{"content":"To verify that the version that has been redeployed is the version intended, examine a difference report for the two versions.","pos":[0,126]},{"content":"In the <bpt id=\"p1\">**</bpt>History<ept id=\"p1\">**</ept> window for the GPO, select the two versions, right-click them, point to <bpt id=\"p2\">**</bpt>Difference<ept id=\"p2\">**</ept>, and then click either <bpt id=\"p3\">**</bpt>HTML Report<ept id=\"p3\">**</ept> or <bpt id=\"p4\">**</bpt>XML Report<ept id=\"p4\">**</ept>.","pos":[127,290]}]}]}],"content":"---\ntitle: Step-by-Step Guide for Microsoft Advanced Group Policy Management 3.0\ndescription: Step-by-Step Guide for Microsoft Advanced Group Policy Management 3.0\nauthor: jamiejdt\nms.assetid: d067f465-d7c8-4f6d-b311-66b9b06874f7\nms.pagetype: mdop\nms.mktglfcycl: manage\nms.sitesec: library\nms.prod: w10\n---\n\n\n# Step-by-Step Guide for Microsoft Advanced Group Policy Management 3.0\n\n\nThis step-by-step guide demonstrates advanced techniques for Group Policy management using the Group Policy Management Console (GPMC) and Microsoft Advanced Group Policy Management (AGPM). AGPM increases the capabilities of the GPMC, providing:\n\n-   Standard roles for delegating permissions to manage Group Policy objects (GPOs) to multiple Group Policy administrators, as well as the ability to delegate access to GPOs in the production environment.\n\n-   An archive to enable Group Policy administrators to create and modify GPOs offline before deploying them to a production environment.\n\n-   The ability to roll back to any previous version of a GPO in the archive and to limit the number of versions stored in the archive.\n\n-   Check-in/check-out capability for GPOs to ensure that Group Policy administrators do not inadvertently overwrite each other's work.\n\n## AGPM scenario overview\n\n\nFor this scenario, you will use a separate user account for each role in AGPM to demonstrate how Group Policy can be managed in an environment with multiple Group Policy administrators who have different levels of permissions. Specifically, you will perform the following tasks:\n\n-   Using an account that is a member of the Domain Admins group, install AGPM Server and assign the AGPM Administrator role to an account or group.\n\n-   Using accounts to which you will assign AGPM roles, install AGPM Client.\n\n-   Using an account with the AGPM Administrator role, configure AGPM and delegate access to GPOs by assigning roles to other accounts.\n\n-   Using an account with the Editor role, request the creation of a GPO, which you then approve using an account with the Approver role. With the Editor account, check the GPO out of the archive, edit the GPO, check the GPO into the archive, and request deployment.\n\n-   Using an account with the Approver role, review the GPO and deploy it to your production environment.\n\n-   Using an account with the Editor role, create a GPO template and use it as a starting point to create a new GPO.\n\n-   Using an account with the Approver role, delete and restore a GPO.\n\n![group policy object development process](images/ab77a1f3-f430-4e7d-be58-ee8f9bd1140e.gif)\n\n## Requirements\n\n\nComputers on which you want to install AGPM must meet the following requirements, and you must create accounts for use in this scenario.\n\n**Note**  \nIf you have AGPM 2.5 installed and are upgrading from Windows Server® 2003 to Windows Server 2008 or Windows Vista® with no service packs installed to Windows Vista with Service Pack 1, you must upgrade the operating system before you can upgrade to AGPM 3.0.\n\n \n\n### AGPM Server requirements\n\nAGPM Server 3.0 requires Windows Server 2008 or Windows Vista with Service Pack 1 and the GPMC from Remote Server Administration Tools (RSAT) installed. Both 32-bit and 64-bit versions are supported.\n\nBefore you install AGPM Server, you must be a member of the Domain Admins group and the following Windows features must be present unless otherwise noted:\n\n-   GPMC\n\n    -   Windows Server 2008: The GPMC is automatically installed by AGPM if not present.\n\n    -   Windows Vista: You must install the GPMC from RSAT before you install AGPM. For more information, see <http://go.microsoft.com/fwlink/?LinkID=116179>.\n\n-   .NET Framework 3.5\n\nThe following Windows features are required by AGPM Server and will be automatically installed if not present:\n\n-   WCF Activation; Non-HTTP Activation\n\n-   Windows Process Activation Service\n\n    -   Process Model\n\n    -   .NET Environment\n\n    -   Configuration APIs\n\n### AGPM Client requirements\n\nAGPM Client 3.0 requires Windows Server 2008 or Windows Vista with Service Pack 1 and the GPMC from Remote Server Administration Tools (RSAT) installed. Both 32-bit and 64-bit versions are supported. AGPM Client can be installed on a computer running AGPM Server.\n\nThe following Windows features are required by AGPM Client and will be automatically installed if not present unless otherwise noted:\n\n-   GPMC\n\n    -   Windows Server 2008: The GPMC is automatically installed by AGPM if not present.\n\n    -   Windows Vista: You must install the GPMC from RSAT before you install AGPM. For more information, see <http://go.microsoft.com/fwlink/?LinkID=116179>.\n\n-   .NET Framework 3.0\n\n### Scenario requirements\n\nBefore you begin this scenario, create four user accounts. During the scenario, you will assign one of the following AGPM roles to each of these accounts: AGPM Administrator (Full Control), Approver, Editor, and Reviewer. These accounts must be able to send and receive e-mail messages. Assign **Link GPOs** permission to the accounts with the AGPM Administrator, Approver, and (optionally) Editor roles.\n\n**Note**  \n**Link GPOs** permission is assigned to members of Domain Administrators and Enterprise Administrators by default. To assign **Link GPOs** permission to additional users or groups (such as accounts with the roles of AGPM Administrator or Approver), click the node for the domain and then click the **Delegation** tab, select **Link GPOs**, click **Add**, and select users or groups to which to assign the permission.\n\n \n\n## Steps for installing and configuring AGPM\n\n\nYou must complete the following steps to install and configure AGPM.\n\n[Step 1: Install AGPM Server](#bkmk-config1)\n\n[Step 2: Install AGPM Client](#bkmk-config2)\n\n[Step 3: Configure an AGPM Server connection](#bkmk-config3)\n\n[Step 4: Configure e-mail notification](#bkmk-config4)\n\n[Step 5: Delegate access](#bkmk-config5)\n\n### <a href=\"\" id=\"bkmk-config1\"></a>Step 1: Install AGPM Server\n\nIn this step, you install AGPM Server on the member server or domain controller that will run the AGPM Service, and you configure the archive. All AGPM operations are managed through this Windows service and are executed with the service's credentials. The archive managed by an AGPM Server can be hosted on that server or on another server in the same forest.\n\n**To install AGPM Server on the computer that will host the AGPM Service**\n\n1.  Log on with an account that is a member of the Domain Admins group.\n\n2.  Start the Microsoft Desktop Optimization Pack CD and follow the instructions on screen to select **Advanced Group Policy Management - Server**.\n\n3.  In the **Welcome** dialog box, click **Next**.\n\n4.  In the **Microsoft Software License Terms** dialog box, accept the terms and click **Next**.\n\n5.  In the **Application Path** dialog box, select a location in which to install AGPM Server. The computer on which AGPM Server is installed will host the AGPM Service and manage the archive. Click **Next**.\n\n6.  In the **Archive Path** dialog box, select a location for the archive relative to the AGPM Server. The archive path can point to a folder on the AGPM Server or elsewhere, but you should select a location with sufficient space to store all GPOs and history data managed by this AGPM Server. Click **Next**.\n\n7.  In the **AGPM Service Account** dialog box, select a service account under which the AGPM Service will run and then click **Next**.\n\n8.  In the **Archive Owner** dialog box, select an account or group to which to initially assign the AGPM Administrator (Full Control) role. This AGPM Administrator can assign AGPM roles and permissions to other Group Policy administrators (including the role of AGPM Administrator). For this scenario, select the account to serve in the AGPM Administrator role. Click **Next**.\n\n9.  In the **Port Configuration** dialog box, type a port on which the AGPM Service should listen. Do not clear the **Add port exception to firewall** check box unless you manually configure port exceptions or use rules to configure port exceptions. Click **Next**.\n\n10. In the **Languages** dialog box, select one or more display languages to install for AGPM Server.\n\n11. Click **Install**, and then click **Finish** to exit the Setup Wizard.\n\n    **Caution**  \n    Do not modify settings for the AGPM Service through **Administrative Tools** and **Services** in the operating system. Doing so can prevent the AGPM Service from starting. For information on how to modify settings for the service, see Help for Advanced Group Policy Management.\n\n     \n\n### <a href=\"\" id=\"bkmk-config2\"></a>Step 2: Install AGPM Client\n\nEach Group Policy administrator—anyone who creates, edits, deploys, reviews, or deletes GPOs—must have AGPM Client installed on computers that they use to manage GPOs. For this scenario, you install AGPM Client on at least one computer. You do not need to install AGPM Client on the computers of end users who do not perform Group Policy administration.\n\n**To install AGPM Client on the computer of a Group Policy administrator**\n\n1.  Start the Microsoft Desktop Optimization Pack CD and follow the instructions on screen to select **Advanced Group Policy Management - Client**.\n\n2.  In the **Welcome** dialog box, click **Next**.\n\n3.  In the **Microsoft Software License Terms** dialog box, accept the terms and click **Next**.\n\n4.  In the **Application Path** dialog box, select a location in which to install AGPM Client. Click **Next**.\n\n5.  In the **AGPM Server** dialog box, type the fully-qualified computer name for the AGPM Server and the port to which to connect. The default port for the AGPM Service is 4600. Do not clear the **Allow Microsoft Management Console through the firewall** check box unless you manually configure port exceptions or use rules to configure port exceptions. Click **Next**.\n\n6.  In the **Languages** dialog box, select one or more display languages to install for AGPM Client.\n\n7.  Click **Install**, and then click **Finish** to exit the Setup Wizard.\n\n### <a href=\"\" id=\"bkmk-config3\"></a>Step 3: Configure an AGPM Server connection\n\nAGPM stores all versions of each controlled Group Policy object (GPO)—a GPO for which AGPM provides change control—in a central archive, so Group Policy administrators can view and modify GPOs offline without immediately impacting the deployed version of each GPO.\n\nIn this step, you configure an AGPM Server connection and ensure that all Group Policy administrators connect to the same AGPM Server. (For information about configuring multiple AGPM Servers, see Help for Advanced Group Policy Management.)\n\n**To configure an AGPM Server connection for all Group Policy administrators**\n\n1.  On a computer on which you have installed AGPM Client, log on with the user account that you selected as the Archive Owner. This user has the role of AGPM Administrator (Full Control).\n\n2.  Click **Start**, point to **Administrative Tools**, and click **Group Policy Management** to open the GPMC.\n\n3.  Edit a GPO that is applied to all Group Policy administrators.\n\n4.  In the **Group Policy Management Editor** window, double-click **User Configuration**, **Policies**, **Administrative Templates**, **Windows Components**, and **AGPM**.\n\n5.  In the details pane, double-click **AGPM: Specify default AGPM Server (all domains)**.\n\n6.  In the **Properties** window, select **Enabled** and type the fully-qualified computer name and port (for example, **server.contoso.com:4600**) for the server hosting the archive. By default, the AGPM Service uses port 4600.\n\n7.  Click **OK**, and then close the **Group Policy Management Editor** window. When Group Policy is updated, the AGPM Server connection is configured for each Group Policy administrator.\n\n### <a href=\"\" id=\"bkmk-config4\"></a>Step 4: Configure e-mail notification\n\nAs an AGPM Administrator (Full Control), you designate the e-mail addresses of Approvers and AGPM Administrators to whom an e-mail message containing a request is sent when an Editor attempts to create, deploy, or delete a GPO. You also determine the alias from which these messages are sent.\n\n**To configure e-mail notification for AGPM**\n\n1.  In the details pane, click the **Domain Delegation** tab.\n\n2.  In the **From e-mail address** field, type the e-mail alias for AGPM from which notifications should be sent.\n\n3.  In the **To e-mail address** field, type the e-mail address for the user account to which you intend to assign the Approver role.\n\n4.  In the **SMTP server** field, type a valid SMTP mail server.\n\n5.  In the **User name** and **Password** fields, type the credentials of a user with access to the SMTP service. Click **Apply**.\n\n### <a href=\"\" id=\"bkmk-config5\"></a>Step 5: Delegate access\n\nAs an AGPM Administrator (Full Control), you delegate domain-level access to GPOs, assigning roles to the account of each Group Policy administrator.\n\n**Note**  \nYou can also delegate access at the GPO level rather than the domain level. For details, see Help for Advanced Group Policy Management.\n\n \n\n**Important**  \nYou should restrict membership in the Group Policy Creator Owners group, so it cannot be used to circumvent AGPM management of access to GPOs. (In the **Group Policy Management Console**, click **Group Policy Objects** in the forest and domain in which you want to manage GPOs, click **Delegation**, and then configure the settings to meet the needs of your organization.)\n\n \n\n**To delegate access to all GPOs throughout a domain**\n\n1.  On the **Domain Delegation** tab, click the **Add** button, select the user account of the Group Policy administrator to serve as Approver, and then click **OK**.\n\n2.  In the **Add Group or User** dialog box, select the **Approver** role to assign that role to the account, and then click **OK**. (This role includes the Reviewer role.)\n\n3.  Click the **Add** button, select the user account of the Group Policy administrator to serve as Editor, and then click **OK**.\n\n4.  In the **Add Group or User** dialog box, select the **Editor** role to assign that role to the account, and then click **OK**. (This role includes the Reviewer role.)\n\n5.  Click the **Add** button, select the user account of the Group Policy administrator to serve as Reviewer, and then click **OK**.\n\n6.  In the **Add Group or User** dialog box, select the **Reviewer** role to assign only that role to the account.\n\n## Steps for managing GPOs\n\n\nYou must complete the following steps to create, edit, review, and deploy GPOs using AGPM. Additionally, you will create a template, delete a GPO, and restore a deleted GPO.\n\n[Step 1: Create a GPO](#bkmk-manage1)\n\n[Step 2: Edit a GPO](#bkmk-manage2)\n\n[Step 3: Review and deploy a GPO](#bkmk-manage3)\n\n[Step 4: Use a template to create a GPO](#bkmk-manage4)\n\n[Step 5: Delete and restore a GPO](#bkmk-manage5)\n\n### <a href=\"\" id=\"bkmk-manage1\"></a>Step 1: Create a GPO\n\nIn an environment with multiple Group Policy administrators, those with the Editor role have the ability to request the creation of new GPOs, but such a request must be approved by someone with the Approver role because the creation of a new GPO impacts the production environment.\n\nIn this step, you use an account with the Editor role to request the creation of a new GPO. Using an account with the Approver role, you approve this request and complete the creation of a GPO.\n\n**To request the creation of a new GPO managed through AGPM**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the Editor role in AGPM.\n\n2.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n3.  Right-click the **Change Control** node, and then click **New Controlled GPO**.\n\n4.  In the **New Controlled GPO** dialog box:\n\n    1.  To receive a copy of the request, type your e-mail address in the **Cc** field.\n\n    2.  Type **MyGPO** as the name for the new GPO.\n\n    3.  Type a comment for the new GPO.\n\n    4.  Click **Create live** so the new GPO will be deployed to the production environment immediately upon approval. Click **Submit**.\n\n5.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The new GPO is displayed on the **Pending** tab.\n\n**To approve the pending request to create a GPO**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Approver in AGPM.\n\n2.  Open the e-mail inbox for the account, and note that you have received an e-mail message from the AGPM alias with the Editor's request to create a GPO.\n\n3.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n4.  On the **Contents** tab, click the **Pending** tab to display the pending GPOs.\n\n5.  Right-click **MyGPO**, and then click **Approve**.\n\n6.  Click **Yes** to confirm approval of the creation of the GPO. The GPO is moved to the **Controlled** tab.\n\n### <a href=\"\" id=\"bkmk-manage2\"></a>Step 2: Edit a GPO\n\nYou can use GPOs to configure computer or user settings and deploy them to many computers or users. In this step, you use an account with the Editor role to check out a GPO from the archive, edit the GPO offline, check the edited GPO into the archive, and request deployment of the GPO to the production environment. For this scenario, you configure a setting in the GPO to require that the password be at least eight characters in length.\n\n**To check the GPO out from the archive for editing**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Editor in AGPM.\n\n2.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n3.  On the **Contents** tab in the details pane, click the **Controlled** tab to display the controlled GPOs.\n\n4.  Right-click **MyGPO**, and then click **Check Out**.\n\n5.  Type a comment to be displayed in the history of the GPO while it is checked out, and then click **OK**.\n\n6.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. On the **Controlled** tab, the state of the GPO is identified as **Checked Out**.\n\n**To edit the GPO offline and configure the minimum password length**\n\n1.  On the **Controlled** tab, right-click **MyGPO**, and then click **Edit** to open the **Group Policy Management Editor** window and make changes to an offline copy of the GPO. For this scenario, configure the minimum password length:\n\n    1.  Under **Computer Configuration**, double-click **Policies**, **Windows Settings**, **Security Settings**, **Account Policies**, and **Password Policy**.\n\n    2.  In the details pane, double-click **Minimum password length**.\n\n    3.  In the properties window, select the **Define this policy setting** check box, set the number of characters to **8**, and then click **OK**.\n\n2.  Close the **Group Policy Management Editor** window.\n\n**To check the GPO into the archive**\n\n1.  On the **Controlled** tab, right-click **MyGPO** and then click **Check In**.\n\n2.  Type a comment, and then click **OK**.\n\n3.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. On the **Controlled** tab, the state of the GPO is identified as **Checked In**.\n\n**To request the deployment of the GPO to the production environment**\n\n1.  On the **Controlled** tab, right-click **MyGPO** and then click **Deploy**.\n\n2.  Because this account is not an Approver or AGPM Administrator, you must submit a request for deployment. To receive a copy of the request, type your e-mail address in the **Cc** field. Type a comment to be displayed in the history of the GPO, and then click **Submit**.\n\n3.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. **MyGPO** is displayed on the list of GPOs on the **Pending** tab.\n\n### <a href=\"\" id=\"bkmk-manage3\"></a>Step 3: Review and deploy a GPO\n\nIn this step, you act as an Approver, creating reports and analyzing the settings and changes to settings in the GPO to determine whether you should approve them. After evaluating the GPO, you deploy it to the production environment and link it to a domain or an organizational unit (OU) so that it takes effect when Group Policy is refreshed for computers in that domain or OU.\n\n**To review settings in the GPO**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Approver in AGPM. (Any Group Policy administrator with the Reviewer role, which is included in all of the other roles, can review the settings in a GPO.)\n\n2.  Open the e-mail inbox for the account and note that you have received an e-mail message from the AGPM alias with an Editor's request to deploy a GPO.\n\n3.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n4.  On the **Contents** tab in the details pane, click the **Pending** tab.\n\n5.  Double-click **MyGPO** to display its history.\n\n6.  Review the settings in the most recent version of MyGPO:\n\n    1.  In the **History** window, right-click the GPO version with the most recent timestamp, click **Settings**, and then click **HTML Report** to display a summary of the GPO's settings.\n\n    2.  In the Web browser, click **show all** to display all of the settings in the GPO. Close the browser.\n\n7.  Compare the most recent version of MyGPO to the first version checked in to the archive:\n\n    1.  In the **History** window, click the GPO version with the most recent time stamp. Press CTRL and click the oldest GPO version for which the **Computer Version** is not **\\***.\n\n    2.  Click the **Differences** button. The **Account Policies/Password Policy** section is highlighted in green and preceded by **\\[+\\]**, indicating that this setting is configured only in the latter version of the GPO.\n\n    3.  Click **Account Policies/Password Policy**. The **Minimum password length** setting is also highlighted in green and preceded by **\\[+\\]**, indicating that it is configured only in the latter version of the GPO.\n\n    4.  Close the Web browser.\n\n**To deploy the GPO to the production environment**\n\n1.  On the **Pending** tab, right-click **MyGPO** and then click **Approve**.\n\n2.  Type a comment to include in the history of the GPO.\n\n3.  Click **Yes**. When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The GPO is deployed to the production environment.\n\n**To link the GPO to a domain or organizational unit**\n\n1.  In the GPMC, right-click the domain or an OU to which to apply the GPO that you configured, and then click **Link an Existing GPO**.\n\n2.  In the **Select GPO** dialog box, click **MyGPO**, and then click **OK**.\n\n### <a href=\"\" id=\"bkmk-manage4\"></a>Step 4: Use a template to create a GPO\n\nIn this step, you use an account with the Editor role to create a template—an uneditable, static version of a GPO for use as a starting point for creating new GPOs—and then create a new GPO based upon that template. Templates are useful for quickly creating multiple GPOs that include many of the same settings.\n\n**To create a template based on an existing GPO**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Editor in AGPM.\n\n2.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n3.  On the **Contents** tab in the details pane, click the **Controlled** tab.\n\n4.  Right-click **MyGPO**, and then click **Save as Template** to create a template incorporating all settings currently in MyGPO.\n\n5.  Type **MyTemplate** as the name for the template and a comment, and then click **OK**.\n\n6.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The new template appears on the **Templates** tab.\n\n**To request the creation of a new GPO managed through AGPM**\n\n1.  Click the **Controlled** tab.\n\n2.  Right-click the **Change Control** node, and then click **New Controlled GPO**.\n\n3.  In the **New Controlled GPO** dialog box:\n\n    1.  To receive a copy of the request, type your e-mail address in the **Cc** field.\n\n    2.  Type **MyOtherGPO** as the name for the new GPO.\n\n    3.  Type a comment for the new GPO.\n\n    4.  Click **Create live**, so the new GPO will be deployed to the production environment immediately upon approval.\n\n    5.  For **From GPO template**, select **MyTemplate**. Click **Submit**.\n\n4.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The new GPO is displayed on the **Pending** tab.\n\nUse an account that has been assigned the role of Approver to approve the pending request to create the GPO as you did in [Step 1: Create a GPO](#bkmk-manage1). MyTemplate incorporates all of the settings that you configured in MyGPO. Because MyOtherGPO was created using MyTemplate, it initially contains all of the settings that MyGPO contained at the time that MyTemplate was created. You can confirm this by generating a difference report to compare MyOtherGPO to MyTemplate.\n\n**To check the GPO out from the archive for editing**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Editor in AGPM.\n\n2.  Right-click **MyOtherGPO**, and then click **Check Out**.\n\n3.  Type a comment to be displayed in the history of the GPO while it is checked out, and then click **OK**.\n\n4.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. On the **Controlled** tab, the state of the GPO is identified as **Checked Out**.\n\n**To edit the GPO offline and configure the account lockout duration**\n\n1.  On the **Controlled** tab, right-click **MyOtherGPO**, and then click **Edit** to open the **Group Policy Management Editor** window and make changes to an offline copy of the GPO. For this scenario, configure the minimum password length:\n\n    1.  Under **Computer Configuration**, double-click **Policies**, **Windows Settings**, **Security Settings**, **Account Policies**, and **Account Lockout Policy**.\n\n    2.  In the details pane, double-click **Account lockout duration**.\n\n    3.  In the properties window, check **Define this policy setting**, set the duration to **30** minutes, and then click **OK**.\n\n2.  Close the **Group Policy Management Editor** window.\n\nCheck MyOtherGPO into the archive and request deployment as you did for MyGPO in [Step 2: Edit a GPO](#bkmk-manage2). You can compare MyOtherGPO to MyGPO or to MyTemplate using difference reports. Any account that includes the Reviewer role (AGPM Administrator \\[Full Control\\], Approver, Editor, or Reviewer) can generate reports.\n\n**To compare a GPO to another GPO and to a template**\n\n1.  To compare MyGPO and MyOtherGPO:\n\n    1.  On the **Controlled** tab, click **MyGPO**. Press CTRL and then click **MyOtherGPO**.\n\n    2.  Right-click **MyOtherGPO**, point to **Differences**, and click **HTML Report**.\n\n2.  To compare MyOtherGPO and MyTemplate:\n\n    1.  On the **Controlled** tab, click **MyOtherGPO**.\n\n    2.  Right-click **MyOtherGPO**, point to **Differences**, and click **Template**.\n\n    3.  Select **MyTemplate** and **HTML Report**, and then click **OK**.\n\n### <a href=\"\" id=\"bkmk-manage5\"></a>Step 5: Delete and restore a GPO\n\nIn this step, you act as an Approver to delete a GPO.\n\n**To delete a GPO**\n\n1.  On a computer on which you have installed AGPM Client, log on with a user account that has been assigned the role of Approver.\n\n2.  In the **Group Policy Management Console** tree, click **Change Control** in the forest and domain in which you want to manage GPOs.\n\n3.  On the **Contents** tab, click the **Controlled** tab to display the controlled GPOs.\n\n4.  Right-click **MyGPO**, and then click **Delete**. Click **Delete GPO from archive and production** to delete both the version in the archive as well as the deployed version of the GPO in the production environment.\n\n5.  Type a comment to be displayed in the audit trail for the GPO, and then click **OK**.\n\n6.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The GPO is removed from the **Controlled** tab and is displayed on the **Recycle Bin** tab, where it can be restored or destroyed.\n\nOccasionally you may discover after deleting a GPO that it is still needed. In this step, you act as an Approver to restore a GPO that has been deleted.\n\n**To restore a deleted GPO**\n\n1.  On the **Contents** tab, click the **Recycle Bin** tab to display deleted GPOs.\n\n2.  Right-click **MyGPO**, and then click **Restore**.\n\n3.  Type a comment to be displayed in the history of the GPO, and then click **OK**.\n\n4.  When the **AGPM Progress** window indicates that overall progress is complete, click **Close**. The GPO is removed from the **Recycle Bin** tab and is displayed on the **Controlled** tab.\n\n    **Note**  \n    Restoring a GPO to the archive does not automatically redeploy it to the production environment. To return the GPO to the production environment, deploy the GPO as in [Step 3: Review and deploy a GPO](#bkmk-manage3).\n\n     \n\nAfter editing and deploying a GPO, you may discover that recent changes to the GPO are causing a problem. In this step, you act as an Approver to roll back to a previous version of the GPO. You can roll back to any version in the history of the GPO. You can use comments and labels to identify known good versions and when specific changes were made.\n\n**To roll back to a previous version of a GPO**\n\n1.  On the **Contents** tab, click the **Controlled** tab to display the controlled GPOs.\n\n2.  Double-click **MyGPO** to display its history.\n\n3.  Right-click the version to be deployed, click **Deploy**, and then click **Yes**.\n\n4.  When the **Progress** window indicates that overall progress is complete, click **Close**. In the **History** window, click **Close**.\n\n    **Note**  \n    To verify that the version that has been redeployed is the version intended, examine a difference report for the two versions. In the **History** window for the GPO, select the two versions, right-click them, point to **Difference**, and then click either **HTML Report** or **XML Report**.\n\n     \n\n \n\n \n\n\n\n\n\n"}