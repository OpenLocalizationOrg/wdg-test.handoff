{"nodes":[{"content":"Create WMI Filters for the GPO (Windows 10)","pos":[11,54]},{"content":"Create WMI Filters for the GPO","pos":[68,98]},{"content":"Create WMI Filters for the GPO","pos":[254,284]},{"content":"Applies to","pos":[288,298]},{"content":"Windows 10","pos":[305,315]},{"content":"Windows Server 2016 Technical Preview","pos":[320,357]},{"content":"To make sure that each GPO associated with a group can only be applied to devices running the correct version of Windows, use the Group Policy Management MMC snap-in to create and assign WMI filters to the GPO.","pos":[359,569]},{"content":"Although you can create a separate membership group for each GPO, you would then have to manage the memberships of the different groups.","pos":[570,706]},{"content":"Instead, use only a single membership group, and let WMI filters automatically ensure the correct GPO is applied to each device.","pos":[707,835]},{"content":"To create a WMI filter that queries for a specified version of Windows","pos":[842,912]},{"content":"To link a WMI filter to a GPO","pos":[993,1022]},{"content":"Administrative credentials","pos":[1059,1085]},{"content":"To complete these procedures, you must be a member of the Domain Administrators group, or otherwise be delegated permissions to modify the GPOs.","pos":[1089,1233]},{"content":"First, create the WMI filter and configure it to look for a specified version (or versions) of the Windows operating system.","pos":[1235,1359]},{"content":"To create a WMI filter that queries for a specified version of Windows","pos":[1364,1434]},{"content":"Open the Group Policy Management console.","pos":[1440,1481]},{"pos":[1487,1624],"content":"In the navigation pane, expand <bpt id=\"p1\">**</bpt>Forest:<ept id=\"p1\">**</ept> <bpt id=\"p2\">*</bpt>YourForestName<ept id=\"p2\">*</ept>, expand <bpt id=\"p3\">**</bpt>Domains<ept id=\"p3\">**</ept>, expand <bpt id=\"p4\">*</bpt>YourDomainName<ept id=\"p4\">*</ept>, and then click <bpt id=\"p5\">**</bpt>WMI Filters<ept id=\"p5\">**</ept>."},{"pos":[1630,1671],"content":"Click <bpt id=\"p1\">**</bpt>Action<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>New<ept id=\"p2\">**</ept>."},{"pos":[1677,1735],"content":"In the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> text box, type the name of the WMI filter."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  Be sure to use a name that clearly indicates the purpose of the filter.","pos":[1742,1824]},{"content":"Check to see if your organization has a naming convention.","pos":[1825,1883]},{"content":"In the <bpt id=\"p1\">**</bpt>Description<ept id=\"p1\">**</ept> text box, type a description for the WMI filter.","pos":[1889,1960]},{"content":"For example, if the filter excludes domain controllers, you might consider stating that in the description.","pos":[1961,2068]},{"pos":[2074,2088],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>."},{"pos":[2094,2147],"content":"Leave the <bpt id=\"p1\">**</bpt>Namespace<ept id=\"p1\">**</ept> value set to <bpt id=\"p2\">**</bpt>root<ph id=\"ph1\">\\\\</ph>CIMv2<ept id=\"p2\">**</ept>."},{"pos":[2153,2185],"content":"In the <bpt id=\"p1\">**</bpt>Query<ept id=\"p1\">**</ept> text box, type:"},{"content":"This query will return <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> for devices running at least Windows Vista and Windows Server 2008.","pos":[2280,2379]},{"content":"To set a filter for just Windows 8 and Windows Server 2012, use \"6.2%\".","pos":[2380,2451]},{"content":"To specify multiple versions, combine them with or, as shown in the following:","pos":[2452,2530]},{"content":"To restrict the query to only clients or only servers, add a clause that includes the ProductType parameter.","pos":[2617,2725]},{"content":"To filter for client operating systems only, such as Windows 8 or Windows 7, use only ProductType=\"1\".","pos":[2726,2828]},{"content":"For server operating systems that are not domain controllers, use ProductType=\"3\".","pos":[2829,2911]},{"content":"For domain controllers only, use ProductType=\"2\".","pos":[2912,2961]},{"content":"This is a useful distinction, because you often want to prevent your GPOs from being applied to the domain controllers on your network.","pos":[2962,3097]},{"pos":[3103,3189],"content":"The following clause returns <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> for all devices that are not domain controllers:"},{"pos":[3268,3440],"content":"The following complete query returns <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> for all devices running Windows 8, and returns <bpt id=\"p2\">**</bpt>false<ept id=\"p2\">**</ept> for any server operating system or any other client operating system."},{"pos":[3556,3663],"content":"The following query returns <bpt id=\"p1\">**</bpt>true<ept id=\"p1\">**</ept> for any device running Windows Server 2012, except domain controllers:"},{"pos":[3779,3824],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to save the query to the filter."},{"pos":[3830,3875],"content":"Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> to save your completed filter."},{"content":"To link a WMI filter to a GPO","pos":[3880,3909]},{"content":"After you have created a filter with the correct query, link the filter to the GPO.","pos":[3911,3994]},{"content":"Filters can be reused with many GPOs simultaneously; you do not have to create a new one for each GPO if an existing one meets your needs.","pos":[3995,4133]},{"content":"Open theGroup Policy Management console.","pos":[4139,4179]},{"content":"In the navigation pane, find and then click the GPO that you want to modify.","pos":[4185,4261]},{"pos":[4267,4336],"content":"Under <bpt id=\"p1\">**</bpt>WMI Filtering<ept id=\"p1\">**</ept>, select the correct WMI filter from the list."},{"pos":[4342,4377],"content":"Click <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept> to accept the filter."}],"content":"---\ntitle: Create WMI Filters for the GPO (Windows 10)\ndescription: Create WMI Filters for the GPO\nms.assetid: b1a6d93d-a3c8-4e61-a388-4a3323f0e74e\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Create WMI Filters for the GPO\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016 Technical Preview\n\nTo make sure that each GPO associated with a group can only be applied to devices running the correct version of Windows, use the Group Policy Management MMC snap-in to create and assign WMI filters to the GPO. Although you can create a separate membership group for each GPO, you would then have to manage the memberships of the different groups. Instead, use only a single membership group, and let WMI filters automatically ensure the correct GPO is applied to each device.\n\n-   [To create a WMI filter that queries for a specified version of Windows](#to-create-a-wmi-filter-that-queries-for-a-specified-version-of-windows)\n\n-   [To link a WMI filter to a GPO](#to-link-a-wmi-filter-to-a-gpo)\n\n**Administrative credentials**\n\nTo complete these procedures, you must be a member of the Domain Administrators group, or otherwise be delegated permissions to modify the GPOs.\n\nFirst, create the WMI filter and configure it to look for a specified version (or versions) of the Windows operating system.\n\n## To create a WMI filter that queries for a specified version of Windows\n\n1.  Open the Group Policy Management console.\n\n2.  In the navigation pane, expand **Forest:** *YourForestName*, expand **Domains**, expand *YourDomainName*, and then click **WMI Filters**.\n\n3.  Click **Action**, and then click **New**.\n\n4.  In the **Name** text box, type the name of the WMI filter.\n\n    >**Note:**  Be sure to use a name that clearly indicates the purpose of the filter. Check to see if your organization has a naming convention.\n\n5.  In the **Description** text box, type a description for the WMI filter. For example, if the filter excludes domain controllers, you might consider stating that in the description.\n\n6.  Click **Add**.\n\n7.  Leave the **Namespace** value set to **root\\\\CIMv2**.\n\n8.  In the **Query** text box, type:\n\n    ``` syntax\n    select * from Win32_OperatingSystem where Version like \"6.%\"\n    ```\n\n    This query will return **true** for devices running at least Windows Vista and Windows Server 2008. To set a filter for just Windows 8 and Windows Server 2012, use \"6.2%\". To specify multiple versions, combine them with or, as shown in the following:\n\n    ``` syntax\n    ... where Version like \"6.1%\" or Version like \"6.2%\"\n    ```\n\n    To restrict the query to only clients or only servers, add a clause that includes the ProductType parameter. To filter for client operating systems only, such as Windows 8 or Windows 7, use only ProductType=\"1\". For server operating systems that are not domain controllers, use ProductType=\"3\". For domain controllers only, use ProductType=\"2\". This is a useful distinction, because you often want to prevent your GPOs from being applied to the domain controllers on your network.\n\n    The following clause returns **true** for all devices that are not domain controllers:\n\n    ``` syntax\n    ... where ProductType=\"1\" or ProductType=\"3\"\n    ```\n\n    The following complete query returns **true** for all devices running Windows 8, and returns **false** for any server operating system or any other client operating system.\n\n    ``` syntax\n    select * from Win32_OperatingSystem where Version like \"6.2%\" and ProductType=\"1\"\n    ```\n\n    The following query returns **true** for any device running Windows Server 2012, except domain controllers:\n\n    ``` syntax\n    select * from Win32_OperatingSystem where Version like \"6.2%\" and ProductType=\"3\"\n    ```\n\n9.  Click **OK** to save the query to the filter.\n\n10. Click **Save** to save your completed filter.\n\n## To link a WMI filter to a GPO\n\nAfter you have created a filter with the correct query, link the filter to the GPO. Filters can be reused with many GPOs simultaneously; you do not have to create a new one for each GPO if an existing one meets your needs.\n\n1.  Open theGroup Policy Management console.\n\n2.  In the navigation pane, find and then click the GPO that you want to modify.\n\n3.  Under **WMI Filtering**, select the correct WMI filter from the list.\n\n4.  Click **Yes** to accept the filter.\n"}