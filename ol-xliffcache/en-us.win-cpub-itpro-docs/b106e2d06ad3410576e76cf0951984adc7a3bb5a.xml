{"nodes":[{"content":"Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI","pos":[11,89]},{"content":"Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI","pos":[103,181]},{"content":"Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI","pos":[345,423]},{"content":"Microsoft User Experience Virtualization (UE-V) 2.0, 2.1, and 2.1 SP1 use XML settings location templates to define the settings that User Experience Virtualization captures and applies.","pos":[426,612]},{"content":"UE-V includes a set of standard settings location templates.","pos":[613,673]},{"content":"It also includes the UE-V Generator tool that enables you to create custom settings location templates.","pos":[674,777]},{"content":"After you create and deploy settings location templates, you can manage those templates by using Windows PowerShell and the Windows Management Instrumentation (WMI).","pos":[778,943]},{"content":"For a complete list of UE-V PowerShell cmdlets, see <bpt id=\"p1\">[</bpt>UE-V 2 Cmdlet Reference<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=393495)</ept> (http://go.microsoft.com/fwlink/p/?LinkId=393495).","pos":[944,1121]},{"content":"Manage UE-V 2 settings location templates by using Windows PowerShell","pos":[1126,1195]},{"content":"The WMI and Windows PowerShell features of UE-V include the ability to enable, disable, register, update, and unregister settings location templates.","pos":[1198,1347]},{"content":"By using these features, you can automate the process of registering, updating, or unregistering templates with the UE-V Agent.","pos":[1348,1475]},{"content":"You can also manually register templates by using WMI and Windows PowerShell commands.","pos":[1476,1562]},{"content":"By using these features in conjunction with an electronic software distribution solution, Group Policy, or another automated deployment method such as a script, you can further automate that process.","pos":[1563,1762]},{"content":"You must have administrator permissions to update, register, or unregister a settings location template.","pos":[1764,1868]},{"content":"Administrator permissions are not required to enable, disable, or list templates.","pos":[1869,1950]},{"content":"****To manage settings location templates by using Windows PowerShell****","pos":[1952,2025]},{"content":"Use an account with administrator rights to open a Windows PowerShell command prompt.","pos":[2031,2116]},{"content":"Use the following Windows PowerShell cmdlets to register and manage the UE-V settings location templates.","pos":[2122,2227]},{"pos":[2233,10566],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Windows PowerShell command</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Get-UevTemplate</code></p></td>\n<td align=\"left\"><p>Lists all the settings location templates that are registered on the computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Get-UevTemplate –Application &lt;string&gt;</code></p></td>\n<td align=\"left\"><p>Lists all the settings location templates that are registered on the computer where the application name or template name contains &lt;string&gt;.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Get-UevTemplate –TemplateID &lt;string&gt;</code></p></td>\n<td align=\"left\"><p>Lists all the settings location templates that are registered on the computer where the template ID contains &lt;string&gt;.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Get-UevTemplate [-ApplicationOrTemplateID] &lt;string&gt;</code></p></td>\n<td align=\"left\"><p>Lists all the settings location templates that are registered on the computer where the application or template name, or template ID contains &lt;string&gt;.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Get-UevTemplateProgram [-ID] &lt;template ID&gt;</code></p></td>\n<td align=\"left\"><p>Gets the name of the program and version information, which depend on the template ID.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Get-UevAppXPackage</code></p></td>\n<td align=\"left\"><p>Gets the effective list of Windows apps.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Get-UevAppXPackage -Computer</code></p></td>\n<td align=\"left\"><p>Gets the list of Windows apps that are configured for the computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Get-UevAppXPackage -CurrentComputerUser</code></p></td>\n<td align=\"left\"><p>Gets the list of Windows apps that are configured for the current user.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Register-UevTemplate [-Path] &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n<td align=\"left\"><p>Registers one or more settings location template with UE-V by using relative paths and/or wildcard characters in file paths. After a template is registered, UE-V synchronizes the settings that are defined in the template between computers that have the template registered.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Register-UevTemplate –LiteralPath &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n<td align=\"left\"><p>Registers one or more settings location template with UE-V by using literal paths, where no characters can be interpreted as wildcard characters. After a template is registered, UE-V synchronizes the settings that are defined in the template between computers that have the template registered.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Unregister-UevTemplate [-ID] &lt;template ID&gt;</code></p></td>\n<td align=\"left\"><p>Unregisters a settings location template with UE-V. When a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Unregister-UevTemplate -All</code></p></td>\n<td align=\"left\"><p>Unregisters all settings location templates with UE-V. When a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Update-UevTemplate [-Path] &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n<td align=\"left\"><p>Updates one or more settings location templates with a more recent version of the template. Use relative paths and/or wildcard characters in the file paths. The new template should be a newer version than the existing template.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Update-UevTemplate –LiteralPath &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n<td align=\"left\"><p>Updates one or more settings location templates with a more recent version of the template. Use full paths to template files, where no characters can be interpreted as wildcard characters. The new template should be a newer version than the existing template.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Clear-UevAppXPackage –Computer [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n<td align=\"left\"><p>Removes one or more Windows apps from the computer Windows app list.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Clear-UevAppXPackage -CurrentComputerUser</code></p></td>\n<td align=\"left\"><p>Removes Windows app from the current user Windows app list.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Clear-UevAppXPackage –Computer -All</code></p></td>\n<td align=\"left\"><p>Removes all Windows apps from the computer Windows app list.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Clear-UevAppXPackage [–CurrentComputerUser] [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n<td align=\"left\"><p>Removes one or more Windows apps from the current user Windows app list.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Clear-UevAppXPackage [–CurrentComputerUser] -All</code></p></td>\n<td align=\"left\"><p>Removes all Windows apps from the current user Windows app list.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Disable-UevTemplate [-ID] &lt;template ID&gt;</code></p></td>\n<td align=\"left\"><p>Disables a settings location template for the current user of the computer.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Disable-UevAppXPackage –Computer [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n<td align=\"left\"><p>Disables one or more Windows apps in the computer Windows app list.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Disable-UevAppXPackage [–CurrentComputerUser] [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n<td align=\"left\"><p>Disables one or more Windows apps in the current user Windows app list.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Enable-UevTemplate [-ID] &lt;template ID&gt;</code></p></td>\n<td align=\"left\"><p>Enables a settings location template for the current user of the computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Enable-UevAppXPackage –Computer [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n<td align=\"left\"><p>Enables one or more Windows apps in the computer Windows app list.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Enable-UevAppXPackage [–CurrentComputerUser] [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n<td align=\"left\"><p>Enables one or more Windows apps in the current user Windows app list.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Test-UevTemplate [-Path] &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n<td align=\"left\"><p>Determines whether one or more settings location templates comply with its XML schema. Can use relative paths and wildcard characters.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Test-UevTemplate –LiteralPath &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n<td align=\"left\"><p>Determines whether one or more settings location templates comply with its XML schema. The path must be a full path to the template file, but does not include wildcard characters.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Windows PowerShell command","pos":[116,142]},{"content":"Description","pos":[165,176]},{"content":"Lists all the settings location templates that are registered on the computer.","pos":[300,378]},{"content":"Lists all the settings location templates that are registered on the computer where the application name or template name contains <ph id=\"ph1\">&amp;lt;</ph>string<ph id=\"ph2\">&amp;gt;</ph>.","pos":[518,664]},{"content":"Lists all the settings location templates that are registered on the computer where the template ID contains <ph id=\"ph1\">&amp;lt;</ph>string<ph id=\"ph2\">&amp;gt;</ph>.","pos":[802,926]},{"content":"Lists all the settings location templates that are registered on the computer where the application or template name, or template ID contains <ph id=\"ph1\">&amp;lt;</ph>string<ph id=\"ph2\">&amp;gt;</ph>.","pos":[1080,1237]},{"content":"Gets the name of the program and version information, which depend on the template ID.","pos":[1381,1467]},{"content":"Gets the effective list of Windows apps.","pos":[1582,1622]},{"content":"Gets the list of Windows apps that are configured for the computer.","pos":[1746,1813]},{"content":"Gets the list of Windows apps that are configured for the current user.","pos":[1949,2020]},{"content":"Registers one or more settings location template with UE-V by using relative paths and/or wildcard characters in file paths. After a template is registered, UE-V synchronizes the settings that are defined in the template between computers that have the template registered.","pos":[2200,2473],"nodes":[{"content":"Registers one or more settings location template with UE-V by using relative paths and/or wildcard characters in file paths.","pos":[0,124]},{"content":"After a template is registered, UE-V synchronizes the settings that are defined in the template between computers that have the template registered.","pos":[125,273]}]},{"content":"Registers one or more settings location template with UE-V by using literal paths, where no characters can be interpreted as wildcard characters. After a template is registered, UE-V synchronizes the settings that are defined in the template between computers that have the template registered.","pos":[2659,2953],"nodes":[{"content":"Registers one or more settings location template with UE-V by using literal paths, where no characters can be interpreted as wildcard characters.","pos":[0,145]},{"content":"After a template is registered, UE-V synchronizes the settings that are defined in the template between computers that have the template registered.","pos":[146,294]}]},{"content":"Unregisters a settings location template with UE-V. When a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.","pos":[3097,3274],"nodes":[{"content":"Unregisters a settings location template with UE-V.","pos":[0,51]},{"content":"When a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.","pos":[52,177]}]},{"content":"Unregisters all settings location templates with UE-V. When a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.","pos":[3398,3578],"nodes":[{"content":"Unregisters all settings location templates with UE-V.","pos":[0,54]},{"content":"When a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.","pos":[55,180]}]},{"content":"Updates one or more settings location templates with a more recent version of the template. Use relative paths and/or wildcard characters in the file paths. The new template should be a newer version than the existing template.","pos":[3756,3983],"nodes":[{"content":"Updates one or more settings location templates with a more recent version of the template.","pos":[0,91]},{"content":"Use relative paths and/or wildcard characters in the file paths.","pos":[92,156]},{"content":"The new template should be a newer version than the existing template.","pos":[157,227]}]},{"content":"Updates one or more settings location templates with a more recent version of the template. Use full paths to template files, where no characters can be interpreted as wildcard characters. The new template should be a newer version than the existing template.","pos":[4167,4426],"nodes":[{"content":"Updates one or more settings location templates with a more recent version of the template.","pos":[0,91]},{"content":"Use full paths to template files, where no characters can be interpreted as wildcard characters.","pos":[92,188]},{"content":"The new template should be a newer version than the existing template.","pos":[189,259]}]},{"content":"Removes one or more Windows apps from the computer Windows app list.","pos":[4631,4699]},{"content":"Removes Windows app from the current user Windows app list.","pos":[4837,4896]},{"content":"Removes all Windows apps from the computer Windows app list.","pos":[5027,5087]},{"content":"Removes one or more Windows apps from the current user Windows app list.","pos":[5306,5378]},{"content":"Removes all Windows apps from the current user Windows app list.","pos":[5522,5586]},{"content":"Disables a settings location template for the current user of the computer.","pos":[5728,5803]},{"content":"Disables one or more Windows apps in the computer Windows app list.","pos":[6010,6077]},{"content":"Disables one or more Windows apps in the current user Windows app list.","pos":[6298,6369]},{"content":"Enables a settings location template for the current user of the computer.","pos":[6509,6583]},{"content":"Enables one or more Windows apps in the computer Windows app list.","pos":[6790,6856]},{"content":"Enables one or more Windows apps in the current user Windows app list.","pos":[7075,7145]},{"content":"Determines whether one or more settings location templates comply with its XML schema. Can use relative paths and wildcard characters.","pos":[7322,7456],"nodes":[{"content":"Determines whether one or more settings location templates comply with its XML schema.","pos":[0,86]},{"content":"Can use relative paths and wildcard characters.","pos":[87,134]}]},{"content":"Determines whether one or more settings location templates comply with its XML schema. The path must be a full path to the template file, but does not include wildcard characters.","pos":[7637,7816],"nodes":[{"content":"Determines whether one or more settings location templates comply with its XML schema.","pos":[0,86]},{"content":"The path must be a full path to the template file, but does not include wildcard characters.","pos":[87,179]}]}]},{"content":"The UE-V Windows PowerShell features enable you to manage a group of settings templates that are deployed in your enterprise.","pos":[10575,10700]},{"content":"Use the following procedure to manage a group of templates by using Windows PowerShell.","pos":[10701,10788]},{"content":"To manage a group of settings location templates by using Windows PowerShell","pos":[10792,10868]},{"content":"Modify or update the desired settings location templates.","pos":[10876,10933]},{"content":"If you want to modify or update the settings location templates, deploy those settings location templates to a folder that is accessible to the local computer.","pos":[10939,11098]},{"content":"On the local computer, open a Windows PowerShell window with administrator rights.","pos":[11104,11186]},{"content":"Unregister all the previously registered versions of the templates by typing the following command.","pos":[11192,11291]},{"content":"This command unregisters all active templates on the computer.","pos":[11353,11415]},{"content":"Register the updated templates by typing the following command.","pos":[11421,11484]},{"content":"This command registers all of the settings location templates that are located in the specified template folder.","pos":[11571,11683]},{"pos":[11721,11737],"content":"Windows app list"},{"content":"By listing a Windows app in the Windows app list, you specify whether that app is enabled or disabled for settings synchronization.","pos":[11739,11870]},{"content":"Apps are identified in the list by their Package Family name and whether settings synchronization should be enabled or disabled for that app.","pos":[11871,12012]},{"content":"When you use these settings along with the Unlisted Default Sync Behavior setting, you can control whether Windows apps are synchronized.","pos":[12013,12150]},{"content":"To display the Package Family Name of installed Windows apps, at a Windows PowerShell command prompt, enter:","pos":[12152,12260]},{"pos":[12359,12551],"content":"To display a list of Windows apps that can synchronize settings on a computer with their package family name, enabled status, and enabled source, at a Windows PowerShell command prompt, enter:"},{"content":"Definitions of Get-UevAppxPackage properties","pos":[12576,12620]},{"content":"DisplayName","pos":[12658,12669]},{"content":"The name that is displayed to the user in the Company Settings Center application.","pos":[12674,12756]},{"content":"The <ph id=\"ph1\">`DisplayName`</ph> property is derived from the <ph id=\"ph2\">`PackageFamilyName`</ph> property.","pos":[12757,12833]},{"content":"PackageFamilyName","pos":[12875,12892]},{"content":"The name of the package that is installed for the current user.","pos":[12897,12960]},{"content":"Enabled","pos":[12992,12999]},{"content":"Defines whether the settings for the app are configured to synchronize.","pos":[13004,13075]},{"content":"EnabledSource","pos":[13113,13126]},{"content":"The location where the configuration that enables or disables the app is set.","pos":[13131,13208]},{"content":"Possible values are: <bpt id=\"p1\">*</bpt>NotSet<ept id=\"p1\">*</ept>, <bpt id=\"p2\">*</bpt>LocalMachine<ept id=\"p2\">*</ept>, <bpt id=\"p3\">*</bpt>LocalUser<ept id=\"p3\">*</ept>, <bpt id=\"p4\">*</bpt>PolicyMachine<ept id=\"p4\">*</ept>, and <bpt id=\"p5\">*</bpt>PolicyUser<ept id=\"p5\">*</ept>.","pos":[13209,13303]},{"content":"NotSet","pos":[13334,13340]},{"content":"The policy is not configured to synchronize this app.","pos":[13345,13398]},{"content":"LocalMachine","pos":[13435,13447]},{"content":"The enabled state is set in the local computer section of the registry.","pos":[13452,13523]},{"content":"LocalUser","pos":[13557,13566]},{"content":"The enabled state is set in the current user section of the registry.","pos":[13571,13640]},{"content":"PolicyMachine","pos":[13678,13691]},{"content":"The enabled state is set in the policy section of the local computer section of the registry.","pos":[13696,13789]},{"pos":[13791,13888],"content":"To get the user-configured list of Windows apps, at the Windows PowerShell command prompt, enter:"},{"pos":[13932,14033],"content":"To get the computer-configured list of Windows apps, at the Windows PowerShell command prompt, enter:"},{"content":"For either parameter, CurrentComputerUser or Computer, the cmdlet returns a list of the Windows apps that are configured at the user or at the computer level.","pos":[14066,14224]},{"content":"Definitions of properties","pos":[14228,14253]},{"content":"DisplayName","pos":[14291,14302]},{"content":"The name that is displayed to the user in the Company Settings Center application.","pos":[14307,14389]},{"content":"The <ph id=\"ph1\">`DisplayName`</ph> property is derived from the <ph id=\"ph2\">`PackageFamilyName`</ph> property.","pos":[14390,14466]},{"content":"PackageFamilyName","pos":[14508,14525]},{"content":"The name of the package that is installed for the current user.","pos":[14530,14593]},{"content":"Enabled","pos":[14625,14632]},{"content":"Defines whether the settings for the app are configured to synchronize for the specified switch, that is, <bpt id=\"p1\">**</bpt>user<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>computer<ept id=\"p2\">**</ept>.","pos":[14637,14768]},{"content":"Installed","pos":[14802,14811]},{"content":"True if the app, that is, the PackageFamilyName is installed for the current user.","pos":[14816,14898]},{"content":"Manage UE-V 2 settings location templates by using WMI","pos":[14904,14958]},{"content":"User Experience Virtualization provides the following set of WMI commands.","pos":[14960,15034]},{"content":"Administrators can use these interfaces to manage settings location templates from Windows PowerShell and automate template administrative tasks.","pos":[15035,15180]},{"content":"To manage settings location templates by using WMI","pos":[15184,15234]},{"content":"Use an account with administrator rights to open a Windows PowerShell window.","pos":[15242,15319]},{"content":"Use the following WMI commands to register and manage the UE-V settings location templates.","pos":[15325,15416]},{"pos":[15422,21164],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\"><code>                         Windows PowerShell command</code></th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV SettingsLocationTemplate | Select-Object TemplateId,TemplateName, TemplateVersion,Enabled | Format-Table -Autosize</code></p></td>\n<td align=\"left\"><p>Lists all the settings location templates that are registered for the computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Invoke-WmiMethod –Namespace root\\Microsoft\\UEV –Class SettingsLocationTemplate –Name GetProcessInfoByTemplateId &lt;template Id&gt;</code></p></td>\n<td align=\"left\"><p>Gets the name of the program and version information, which depends on the template name.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV EffectiveWindows8App</code></p></td>\n<td align=\"left\"><p>Gets the effective list of Windows apps.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Get-WmiObject -Namespace root\\Microsoft\\UEV MachineConfiguredWindows8App</p></td>\n<td align=\"left\"><p>Gets the list of Windows apps that are configured for the computer.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguredWindows8App</code></p></td>\n<td align=\"left\"><p>Gets the list of Windows apps that are configured for the current user.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name Register -ArgumentList &lt;template path &gt;</code></p></td>\n<td align=\"left\"><p>Registers a settings location template with UE-V.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name UnregisterByTemplateId -ArgumentList &lt;template ID&gt;</code></p></td>\n<td align=\"left\"><p>Unregisters a settings location template with UE-V. As soon as a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name Update -ArgumentList &lt;template path&gt;</code></p></td>\n<td align=\"left\"><p>Updates a settings location template with UE-V. The new template should be a newer version than the existing one.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class MachineConfiguredWindows8App -Name RemoveApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n<td align=\"left\"><p>Removes one or more Windows apps from the computer Windows app list.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class UserConfiguredWindows8App -Name RemoveApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n<td align=\"left\"><p>Removes one or more Windows apps from the current user Windows app list.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name DisableByTemplateId -ArgumentList &lt;template ID&gt;</code></p></td>\n<td align=\"left\"><p>Disables one or more settings location templates with UE-V.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class MachineConfiguredWindows8App -Name DisableApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n<td align=\"left\"><p>Disables one or more Windows apps in the computer Windows app list.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class UserConfiguredWindows8App -Name DisableApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n<td align=\"left\"><p>Disables one or more Windows apps in the current user Windows app list.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name EnableByTemplateId -ArgumentList &lt;template ID&gt;</code></p></td>\n<td align=\"left\"><p>Enables a settings location template with UE-V.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class MachineConfiguredWindows8App -Name EnableApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n<td align=\"left\"><p>Enables Windows apps in the computer Windows app list.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class UserConfiguredWindows8App -Name EnableApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n<td align=\"left\"><p>Enables Windows apps in the current user Windows app list.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name Validate -ArgumentList &lt;template path&gt;</code></p></td>\n<td align=\"left\"><p>Determines whether a given settings location template complies with its XML schema.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Description","pos":[203,214]},{"content":"Lists all the settings location templates that are registered for the computer.","pos":[481,560]},{"content":"Gets the name of the program and version information, which depends on the template name.","pos":[788,877]},{"content":"Gets the effective list of Windows apps.","pos":[1037,1077]},{"content":"Get-WmiObject -Namespace root\\Microsoft\\UEV MachineConfiguredWindows8App","pos":[1131,1203]},{"content":"Gets the list of Windows apps that are configured for the computer.","pos":[1233,1300]},{"content":"Gets the list of Windows apps that are configured for the current user.","pos":[1465,1536]},{"content":"Registers a settings location template with UE-V.","pos":[1763,1812]},{"content":"Unregisters a settings location template with UE-V. As soon as a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.","pos":[2049,2232],"nodes":[{"content":"Unregisters a settings location template with UE-V.","pos":[0,51]},{"content":"As soon as a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.","pos":[52,183]}]},{"content":"Updates a settings location template with UE-V. The new template should be a newer version than the existing one.","pos":[2456,2569],"nodes":[{"content":"Updates a settings location template with UE-V.","pos":[0,47]},{"content":"The new template should be a newer version than the existing one.","pos":[48,113]}]},{"content":"Removes one or more Windows apps from the computer Windows app list.","pos":[2827,2895]},{"content":"Removes one or more Windows apps from the current user Windows app list.","pos":[3151,3223]},{"content":"Disables one or more settings location templates with UE-V.","pos":[3457,3516]},{"content":"Disables one or more Windows apps in the computer Windows app list.","pos":[3776,3843]},{"content":"Disables one or more Windows apps in the current user Windows app list.","pos":[4099,4170]},{"content":"Enables a settings location template with UE-V.","pos":[4404,4451]},{"content":"Enables Windows apps in the computer Windows app list.","pos":[4709,4763]},{"content":"Enables Windows apps in the current user Windows app list.","pos":[5019,5077]},{"content":"Determines whether a given settings location template complies with its XML schema.","pos":[5302,5385]}]},{"pos":[21177,21379],"content":"**Note**  \nWhere a list of Package Family Names is called by the WMI command, the list must be in quotes and separated by a pipe symbol, for example, `\"<package family name | package family name>\"`.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"Where a list of Package Family Names is called by the WMI command, the list must be in quotes and separated by a pipe symbol, for example, <ph id=\"ph1\">`\"&lt;package family name | package family name&gt;\"`</ph>.","pos":[11,198]}]},{"content":"Deploying the UE-V Agent using Windows PowerShell","pos":[21392,21441]},{"content":"How to deploy the UE-V Agent by using Windows PowerShell","pos":[21445,21501]},{"content":"Stage the UE-V Agent installation package in an accessible network share.","pos":[21509,21582]},{"pos":[21588,21901],"content":"**Note**  \nUse AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent. The Windows Installer packages, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture. To uninstall the UE-V Agent at a later time by using the installation file, you must use the same file type.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"Use AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent. The Windows Installer packages, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture. To uninstall the UE-V Agent at a later time by using the installation file, you must use the same file type.","pos":[11,309],"nodes":[{"content":"Use AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent.","pos":[0,79]},{"content":"The Windows Installer packages, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture.","pos":[80,189]},{"content":"To uninstall the UE-V Agent at a later time by using the installation file, you must use the same file type.","pos":[190,298]}]}]},{"content":"Use one of the following Windows PowerShell commands to install the UE-V Agent.","pos":[21914,21993]},{"content":"<bpt id=\"p1\">**</bpt>Got a suggestion for UE-V<ept id=\"p1\">**</ept>?","pos":[22290,22320]},{"content":"Add or vote on suggestions <bpt id=\"p1\">[</bpt>here<ept id=\"p1\">](http://uev.uservoice.com/forums/280428-microsoft-user-experience-virtualization)</ept>.","pos":[22321,22436]},{"content":"<bpt id=\"p1\">**</bpt>Got a UE-V issue<ept id=\"p1\">**</ept>?","pos":[22437,22458]},{"content":"Use the <bpt id=\"p1\">[</bpt>UE-V TechNet Forum<ept id=\"p1\">](https://social.technet.microsoft.com/Forums/home?forum=mdopuev)</ept>.","pos":[22459,22552]},{"content":"Related topics","pos":[22557,22571]},{"content":"Administering UE-V 2.x with Windows PowerShell and WMI","pos":[22575,22629]},{"content":"Administering UE-V 2.x","pos":[22702,22724]}],"content":"---\ntitle: Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI\ndescription: Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI\nauthor: jamiejdt\nms.assetid: b5253050-acc3-4274-90d0-1fa4c480331d\nms.pagetype: mdop, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w10\n---\n\n\n# Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI\n\n\nMicrosoft User Experience Virtualization (UE-V) 2.0, 2.1, and 2.1 SP1 use XML settings location templates to define the settings that User Experience Virtualization captures and applies. UE-V includes a set of standard settings location templates. It also includes the UE-V Generator tool that enables you to create custom settings location templates. After you create and deploy settings location templates, you can manage those templates by using Windows PowerShell and the Windows Management Instrumentation (WMI). For a complete list of UE-V PowerShell cmdlets, see [UE-V 2 Cmdlet Reference](http://go.microsoft.com/fwlink/p/?LinkId=393495) (http://go.microsoft.com/fwlink/p/?LinkId=393495).\n\n## Manage UE-V 2 settings location templates by using Windows PowerShell\n\n\nThe WMI and Windows PowerShell features of UE-V include the ability to enable, disable, register, update, and unregister settings location templates. By using these features, you can automate the process of registering, updating, or unregistering templates with the UE-V Agent. You can also manually register templates by using WMI and Windows PowerShell commands. By using these features in conjunction with an electronic software distribution solution, Group Policy, or another automated deployment method such as a script, you can further automate that process.\n\nYou must have administrator permissions to update, register, or unregister a settings location template. Administrator permissions are not required to enable, disable, or list templates.\n\n****To manage settings location templates by using Windows PowerShell****\n\n1.  Use an account with administrator rights to open a Windows PowerShell command prompt.\n\n2.  Use the following Windows PowerShell cmdlets to register and manage the UE-V settings location templates.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\">Windows PowerShell command</th>\n    <th align=\"left\">Description</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Get-UevTemplate</code></p></td>\n    <td align=\"left\"><p>Lists all the settings location templates that are registered on the computer.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Get-UevTemplate –Application &lt;string&gt;</code></p></td>\n    <td align=\"left\"><p>Lists all the settings location templates that are registered on the computer where the application name or template name contains &lt;string&gt;.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Get-UevTemplate –TemplateID &lt;string&gt;</code></p></td>\n    <td align=\"left\"><p>Lists all the settings location templates that are registered on the computer where the template ID contains &lt;string&gt;.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Get-UevTemplate [-ApplicationOrTemplateID] &lt;string&gt;</code></p></td>\n    <td align=\"left\"><p>Lists all the settings location templates that are registered on the computer where the application or template name, or template ID contains &lt;string&gt;.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Get-UevTemplateProgram [-ID] &lt;template ID&gt;</code></p></td>\n    <td align=\"left\"><p>Gets the name of the program and version information, which depend on the template ID.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Get-UevAppXPackage</code></p></td>\n    <td align=\"left\"><p>Gets the effective list of Windows apps.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Get-UevAppXPackage -Computer</code></p></td>\n    <td align=\"left\"><p>Gets the list of Windows apps that are configured for the computer.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Get-UevAppXPackage -CurrentComputerUser</code></p></td>\n    <td align=\"left\"><p>Gets the list of Windows apps that are configured for the current user.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Register-UevTemplate [-Path] &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n    <td align=\"left\"><p>Registers one or more settings location template with UE-V by using relative paths and/or wildcard characters in file paths. After a template is registered, UE-V synchronizes the settings that are defined in the template between computers that have the template registered.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Register-UevTemplate –LiteralPath &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n    <td align=\"left\"><p>Registers one or more settings location template with UE-V by using literal paths, where no characters can be interpreted as wildcard characters. After a template is registered, UE-V synchronizes the settings that are defined in the template between computers that have the template registered.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Unregister-UevTemplate [-ID] &lt;template ID&gt;</code></p></td>\n    <td align=\"left\"><p>Unregisters a settings location template with UE-V. When a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Unregister-UevTemplate -All</code></p></td>\n    <td align=\"left\"><p>Unregisters all settings location templates with UE-V. When a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Update-UevTemplate [-Path] &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n    <td align=\"left\"><p>Updates one or more settings location templates with a more recent version of the template. Use relative paths and/or wildcard characters in the file paths. The new template should be a newer version than the existing template.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Update-UevTemplate –LiteralPath &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n    <td align=\"left\"><p>Updates one or more settings location templates with a more recent version of the template. Use full paths to template files, where no characters can be interpreted as wildcard characters. The new template should be a newer version than the existing template.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Clear-UevAppXPackage –Computer [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n    <td align=\"left\"><p>Removes one or more Windows apps from the computer Windows app list.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Clear-UevAppXPackage -CurrentComputerUser</code></p></td>\n    <td align=\"left\"><p>Removes Windows app from the current user Windows app list.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Clear-UevAppXPackage –Computer -All</code></p></td>\n    <td align=\"left\"><p>Removes all Windows apps from the computer Windows app list.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Clear-UevAppXPackage [–CurrentComputerUser] [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n    <td align=\"left\"><p>Removes one or more Windows apps from the current user Windows app list.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Clear-UevAppXPackage [–CurrentComputerUser] -All</code></p></td>\n    <td align=\"left\"><p>Removes all Windows apps from the current user Windows app list.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Disable-UevTemplate [-ID] &lt;template ID&gt;</code></p></td>\n    <td align=\"left\"><p>Disables a settings location template for the current user of the computer.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Disable-UevAppXPackage –Computer [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n    <td align=\"left\"><p>Disables one or more Windows apps in the computer Windows app list.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Disable-UevAppXPackage [–CurrentComputerUser] [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n    <td align=\"left\"><p>Disables one or more Windows apps in the current user Windows app list.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Enable-UevTemplate [-ID] &lt;template ID&gt;</code></p></td>\n    <td align=\"left\"><p>Enables a settings location template for the current user of the computer.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Enable-UevAppXPackage –Computer [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n    <td align=\"left\"><p>Enables one or more Windows apps in the computer Windows app list.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Enable-UevAppXPackage [–CurrentComputerUser] [-PackageFamilyName] &lt;package family name&gt;[,&lt;package family name&gt;]</code></p></td>\n    <td align=\"left\"><p>Enables one or more Windows apps in the current user Windows app list.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Test-UevTemplate [-Path] &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n    <td align=\"left\"><p>Determines whether one or more settings location templates comply with its XML schema. Can use relative paths and wildcard characters.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Test-UevTemplate –LiteralPath &lt;template file path&gt;[,&lt;template file path&gt;]</code></p></td>\n    <td align=\"left\"><p>Determines whether one or more settings location templates comply with its XML schema. The path must be a full path to the template file, but does not include wildcard characters.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\nThe UE-V Windows PowerShell features enable you to manage a group of settings templates that are deployed in your enterprise. Use the following procedure to manage a group of templates by using Windows PowerShell.\n\n**To manage a group of settings location templates by using Windows PowerShell**\n\n1.  Modify or update the desired settings location templates.\n\n2.  If you want to modify or update the settings location templates, deploy those settings location templates to a folder that is accessible to the local computer.\n\n3.  On the local computer, open a Windows PowerShell window with administrator rights.\n\n4.  Unregister all the previously registered versions of the templates by typing the following command.\n\n    ``` syntax\n    Unregister-UevTemplate -All\n    ```\n\n    This command unregisters all active templates on the computer.\n\n5.  Register the updated templates by typing the following command.\n\n    ``` syntax\n    Register-UevTemplate <path to template folder>\\*.xml\n    ```\n\n    This command registers all of the settings location templates that are located in the specified template folder.\n\n### <a href=\"\" id=\"win8applist\"></a>Windows app list\n\nBy listing a Windows app in the Windows app list, you specify whether that app is enabled or disabled for settings synchronization. Apps are identified in the list by their Package Family name and whether settings synchronization should be enabled or disabled for that app. When you use these settings along with the Unlisted Default Sync Behavior setting, you can control whether Windows apps are synchronized.\n\nTo display the Package Family Name of installed Windows apps, at a Windows PowerShell command prompt, enter:\n\n``` syntax\nGet-AppxPackage | Sort-Object PackageFamilyName | Format-Table PackageFamilyName\n```\n\nTo display a list of Windows apps that can synchronize settings on a computer with their package family name, enabled status, and enabled source, at a Windows PowerShell command prompt, enter: `Get-UevAppxPackage`\n\n**Definitions of Get-UevAppxPackage properties**\n\n<a href=\"\" id=\"displayname\"></a>**DisplayName**  \nThe name that is displayed to the user in the Company Settings Center application. The `DisplayName` property is derived from the `PackageFamilyName` property.\n\n<a href=\"\" id=\"packagefamilyname\"></a>**PackageFamilyName**  \nThe name of the package that is installed for the current user.\n\n<a href=\"\" id=\"enabled\"></a>**Enabled**  \nDefines whether the settings for the app are configured to synchronize.\n\n<a href=\"\" id=\"enabledsource\"></a>**EnabledSource**  \nThe location where the configuration that enables or disables the app is set. Possible values are: *NotSet*, *LocalMachine*, *LocalUser*, *PolicyMachine*, and *PolicyUser*.\n\n<a href=\"\" id=\"notset\"></a>**NotSet**  \nThe policy is not configured to synchronize this app.\n\n<a href=\"\" id=\"localmachine\"></a>**LocalMachine**  \nThe enabled state is set in the local computer section of the registry.\n\n<a href=\"\" id=\"localuser\"></a>**LocalUser**  \nThe enabled state is set in the current user section of the registry.\n\n<a href=\"\" id=\"policymachine\"></a>**PolicyMachine**  \nThe enabled state is set in the policy section of the local computer section of the registry.\n\nTo get the user-configured list of Windows apps, at the Windows PowerShell command prompt, enter: `Get-UevAppxPackage –CurrentComputerUser`\n\nTo get the computer-configured list of Windows apps, at the Windows PowerShell command prompt, enter: `Get-UevAppxPackage –Computer`\n\nFor either parameter, CurrentComputerUser or Computer, the cmdlet returns a list of the Windows apps that are configured at the user or at the computer level.\n\n**Definitions of properties**\n\n<a href=\"\" id=\"displayname\"></a>**DisplayName**  \nThe name that is displayed to the user in the Company Settings Center application. The `DisplayName` property is derived from the `PackageFamilyName` property.\n\n<a href=\"\" id=\"packagefamilyname\"></a>**PackageFamilyName**  \nThe name of the package that is installed for the current user.\n\n<a href=\"\" id=\"enabled\"></a>**Enabled**  \nDefines whether the settings for the app are configured to synchronize for the specified switch, that is, **user** or **computer**.\n\n<a href=\"\" id=\"installed\"></a>**Installed**  \nTrue if the app, that is, the PackageFamilyName is installed for the current user.\n\n### Manage UE-V 2 settings location templates by using WMI\n\nUser Experience Virtualization provides the following set of WMI commands. Administrators can use these interfaces to manage settings location templates from Windows PowerShell and automate template administrative tasks.\n\n**To manage settings location templates by using WMI**\n\n1.  Use an account with administrator rights to open a Windows PowerShell window.\n\n2.  Use the following WMI commands to register and manage the UE-V settings location templates.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\"><code>                         Windows PowerShell command</code></th>\n    <th align=\"left\">Description</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV SettingsLocationTemplate | Select-Object TemplateId,TemplateName, TemplateVersion,Enabled | Format-Table -Autosize</code></p></td>\n    <td align=\"left\"><p>Lists all the settings location templates that are registered for the computer.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod –Namespace root\\Microsoft\\UEV –Class SettingsLocationTemplate –Name GetProcessInfoByTemplateId &lt;template Id&gt;</code></p></td>\n    <td align=\"left\"><p>Gets the name of the program and version information, which depends on the template name.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV EffectiveWindows8App</code></p></td>\n    <td align=\"left\"><p>Gets the effective list of Windows apps.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Get-WmiObject -Namespace root\\Microsoft\\UEV MachineConfiguredWindows8App</p></td>\n    <td align=\"left\"><p>Gets the list of Windows apps that are configured for the computer.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguredWindows8App</code></p></td>\n    <td align=\"left\"><p>Gets the list of Windows apps that are configured for the current user.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name Register -ArgumentList &lt;template path &gt;</code></p></td>\n    <td align=\"left\"><p>Registers a settings location template with UE-V.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name UnregisterByTemplateId -ArgumentList &lt;template ID&gt;</code></p></td>\n    <td align=\"left\"><p>Unregisters a settings location template with UE-V. As soon as a template is unregistered, UE-V no longer synchronizes the settings that are defined in the template between computers.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name Update -ArgumentList &lt;template path&gt;</code></p></td>\n    <td align=\"left\"><p>Updates a settings location template with UE-V. The new template should be a newer version than the existing one.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class MachineConfiguredWindows8App -Name RemoveApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n    <td align=\"left\"><p>Removes one or more Windows apps from the computer Windows app list.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class UserConfiguredWindows8App -Name RemoveApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n    <td align=\"left\"><p>Removes one or more Windows apps from the current user Windows app list.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name DisableByTemplateId -ArgumentList &lt;template ID&gt;</code></p></td>\n    <td align=\"left\"><p>Disables one or more settings location templates with UE-V.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class MachineConfiguredWindows8App -Name DisableApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n    <td align=\"left\"><p>Disables one or more Windows apps in the computer Windows app list.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class UserConfiguredWindows8App -Name DisableApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n    <td align=\"left\"><p>Disables one or more Windows apps in the current user Windows app list.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name EnableByTemplateId -ArgumentList &lt;template ID&gt;</code></p></td>\n    <td align=\"left\"><p>Enables a settings location template with UE-V.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class MachineConfiguredWindows8App -Name EnableApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n    <td align=\"left\"><p>Enables Windows apps in the computer Windows app list.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class UserConfiguredWindows8App -Name EnableApp -ArgumentList &lt;package family name | package family name&gt;</code></p></td>\n    <td align=\"left\"><p>Enables Windows apps in the current user Windows app list.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name Validate -ArgumentList &lt;template path&gt;</code></p></td>\n    <td align=\"left\"><p>Determines whether a given settings location template complies with its XML schema.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n    **Note**  \n    Where a list of Package Family Names is called by the WMI command, the list must be in quotes and separated by a pipe symbol, for example, `\"<package family name | package family name>\"`.\n\n     \n\n### Deploying the UE-V Agent using Windows PowerShell\n\n**How to deploy the UE-V Agent by using Windows PowerShell**\n\n1.  Stage the UE-V Agent installation package in an accessible network share.\n\n    **Note**  \n    Use AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent. The Windows Installer packages, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture. To uninstall the UE-V Agent at a later time by using the installation file, you must use the same file type.\n\n     \n\n2.  Use one of the following Windows PowerShell commands to install the UE-V Agent.\n\n    -   `& AgentSetup.exe /quiet /norestart /log \"%temp%\\UE-VAgentInstaller.log\" SettingsStoragePath=\\\\server\\settingsshare\\%username%`\n\n    -   `& msiexec.exe /i \"<path to msi file>\" /quiet /norestart /l*v \"%temp%\\UE-VAgentInstaller.log\" SettingsStoragePath=\\\\server\\settingsshare\\%username%`\n\n**Got a suggestion for UE-V**? Add or vote on suggestions [here](http://uev.uservoice.com/forums/280428-microsoft-user-experience-virtualization). **Got a UE-V issue**? Use the [UE-V TechNet Forum](https://social.technet.microsoft.com/Forums/home?forum=mdopuev).\n\n## Related topics\n\n\n[Administering UE-V 2.x with Windows PowerShell and WMI](administering-ue-v-2x-with-windows-powershell-and-wmi-both-uevv2.md)\n\n[Administering UE-V 2.x](administering-ue-v-2x-new-uevv2.md)\n\n \n\n \n\n\n\n\n\n"}