{"nodes":[{"content":"Managing the UE-V 2.x Agent and Packages with Windows PowerShell and WMI","pos":[11,83]},{"content":"Managing the UE-V 2.x Agent and Packages with Windows PowerShell and WMI","pos":[97,169]},{"content":"Managing the UE-V 2.x Agent and Packages with Windows PowerShell and WMI","pos":[333,405]},{"content":"You can use Windows Management Instrumentation (WMI) and Windows PowerShell to manage Microsoft User Experience Virtualization (UE-V) 2.0, 2.1, and 2.1 SP1 Agent configuration and synchronization behavior.","pos":[408,613]},{"content":"For a complete list of UE-V PowerShell cmdlets, see <bpt id=\"p1\">[</bpt>UE-V 2 Cmdlet Reference<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=393495)</ept> (http://go.microsoft.com/fwlink/?LinkId=393495).","pos":[614,787]},{"content":"To deploy the UE-V Agent by using Windows PowerShell","pos":[791,843]},{"content":"Stage the UE-V installer file in an accessible network share.","pos":[851,912]},{"pos":[918,1227],"content":"**Note**  \nUse AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent. Windows Installer packages, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture. To uninstall the UE-V Agent at a later time by using the installation file, you must use the same file type.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"Use AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent. Windows Installer packages, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture. To uninstall the UE-V Agent at a later time by using the installation file, you must use the same file type.","pos":[11,305],"nodes":[{"content":"Use AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent.","pos":[0,79]},{"content":"Windows Installer packages, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture.","pos":[80,185]},{"content":"To uninstall the UE-V Agent at a later time by using the installation file, you must use the same file type.","pos":[186,294]}]}]},{"content":"Use one of the following Windows PowerShell commands to install the UE-V Agent.","pos":[1240,1319]},{"content":"To configure the UE-V Agent by using Windows PowerShell","pos":[1618,1673]},{"content":"Open a Windows PowerShell window.","pos":[1681,1714]},{"content":"To manage computer settings that affect all users of the computer by using the <bpt id=\"p1\">*</bpt>Computer<ept id=\"p1\">*</ept> parameter, open the window with an account that has administrator rights.","pos":[1715,1878]},{"content":"Use the following Windows PowerShell commands to configure the agent.","pos":[1884,1953]},{"pos":[1959,12296],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Windows PowerShell command</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Get-UevConfiguration</code></p>\n<p></p></td>\n<td align=\"left\"><p>Gets the effective UE-V Agent settings. User-specific settings have precedence over the computer settings.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Get-UevConfiguration - CurrentComputerUser</code></p>\n<p></p></td>\n<td align=\"left\"><p>Gets the UE-V Agent settings values for the current user only.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Get-UevConfiguration -Computer</code></p></td>\n<td align=\"left\"><p>Gets the UE-V Agent configuration settings values for all users on the computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Get-UevConfiguration -Details</code></p></td>\n<td align=\"left\"><p>Gets the details for each configuration setting. Displays where the setting is configured or if it uses the default value. Is displayed if the current setting is valid.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer –ContactITDescription &lt;IT description&gt;</code></p></td>\n<td align=\"left\"><p>Sets the text that is displayed in the Company Settings Center for the help link.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer -ContactITUrl &lt;string&gt;</code></p></td>\n<td align=\"left\"><p>Sets the URL of the link in the Company Settings Center for the help link. Any URL protocol can be used.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer –EnableDontSyncWindows8AppSettings</code></p></td>\n<td align=\"left\"><p>Configures the UE-V Agent to not synchronize any Windows apps for all users on the computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set-UevConfiguration -CurrentComputerUser – EnableDontSyncWindows8AppSettings</code></p></td>\n<td align=\"left\"><p>Configures the UE-V Agent to not synchronize any Windows apps for the current computer user.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer –EnableFirstUseNotification</code></p></td>\n<td align=\"left\"><p>Configures the UE-V Agent to display notification the first time the agent runs for all users on the computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer –DisableFirstUseNotification</code></p></td>\n<td align=\"left\"><p>Configures the UE-V Agent to not display notification the first time that the agent runs for all users on the computer.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer –EnableSettingsImportNotify</code></p></td>\n<td align=\"left\"><p>Configures the UE-V Agent to notify all users on the computer when settings synchronization is delayed.</p>\n<p>Use the <em>DisableSettingsImportNotify</em> parameter to disable notification.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set-UevConfiguration - CurrentComputerUser -EnableSettingsImportNotify</code></p></td>\n<td align=\"left\"><p>Configures the UE-V Agent to notify the current user when settings synchronization is delayed.</p>\n<p>Use the <em>DisableSettingsImportNotify</em> parameter to disable notification.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer –EnableSyncUnlistedWindows8Apps</code></p></td>\n<td align=\"left\"><p>Configures the UE-V Agent to synchronize all Windows apps that are not explicitly disabled by the Windows app list for all users of the computer. For more information, see &quot;Get-UevAppxPackage&quot; in [Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI](managing-ue-v-2x-settings-location-templates-using-windows-powershell-and-wmi-both-uevv2.md).</p>\n<p>Use the <em>DisableSyncUnlistedWindows8Apps</em> parameter to configure the UE-V Agent to synchronize only Windows apps that are explicitly enabled by the Windows App List.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set-UevConfiguration - CurrentComputerUser - EnableSyncUnlistedWindows8Apps</code></p></td>\n<td align=\"left\"><p>Configures the UE-V Agent to synchronize all Windows apps that are not explicitly disabled by the Windows app list for the current user on the computer. For more information, see &quot;Get-UevAppxPackage&quot; in [Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI](managing-ue-v-2x-settings-location-templates-using-windows-powershell-and-wmi-both-uevv2.md).</p>\n<p>Use the <em>DisableSyncUnlistedWindows8Apps</em> parameter to configure the UE-V Agent to synchronize only Windows apps that are explicitly enabled by the Windows App List.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration –Computer –DisableSync</code></p></td>\n<td align=\"left\"><p>Disables UE-V for all the users on the computer.</p>\n<p>Use the <em>EnableSync</em> parameter to enable or re-enable.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set-UevConfiguration –CurrentComputerUser -DisableSync</code></p></td>\n<td align=\"left\"><p>Disables UE-V for the current user on the computer.</p>\n<p>Use the <em>EnableSync</em> parameter to enable or re-enable.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer –EnableTrayIcon</code></p></td>\n<td align=\"left\"><p>Enables the UE-V icon in the notification area for all users of the computer.</p>\n<p>Use the <em>DisableTrayIcon</em> parameter to disable the icon.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer -MaxPackageSizeInBytes &lt;size in bytes&gt;</code></p></td>\n<td align=\"left\"><p>Configures the UE-V agent to report when a settings package file size reaches the defined threshold for all users on the computer. Sets the threshold package size in bytes.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration -CurrentComputerUser -MaxPackageSizeInBytes &lt;size in bytes&gt;</code></p></td>\n<td align=\"left\"><p>Configures the UE-V agent to report when a settings package file size reaches the defined threshold. Sets the package size warning threshold for the current user.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer -SettingsImportNotifyDelayInSeconds</code></p></td>\n<td align=\"left\"><p>Specifies the time in seconds before the user is notified for all users of the computer</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration - CurrentComputerUser -SettingsImportNotifyDelayInSeconds</code></p></td>\n<td align=\"left\"><p>Specifies the time in seconds before notification for the current user is sent.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer -SettingsStoragePath &lt;path to _settings_storage_location&gt;</code></p></td>\n<td align=\"left\"><p>Defines a per-computer settings storage location for all users of the computer.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration -CurrentComputerUser -SettingsStoragePath &lt;path to _settings_storage_location&gt;</code></p></td>\n<td align=\"left\"><p>Defines a per-user settings storage location.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set-UevConfiguration –Computer –SettingsTemplateCatalogPath &lt;path to catalog&gt;</code></p></td>\n<td align=\"left\"><p>Sets the settings template catalog path for all users of the computer.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer -SyncMethod &lt;sync method&gt;</code></p></td>\n<td align=\"left\"><p>Sets the synchronization method for all users of the computer: SyncProvider or None.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set-UevConfiguration -CurrentComputerUser  -SyncMethod &lt;sync method&gt;</code></p></td>\n<td align=\"left\"><p>Sets the synchronization method for the current user: SyncProvider or None.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Set-UevConfiguration -Computer -SyncTimeoutInMilliseconds &lt;timeout in milliseconds&gt;</code></p></td>\n<td align=\"left\"><p>Sets the synchronization time-out in milliseconds for all users of the computer</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Set- UevConfiguration -CurrentComputerUser -SyncTimeoutInMilliseconds &lt;timeout in milliseconds&gt;</code></p></td>\n<td align=\"left\"><p>Set the synchronization time-out for the current user.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Clear-UevConfiguration –Computer -&lt;setting name&gt;</code></p></td>\n<td align=\"left\"><p>Clears the specified setting for all users on the computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Clear-UevConfiguration –CurrentComputerUser -&lt;setting name&gt;</code></p></td>\n<td align=\"left\"><p>Clears the specified setting for the current user only.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Export-UevConfiguration &lt;settings migration file&gt;</code></p></td>\n<td align=\"left\"><p>Exports the UE-V computer configuration to a settings migration file. The file name extension must be .uev.</p>\n<p>The <code>Export</code> cmdlet exports all UE-V Agent settings that are configurable with the <em>Computer</em> parameter.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Import-UevConfiguration &lt;settings migration file&gt;</code></p></td>\n<td align=\"left\"><p>Imports the UE-V computer configuration from a settings migration file. The file name extension must be .uev.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Windows PowerShell command","pos":[116,142]},{"content":"Description","pos":[165,176]},{"content":"Gets the effective UE-V Agent settings. User-specific settings have precedence over the computer settings.","pos":[313,419],"nodes":[{"content":"Gets the effective UE-V Agent settings.","pos":[0,39]},{"content":"User-specific settings have precedence over the computer settings.","pos":[40,106]}]},{"content":"Gets the UE-V Agent settings values for the current user only.","pos":[566,628]},{"content":"Gets the UE-V Agent configuration settings values for all users on the computer.","pos":[754,834]},{"content":"Gets the details for each configuration setting. Displays where the setting is configured or if it uses the default value. Is displayed if the current setting is valid.","pos":[960,1128],"nodes":[{"content":"Gets the details for each configuration setting.","pos":[0,48]},{"content":"Displays where the setting is configured or if it uses the default value.","pos":[49,122]},{"content":"Is displayed if the current setting is valid.","pos":[123,168]}]},{"content":"Sets the text that is displayed in the Company Settings Center for the help link.","pos":[1299,1380]},{"content":"Sets the URL of the link in the Company Settings Center for the help link. Any URL protocol can be used.","pos":[1536,1640],"nodes":[{"content":"Sets the URL of the link in the Company Settings Center for the help link.","pos":[0,74]},{"content":"Any URL protocol can be used.","pos":[75,104]}]},{"content":"Configures the UE-V Agent to not synchronize any Windows apps for all users on the computer.","pos":[1801,1893]},{"content":"Configures the UE-V Agent to not synchronize any Windows apps for the current computer user.","pos":[2067,2159]},{"content":"Configures the UE-V Agent to display notification the first time the agent runs for all users on the computer.","pos":[2313,2423]},{"content":"Configures the UE-V Agent to not display notification the first time that the agent runs for all users on the computer.","pos":[2579,2698]},{"content":"Configures the UE-V Agent to notify all users on the computer when settings synchronization is delayed.","pos":[2852,2955]},{"content":"Use the <ph id=\"ph1\">&lt;em&gt;</ph>DisableSettingsImportNotify<ph id=\"ph2\">&lt;/em&gt;</ph> parameter to disable notification.","pos":[2963,3042]},{"content":"Configures the UE-V Agent to notify the current user when settings synchronization is delayed.","pos":[3209,3303]},{"content":"Use the <ph id=\"ph1\">&lt;em&gt;</ph>DisableSettingsImportNotify<ph id=\"ph2\">&lt;/em&gt;</ph> parameter to disable notification.","pos":[3311,3390]},{"content":"Configures the UE-V Agent to synchronize all Windows apps that are not explicitly disabled by the Windows app list for all users of the computer. For more information, see &quot;Get-UevAppxPackage&quot; in [Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI](managing-ue-v-2x-settings-location-templates-using-windows-powershell-and-wmi-both-uevv2.md).","pos":[3548,3928],"nodes":[{"content":"Configures the UE-V Agent to synchronize all Windows apps that are not explicitly disabled by the Windows app list for all users of the computer.","pos":[0,145]},{"content":"For more information, see <ph id=\"ph1\">&amp;quot;</ph>Get-UevAppxPackage<ph id=\"ph2\">&amp;quot;</ph> in <bpt id=\"p1\">[</bpt>Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI<ept id=\"p1\">](managing-ue-v-2x-settings-location-templates-using-windows-powershell-and-wmi-both-uevv2.md)</ept>.","pos":[146,380]}]},{"content":"Use the <ph id=\"ph1\">&lt;em&gt;</ph>DisableSyncUnlistedWindows8Apps<ph id=\"ph2\">&lt;/em&gt;</ph> parameter to configure the UE-V Agent to synchronize only Windows apps that are explicitly enabled by the Windows App List.","pos":[3936,4108]},{"content":"Configures the UE-V Agent to synchronize all Windows apps that are not explicitly disabled by the Windows app list for the current user on the computer. For more information, see &quot;Get-UevAppxPackage&quot; in [Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI](managing-ue-v-2x-settings-location-templates-using-windows-powershell-and-wmi-both-uevv2.md).","pos":[4280,4667],"nodes":[{"content":"Configures the UE-V Agent to synchronize all Windows apps that are not explicitly disabled by the Windows app list for the current user on the computer.","pos":[0,152]},{"content":"For more information, see <ph id=\"ph1\">&amp;quot;</ph>Get-UevAppxPackage<ph id=\"ph2\">&amp;quot;</ph> in <bpt id=\"p1\">[</bpt>Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI<ept id=\"p1\">](managing-ue-v-2x-settings-location-templates-using-windows-powershell-and-wmi-both-uevv2.md)</ept>.","pos":[153,387]}]},{"content":"Use the <ph id=\"ph1\">&lt;em&gt;</ph>DisableSyncUnlistedWindows8Apps<ph id=\"ph2\">&lt;/em&gt;</ph> parameter to configure the UE-V Agent to synchronize only Windows apps that are explicitly enabled by the Windows App List.","pos":[4675,4847]},{"content":"Disables UE-V for all the users on the computer.","pos":[4986,5034]},{"content":"Use the <ph id=\"ph1\">&lt;em&gt;</ph>EnableSync<ph id=\"ph2\">&lt;/em&gt;</ph> parameter to enable or re-enable.","pos":[5042,5103]},{"content":"Disables UE-V for the current user on the computer.","pos":[5254,5305]},{"content":"Use the <ph id=\"ph1\">&lt;em&gt;</ph>EnableSync<ph id=\"ph2\">&lt;/em&gt;</ph> parameter to enable or re-enable.","pos":[5313,5374]},{"content":"Enables the UE-V icon in the notification area for all users of the computer.","pos":[5516,5593]},{"content":"Use the <ph id=\"ph1\">&lt;em&gt;</ph>DisableTrayIcon<ph id=\"ph2\">&lt;/em&gt;</ph> parameter to disable the icon.","pos":[5601,5664]},{"content":"Configures the UE-V agent to report when a settings package file size reaches the defined threshold for all users on the computer. Sets the threshold package size in bytes.","pos":[5836,6008],"nodes":[{"content":"Configures the UE-V agent to report when a settings package file size reaches the defined threshold for all users on the computer.","pos":[0,130]},{"content":"Sets the threshold package size in bytes.","pos":[131,172]}]},{"content":"Configures the UE-V agent to report when a settings package file size reaches the defined threshold. Sets the package size warning threshold for the current user.","pos":[6190,6352],"nodes":[{"content":"Configures the UE-V agent to report when a settings package file size reaches the defined threshold.","pos":[0,100]},{"content":"Sets the package size warning threshold for the current user.","pos":[101,162]}]},{"content":"Specifies the time in seconds before the user is notified for all users of the computer","pos":[6515,6602]},{"content":"Specifies the time in seconds before notification for the current user is sent.","pos":[6776,6855]},{"content":"Defines a per-computer settings storage location for all users of the computer.","pos":[7046,7125]},{"content":"Defines a per-user settings storage location.","pos":[7326,7371]},{"content":"Sets the settings template catalog path for all users of the computer.","pos":[7551,7621]},{"content":"Sets the synchronization method for all users of the computer: SyncProvider or None.","pos":[7779,7863]},{"content":"Sets the synchronization method for the current user: SyncProvider or None.","pos":[8034,8109]},{"content":"Sets the synchronization time-out in milliseconds for all users of the computer","pos":[8294,8373]},{"content":"Set the synchronization time-out for the current user.","pos":[8571,8625]},{"content":"Clears the specified setting for all users on the computer.","pos":[8775,8834]},{"content":"Clears the specified setting for the current user only.","pos":[8996,9051]},{"content":"Exports the UE-V computer configuration to a settings migration file. The file name extension must be .uev.","pos":[9202,9309],"nodes":[{"content":"Exports the UE-V computer configuration to a settings migration file.","pos":[0,69]},{"content":"The file name extension must be .uev.","pos":[70,107]}]},{"content":"The <ph id=\"ph1\">&lt;code&gt;Export&lt;/code&gt;</ph> cmdlet exports all UE-V Agent settings that are configurable with the <ph id=\"ph2\">&lt;em&gt;</ph>Computer<ph id=\"ph3\">&lt;/em&gt;</ph> parameter.","pos":[9317,9439]},{"content":"Imports the UE-V computer configuration from a settings migration file. The file name extension must be .uev.","pos":[9591,9700],"nodes":[{"content":"Imports the UE-V computer configuration from a settings migration file.","pos":[0,71]},{"content":"The file name extension must be .uev.","pos":[72,109]}]}]},{"content":"To export UE-V package settings and repair UE-V templates by using Windows PowerShell","pos":[12307,12392]},{"content":"Open a Windows PowerShell window as an administrator.","pos":[12400,12453]},{"content":"Use the following Windows PowerShell commands to configure the agent.","pos":[12459,12528]},{"pos":[12534,13268],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><strong>Windows PowerShell command</strong></p></td>\n<td align=\"left\"><p><strong>Description</strong></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Export-UevPackage MicrosoftCalculator6.pkgx</p></td>\n<td align=\"left\"><p>Extracts the settings from a Microsoft Calculator package file and converts them into a human-readable format in XML.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Repair-UevTemplateIndex</p></td>\n<td align=\"left\"><p>Repairs the index of the UE-V settings location templates.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Windows PowerShell command","pos":[124,150]},{"content":"Description","pos":[197,208]},{"content":"Export-UevPackage MicrosoftCalculator6.pkgx","pos":[271,314]},{"content":"Extracts the settings from a Microsoft Calculator package file and converts them into a human-readable format in XML.","pos":[344,461]},{"content":"Repair-UevTemplateIndex","pos":[514,537]},{"content":"Repairs the index of the UE-V settings location templates.","pos":[567,625]}]},{"content":"To configure the UE-V Agent by using WMI","pos":[13279,13319]},{"content":"User Experience Virtualization provides the following set of WMI commands.","pos":[13327,13401]},{"content":"Administrators can use this interface to configure the UE-V agent at the command line and automate typical configuration tasks.","pos":[13402,13529]},{"content":"Use an account with administrator rights to open a Windows PowerShell window.","pos":[13535,13612]},{"content":"Use the following WMI commands to configure the agent.","pos":[13618,13672]},{"pos":[13678,18645],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\"><code>Windows PowerShell command</code></th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV Configuration</code></p>\n<p></p></td>\n<td align=\"left\"><p>Displays the active UE-V Agent settings. User-specific settings have precedence over the computer settings.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguration</code></p></td>\n<td align=\"left\"><p>Displays the UE-V Agent configuration that is defined for a user.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p></td>\n<td align=\"left\"><p>Displays the UE-V Agent configuration that is defined for a computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Get-WmiObject –Namespace root\\Microsoft\\Uev ConfigurationItem</code></p></td>\n<td align=\"left\"><p>Displays the details for each configuration item.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n<p><code>$config.SettingsStoragePath = &lt;path_to_settings_storage_location&gt;</code></p>\n<p>$config.Put()</p></td>\n<td align=\"left\"><p>Defines a per-computer settings storage location.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguration</code></p>\n<p><code>$config.SettingsStoragePath = &lt;path_to_settings_storage_location&gt;</code></p>\n<p><code>$config.Put()</code></p></td>\n<td align=\"left\"><p>Defines a per-user settings storage location.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n<p><code>$config.SyncTimeoutInMilliseconds = &lt;timeout_in_milliseconds&gt;</code></p>\n<p><code>$config.Put()</code></p></td>\n<td align=\"left\"><p>Sets the synchronization time-out in milliseconds for all users of the computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n<p><code>$config.MaxPackageSizeInBytes = &lt;size_in_bytes&gt;</code></p>\n<p><code>$config.Put()</code></p></td>\n<td align=\"left\"><p>Configures the UE-V Agent to report when a settings package file size reaches a defined threshold. Set the threshold package file size in bytes for all users of the computer.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n<p><code>$config.SyncMethod = &lt;sync_method&gt;</code></p>\n<p><code>$config.Put()</code></p></td>\n<td align=\"left\"><p>Sets the synchronization method for all users of the computer: SyncProvider or None.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n<p><code>$config.&lt;setting name&gt; = $true</code></p>\n<p><code>$config.Put()</code></p></td>\n<td align=\"left\"><p>To enable a specific per-computer setting, clear the setting, and use <em>$null</em> as the setting value. Use UserConfiguration for per-user settings.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n<p><code>$config.&lt;setting name&gt; = $false</code></p>\n<p><code>$config.Put()</code></p></td>\n<td align=\"left\"><p>To disable a specific per-computer setting, clear the setting, and use <em>$null</em> as the setting value. Use User Configuration for per-user settings.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n<p><code>$config.&lt;setting name&gt; = &lt;setting value&gt;</code></p>\n<p><code>$config.Put()</code></p></td>\n<td align=\"left\"><p>Updates a specific per-computer setting. To clear the setting, use <em>$null</em> as the setting value.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n<p><code></code>$config.&lt;setting name&gt; = &lt;setting value&gt;</p>\n<p><code>$config.Put()</code></p></td>\n<td align=\"left\"><p>Updates a specific per-user setting for all users of the computer. To clear the setting, use <em>$null</em> as the setting value.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Description","pos":[178,189]},{"content":"Displays the active UE-V Agent settings. User-specific settings have precedence over the computer settings.","pos":[363,470],"nodes":[{"content":"Displays the active UE-V Agent settings.","pos":[0,40]},{"content":"User-specific settings have precedence over the computer settings.","pos":[41,107]}]},{"content":"Displays the UE-V Agent configuration that is defined for a user.","pos":[628,693]},{"content":"Displays the UE-V Agent configuration that is defined for a computer.","pos":[854,923]},{"content":"Displays the details for each configuration item.","pos":[1081,1130]},{"content":"$config.Put()","pos":[1371,1384]},{"content":"Defines a per-computer settings storage location.","pos":[1414,1463]},{"content":"Defines a per-user settings storage location.","pos":[1757,1802]},{"content":"Sets the synchronization time-out in milliseconds for all users of the computer.","pos":[2095,2175]},{"content":"Configures the UE-V Agent to report when a settings package file size reaches a defined threshold. Set the threshold package file size in bytes for all users of the computer.","pos":[2455,2629],"nodes":[{"content":"Configures the UE-V Agent to report when a settings package file size reaches a defined threshold.","pos":[0,98]},{"content":"Set the threshold package file size in bytes for all users of the computer.","pos":[99,174]}]},{"content":"Sets the synchronization method for all users of the computer: SyncProvider or None.","pos":[2895,2979]},{"content":"To enable a specific per-computer setting, clear the setting, and use <em>$null</em> as the setting value. Use UserConfiguration for per-user settings.","pos":[3242,3393],"nodes":[{"content":"To enable a specific per-computer setting, clear the setting, and use <ph id=\"ph1\">&lt;em&gt;</ph>$null<ph id=\"ph2\">&lt;/em&gt;</ph> as the setting value.","pos":[0,106]},{"content":"Use UserConfiguration for per-user settings.","pos":[107,151]}]},{"content":"To disable a specific per-computer setting, clear the setting, and use <em>$null</em> as the setting value. Use User Configuration for per-user settings.","pos":[3656,3809],"nodes":[{"content":"To disable a specific per-computer setting, clear the setting, and use <ph id=\"ph1\">&lt;em&gt;</ph>$null<ph id=\"ph2\">&lt;/em&gt;</ph> as the setting value.","pos":[0,107]},{"content":"Use User Configuration for per-user settings.","pos":[108,153]}]},{"content":"Updates a specific per-computer setting. To clear the setting, use <em>$null</em> as the setting value.","pos":[4088,4191],"nodes":[{"content":"Updates a specific per-computer setting.","pos":[0,40]},{"content":"To clear the setting, use <ph id=\"ph1\">&lt;em&gt;</ph>$null<ph id=\"ph2\">&lt;/em&gt;</ph> as the setting value.","pos":[41,103]}]},{"content":"$config.<ph id=\"ph1\">&amp;lt;</ph>setting name<ph id=\"ph2\">&amp;gt; = &amp;lt;</ph>setting value","pos":[4353,4401]},{"content":"Updates a specific per-user setting for all users of the computer. To clear the setting, use <em>$null</em> as the setting value.","pos":[4469,4598],"nodes":[{"content":"Updates a specific per-user setting for all users of the computer.","pos":[0,66]},{"content":"To clear the setting, use <ph id=\"ph1\">&lt;em&gt;</ph>$null<ph id=\"ph2\">&lt;/em&gt;</ph> as the setting value.","pos":[67,129]}]}]},{"content":"Upon configuration of the UE-V Agent with WMI and Windows PowerShell, the defined configuration is stored in the registry in the following locations.","pos":[18658,18807]},{"content":"To export UE-V package settings and repair UE-V templates by using WMI","pos":[18950,19020]},{"content":"UE-V provides the following set of WMI commands.","pos":[19028,19076]},{"content":"Administrators can use this interface to export a package or repair UE-V templates.","pos":[19077,19160]},{"content":"Use the following WMI commands.","pos":[19166,19197]},{"pos":[19203,20089],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">WMI command</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class UserSettings -Name ExportPackage -ArgumentList &lt;package name&gt;</code></p></td>\n<td align=\"left\"><p>Extracts the settings from a package file and converts them into a human-readable format in XML.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name RebuildIndex</code></p></td>\n<td align=\"left\"><p>Repairs the index of the UE-V settings location templates. Must be run as administrator.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"WMI command","pos":[116,127]},{"content":"Description","pos":[150,161]},{"content":"Extracts the settings from a package file and converts them into a human-readable format in XML.","pos":[391,487]},{"content":"Repairs the index of the UE-V settings location templates. Must be run as administrator.","pos":[681,769],"nodes":[{"content":"Repairs the index of the UE-V settings location templates.","pos":[0,58]},{"content":"Must be run as administrator.","pos":[59,88]}]}]},{"content":"<bpt id=\"p1\">**</bpt>Got a suggestion for UE-V<ept id=\"p1\">**</ept>?","pos":[20102,20132]},{"content":"Add or vote on suggestions <bpt id=\"p1\">[</bpt>here<ept id=\"p1\">](http://uev.uservoice.com/forums/280428-microsoft-user-experience-virtualization)</ept>.","pos":[20133,20248]},{"content":"<bpt id=\"p1\">**</bpt>Got a UE-V issue<ept id=\"p1\">**</ept>?","pos":[20249,20270]},{"content":"Use the <bpt id=\"p1\">[</bpt>UE-V TechNet Forum<ept id=\"p1\">](https://social.technet.microsoft.com/Forums/home?forum=mdopuev)</ept>.","pos":[20271,20364]},{"content":"Related topics","pos":[20369,20383]},{"content":"Administering UE-V 2.x with Windows PowerShell and WMI","pos":[20387,20441]},{"content":"Administering UE-V 2.x","pos":[20514,20536]}],"content":"---\ntitle: Managing the UE-V 2.x Agent and Packages with Windows PowerShell and WMI\ndescription: Managing the UE-V 2.x Agent and Packages with Windows PowerShell and WMI\nauthor: jamiejdt\nms.assetid: 56e6780b-8b2c-4717-91c8-2af63062ab75\nms.pagetype: mdop, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w10\n---\n\n\n# Managing the UE-V 2.x Agent and Packages with Windows PowerShell and WMI\n\n\nYou can use Windows Management Instrumentation (WMI) and Windows PowerShell to manage Microsoft User Experience Virtualization (UE-V) 2.0, 2.1, and 2.1 SP1 Agent configuration and synchronization behavior. For a complete list of UE-V PowerShell cmdlets, see [UE-V 2 Cmdlet Reference](http://go.microsoft.com/fwlink/?LinkId=393495) (http://go.microsoft.com/fwlink/?LinkId=393495).\n\n**To deploy the UE-V Agent by using Windows PowerShell**\n\n1.  Stage the UE-V installer file in an accessible network share.\n\n    **Note**  \n    Use AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent. Windows Installer packages, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture. To uninstall the UE-V Agent at a later time by using the installation file, you must use the same file type.\n\n     \n\n2.  Use one of the following Windows PowerShell commands to install the UE-V Agent.\n\n    -   `& AgentSetup.exe /quiet /norestart /log \"%temp%\\UE-VAgentInstaller.log\" SettingsStoragePath=\\\\server\\settingsshare\\%username%`\n\n    -   `& msiexec.exe /i \"<path to msi file>\" /quiet /norestart /l*v \"%temp%\\UE-VAgentInstaller.log\" SettingsStoragePath=\\\\server\\settingsshare\\%username%`\n\n**To configure the UE-V Agent by using Windows PowerShell**\n\n1.  Open a Windows PowerShell window. To manage computer settings that affect all users of the computer by using the *Computer* parameter, open the window with an account that has administrator rights.\n\n2.  Use the following Windows PowerShell commands to configure the agent.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\">Windows PowerShell command</th>\n    <th align=\"left\">Description</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Get-UevConfiguration</code></p>\n    <p></p></td>\n    <td align=\"left\"><p>Gets the effective UE-V Agent settings. User-specific settings have precedence over the computer settings.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Get-UevConfiguration - CurrentComputerUser</code></p>\n    <p></p></td>\n    <td align=\"left\"><p>Gets the UE-V Agent settings values for the current user only.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Get-UevConfiguration -Computer</code></p></td>\n    <td align=\"left\"><p>Gets the UE-V Agent configuration settings values for all users on the computer.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Get-UevConfiguration -Details</code></p></td>\n    <td align=\"left\"><p>Gets the details for each configuration setting. Displays where the setting is configured or if it uses the default value. Is displayed if the current setting is valid.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer –ContactITDescription &lt;IT description&gt;</code></p></td>\n    <td align=\"left\"><p>Sets the text that is displayed in the Company Settings Center for the help link.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer -ContactITUrl &lt;string&gt;</code></p></td>\n    <td align=\"left\"><p>Sets the URL of the link in the Company Settings Center for the help link. Any URL protocol can be used.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer –EnableDontSyncWindows8AppSettings</code></p></td>\n    <td align=\"left\"><p>Configures the UE-V Agent to not synchronize any Windows apps for all users on the computer.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -CurrentComputerUser – EnableDontSyncWindows8AppSettings</code></p></td>\n    <td align=\"left\"><p>Configures the UE-V Agent to not synchronize any Windows apps for the current computer user.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer –EnableFirstUseNotification</code></p></td>\n    <td align=\"left\"><p>Configures the UE-V Agent to display notification the first time the agent runs for all users on the computer.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer –DisableFirstUseNotification</code></p></td>\n    <td align=\"left\"><p>Configures the UE-V Agent to not display notification the first time that the agent runs for all users on the computer.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer –EnableSettingsImportNotify</code></p></td>\n    <td align=\"left\"><p>Configures the UE-V Agent to notify all users on the computer when settings synchronization is delayed.</p>\n    <p>Use the <em>DisableSettingsImportNotify</em> parameter to disable notification.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set-UevConfiguration - CurrentComputerUser -EnableSettingsImportNotify</code></p></td>\n    <td align=\"left\"><p>Configures the UE-V Agent to notify the current user when settings synchronization is delayed.</p>\n    <p>Use the <em>DisableSettingsImportNotify</em> parameter to disable notification.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer –EnableSyncUnlistedWindows8Apps</code></p></td>\n    <td align=\"left\"><p>Configures the UE-V Agent to synchronize all Windows apps that are not explicitly disabled by the Windows app list for all users of the computer. For more information, see &quot;Get-UevAppxPackage&quot; in [Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI](managing-ue-v-2x-settings-location-templates-using-windows-powershell-and-wmi-both-uevv2.md).</p>\n    <p>Use the <em>DisableSyncUnlistedWindows8Apps</em> parameter to configure the UE-V Agent to synchronize only Windows apps that are explicitly enabled by the Windows App List.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set-UevConfiguration - CurrentComputerUser - EnableSyncUnlistedWindows8Apps</code></p></td>\n    <td align=\"left\"><p>Configures the UE-V Agent to synchronize all Windows apps that are not explicitly disabled by the Windows app list for the current user on the computer. For more information, see &quot;Get-UevAppxPackage&quot; in [Managing UE-V 2.x Settings Location Templates Using Windows PowerShell and WMI](managing-ue-v-2x-settings-location-templates-using-windows-powershell-and-wmi-both-uevv2.md).</p>\n    <p>Use the <em>DisableSyncUnlistedWindows8Apps</em> parameter to configure the UE-V Agent to synchronize only Windows apps that are explicitly enabled by the Windows App List.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration –Computer –DisableSync</code></p></td>\n    <td align=\"left\"><p>Disables UE-V for all the users on the computer.</p>\n    <p>Use the <em>EnableSync</em> parameter to enable or re-enable.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set-UevConfiguration –CurrentComputerUser -DisableSync</code></p></td>\n    <td align=\"left\"><p>Disables UE-V for the current user on the computer.</p>\n    <p>Use the <em>EnableSync</em> parameter to enable or re-enable.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer –EnableTrayIcon</code></p></td>\n    <td align=\"left\"><p>Enables the UE-V icon in the notification area for all users of the computer.</p>\n    <p>Use the <em>DisableTrayIcon</em> parameter to disable the icon.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer -MaxPackageSizeInBytes &lt;size in bytes&gt;</code></p></td>\n    <td align=\"left\"><p>Configures the UE-V agent to report when a settings package file size reaches the defined threshold for all users on the computer. Sets the threshold package size in bytes.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -CurrentComputerUser -MaxPackageSizeInBytes &lt;size in bytes&gt;</code></p></td>\n    <td align=\"left\"><p>Configures the UE-V agent to report when a settings package file size reaches the defined threshold. Sets the package size warning threshold for the current user.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer -SettingsImportNotifyDelayInSeconds</code></p></td>\n    <td align=\"left\"><p>Specifies the time in seconds before the user is notified for all users of the computer</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration - CurrentComputerUser -SettingsImportNotifyDelayInSeconds</code></p></td>\n    <td align=\"left\"><p>Specifies the time in seconds before notification for the current user is sent.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer -SettingsStoragePath &lt;path to _settings_storage_location&gt;</code></p></td>\n    <td align=\"left\"><p>Defines a per-computer settings storage location for all users of the computer.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -CurrentComputerUser -SettingsStoragePath &lt;path to _settings_storage_location&gt;</code></p></td>\n    <td align=\"left\"><p>Defines a per-user settings storage location.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set-UevConfiguration –Computer –SettingsTemplateCatalogPath &lt;path to catalog&gt;</code></p></td>\n    <td align=\"left\"><p>Sets the settings template catalog path for all users of the computer.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer -SyncMethod &lt;sync method&gt;</code></p></td>\n    <td align=\"left\"><p>Sets the synchronization method for all users of the computer: SyncProvider or None.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -CurrentComputerUser  -SyncMethod &lt;sync method&gt;</code></p></td>\n    <td align=\"left\"><p>Sets the synchronization method for the current user: SyncProvider or None.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Set-UevConfiguration -Computer -SyncTimeoutInMilliseconds &lt;timeout in milliseconds&gt;</code></p></td>\n    <td align=\"left\"><p>Sets the synchronization time-out in milliseconds for all users of the computer</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Set- UevConfiguration -CurrentComputerUser -SyncTimeoutInMilliseconds &lt;timeout in milliseconds&gt;</code></p></td>\n    <td align=\"left\"><p>Set the synchronization time-out for the current user.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Clear-UevConfiguration –Computer -&lt;setting name&gt;</code></p></td>\n    <td align=\"left\"><p>Clears the specified setting for all users on the computer.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Clear-UevConfiguration –CurrentComputerUser -&lt;setting name&gt;</code></p></td>\n    <td align=\"left\"><p>Clears the specified setting for the current user only.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Export-UevConfiguration &lt;settings migration file&gt;</code></p></td>\n    <td align=\"left\"><p>Exports the UE-V computer configuration to a settings migration file. The file name extension must be .uev.</p>\n    <p>The <code>Export</code> cmdlet exports all UE-V Agent settings that are configurable with the <em>Computer</em> parameter.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Import-UevConfiguration &lt;settings migration file&gt;</code></p></td>\n    <td align=\"left\"><p>Imports the UE-V computer configuration from a settings migration file. The file name extension must be .uev.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n**To export UE-V package settings and repair UE-V templates by using Windows PowerShell**\n\n1.  Open a Windows PowerShell window as an administrator.\n\n2.  Use the following Windows PowerShell commands to configure the agent.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><strong>Windows PowerShell command</strong></p></td>\n    <td align=\"left\"><p><strong>Description</strong></p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Export-UevPackage MicrosoftCalculator6.pkgx</p></td>\n    <td align=\"left\"><p>Extracts the settings from a Microsoft Calculator package file and converts them into a human-readable format in XML.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Repair-UevTemplateIndex</p></td>\n    <td align=\"left\"><p>Repairs the index of the UE-V settings location templates.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n**To configure the UE-V Agent by using WMI**\n\n1.  User Experience Virtualization provides the following set of WMI commands. Administrators can use this interface to configure the UE-V agent at the command line and automate typical configuration tasks.\n\n    Use an account with administrator rights to open a Windows PowerShell window.\n\n2.  Use the following WMI commands to configure the agent.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\"><code>Windows PowerShell command</code></th>\n    <th align=\"left\">Description</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV Configuration</code></p>\n    <p></p></td>\n    <td align=\"left\"><p>Displays the active UE-V Agent settings. User-specific settings have precedence over the computer settings.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguration</code></p></td>\n    <td align=\"left\"><p>Displays the UE-V Agent configuration that is defined for a user.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p></td>\n    <td align=\"left\"><p>Displays the UE-V Agent configuration that is defined for a computer.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Get-WmiObject –Namespace root\\Microsoft\\Uev ConfigurationItem</code></p></td>\n    <td align=\"left\"><p>Displays the details for each configuration item.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n    <p><code>$config.SettingsStoragePath = &lt;path_to_settings_storage_location&gt;</code></p>\n    <p>$config.Put()</p></td>\n    <td align=\"left\"><p>Defines a per-computer settings storage location.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguration</code></p>\n    <p><code>$config.SettingsStoragePath = &lt;path_to_settings_storage_location&gt;</code></p>\n    <p><code>$config.Put()</code></p></td>\n    <td align=\"left\"><p>Defines a per-user settings storage location.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n    <p><code>$config.SyncTimeoutInMilliseconds = &lt;timeout_in_milliseconds&gt;</code></p>\n    <p><code>$config.Put()</code></p></td>\n    <td align=\"left\"><p>Sets the synchronization time-out in milliseconds for all users of the computer.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n    <p><code>$config.MaxPackageSizeInBytes = &lt;size_in_bytes&gt;</code></p>\n    <p><code>$config.Put()</code></p></td>\n    <td align=\"left\"><p>Configures the UE-V Agent to report when a settings package file size reaches a defined threshold. Set the threshold package file size in bytes for all users of the computer.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n    <p><code>$config.SyncMethod = &lt;sync_method&gt;</code></p>\n    <p><code>$config.Put()</code></p></td>\n    <td align=\"left\"><p>Sets the synchronization method for all users of the computer: SyncProvider or None.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n    <p><code>$config.&lt;setting name&gt; = $true</code></p>\n    <p><code>$config.Put()</code></p></td>\n    <td align=\"left\"><p>To enable a specific per-computer setting, clear the setting, and use <em>$null</em> as the setting value. Use UserConfiguration for per-user settings.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n    <p><code>$config.&lt;setting name&gt; = $false</code></p>\n    <p><code>$config.Put()</code></p></td>\n    <td align=\"left\"><p>To disable a specific per-computer setting, clear the setting, and use <em>$null</em> as the setting value. Use User Configuration for per-user settings.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n    <p><code>$config.&lt;setting name&gt; = &lt;setting value&gt;</code></p>\n    <p><code>$config.Put()</code></p></td>\n    <td align=\"left\"><p>Updates a specific per-computer setting. To clear the setting, use <em>$null</em> as the setting value.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</code></p>\n    <p><code></code>$config.&lt;setting name&gt; = &lt;setting value&gt;</p>\n    <p><code>$config.Put()</code></p></td>\n    <td align=\"left\"><p>Updates a specific per-user setting for all users of the computer. To clear the setting, use <em>$null</em> as the setting value.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n    Upon configuration of the UE-V Agent with WMI and Windows PowerShell, the defined configuration is stored in the registry in the following locations.\n\n    `\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\UEV\\Agent\\Configuration`\n\n    `\\HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\UEV\\Agent\\Configuration`\n\n**To export UE-V package settings and repair UE-V templates by using WMI**\n\n1.  UE-V provides the following set of WMI commands. Administrators can use this interface to export a package or repair UE-V templates.\n\n2.  Use the following WMI commands.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\">WMI command</th>\n    <th align=\"left\">Description</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class UserSettings -Name ExportPackage -ArgumentList &lt;package name&gt;</code></p></td>\n    <td align=\"left\"><p>Extracts the settings from a package file and converts them into a human-readable format in XML.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class SettingsLocationTemplate -Name RebuildIndex</code></p></td>\n    <td align=\"left\"><p>Repairs the index of the UE-V settings location templates. Must be run as administrator.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n    **Got a suggestion for UE-V**? Add or vote on suggestions [here](http://uev.uservoice.com/forums/280428-microsoft-user-experience-virtualization). **Got a UE-V issue**? Use the [UE-V TechNet Forum](https://social.technet.microsoft.com/Forums/home?forum=mdopuev).\n\n## Related topics\n\n\n[Administering UE-V 2.x with Windows PowerShell and WMI](administering-ue-v-2x-with-windows-powershell-and-wmi-both-uevv2.md)\n\n[Administering UE-V 2.x](administering-ue-v-2x-new-uevv2.md)\n\n \n\n \n\n\n\n\n\n"}