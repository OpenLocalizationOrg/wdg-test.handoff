{"nodes":[{"content":"Running a Locally Installed Application Inside a Virtual Environment with Virtualized Applications","pos":[11,109]},{"content":"Running a Locally Installed Application Inside a Virtual Environment with Virtualized Applications","pos":[123,221]},{"content":"Running a Locally Installed Application Inside a Virtual Environment with Virtualized Applications","pos":[396,494]},{"content":"You can run a locally installed application in a virtual environment, alongside applications that have been virtualized by using Microsoft Application Virtualization (App-V).","pos":[497,671]},{"content":"You might want to do this if you:","pos":[672,705]},{"content":"Want to install and run an application locally on client computers, but want to virtualize and run specific plug-ins that work with that local application.","pos":[711,866]},{"content":"Are troubleshooting an App-V client package and want to open a local application within the App-V virtual environment.","pos":[872,990]},{"content":"Use any of the following methods to open a local application inside the App-V virtual environment:","pos":[992,1090]},{"content":"RunVirtual registry key","pos":[1097,1120]},{"content":"Get-AppvClientPackage PowerShell cmdlet","pos":[1153,1192]},{"content":"Command line switch /appvpid:<ph id=\"ph1\">&amp;lt;</ph>PID","pos":[1234,1270]},{"content":"Command line hook switch /appvve:<ph id=\"ph1\">&amp;lt;</ph>GUID","pos":[1307,1348]},{"content":"Each method accomplishes essentially the same task, but some methods may be better suited for some applications than others, depending on whether the virtualized application is already running.","pos":[1384,1577]},{"pos":[1625,1648],"content":"RunVirtual registry key"},{"pos":[1651,1864],"content":"To add a locally installed application to a package or to a connection group’s virtual environment, you add a subkey to the <ph id=\"ph1\">`RunVirtual`</ph> registry key in the Registry Editor, as described in the following sections."},{"content":"There is no Group Policy setting available to manage this registry key, so you have to use System Center Configuration Manager or another electronic software distribution (ESD) system, or manually edit the registry.","pos":[1866,2081]},{"pos":[2113,2175],"content":"Supported methods of publishing packages when using RunVirtual"},{"content":"App-V version","pos":[2293,2306]},{"content":"Supported publishing methods","pos":[2329,2357]},{"content":"App-V 5.0 SP3","pos":[2423,2436]},{"content":"Published globally or to the user","pos":[2466,2499]},{"content":"App-V 5.0 through App-V 5.0 SP2","pos":[2553,2584]},{"content":"Published globally only","pos":[2614,2637]},{"content":"Steps to create the subkey","pos":[2679,2705]},{"pos":[2711,2849],"content":"Using the information in the following table, create a new registry key using the name of the executable file, for example, <bpt id=\"p1\">**</bpt>MyApp.exe<ept id=\"p1\">**</ept>."},{"pos":[2855,5021],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Package publishing method</th>\n<th align=\"left\">Where to create the registry key</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Published globally</p></td>\n<td align=\"left\"><p>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual</p>\n<p><strong>Example</strong>: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual\\MyApp.exe</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Published to the user</p></td>\n<td align=\"left\"><p>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual</p>\n<p><strong>Example</strong>: HKEY_CURRENT_USER \\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual\\MyApp.exe</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Connection group can contain:</p>\n<ul>\n<li><p>Packages that are published just globally or just to the user</p></li>\n<li><p>Packages that are published globally and to the user</p></li>\n</ul></td>\n<td align=\"left\"><p>Either HKEY_LOCAL_MACHINE or HKEY_CURRENT_USER key, but all of the following must be true:</p>\n<ul>\n<li><p>If you want to include multiple packages in the virtual environment, you must include them in an enabled connection group.</p></li>\n<li><p>Create only one subkey for one of the packages in the connection group. If, for example, you have one package that is published globally, and another package that is published to the user, you create a subkey for either of these packages, but not both. Although you create a subkey for only one of the packages, all of the packages in the connection group, plus the local application, will be available in the virtual environment.</p></li>\n<li><p>The key under which you create the subkey must match the publishing method you used for the package.</p>\n<p>For example, if you published the package to the user, you must create the subkey under <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual</code>.</p></li>\n</ul></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Package publishing method","pos":[116,141]},{"content":"Where to create the registry key","pos":[164,196]},{"content":"Published globally","pos":[262,280]},{"content":"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual","pos":[310,370]},{"content":"Example<ph id=\"ph1\">&lt;/strong&gt;</ph>: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual\\MyApp.exe","pos":[386,474]},{"content":"Published to the user","pos":[528,549]},{"content":"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual","pos":[579,638]},{"content":"Example<ph id=\"ph1\">&lt;/strong&gt;</ph>: HKEY_CURRENT_USER \\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual\\MyApp.exe","pos":[654,742]},{"content":"Connection group can contain:","pos":[795,824]},{"content":"Packages that are published just globally or just to the user","pos":[841,902]},{"content":"Packages that are published globally and to the user","pos":[919,971]},{"content":"Either HKEY_LOCAL_MACHINE or HKEY_CURRENT_USER key, but all of the following must be true:","pos":[1012,1102]},{"content":"If you want to include multiple packages in the virtual environment, you must include them in an enabled connection group.","pos":[1119,1241]},{"content":"Create only one subkey for one of the packages in the connection group. If, for example, you have one package that is published globally, and another package that is published to the user, you create a subkey for either of these packages, but not both. Although you create a subkey for only one of the packages, all of the packages in the connection group, plus the local application, will be available in the virtual environment.","pos":[1258,1688],"nodes":[{"content":"Create only one subkey for one of the packages in the connection group.","pos":[0,71]},{"content":"If, for example, you have one package that is published globally, and another package that is published to the user, you create a subkey for either of these packages, but not both.","pos":[72,252]},{"content":"Although you create a subkey for only one of the packages, all of the packages in the connection group, plus the local application, will be available in the virtual environment.","pos":[253,430]}]},{"content":"The key under which you create the subkey must match the publishing method you used for the package.","pos":[1705,1805]},{"content":"For example, if you published the package to the user, you must create the subkey under <ph id=\"ph1\">&lt;code&gt;HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual&lt;/code&gt;</ph>.","pos":[1813,1974]}]},{"content":"Set the new registry subkey’s value to the PackageId and VersionId of the package, separating the values with an underscore.","pos":[5034,5158]},{"pos":[5164,5208],"content":"<bpt id=\"p1\">**</bpt>Syntax<ept id=\"p1\">**</ept>: <ph id=\"ph1\">&amp;lt;</ph>PackageId<ph id=\"ph2\">&amp;gt;\\_&amp;lt;</ph>VersionId"},{"pos":[5218,5304],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>: 4c909996-afc9-4352-b606-0b74542a09c1<ph id=\"ph1\">\\_</ph>be463724-Oct1-48f1-8604-c4bd7ca92fa"},{"content":"The application in the previous example would produce a registry export file (.reg file) like the following:","pos":[5310,5418]},{"pos":[5771,5810],"content":"Get-AppvClientPackage PowerShell cmdlet"},{"content":"You can use the <bpt id=\"p1\">**</bpt>Start-AppVVirtualProcess<ept id=\"p1\">**</ept> cmdlet to retrieve the package name and then start a process within the specified package's virtual environment.","pos":[5813,5970]},{"content":"This method lets you launch any command within the context of an App-V package, regardless of whether the package is currently running.","pos":[5971,6106]},{"pos":[6108,6206],"content":"Use the following example syntax, and substitute the name of your package for <bpt id=\"p1\">**</bpt><ph id=\"ph1\">&amp;lt;</ph>Package<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">**</ept>:"},{"pos":[6319,6537],"content":"If you don’t know the exact name of your package, you can use the command line <bpt id=\"p1\">**</bpt>Get-AppvClientPackage <ph id=\"ph1\">\\*</ph>executable<ph id=\"ph2\">\\*</ph><ept id=\"p1\">**</ept>, where <bpt id=\"p2\">**</bpt>executable<ept id=\"p2\">**</ept> is the name of the application, for example: Get-AppvClientPackage <ph id=\"ph3\">\\*</ph>Word<ph id=\"ph4\">\\*</ph>."},{"pos":[6585,6621],"content":"Command line switch /appvpid:<ph id=\"ph1\">&amp;lt;</ph>PID"},{"content":"You can apply the <bpt id=\"p1\">**</bpt>/appvpid:<ph id=\"ph1\">&amp;lt;</ph>PID<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">**</ept> switch to any command, which enables that command to run within a virtual process that you select by specifying its process ID (PID).","pos":[6628,6804]},{"content":"Using this method launches the new executable in the same App-V environment as an executable that is already running.","pos":[6805,6922]},{"pos":[6924,6932],"content":"Example:"},{"pos":[6958,7075],"content":"To find the process ID (PID) of your App-V process, run the command <bpt id=\"p1\">**</bpt>tasklist.exe<ept id=\"p1\">**</ept> from an elevated command prompt."},{"pos":[7127,7168],"content":"Command line hook switch /appvve:<ph id=\"ph1\">&amp;lt;</ph>GUID"},{"content":"This switch lets you run a local command within the virtual environment of an App-V package.","pos":[7175,7267]},{"content":"Unlike the <bpt id=\"p1\">**</bpt>/appvid<ept id=\"p1\">**</ept> switch, where the virtual environment must already be running, this switch enables you to start the virtual environment.","pos":[7268,7411]},{"pos":[7413,7420],"content":"Syntax:"},{"pos":[7466,7474],"content":"Example:"},{"content":"To get the package GUID and version GUID of your application, run the <bpt id=\"p1\">**</bpt>Get-AppvClientPackage<ept id=\"p1\">**</ept> cmdlet.","pos":[7560,7663]},{"content":"Concatenate the <bpt id=\"p1\">**</bpt>/appvve<ept id=\"p1\">**</ept> switch with the following:","pos":[7664,7718]},{"content":"A colon","pos":[7724,7731]},{"content":"Package GUID of the desired package","pos":[7737,7772]},{"content":"An underscore","pos":[7778,7791]},{"content":"Version ID of the desired package","pos":[7797,7830]},{"pos":[7832,8042],"content":"If you don’t know the exact name of your package, use the command line <bpt id=\"p1\">**</bpt>Get-AppvClientPackage <ph id=\"ph1\">\\*</ph>executable<ph id=\"ph2\">\\*</ph><ept id=\"p1\">**</ept>, where <bpt id=\"p2\">**</bpt>executable<ept id=\"p2\">**</ept> is the name of the application, for example: Get-AppvClientPackage <ph id=\"ph3\">\\*</ph>Word<ph id=\"ph4\">\\*</ph>."},{"content":"This method lets you launch any command within the context of an App-V package, regardless of whether the package is currently running.","pos":[8044,8179]},{"content":"Got a suggestion for App-V?","pos":[8184,8211]},{"content":"Add or vote on suggestions <bpt id=\"p1\">[</bpt>here<ept id=\"p1\">](http://appv.uservoice.com/forums/280448-microsoft-application-virtualization)</ept>.","pos":[8214,8326]},{"content":"For App-V issues, use the <bpt id=\"p1\">[</bpt>App-V TechNet Forum<ept id=\"p1\">](https://social.technet.microsoft.com/Forums/home?forum=mdopappv)</ept>.","pos":[8327,8440]},{"content":"Related topics","pos":[8445,8459]},{"content":"Technical Reference for App-V 5.0","pos":[8463,8496]}],"content":"---\ntitle: Running a Locally Installed Application Inside a Virtual Environment with Virtualized Applications\ndescription: Running a Locally Installed Application Inside a Virtual Environment with Virtualized Applications\nauthor: jamiejdt\nms.assetid: a8affa46-f1f7-416c-8125-9595cfbfdbc7\nms.pagetype: mdop, appcompat, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w10\n---\n\n\n# Running a Locally Installed Application Inside a Virtual Environment with Virtualized Applications\n\n\nYou can run a locally installed application in a virtual environment, alongside applications that have been virtualized by using Microsoft Application Virtualization (App-V). You might want to do this if you:\n\n-   Want to install and run an application locally on client computers, but want to virtualize and run specific plug-ins that work with that local application.\n\n-   Are troubleshooting an App-V client package and want to open a local application within the App-V virtual environment.\n\nUse any of the following methods to open a local application inside the App-V virtual environment:\n\n-   [RunVirtual registry key](#bkmk-runvirtual-regkey)\n\n-   [Get-AppvClientPackage PowerShell cmdlet](#bkmk-get-appvclientpackage-posh)\n\n-   [Command line switch /appvpid:&lt;PID&gt;](#bkmk-cl-switch-appvpid)\n\n-   [Command line hook switch /appvve:&lt;GUID&gt;](#bkmk-cl-hook-switch-appvve)\n\nEach method accomplishes essentially the same task, but some methods may be better suited for some applications than others, depending on whether the virtualized application is already running.\n\n## <a href=\"\" id=\"bkmk-runvirtual-regkey\"></a>RunVirtual registry key\n\n\nTo add a locally installed application to a package or to a connection group’s virtual environment, you add a subkey to the `RunVirtual` registry key in the Registry Editor, as described in the following sections.\n\nThere is no Group Policy setting available to manage this registry key, so you have to use System Center Configuration Manager or another electronic software distribution (ESD) system, or manually edit the registry.\n\n### <a href=\"\" id=\"bkmk-\"></a>Supported methods of publishing packages when using RunVirtual\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">App-V version</th>\n<th align=\"left\">Supported publishing methods</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>App-V 5.0 SP3</p></td>\n<td align=\"left\"><p>Published globally or to the user</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>App-V 5.0 through App-V 5.0 SP2</p></td>\n<td align=\"left\"><p>Published globally only</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n### Steps to create the subkey\n\n1.  Using the information in the following table, create a new registry key using the name of the executable file, for example, **MyApp.exe**.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\">Package publishing method</th>\n    <th align=\"left\">Where to create the registry key</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Published globally</p></td>\n    <td align=\"left\"><p>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual</p>\n    <p><strong>Example</strong>: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual\\MyApp.exe</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Published to the user</p></td>\n    <td align=\"left\"><p>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual</p>\n    <p><strong>Example</strong>: HKEY_CURRENT_USER \\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual\\MyApp.exe</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Connection group can contain:</p>\n    <ul>\n    <li><p>Packages that are published just globally or just to the user</p></li>\n    <li><p>Packages that are published globally and to the user</p></li>\n    </ul></td>\n    <td align=\"left\"><p>Either HKEY_LOCAL_MACHINE or HKEY_CURRENT_USER key, but all of the following must be true:</p>\n    <ul>\n    <li><p>If you want to include multiple packages in the virtual environment, you must include them in an enabled connection group.</p></li>\n    <li><p>Create only one subkey for one of the packages in the connection group. If, for example, you have one package that is published globally, and another package that is published to the user, you create a subkey for either of these packages, but not both. Although you create a subkey for only one of the packages, all of the packages in the connection group, plus the local application, will be available in the virtual environment.</p></li>\n    <li><p>The key under which you create the subkey must match the publishing method you used for the package.</p>\n    <p>For example, if you published the package to the user, you must create the subkey under <code>HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual</code>.</p></li>\n    </ul></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n2.  Set the new registry subkey’s value to the PackageId and VersionId of the package, separating the values with an underscore.\n\n    **Syntax**: &lt;PackageId&gt;\\_&lt;VersionId&gt;\n\n    **Example**: 4c909996-afc9-4352-b606-0b74542a09c1\\_be463724-Oct1-48f1-8604-c4bd7ca92fa\n\n    The application in the previous example would produce a registry export file (.reg file) like the following:\n\n    ``` syntax\n    Windows Registry Editor Version 5.00 \n    [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual] \n    @=\"\" \n    [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\AppV\\Client\\RunVirtual\\MyApp.exe] \n    @=\"aaaaaaaa-bbbb-cccc-dddd-eeeeeeee_11111111-2222-3333-4444-555555555\n    ```\n\n## <a href=\"\" id=\"bkmk-get-appvclientpackage-posh\"></a>Get-AppvClientPackage PowerShell cmdlet\n\n\nYou can use the **Start-AppVVirtualProcess** cmdlet to retrieve the package name and then start a process within the specified package's virtual environment. This method lets you launch any command within the context of an App-V package, regardless of whether the package is currently running.\n\nUse the following example syntax, and substitute the name of your package for **&lt;Package&gt;**:\n\n`$AppVName = Get-AppvClientPackage <Package>`\n\n`Start-AppvVirtualProcess -AppvClientObject $AppVName cmd.exe`\n\nIf you don’t know the exact name of your package, you can use the command line **Get-AppvClientPackage \\*executable\\***, where **executable** is the name of the application, for example: Get-AppvClientPackage \\*Word\\*.\n\n## <a href=\"\" id=\"bkmk-cl-switch-appvpid\"></a>Command line switch /appvpid:&lt;PID&gt;\n\n\nYou can apply the **/appvpid:&lt;PID&gt;** switch to any command, which enables that command to run within a virtual process that you select by specifying its process ID (PID). Using this method launches the new executable in the same App-V environment as an executable that is already running.\n\nExample: `cmd.exe /appvpid:8108`\n\nTo find the process ID (PID) of your App-V process, run the command **tasklist.exe** from an elevated command prompt.\n\n## <a href=\"\" id=\"bkmk-cl-hook-switch-appvve\"></a>Command line hook switch /appvve:&lt;GUID&gt;\n\n\nThis switch lets you run a local command within the virtual environment of an App-V package. Unlike the **/appvid** switch, where the virtual environment must already be running, this switch enables you to start the virtual environment.\n\nSyntax: `cmd.exe /appvve:<PACKAGEGUID_VERSIONGUID>`\n\nExample: `cmd.exe /appvve:aaaaaaaa-bbbb-cccc-dddd-eeeeeeee_11111111-2222-3333-4444-55555555`\n\nTo get the package GUID and version GUID of your application, run the **Get-AppvClientPackage** cmdlet. Concatenate the **/appvve** switch with the following:\n\n-   A colon\n\n-   Package GUID of the desired package\n\n-   An underscore\n\n-   Version ID of the desired package\n\nIf you don’t know the exact name of your package, use the command line **Get-AppvClientPackage \\*executable\\***, where **executable** is the name of the application, for example: Get-AppvClientPackage \\*Word\\*.\n\nThis method lets you launch any command within the context of an App-V package, regardless of whether the package is currently running.\n\n## Got a suggestion for App-V?\n\n\nAdd or vote on suggestions [here](http://appv.uservoice.com/forums/280448-microsoft-application-virtualization). For App-V issues, use the [App-V TechNet Forum](https://social.technet.microsoft.com/Forums/home?forum=mdopappv).\n\n## Related topics\n\n\n[Technical Reference for App-V 5.0](technical-reference-for-app-v-50.md)\n\n \n\n \n\n\n\n\n\n"}