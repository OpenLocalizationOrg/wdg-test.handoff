{"nodes":[{"content":"5031(F) The Windows Firewall Service blocked an application from accepting incoming connections on the network.","pos":[11,122]},{"content":"(Windows 10)","pos":[123,135]},{"content":"Describes security event 5031(F) The Windows Firewall Service blocked an application from accepting incoming connections on the network.","pos":[149,285]},{"content":"5031(F): The Windows Firewall Service blocked an application from accepting incoming connections on the network.","pos":[385,497]},{"content":"Applies to","pos":[501,511]},{"content":"Windows 10","pos":[518,528]},{"content":"Windows Server 2016","pos":[533,552]},{"pos":[672,773],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit Filtering Platform Connection<ept id=\"p2\">](audit-filtering-platform-connection.md)</ept>"},{"content":"Event Description:","pos":[778,796]},{"pos":[801,1018],"content":"This event generates when an application was blocked from accepting incoming connections on the network by <bpt id=\"p1\">[</bpt>Windows Filtering Platform<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366510(v=vs.85).aspx)</ept>."},{"pos":[1020,1332],"content":"If you don’t have any firewall rules (Allow or Deny) in Windows Firewall for specific applications, you will get this event from <bpt id=\"p1\">[</bpt>Windows Filtering Platform<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366510(v=vs.85).aspx)</ept> layer, because by default this layer is denying any incoming connections."},{"pos":[1336,1472],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For recommendations, see <bpt id=\"p2\">[</bpt>Security Monitoring Recommendations<ept id=\"p2\">](#security-monitoring-recommendations)</ept> for this event."},{"content":"Event XML:","pos":[1495,1505]},{"pos":[2262,2296],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> None."},{"pos":[2298,2359],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008, Windows Vista."},{"pos":[2361,2385],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Field Descriptions:","pos":[2390,2409]},{"content":"<bpt id=\"p1\">**</bpt>Profiles<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: network profile using which application was blocked.","pos":[2418,2509]},{"content":"Possible values:","pos":[2510,2526]},{"content":"Domain","pos":[2536,2542]},{"content":"Public","pos":[2552,2558]},{"content":"Private","pos":[2568,2575]},{"pos":[2581,2690],"content":"<bpt id=\"p1\">**</bpt>Application<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: full path and file name of executable file for blocked application."},{"content":"Security Monitoring Recommendations","pos":[2695,2730]},{"content":"For 5031(F): The Windows Firewall Service blocked an application from accepting incoming connections on the network.","pos":[2732,2848]},{"content":"You can use this event to detect applications for which no Windows Firewall rules were created.","pos":[2854,2949]},{"pos":[2955,3148],"content":"If you have a pre-defined application which should be used to perform the operation that was reported by this event, monitor events with “<bpt id=\"p1\">**</bpt>Application<ept id=\"p1\">**</ept>” not equal to your defined application."},{"pos":[3154,3355],"content":"You can monitor to see if “<bpt id=\"p1\">**</bpt>Application<ept id=\"p1\">**</ept>” is not in a standard folder (for example, not in <bpt id=\"p2\">**</bpt>System32<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Program Files<ept id=\"p3\">**</ept>) or is in a restricted folder (for example, <bpt id=\"p4\">**</bpt>Temporary Internet Files<ept id=\"p4\">**</ept>)."},{"pos":[3361,3544],"content":"If you have a pre-defined list of restricted substrings or words in application names (for example, “<bpt id=\"p1\">**</bpt>mimikatz<ept id=\"p1\">**</ept>” or “<bpt id=\"p2\">**</bpt>cain.exe<ept id=\"p2\">**</ept>”), check for these substrings in “<bpt id=\"p3\">**</bpt>Application<ept id=\"p3\">**</ept>.”"}],"content":"---\ntitle: 5031(F) The Windows Firewall Service blocked an application from accepting incoming connections on the network. (Windows 10)\ndescription: Describes security event 5031(F) The Windows Firewall Service blocked an application from accepting incoming connections on the network.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 5031(F): The Windows Firewall Service blocked an application from accepting incoming connections on the network.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\n<img src=\"images/event-5031.png\" alt=\"Event 5031 illustration\" width=\"449\" height=\"317\" hspace=\"10\" align=\"left\" />\n\n***Subcategory:***&nbsp;[Audit Filtering Platform Connection](audit-filtering-platform-connection.md)\n\n***Event Description:***\n\nThis event generates when an application was blocked from accepting incoming connections on the network by [Windows Filtering Platform](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366510(v=vs.85).aspx).\n\nIf you don’t have any firewall rules (Allow or Deny) in Windows Firewall for specific applications, you will get this event from [Windows Filtering Platform](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366510(v=vs.85).aspx) layer, because by default this layer is denying any incoming connections.\n\n> **Note**&nbsp;&nbsp;For recommendations, see [Security Monitoring Recommendations](#security-monitoring-recommendations) for this event.\n\n<br clear=\"all\">\n\n***Event XML:***\n```\n- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n- <System>\n <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> \n <EventID>5031</EventID> \n <Version>0</Version> \n <Level>0</Level> \n <Task>12810</Task> \n <Opcode>0</Opcode> \n <Keywords>0x8010000000000000</Keywords> \n <TimeCreated SystemTime=\"2015-09-22T03:46:36.634473000Z\" /> \n <EventRecordID>304373</EventRecordID> \n <Correlation /> \n <Execution ProcessID=\"516\" ThreadID=\"2976\" /> \n <Channel>Security</Channel> \n <Computer>DC01.contoso.local</Computer> \n <Security /> \n </System>\n- <EventData>\n <Data Name=\"Profiles\">Domain</Data> \n <Data Name=\"Application\">C:\\\\documents\\\\listener.exe</Data> \n </EventData>\n </Event>\n\n```\n\n***Required Server Roles:*** None.\n\n***Minimum OS Version:*** Windows Server 2008, Windows Vista.\n\n***Event Versions:*** 0.\n\n***Field Descriptions:***\n\n-   **Profiles** \\[Type = UnicodeString\\]: network profile using which application was blocked. Possible values:\n\n    -   Domain\n\n    -   Public\n\n    -   Private\n\n-   **Application** \\[Type = UnicodeString\\]: full path and file name of executable file for blocked application.\n\n## Security Monitoring Recommendations\n\nFor 5031(F): The Windows Firewall Service blocked an application from accepting incoming connections on the network.\n\n-   You can use this event to detect applications for which no Windows Firewall rules were created.\n\n-   If you have a pre-defined application which should be used to perform the operation that was reported by this event, monitor events with “**Application**” not equal to your defined application.\n\n-   You can monitor to see if “**Application**” is not in a standard folder (for example, not in **System32** or **Program Files**) or is in a restricted folder (for example, **Temporary Internet Files**).\n\n-   If you have a pre-defined list of restricted substrings or words in application names (for example, “**mimikatz**” or “**cain.exe**”), check for these substrings in “**Application**.”\n\n"}