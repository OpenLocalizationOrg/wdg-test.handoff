{"nodes":[{"content":"Online deployment with Office 365 (Surface Hub)","pos":[11,58]},{"content":"This topic has instructions for adding a device account for your Microsoft Surface Hub when you have a pure, online deployment.","pos":[72,199]},{"content":"Online deployment with Office 365 (Surface Hub)","pos":[411,458]},{"content":"This topic has instructions for adding a device account for your Microsoft Surface Hub when you have a pure, online deployment.","pos":[461,588]},{"content":"If you have a pure, online (O365) deployment, then you can <bpt id=\"p1\">[</bpt>use the provided PowerShell scripts<ept id=\"p1\">](appendix-a-powershell-scripts-for-surface-hub.md#create-os356-ps-scripts)</ept> to create device accounts.","pos":[590,787]},{"content":"If you’re using Microsoft Exchange 2010 or Lync 2010, you can use equivalent cmdlets that will produce the same results.","pos":[788,908]},{"content":"Those cmdlets are described in this section.","pos":[909,953]},{"content":"Start a remote PowerShell session on a PC and connect to Exchange.","pos":[959,1025]},{"content":"Be sure you have the right permissions set to run the associated cmdlets.","pos":[1031,1104]},{"content":"After establishing a session, you’ll either create a new mailbox and enable it as a RoomMailboxAccount, or change the settings for an existing room mailbox.","pos":[1456,1612]},{"content":"This will allow the account to authenticate into the Surface Hub.","pos":[1613,1678]},{"content":"If you're changing an existing resource mailbox:","pos":[1684,1732]},{"content":"If you’re creating a new resource mailbox:","pos":[1916,1958]},{"content":"After setting up the mailbox, you will need to either create a new Exchange ActiveSync policy, or use a compatible existing policy.","pos":[2203,2334]},{"content":"Surface Hubs are only compatible with device accounts that have an ActiveSync policy where the <bpt id=\"p1\">**</bpt>PasswordEnabled<ept id=\"p1\">**</ept> property is set to False.","pos":[2340,2480]},{"content":"If this isn’t set properly, then Exchange services on the Surface Hub (mail, calendar, and joining meetings), will not be enabled.","pos":[2481,2611]},{"content":"If you haven’t created a compatible policy yet, use the following cmdlet—this one creates a policy called \"Surface Hubs\".","pos":[2617,2738]},{"content":"Once it’s created, you can apply the same policy to other device accounts.","pos":[2739,2813]},{"content":"Once you have a compatible policy, then you will need to apply the policy to the device account.","pos":[2937,3033]},{"content":"However, policies can only be applied to user accounts and not resource mailboxes.","pos":[3034,3116]},{"content":"You need to convert the mailbox into a user type, apply the policy, and then convert it back into a mailbox—you may need to re-enable it and set the password again too.","pos":[3117,3285]},{"content":"Various Exchange properties must be set on the device account to improve the meeting experience.","pos":[3579,3675]},{"content":"You can see which properties need to be set in the <bpt id=\"p1\">[</bpt>Exchange properties<ept id=\"p1\">](exchange-properties-for-surface-hub-device-accounts.md)</ept> section.","pos":[3676,3813]},{"content":"Connect to Azure AD.","pos":[4176,4196]},{"content":"You need to connect to Azure AD to apply some account settings.","pos":[4202,4265]},{"content":"You can run this cmdlet to connect.","pos":[4266,4301]},{"content":"If you decide to have the password not expire, you can set that with PowerShell cmdlets too.","pos":[4376,4468]},{"content":"See <bpt id=\"p1\">[</bpt>Password management<ept id=\"p1\">](password-management-for-surface-hub-device-accounts.md)</ept> for more information.","pos":[4469,4572]},{"content":"The device account needs to have a valid Office 365 (O365) license, or Exchange and Skype for Business will not work.","pos":[4678,4795]},{"content":"If you have the license, you need to assign a usage location to your device account—this determines what license SKUs are available for your account.","pos":[4796,4945]},{"pos":[4951,5048],"content":"Next, you can use <ph id=\"ph1\">`Get-MsolAccountSku`</ph> to retrieve a list of available SKUs for your O365 tenant."},{"content":"Once you list out the SKUs, you can add a license using the <ph id=\"ph1\">`Set-MsolUserLicense`</ph> cmdlet.","pos":[5054,5143]},{"content":"In this case, <ph id=\"ph1\">`$strLicense`</ph> is the SKU code that you see (for example, <bpt id=\"p1\">*</bpt>contoso:STANDARDPACK<ept id=\"p1\">*</ept>).","pos":[5144,5239]},{"content":"Enable the device account with Skype for Business.","pos":[5437,5487]},{"content":"In order to enable Skype for Business, your environment will need to meet the following prerequisites:","pos":[5493,5595]},{"content":"You'll need to have Lync Online (Plan 2) or higher in your O365 plan.","pos":[5605,5674]},{"content":"The plan needs to support conferencing capability.","pos":[5675,5725]},{"content":"If you need Enterprise Voice (PSTN telephony) using telephony service providers for the Surface Hub, you need Lync Online (Plan 3).","pos":[5734,5865]},{"content":"Your tenant users must have Exchange mailboxes.","pos":[5874,5921]},{"content":"Your Surface Hub account does require a Lync Online (Plan 2) or Lync Online (Plan 3) license, but it does not require an Exchange Online license.","pos":[5930,6075]},{"content":"Start by creating a remote PowerShell session from a PC.","pos":[6099,6155]},{"content":"To enable your Surface Hub account for Skype for Business Server, run this cmdlet:","pos":[6347,6429]},{"pos":[6603,6776],"content":"If you aren't sure what value to use for the <ph id=\"ph1\">`RegistrarPool`</ph> parameter in your environment, you can get the value from an existing Skype for Business user using this cmdlet:"},{"content":"Assign Skype for Business license to your Surface Hub account.","pos":[6902,6964]},{"content":"Once you've completed the preceding steps to enable your Surface Hub account in Skype for Business Online, you need to assign a license to the Surface Hub.","pos":[6970,7125]},{"content":"Using the O365 administrative portal, assign either a Skype for Business Online (Plan 2) or a Skype for Business Online (Plan 3) to the device.","pos":[7126,7269]},{"content":"Login as a tenant administrator, open the O365 Administrative Portal, and click on the Admin app.","pos":[7279,7376]},{"pos":[7385,7465],"content":"Click on <bpt id=\"p1\">**</bpt>Users and Groups<ept id=\"p1\">**</ept> and then <bpt id=\"p2\">**</bpt>Add users, reset passwords, and more<ept id=\"p2\">**</ept>."},{"content":"Select the Surface Hub account, and then click or tap the pen icon, which means edit.","pos":[7474,7559]},{"pos":[7568,7601],"content":"Click on the <bpt id=\"p1\">**</bpt>Licenses<ept id=\"p1\">**</ept> option."},{"content":"In the <bpt id=\"p1\">**</bpt>Assign licenses<ept id=\"p1\">**</ept> section, you need to select Skype for Business (Plan 2) or Skype for Business (Plan 3), depending on your licensing and what you've decided in terms of needing Enterprise Voice.","pos":[7610,7814]},{"content":"You'll have to use a Plan 3 license if you want to use Enterprise Voice on your Surface Hub.","pos":[7815,7907]},{"pos":[7916,7947],"content":"Click <bpt id=\"p1\">**</bpt>Save<ept id=\"p1\">**</ept> and you're done."},{"pos":[7950,8138],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>: It's also possible to use the Windows Azure Active Directory Module for Windows PowerShell to run the cmdlets needed to assign one of these licenses, but that's not covered here."},{"content":"For validation, you should be able to use any Skype for Business client (PC, Android, etc) to log in to this account.","pos":[8140,8257]}],"content":"---\ntitle: Online deployment with Office 365 (Surface Hub)\ndescription: This topic has instructions for adding a device account for your Microsoft Surface Hub when you have a pure, online deployment.\nms.assetid: D325CA68-A03F-43DF-8520-EACF7C3EDEC1\nkeywords: device account for Surface Hub, online deployment\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: surfacehub\nauthor: TrudyHa\n---\n\n# Online deployment with Office 365 (Surface Hub)\n\n\nThis topic has instructions for adding a device account for your Microsoft Surface Hub when you have a pure, online deployment.\n\nIf you have a pure, online (O365) deployment, then you can [use the provided PowerShell scripts](appendix-a-powershell-scripts-for-surface-hub.md#create-os356-ps-scripts) to create device accounts. If you’re using Microsoft Exchange 2010 or Lync 2010, you can use equivalent cmdlets that will produce the same results. Those cmdlets are described in this section.\n\n1.  Start a remote PowerShell session on a PC and connect to Exchange.\n\n    Be sure you have the right permissions set to run the associated cmdlets.\n\n    ```PowerShell\n    Set-ExecutionPolicy Unrestricted\n    $org='contoso.microsoft.com'\n    $cred=Get-Credential $admin@$org\n    $sess= New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlook.office365.com/powershell-liveid/ -Credential $cred -Authentication Basic -AllowRedirection\n    Import-PSSession $sess\n    ```\n\n2.  After establishing a session, you’ll either create a new mailbox and enable it as a RoomMailboxAccount, or change the settings for an existing room mailbox. This will allow the account to authenticate into the Surface Hub.\n\n    If you're changing an existing resource mailbox:\n\n    ```PowerShell\n    Set-Mailbox -Identity 'HUB01' -EnableRoomMailboxAccount $true -RoomMailboxPassword (ConvertTo-SecureString -String <password> -AsPlainText -Force)\n    ```\n\n    If you’re creating a new resource mailbox:\n\n    ```PowerShell\n    New-Mailbox -MicrosoftOnlineServicesID HUB01@contoso.com -Alias HUB01 -Name \"Hub-01\" -Room -EnableRoomMailboxAccount $true -RoomMailboxPassword (ConvertTo-SecureString -String <password> -AsPlainText -Force)\n    ```\n\n3.  After setting up the mailbox, you will need to either create a new Exchange ActiveSync policy, or use a compatible existing policy.\n\n    Surface Hubs are only compatible with device accounts that have an ActiveSync policy where the **PasswordEnabled** property is set to False. If this isn’t set properly, then Exchange services on the Surface Hub (mail, calendar, and joining meetings), will not be enabled.\n\n    If you haven’t created a compatible policy yet, use the following cmdlet—this one creates a policy called \"Surface Hubs\". Once it’s created, you can apply the same policy to other device accounts.\n\n    ```PowerShell\n    $easPolicy = New-MobileDeviceMailboxPolicy -Name “SurfaceHubs” -PasswordEnabled $false\n    ```\n\n    Once you have a compatible policy, then you will need to apply the policy to the device account. However, policies can only be applied to user accounts and not resource mailboxes. You need to convert the mailbox into a user type, apply the policy, and then convert it back into a mailbox—you may need to re-enable it and set the password again too.\n\n    ```PowerShell\n    Set-Mailbox $acctUpn -Type Regular\n    Set-CASMailbox $acctUpn -ActiveSyncMailboxPolicy $easPolicy.Id\n    Set-Mailbox $acctUpn -Type Room\n    Set-Mailbox $credNewAccount.UserName -RoomMailboxPassword $credNewAccount.Password -EnableRoomMailboxAccount $true\n    ```\n\n4.  Various Exchange properties must be set on the device account to improve the meeting experience. You can see which properties need to be set in the [Exchange properties](exchange-properties-for-surface-hub-device-accounts.md) section.\n\n    ```PowerShell\n    Set-CalendarProcessing -Identity $acctUpn -AutomateProcessing AutoAccept -AddOrganizerToSubject $false –AllowConflicts $false –DeleteComments $false -DeleteSubject $false -RemovePrivateProperty $false\n    Set-CalendarProcessing -Identity $acctUpn -AddAdditionalResponse $true -AdditionalResponse \"This is a Surface Hub room!\"\n    ```\n\n5.  Connect to Azure AD.\n\n    You need to connect to Azure AD to apply some account settings. You can run this cmdlet to connect.\n\n    ```PowerShell\n    Connect-MsolService -Credential $cred\n    ```\n\n6.  If you decide to have the password not expire, you can set that with PowerShell cmdlets too. See [Password management](password-management-for-surface-hub-device-accounts.md) for more information.\n\n    ```PowerShell\n    Set-MsolUser -UserPrincipalName $acctUpn -PasswordNeverExpires $true\n    ```\n\n7.  The device account needs to have a valid Office 365 (O365) license, or Exchange and Skype for Business will not work. If you have the license, you need to assign a usage location to your device account—this determines what license SKUs are available for your account.\n\n    Next, you can use `Get-MsolAccountSku` to retrieve a list of available SKUs for your O365 tenant.\n\n    Once you list out the SKUs, you can add a license using the `Set-MsolUserLicense` cmdlet. In this case, `$strLicense` is the SKU code that you see (for example, *contoso:STANDARDPACK*).\n\n    ```PowerShell\n    Set-MsolUser -UserPrincipalName $acctUpn -UsageLocation \"US\"\n    Get-MsolAccountSku\n    Set-MsolUserLicense -UserPrincipalName $acctUpn -AddLicenses $strLicense\n    ```\n\n8.  Enable the device account with Skype for Business.\n\n    In order to enable Skype for Business, your environment will need to meet the following prerequisites:\n\n    -   You'll need to have Lync Online (Plan 2) or higher in your O365 plan. The plan needs to support conferencing capability.\n    -   If you need Enterprise Voice (PSTN telephony) using telephony service providers for the Surface Hub, you need Lync Online (Plan 3).\n    -   Your tenant users must have Exchange mailboxes.\n    -   Your Surface Hub account does require a Lync Online (Plan 2) or Lync Online (Plan 3) license, but it does not require an Exchange Online license.\n\n    <!-- -->\n\n    -   Start by creating a remote PowerShell session from a PC.\n\n        ```PowerShell\n        Import-Module LyncOnlineConnector  \n        $cssess=New-CsOnlineSession -Credential $cred  \n        Import-PSSession $cssess -AllowClobber\n        ```\n\n    -   To enable your Surface Hub account for Skype for Business Server, run this cmdlet:\n\n        ```PowerShell\n        Enable-CsMeetingRoom -Identity $rm -RegistrarPool  \n        \"sippoolbl20a04.infra.lync.com\" -SipAddressType EmailAddress\n        ```\n\n        If you aren't sure what value to use for the `RegistrarPool` parameter in your environment, you can get the value from an existing Skype for Business user using this cmdlet:\n\n        ```PowerShell\n        Get-CsOnlineUser -Identity ‘alice@contoso.microsoft.com’| fl *registrarpool*\n        ```\n\n9.  Assign Skype for Business license to your Surface Hub account.\n\n    Once you've completed the preceding steps to enable your Surface Hub account in Skype for Business Online, you need to assign a license to the Surface Hub. Using the O365 administrative portal, assign either a Skype for Business Online (Plan 2) or a Skype for Business Online (Plan 3) to the device.\n\n    -   Login as a tenant administrator, open the O365 Administrative Portal, and click on the Admin app.\n    -   Click on **Users and Groups** and then **Add users, reset passwords, and more**.\n    -   Select the Surface Hub account, and then click or tap the pen icon, which means edit.\n    -   Click on the **Licenses** option.\n    -   In the **Assign licenses** section, you need to select Skype for Business (Plan 2) or Skype for Business (Plan 3), depending on your licensing and what you've decided in terms of needing Enterprise Voice. You'll have to use a Plan 3 license if you want to use Enterprise Voice on your Surface Hub.\n    -   Click **Save** and you're done.\n\n>**Note**: It's also possible to use the Windows Azure Active Directory Module for Windows PowerShell to run the cmdlets needed to assign one of these licenses, but that's not covered here.\n\nFor validation, you should be able to use any Skype for Business client (PC, Android, etc) to log in to this account.\n\n\n\n\n\n"}