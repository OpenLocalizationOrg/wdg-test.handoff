{"nodes":[{"content":"Network security Do not store LAN Manager hash value on next password change (Windows 10)","pos":[11,100]},{"content":"Describes the best practices, location, values, policy management and security considerations for the Network security Do not store LAN Manager hash value on next password change security policy setting.","pos":[114,317]},{"content":"Network security: Do not store LAN Manager hash value on next password change","pos":[473,550]},{"content":"Applies to","pos":[554,564]},{"content":"Windows 10","pos":[571,581]},{"pos":[583,791],"content":"Describes the best practices, location, values, policy management and security considerations for the <bpt id=\"p1\">**</bpt>Network security: Do not store LAN Manager hash value on next password change<ept id=\"p1\">**</ept> security policy setting."},{"content":"Reference","pos":[796,805]},{"content":"This policy setting determines whether LAN Manager is prevented from storing hash values for the new password the next time the password is changed.","pos":[807,955]},{"content":"Hash values are a representation of the password after the encryption algorithm is applied that corresponds to the format that is specified by the algorithm.","pos":[956,1113]},{"content":"To decrypt the hash value, the encryption algorithm must be determined and then reversed.","pos":[1114,1203]},{"content":"The LAN Manager hash is relatively weak and prone to attack compared to the cryptographically stronger NTLM hash.","pos":[1204,1317]},{"content":"Because the LM hash is stored on the local device in the security database, the passwords can be compromised if the security database, Security Accounts Manager (SAM), is attacked.","pos":[1318,1498]},{"content":"By attacking the SAM file, attackers can potentially gain access to user names and password hashes.","pos":[1500,1599]},{"content":"Attackers can use a password-cracking tool to determine what the password is.","pos":[1600,1677]},{"content":"After they have access to this information, they can use it to gain access to resources on your network by impersonating users.","pos":[1678,1805]},{"content":"Enabling this policy setting will not prevent these types of attacks, but it will make them much more difficult.","pos":[1806,1918]},{"content":"Possible values","pos":[1924,1939]},{"content":"Enabled","pos":[1945,1952]},{"content":"Disabled","pos":[1957,1965]},{"content":"Not defined","pos":[1970,1981]},{"content":"Best practices","pos":[1987,2001]},{"pos":[2007,2108],"content":"Set <bpt id=\"p1\">**</bpt>Network security: Do not store LAN Manager hash value on next password change<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Enabled<ept id=\"p2\">**</ept>."},{"content":"Require all users to set new passwords the next time they log on to the domain so that LAN Manager hashes are removed.","pos":[2113,2231]},{"content":"Location","pos":[2237,2245]},{"content":"Computer Configuration<ph id=\"ph1\">\\\\</ph>Windows Settings<ph id=\"ph2\">\\\\</ph>Security Settings<ph id=\"ph3\">\\\\</ph>Local Policies<ph id=\"ph4\">\\\\</ph>Security Options","pos":[2247,2340]},{"content":"Default values","pos":[2346,2360]},{"content":"The following table lists the actual and effective default values for this policy.","pos":[2362,2444]},{"content":"Default values are also listed on the policy’s property page.","pos":[2445,2506]},{"content":"Server type or GPO","pos":[2510,2528]},{"content":"Default value","pos":[2531,2544]},{"content":"Default Domain Policy","pos":[2559,2580]},{"content":"Not defined","pos":[2582,2593]},{"content":"Default Domain Controller Policy","pos":[2598,2630]},{"content":"Not defined","pos":[2633,2644]},{"content":"Stand-Alone Server Default Settings","pos":[2649,2684]},{"content":"Enabled","pos":[2687,2694]},{"content":"DC Effective Default Settings","pos":[2699,2728]},{"content":"Enabled","pos":[2731,2738]},{"content":"Member Server Effective Default Settings","pos":[2743,2783]},{"content":"Enabled","pos":[2784,2791]},{"content":"Client Computer Effective Default Settings","pos":[2796,2838]},{"content":"Enabled","pos":[2841,2848]},{"content":"Policy management","pos":[2856,2873]},{"content":"This section describes features and tools that are available to help you manage this policy.","pos":[2875,2967]},{"content":"Restart requirement","pos":[2973,2992]},{"content":"None.","pos":[2994,2999]},{"content":"Changes to this policy become effective without a device restart when they are saved locally or distributed through Group Policy.","pos":[3000,3129]},{"content":"Security considerations","pos":[3134,3157]},{"content":"This section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.","pos":[3159,3353]},{"content":"Vulnerability","pos":[3359,3372]},{"content":"The SAM file can be targeted by attackers who seek access to user names and password hashes.","pos":[3374,3466]},{"content":"Such attacks use special tools to discover passwords, which can then be used to impersonate users and gain access to resources on your network.","pos":[3467,3610]},{"content":"These types of attacks are not prevented by enabling this policy setting because LAN Manager hashes are much weaker than NTLM hashes, but it is much more difficult for these attacks to succeed.","pos":[3611,3804]},{"content":"Countermeasure","pos":[3810,3824]},{"content":"Enable the <bpt id=\"p1\">**</bpt>Network security: Do not store LAN Manager hash value on next password change<ept id=\"p1\">**</ept> setting.","pos":[3826,3927]},{"content":"Require all users to set new passwords the next time they log on to the domain so that LAN Manager hashes are removed.","pos":[3928,4046]},{"content":"Potential impact","pos":[4052,4068]},{"content":"Some non-Microsoft applications might not be able to connect to the system.","pos":[4070,4145]},{"content":"Related topics","pos":[4150,4164]},{"content":"Security Options","pos":[4169,4185]}],"content":"---\ntitle: Network security Do not store LAN Manager hash value on next password change (Windows 10)\ndescription: Describes the best practices, location, values, policy management and security considerations for the Network security Do not store LAN Manager hash value on next password change security policy setting.\nms.assetid: 6452b268-e5ba-4889-9d38-db28f919af51\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Network security: Do not store LAN Manager hash value on next password change\n\n**Applies to**\n-   Windows 10\n\nDescribes the best practices, location, values, policy management and security considerations for the **Network security: Do not store LAN Manager hash value on next password change** security policy setting.\n\n## Reference\n\nThis policy setting determines whether LAN Manager is prevented from storing hash values for the new password the next time the password is changed. Hash values are a representation of the password after the encryption algorithm is applied that corresponds to the format that is specified by the algorithm. To decrypt the hash value, the encryption algorithm must be determined and then reversed. The LAN Manager hash is relatively weak and prone to attack compared to the cryptographically stronger NTLM hash. Because the LM hash is stored on the local device in the security database, the passwords can be compromised if the security database, Security Accounts Manager (SAM), is attacked.\n\nBy attacking the SAM file, attackers can potentially gain access to user names and password hashes. Attackers can use a password-cracking tool to determine what the password is. After they have access to this information, they can use it to gain access to resources on your network by impersonating users. Enabling this policy setting will not prevent these types of attacks, but it will make them much more difficult.\n\n### Possible values\n\n-   Enabled\n-   Disabled\n-   Not defined\n\n### Best practices\n\n1.  Set **Network security: Do not store LAN Manager hash value on next password change** to **Enabled**.\n2.  Require all users to set new passwords the next time they log on to the domain so that LAN Manager hashes are removed.\n\n### Location\n\nComputer Configuration\\\\Windows Settings\\\\Security Settings\\\\Local Policies\\\\Security Options\n\n### Default values\n\nThe following table lists the actual and effective default values for this policy. Default values are also listed on the policy’s property page.\n\n| Server type or GPO | Default value |\n| - | - |\n| Default Domain Policy| Not defined| \n| Default Domain Controller Policy | Not defined| \n| Stand-Alone Server Default Settings | Enabled| \n| DC Effective Default Settings | Enabled| \n| Member Server Effective Default Settings|Enabled| \n| Client Computer Effective Default Settings | Enabled| \n \n## Policy management\n\nThis section describes features and tools that are available to help you manage this policy.\n\n### Restart requirement\n\nNone. Changes to this policy become effective without a device restart when they are saved locally or distributed through Group Policy.\n\n## Security considerations\n\nThis section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.\n\n### Vulnerability\n\nThe SAM file can be targeted by attackers who seek access to user names and password hashes. Such attacks use special tools to discover passwords, which can then be used to impersonate users and gain access to resources on your network. These types of attacks are not prevented by enabling this policy setting because LAN Manager hashes are much weaker than NTLM hashes, but it is much more difficult for these attacks to succeed.\n\n### Countermeasure\n\nEnable the **Network security: Do not store LAN Manager hash value on next password change** setting. Require all users to set new passwords the next time they log on to the domain so that LAN Manager hashes are removed.\n\n### Potential impact\n\nSome non-Microsoft applications might not be able to connect to the system.\n\n## Related topics\n\n- [Security Options](security-options.md)\n"}