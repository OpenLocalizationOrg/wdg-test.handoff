{"nodes":[{"content":"On-premises deployment (Surface Hub)","pos":[11,47]},{"content":"This topic explains how you add a device account for your Microsoft Surface Hub when you have a single-forest, on-premises deployment.","pos":[61,195]},{"content":"On-premises deployment (Surface Hub)","pos":[431,467]},{"content":"This topic explains how you add a device account for your Microsoft Surface Hub when you have a single-forest, on-premises deployment.","pos":[470,604]},{"content":"If you have a single-forest on-premises deployment with Microsoft Exchange 2013 or later and Skype for Business 2013 or later, then you can <bpt id=\"p1\">[</bpt>use the provided PowerShell scripts<ept id=\"p1\">](appendix-a-powershell-scripts-for-surface-hub.md#create-on-premise-ps-scripts)</ept> to create device accounts.","pos":[606,889]},{"content":"If you’re using a multi-forest deployment, or are using Exchange 2010 or Lync 2010, you can use equivalent cmdlets that will produce the same results.","pos":[890,1040]},{"content":"Those cmdlets are described in this section.","pos":[1041,1085]},{"content":"Start a remote PowerShell session from a PC and connect to Exchange.","pos":[1091,1159]},{"content":"Be sure you have the right permissions set to run the associated cmdlets.","pos":[1165,1238]},{"pos":[1244,1412],"content":"Note here that <ph id=\"ph1\">`$strExchangeServer`</ph> is the fully qualified domain name (FQDN) of your Exchange server, and <ph id=\"ph2\">`$strLyncFQDN`</ph> is the FQDN of your Skype for Business server."},{"content":"After establishing a session, you’ll either create a new mailbox and enable it as a RoomMailboxAccount, or change the settings for an existing room mailbox.","pos":[1987,2143]},{"content":"This will allow the account to authenticate into the Surface Hub.","pos":[2144,2209]},{"content":"If you're changing an existing resource mailbox:","pos":[2215,2263]},{"content":"If you’re creating a new resource mailbox:","pos":[2447,2489]},{"content":"After setting up the mailbox, you will need to either create a new Exchange ActiveSync policy, or use a compatible existing policy.","pos":[2726,2857]},{"content":"Surface Hubs are only compatible with device accounts that have an ActiveSync policy where the <bpt id=\"p1\">**</bpt>PasswordEnabled<ept id=\"p1\">**</ept> property is set to False.","pos":[2863,3003]},{"content":"If this isn’t set properly, then Exchange services on the Surface Hub (mail, calendar, and joining meetings), will not be enabled.","pos":[3004,3134]},{"content":"If you haven’t created a compatible policy yet, use the following cmdlet—this one creates a policy called \"Surface Hubs\".","pos":[3140,3261]},{"content":"Once it’s created, you can apply the same policy to other device accounts.","pos":[3262,3336]},{"content":"Once you have a compatible policy, then you will need to apply the policy to the device account.","pos":[3460,3556]},{"content":"However, policies can only be applied to user accounts and not resource mailboxes.","pos":[3557,3639]},{"content":"You need to convert the mailbox into a user type, apply the policy, and then convert it back into a mailbox—you may need to re-enable it and set the password again too.","pos":[3640,3808]},{"content":"Various Exchange properties can be set on the device account to improve the meeting experience for people.","pos":[4099,4205]},{"content":"You can see which properties need to be set in the <bpt id=\"p1\">[</bpt>Exchange properties<ept id=\"p1\">](exchange-properties-for-surface-hub-device-accounts.md)</ept> section.","pos":[4206,4343]},{"content":"If you decide to have the password not expire, you can set that with PowerShell cmdlets too.","pos":[4719,4811]},{"content":"See <bpt id=\"p1\">[</bpt>Password management<ept id=\"p1\">](password-management-for-surface-hub-device-accounts.md)</ept> for more information.","pos":[4812,4915]},{"content":"Enable the account in Active Directory so it will authenticate to the Surface Hub.","pos":[5000,5082]},{"content":"Enable the device account with Skype for Business by enabling your Surface Hub AD account on a Skype for Business Server pool:","pos":[5154,5280]},{"content":"You'll need to use the Session Initiation Protocol (SIP) address and domain controller for the Surface Hub, along with your own Skype for Business Server pool identifier and user identity.","pos":[5478,5666]},{"content":"OPTIONAL: You can also allow your Surface Hub to make and receive public switched telephone network (PSTN) phone calls by enabling Enterprise Voice for your account.","pos":[5672,5837]},{"content":"Enterprise Voice isn't a requirement for Surface Hub, but if you want PSTN dialing functionality for the Surface Hub client, here's how to enable it:","pos":[5838,5987]},{"content":"Again, you'll need to replace the provided domain controller and phone number examples with your own information.","pos":[6235,6348]},{"content":"The parameter value <ph id=\"ph1\">`$true`</ph> stays the same.","pos":[6349,6392]}],"content":"---\ntitle: On-premises deployment (Surface Hub)\ndescription: This topic explains how you add a device account for your Microsoft Surface Hub when you have a single-forest, on-premises deployment.\nms.assetid: 80E12195-A65B-42D1-8B84-ECC3FCBAAFC6\nkeywords: single forest deployment, on prem deployment, device account, Surface Hub\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: surfacehub\nauthor: TrudyHa\n---\n\n# On-premises deployment (Surface Hub)\n\n\nThis topic explains how you add a device account for your Microsoft Surface Hub when you have a single-forest, on-premises deployment.\n\nIf you have a single-forest on-premises deployment with Microsoft Exchange 2013 or later and Skype for Business 2013 or later, then you can [use the provided PowerShell scripts](appendix-a-powershell-scripts-for-surface-hub.md#create-on-premise-ps-scripts) to create device accounts. If you’re using a multi-forest deployment, or are using Exchange 2010 or Lync 2010, you can use equivalent cmdlets that will produce the same results. Those cmdlets are described in this section.\n\n1.  Start a remote PowerShell session from a PC and connect to Exchange.\n\n    Be sure you have the right permissions set to run the associated cmdlets.\n\n    Note here that `$strExchangeServer` is the fully qualified domain name (FQDN) of your Exchange server, and `$strLyncFQDN` is the FQDN of your Skype for Business server.\n\n    ```PowerShell\n    Set-ExecutionPolicy Unrestricted\n    $org='contoso.microsoft.com'\n    $cred=Get-Credential $admin@$org\n    $sessExchange = New-PSSession -ConfigurationName microsoft.exchange -Credential $cred -AllowRedirection -Authentication Kerberos -ConnectionUri \"http://$strExchangeServer/powershell\" -WarningAction SilentlyContinue\n    $sessLync = New-PSSession -Credential $cred -ConnectionURI \"https://$strLyncFQDN/OcsPowershell\" -AllowRedirection -WarningAction SilentlyContinue\n    Import-PSSession $sessExchange\n    Import-PSSession $sessLync\n    ```\n\n2.  After establishing a session, you’ll either create a new mailbox and enable it as a RoomMailboxAccount, or change the settings for an existing room mailbox. This will allow the account to authenticate into the Surface Hub.\n\n    If you're changing an existing resource mailbox:\n\n    ```PowerShell\n    Set-Mailbox -Identity 'HUB01' -EnableRoomMailboxAccount $true -RoomMailboxPassword (ConvertTo-SecureString -String <password> -AsPlainText -Force)\n    ```\n\n    If you’re creating a new resource mailbox:\n\n    ```PowerShell\n    New-Mailbox -UserPrincipalName HUB01@contoso.com -Alias HUB01 -Name \"Hub-01\" -Room -EnableRoomMailboxAccount $true -RoomMailboxPassword (ConvertTo-SecureString -String <password> -AsPlainText -Force)\n    ```\n\n3.  After setting up the mailbox, you will need to either create a new Exchange ActiveSync policy, or use a compatible existing policy.\n\n    Surface Hubs are only compatible with device accounts that have an ActiveSync policy where the **PasswordEnabled** property is set to False. If this isn’t set properly, then Exchange services on the Surface Hub (mail, calendar, and joining meetings), will not be enabled.\n\n    If you haven’t created a compatible policy yet, use the following cmdlet—this one creates a policy called \"Surface Hubs\". Once it’s created, you can apply the same policy to other device accounts.\n\n    ```PowerShell\n    $easPolicy = New-MobileDeviceMailboxPolicy -Name “SurfaceHubs” -PasswordEnabled $false\n    ```\n\n    Once you have a compatible policy, then you will need to apply the policy to the device account. However, policies can only be applied to user accounts and not resource mailboxes. You need to convert the mailbox into a user type, apply the policy, and then convert it back into a mailbox—you may need to re-enable it and set the password again too.\n\n    ```PowerShell\n    Set-Mailbox $acctUpn -Type Regular\n    Set-CASMailbox $acctUpn -ActiveSyncMailboxPolicy $easPolicy\n    Set-Mailbox $acctUpn -Type Room\n    Set-Mailbox $credNewAccount.UserName -RoomMailboxPassword $credNewAccount.Password -EnableRoomMailboxAccount $true\n    ```\n\n4.  Various Exchange properties can be set on the device account to improve the meeting experience for people. You can see which properties need to be set in the [Exchange properties](exchange-properties-for-surface-hub-device-accounts.md) section.\n\n    ```PowerShell\n    Set-CalendarProcessing -Identity $acctUpn -AutomateProcessing AutoAccept -AddOrganizerToSubject $false –AllowConflicts $false –DeleteComments $false -DeleteSubject $false -RemovePrivateProperty $false\n    Set-CalendarProcessing -Identity $acctUpn -AddAdditionalResponse $true -AdditionalResponse \"This is a <tla rid=\"surface_hub\"/> room!\"\n    ```\n\n5.  If you decide to have the password not expire, you can set that with PowerShell cmdlets too. See [Password management](password-management-for-surface-hub-device-accounts.md) for more information.\n\n    ```PowerShell\n    Set-AdUser $acctUpn -PasswordNeverExpires $true\n    ```\n\n6.  Enable the account in Active Directory so it will authenticate to the Surface Hub.\n\n    ```PowerShell\n    Set-AdUser $acctUpn -Enabled $true\n    ```\n\n7.  Enable the device account with Skype for Business by enabling your Surface Hub AD account on a Skype for Business Server pool:\n\n    ```PowerShell\n    Enable-CsMeetingRoom -SipAddress \"sip:HUB01@contoso.com\"\n     -DomainController DC-ND-001.contoso.com -RegistrarPool LYNCPool15.contoso.com\n     -Identity HUB01\n    ```\n\n    You'll need to use the Session Initiation Protocol (SIP) address and domain controller for the Surface Hub, along with your own Skype for Business Server pool identifier and user identity.\n\n8.  OPTIONAL: You can also allow your Surface Hub to make and receive public switched telephone network (PSTN) phone calls by enabling Enterprise Voice for your account. Enterprise Voice isn't a requirement for Surface Hub, but if you want PSTN dialing functionality for the Surface Hub client, here's how to enable it:\n\n    ```PowerShell\n    CsMeetingRoom HUB01 -DomainController DC-ND-001.contoso.com\n     -LineURItel: +14255550555;ext=50555\" Set-CsMeetingRoom -DomainController DC-ND-001.contoso.com\n     -Identity HUB01 -EnterpriseVoiceEnabled $true\n    ```\n\n    Again, you'll need to replace the provided domain controller and phone number examples with your own information. The parameter value `$true` stays the same.\n\n \n\n \n\n\n\n\n\n"}