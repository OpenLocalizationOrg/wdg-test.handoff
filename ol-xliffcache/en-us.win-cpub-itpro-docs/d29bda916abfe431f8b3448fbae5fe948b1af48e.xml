{"nodes":[{"content":"4622(S) A security package has been loaded by the Local Security Authority.","pos":[11,86]},{"content":"(Windows 10)","pos":[87,99]},{"content":"Describes security event 4622(S) A security package has been loaded by the Local Security Authority.","pos":[113,213]},{"content":"4622(S): A security package has been loaded by the Local Security Authority.","pos":[313,389]},{"content":"Applies to","pos":[393,403]},{"content":"Windows 10","pos":[410,420]},{"content":"Windows Server 2016","pos":[425,444]},{"pos":[564,657],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit Security System Extension<ept id=\"p2\">](audit-security-system-extension.md)</ept>"},{"content":"Event Description:","pos":[662,680]},{"pos":[685,954],"content":"This event generates every time <bpt id=\"p1\">[</bpt>Security Package<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/windows/desktop/aa380501(v=vs.85).aspx)</ept> has been loaded by the Local Security Authority (<bpt id=\"p2\">[</bpt>LSA<ept id=\"p2\">](https://msdn.microsoft.com/en-us/library/windows/desktop/aa378326(v=vs.85).aspx)</ept>)."},{"content":"Security Package is the software implementation of a security protocol (Kerberos, NTLM, for example).","pos":[956,1057]},{"content":"Security packages are contained in security support provider DLLs or security support provider/authentication package DLLs.","pos":[1058,1181]},{"pos":[1183,1448],"content":"Each time the system starts, the LSA loads the Security Package DLLs from <bpt id=\"p1\">**</bpt>HKEY<ph id=\"ph1\">\\_</ph>LOCAL<ph id=\"ph2\">\\_</ph>MACHINE<ph id=\"ph3\">\\\\</ph>SYSTEM<ph id=\"ph4\">\\\\</ph>CurrentControlSet<ph id=\"ph5\">\\\\</ph>Control<ph id=\"ph6\">\\\\</ph>Lsa<ph id=\"ph7\">\\\\</ph>OSConfig<ph id=\"ph8\">\\\\</ph>Security Packages<ept id=\"p1\">**</ept> registry value and performs the initialization sequence for every package located in these DLLs."},{"pos":[1450,1663],"content":"It is also possible to add security package dynamically using <bpt id=\"p1\">[</bpt>AddSecurityPackage<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/windows/desktop/dd401506(v=vs.85).aspx)</ept> function, not only during system startup process."},{"pos":[1667,1803],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For recommendations, see <bpt id=\"p2\">[</bpt>Security Monitoring Recommendations<ept id=\"p2\">](#security-monitoring-recommendations)</ept> for this event."},{"content":"Event XML:","pos":[1826,1836]},{"pos":[2582,2616],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> None."},{"pos":[2618,2679],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008, Windows Vista."},{"pos":[2681,2705],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Field Descriptions:","pos":[2710,2729]},{"content":"<bpt id=\"p1\">**</bpt>Security Package Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the name of loaded Security Package.","pos":[2734,2826]},{"content":"The format is: DLL<ph id=\"ph1\">\\_</ph>PATH<ph id=\"ph2\">\\_</ph>AND<ph id=\"ph3\">\\_</ph>NAME: SECURITY<ph id=\"ph4\">\\_</ph>PACKAGE<ph id=\"ph5\">\\_</ph>NAME.","pos":[2827,2888]},{"content":"These are some Security Package DLLs loaded by default in Windows 10:","pos":[2890,2959]},{"content":"C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>system32<ph id=\"ph3\">\\\\</ph>schannel.DLL : Microsoft Unified Security Protocol Provider","pos":[2965,3047]},{"content":"C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>system32<ph id=\"ph3\">\\\\</ph>schannel.DLL : Schannel","pos":[3053,3099]},{"content":"C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>system32<ph id=\"ph3\">\\\\</ph>cloudAP.DLL : CloudAP","pos":[3105,3149]},{"content":"C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>system32<ph id=\"ph3\">\\\\</ph>wdigest.DLL : WDigest","pos":[3155,3199]},{"content":"C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>system32<ph id=\"ph3\">\\\\</ph>pku2u.DLL : pku2u","pos":[3205,3245]},{"content":"C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>system32<ph id=\"ph3\">\\\\</ph>tspkg.DLL : TSSSP","pos":[3251,3291]},{"content":"C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>system32<ph id=\"ph3\">\\\\</ph>msv1<ph id=\"ph4\">\\_</ph>0.DLL : NTLM","pos":[3297,3338]},{"content":"C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>system32<ph id=\"ph3\">\\\\</ph>kerberos.DLL : Kerberos","pos":[3344,3390]},{"content":"C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>system32<ph id=\"ph3\">\\\\</ph>negoexts.DLL : NegoExtender","pos":[3396,3446]},{"content":"C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>system32<ph id=\"ph3\">\\\\</ph>lsasrv.dll : Negotiate","pos":[3452,3497]},{"content":"Security Monitoring Recommendations","pos":[3502,3537]},{"content":"For 4622(S): A security package has been loaded by the Local Security Authority.","pos":[3539,3619]},{"content":"Typically this event has an informational purpose.","pos":[3625,3675]},{"content":"If you defined the list of allowed Security Packages in the system, then you can check is “<bpt id=\"p1\">**</bpt>Security Package Name”<ept id=\"p1\">**</ept> field value in the whitelist or not.","pos":[3676,3830]}],"content":"---\ntitle: 4622(S) A security package has been loaded by the Local Security Authority. (Windows 10)\ndescription: Describes security event 4622(S) A security package has been loaded by the Local Security Authority.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 4622(S): A security package has been loaded by the Local Security Authority.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\n<img src=\"images/event-4622.png\" alt=\"Event 4622 illustration\" width=\"449\" height=\"317\" hspace=\"10\" align=\"left\" />\n\n***Subcategory:***&nbsp;[Audit Security System Extension](audit-security-system-extension.md)\n\n***Event Description:***\n\nThis event generates every time [Security Package](https://msdn.microsoft.com/en-us/library/windows/desktop/aa380501(v=vs.85).aspx) has been loaded by the Local Security Authority ([LSA](https://msdn.microsoft.com/en-us/library/windows/desktop/aa378326(v=vs.85).aspx)).\n\nSecurity Package is the software implementation of a security protocol (Kerberos, NTLM, for example). Security packages are contained in security support provider DLLs or security support provider/authentication package DLLs.\n\nEach time the system starts, the LSA loads the Security Package DLLs from **HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\OSConfig\\\\Security Packages** registry value and performs the initialization sequence for every package located in these DLLs.\n\nIt is also possible to add security package dynamically using [AddSecurityPackage](https://msdn.microsoft.com/en-us/library/windows/desktop/dd401506(v=vs.85).aspx) function, not only during system startup process.\n\n> **Note**&nbsp;&nbsp;For recommendations, see [Security Monitoring Recommendations](#security-monitoring-recommendations) for this event.\n\n<br clear=\"all\">\n\n***Event XML:***\n```\n- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n- <System>\n <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> \n <EventID>4622</EventID> \n <Version>0</Version> \n <Level>0</Level> \n <Task>12289</Task> \n <Opcode>0</Opcode> \n <Keywords>0x8020000000000000</Keywords> \n <TimeCreated SystemTime=\"2015-10-14T03:36:41.359331100Z\" /> \n <EventRecordID>1048131</EventRecordID> \n <Correlation /> \n <Execution ProcessID=\"516\" ThreadID=\"520\" /> \n <Channel>Security</Channel> \n <Computer>DC01.contoso.local</Computer> \n <Security /> \n </System>\n- <EventData>\n <Data Name=\"SecurityPackageName\">C:\\\\Windows\\\\system32\\\\kerberos.DLL : Kerberos</Data> \n </EventData>\n </Event>\n\n```\n\n***Required Server Roles:*** None.\n\n***Minimum OS Version:*** Windows Server 2008, Windows Vista.\n\n***Event Versions:*** 0.\n\n***Field Descriptions:***\n\n**Security Package Name** \\[Type = UnicodeString\\]**:** the name of loaded Security Package. The format is: DLL\\_PATH\\_AND\\_NAME: SECURITY\\_PACKAGE\\_NAME.\n\nThese are some Security Package DLLs loaded by default in Windows 10:\n\n-   C:\\\\Windows\\\\system32\\\\schannel.DLL : Microsoft Unified Security Protocol Provider\n\n-   C:\\\\Windows\\\\system32\\\\schannel.DLL : Schannel\n\n-   C:\\\\Windows\\\\system32\\\\cloudAP.DLL : CloudAP\n\n-   C:\\\\Windows\\\\system32\\\\wdigest.DLL : WDigest\n\n-   C:\\\\Windows\\\\system32\\\\pku2u.DLL : pku2u\n\n-   C:\\\\Windows\\\\system32\\\\tspkg.DLL : TSSSP\n\n-   C:\\\\Windows\\\\system32\\\\msv1\\_0.DLL : NTLM\n\n-   C:\\\\Windows\\\\system32\\\\kerberos.DLL : Kerberos\n\n-   C:\\\\Windows\\\\system32\\\\negoexts.DLL : NegoExtender\n\n-   C:\\\\Windows\\\\system32\\\\lsasrv.dll : Negotiate\n\n## Security Monitoring Recommendations\n\nFor 4622(S): A security package has been loaded by the Local Security Authority.\n\n-   Typically this event has an informational purpose. If you defined the list of allowed Security Packages in the system, then you can check is “**Security Package Name”** field value in the whitelist or not.\n\n"}