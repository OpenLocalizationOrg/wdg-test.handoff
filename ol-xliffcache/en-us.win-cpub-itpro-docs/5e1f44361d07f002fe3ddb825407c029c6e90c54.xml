{"nodes":[{"content":"Run the Automatically Generate Rules wizard (Windows 10)","pos":[11,67]},{"content":"This topic for IT professionals describes steps to run the wizard to create AppLocker rules on a reference device.","pos":[81,195]},{"content":"Run the Automatically Generate Rules wizard","pos":[351,394]},{"content":"Applies to","pos":[398,408]},{"content":"Windows 10","pos":[415,425]},{"content":"This topic for IT professionals describes steps to run the wizard to create AppLocker rules on a reference device.","pos":[427,541]},{"content":"AppLocker allows you to automatically generate rules for all files within a folder.","pos":[543,626]},{"content":"It will scan the specified folder and create the condition types that you choose for each file in that folder.","pos":[627,737]},{"content":"You can perform this task by using the Group Policy Management Console for an AppLocker policy in a Group Policy Object (GPO) or by using the Local Security Policy snap-in for an AppLocker policy on a local device or in a security template.","pos":[739,979]},{"content":"For info how to use these MMC snap-ins to administer AppLocker, see <bpt id=\"p1\">[</bpt>Administer AppLocker<ept id=\"p1\">](administer-applocker.md#bkmk-using-snapins)</ept>.","pos":[980,1115]},{"content":"To automatically generate rules","pos":[1119,1150]},{"content":"Open the AppLocker console.","pos":[1158,1185]},{"content":"Right-click the appropriate rule type for which you want to automatically generate rules.","pos":[1190,1279]},{"content":"You can automatically generate rules for executable, Windows Installer, script and packaged app rules.","pos":[1280,1382]},{"pos":[1387,1426],"content":"Click <bpt id=\"p1\">**</bpt>Automatically Generate Rules<ept id=\"p1\">**</ept>."},{"content":"On the <bpt id=\"p1\">**</bpt>Folder and Permissions<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> to choose the folder to be analyzed.","pos":[1431,1524]},{"content":"By default, this is the Program Files folder.","pos":[1525,1570]},{"content":"Click <bpt id=\"p1\">**</bpt>Select<ept id=\"p1\">**</ept> to choose the security group in which the default rules should be applied.","pos":[1575,1666]},{"content":"By default, this is the <bpt id=\"p1\">**</bpt>Everyone<ept id=\"p1\">**</ept> group.","pos":[1667,1710]},{"content":"The wizard provides a name in the <bpt id=\"p1\">**</bpt>Name to identify this set of rules<ept id=\"p1\">**</ept> box based on the name of the folder that you have selected.","pos":[1715,1847]},{"content":"Accept the provided name or type a different name, and then click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[1848,1923]},{"content":"On the <bpt id=\"p1\">**</bpt>Rule Preferences<ept id=\"p1\">**</ept> page, choose the conditions that you want the wizard to use while creating rules, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","pos":[1928,2062]},{"content":"For more info about rule conditions, see <bpt id=\"p1\">[</bpt>Understanding AppLocker rule condition types<ept id=\"p1\">](understanding-applocker-rule-condition-types.md)</ept>.","pos":[2063,2200]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  The <bpt id=\"p2\">**</bpt>Reduce the number of rules created by grouping similar files<ept id=\"p2\">**</ept> check box is selected by default.","pos":[2207,2320]},{"content":"This helps you organize AppLocker rules and reduce the number of rules that you create by performing the following operations for the rule condition that you select:","pos":[2321,2486]},{"content":"One publisher condition is created for all files that have the same publisher and product name.","pos":[2500,2595]},{"content":"One path condition is created for the folder that you select.","pos":[2604,2665]},{"content":"For example, if you select <bpt id=\"p1\">*</bpt>C:<ph id=\"ph1\">\\\\</ph>Program Files<ph id=\"ph2\">\\\\</ph>ProgramName<ph id=\"ph3\">\\\\</ph><ept id=\"p1\">*</ept> and the files in that folder are not signed, the wizard creates a rule for <bpt id=\"p2\">*</bpt>%programfiles%<ph id=\"ph4\">\\\\</ph>ProgramName<ph id=\"ph5\">\\\\\\*</ph><ept id=\"p2\">*</ept>.","pos":[2666,2837]},{"content":"One file hash condition is created that contains all of the file hashes.","pos":[2846,2918]},{"content":"When rule grouping is disabled, the wizard creates a file hash rule for each file.","pos":[2919,3001]},{"content":"Review the files that were analyzed and the rules that will be automatically created.","pos":[3012,3097]},{"content":"To make changes, click <bpt id=\"p1\">**</bpt>Previous<ept id=\"p1\">**</ept> to return to the page where you can change your selections.","pos":[3098,3193]},{"content":"After reviewing the rules, click <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>.","pos":[3194,3238]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  If you are running the wizard to create your first rules for a GPO, you will be prompted to create the default rules, which allow critical system files to run, after completing the wizard.","pos":[3241,3440]},{"content":"You may edit the default rules at any time.","pos":[3441,3484]},{"content":"If your organization has decided to edit the default rules or create custom rules to allow the Windows system files to run, ensure that you delete the default rules after replacing them with your custom rules.","pos":[3485,3694]}],"content":"---\ntitle: Run the Automatically Generate Rules wizard (Windows 10)\ndescription: This topic for IT professionals describes steps to run the wizard to create AppLocker rules on a reference device.\nms.assetid: 8cad1e14-d5b2-437c-8f88-70cffd7b3d8e\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Run the Automatically Generate Rules wizard\n\n**Applies to**\n-   Windows 10\n\nThis topic for IT professionals describes steps to run the wizard to create AppLocker rules on a reference device.\n\nAppLocker allows you to automatically generate rules for all files within a folder. It will scan the specified folder and create the condition types that you choose for each file in that folder.\n\nYou can perform this task by using the Group Policy Management Console for an AppLocker policy in a Group Policy Object (GPO) or by using the Local Security Policy snap-in for an AppLocker policy on a local device or in a security template. For info how to use these MMC snap-ins to administer AppLocker, see [Administer AppLocker](administer-applocker.md#bkmk-using-snapins).\n\n**To automatically generate rules**\n\n1.  Open the AppLocker console.\n2.  Right-click the appropriate rule type for which you want to automatically generate rules. You can automatically generate rules for executable, Windows Installer, script and packaged app rules.\n3.  Click **Automatically Generate Rules**.\n4.  On the **Folder and Permissions** page, click **Browse** to choose the folder to be analyzed. By default, this is the Program Files folder.\n5.  Click **Select** to choose the security group in which the default rules should be applied. By default, this is the **Everyone** group.\n6.  The wizard provides a name in the **Name to identify this set of rules** box based on the name of the folder that you have selected. Accept the provided name or type a different name, and then click **Next**.\n7.  On the **Rule Preferences** page, choose the conditions that you want the wizard to use while creating rules, and then click **Next**. For more info about rule conditions, see [Understanding AppLocker rule condition types](understanding-applocker-rule-condition-types.md).\n\n    >**Note:**  The **Reduce the number of rules created by grouping similar files** check box is selected by default. This helps you organize AppLocker rules and reduce the number of rules that you create by performing the following operations for the rule condition that you select:\n    \n    -   One publisher condition is created for all files that have the same publisher and product name.\n    -   One path condition is created for the folder that you select. For example, if you select *C:\\\\Program Files\\\\ProgramName\\\\* and the files in that folder are not signed, the wizard creates a rule for *%programfiles%\\\\ProgramName\\\\\\**.\n    -   One file hash condition is created that contains all of the file hashes. When rule grouping is disabled, the wizard creates a file hash rule for each file.\n     \n8.  Review the files that were analyzed and the rules that will be automatically created. To make changes, click **Previous** to return to the page where you can change your selections. After reviewing the rules, click **Create**.\n\n>**Note:**  If you are running the wizard to create your first rules for a GPO, you will be prompted to create the default rules, which allow critical system files to run, after completing the wizard. You may edit the default rules at any time. If your organization has decided to edit the default rules or create custom rules to allow the Windows system files to run, ensure that you delete the default rules after replacing them with your custom rules.\n"}