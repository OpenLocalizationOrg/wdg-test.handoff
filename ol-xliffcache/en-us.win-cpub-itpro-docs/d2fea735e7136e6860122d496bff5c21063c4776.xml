{"nodes":[{"content":"4951(F) A rule has been ignored because its major version number was not recognized by Windows Firewall.","pos":[11,115]},{"content":"(Windows 10)","pos":[116,128]},{"content":"Describes security event 4951(F) A rule has been ignored because its major version number was not recognized by Windows Firewall.","pos":[142,271]},{"content":"4951(F): A rule has been ignored because its major version number was not recognized by Windows Firewall.","pos":[371,476]},{"content":"Applies to","pos":[480,490]},{"content":"Windows 10","pos":[497,507]},{"content":"Windows Server 2016","pos":[512,531]},{"pos":[651,756],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit MPSSVC Rule-Level Policy Change<ept id=\"p2\">](audit-mpssvc-rule-level-policy-change.md)</ept>"},{"content":"Event Description:","pos":[761,779]},{"content":"When you create or edit a Windows Firewall rule, the settings that you can include depend upon the version of Windows you use when creating the rule.","pos":[784,933]},{"content":"As new settings are added to later versions of Windows or to service packs for existing versions of Windows, the version number of the rules processing engine is updated, and that version number is stamped into rules that are created by using that version of Windows.","pos":[934,1201]},{"content":"For example, Windows Vista produces firewall rules that are stamped with version \"v2.0\".","pos":[1202,1290]},{"content":"Future versions of Windows might use \"v2.1\", or \"v3.0\" to indicate, respectively, minor or major changes and additions.","pos":[1291,1410]},{"content":"If you create a firewall rule on a newer version of Windows that references firewall settings that are not available on earlier versions of Windows, and then try to deploy that rule to computers running the earlier version of Windows, the firewall engine produces this error to indicate that it cannot process the rule.","pos":[1412,1731]},{"content":"The only solution is to remove the incompatible rule, and then deploy a compatible rule.","pos":[1733,1821]},{"pos":[1825,1961],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For recommendations, see <bpt id=\"p2\">[</bpt>Security Monitoring Recommendations<ept id=\"p2\">](#security-monitoring-recommendations)</ept> for this event."},{"content":"Event XML:","pos":[1984,1994]},{"pos":[2786,2820],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> None."},{"pos":[2822,2883],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008, Windows Vista."},{"pos":[2885,2909],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Field Descriptions:","pos":[2914,2933]},{"content":"<bpt id=\"p1\">**</bpt>Profile<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the name of the profile of the ignored rule.","pos":[2938,3024]},{"content":"Possible values are:","pos":[3025,3045]},{"content":"All","pos":[3051,3054]},{"content":"Domain,Public","pos":[3060,3073]},{"content":"Domain,Private","pos":[3079,3093]},{"content":"Private,Public","pos":[3099,3113]},{"content":"Public","pos":[3119,3125]},{"content":"Domain","pos":[3131,3137]},{"content":"Private","pos":[3143,3150]},{"content":"Ignored Rule:","pos":[3154,3167]},{"pos":[3175,3256],"content":"<bpt id=\"p1\">**</bpt>ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the unique identifier for ignored firewall rule."},{"pos":[3262,3538],"content":"To see the unique ID of the rule you need to navigate to “<bpt id=\"p1\">**</bpt>HKEY<ph id=\"ph1\">\\_</ph>LOCAL<ph id=\"ph2\">\\_</ph>MACHINE<ph id=\"ph3\">\\\\</ph>SYSTEM<ph id=\"ph4\">\\\\</ph>CurrentControlSet<ph id=\"ph5\">\\\\</ph>Services<ph id=\"ph6\">\\\\</ph>SharedAccess<ph id=\"ph7\">\\\\</ph>Parameters<ph id=\"ph8\">\\\\</ph>FirewallPolicy<ph id=\"ph9\">\\\\</ph>FirewallRules”<ept id=\"p1\">**</ept> registry key and you will see the list of Windows Firewall rule IDs (Name column) with parameters:"},{"content":"<bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the name of the rule which was ignored.","pos":[3679,3753]},{"content":"You can see the name of Windows Firewall rule using Windows Firewall with Advanced Security management console (<bpt id=\"p1\">**</bpt>wf.msc<ept id=\"p1\">**</ept>), check “Name” column:","pos":[3754,3899]},{"content":"Security Monitoring Recommendations","pos":[4055,4090]},{"content":"For 4951(F): A rule has been ignored because its major version number was not recognized by Windows Firewall.","pos":[4092,4201]},{"content":"This event can be a sign of software issues, Windows Firewall registry errors or corruption, or Group Policy setting misconfigurations.","pos":[4207,4342]},{"content":"We recommend monitoring this event and investigating the reason for the condition.","pos":[4343,4425]},{"content":"Typically this event indicates configuration issues, not security issues.","pos":[4426,4499]}],"content":"---\ntitle: 4951(F) A rule has been ignored because its major version number was not recognized by Windows Firewall. (Windows 10)\ndescription: Describes security event 4951(F) A rule has been ignored because its major version number was not recognized by Windows Firewall.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 4951(F): A rule has been ignored because its major version number was not recognized by Windows Firewall.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\n<img src=\"images/event-4951.png\" alt=\"Event 4951 illustration\" width=\"449\" height=\"364\" hspace=\"10\" align=\"left\" />\n\n***Subcategory:***&nbsp;[Audit MPSSVC Rule-Level Policy Change](audit-mpssvc-rule-level-policy-change.md)\n\n***Event Description:***\n\nWhen you create or edit a Windows Firewall rule, the settings that you can include depend upon the version of Windows you use when creating the rule. As new settings are added to later versions of Windows or to service packs for existing versions of Windows, the version number of the rules processing engine is updated, and that version number is stamped into rules that are created by using that version of Windows. For example, Windows Vista produces firewall rules that are stamped with version \"v2.0\". Future versions of Windows might use \"v2.1\", or \"v3.0\" to indicate, respectively, minor or major changes and additions.\n\nIf you create a firewall rule on a newer version of Windows that references firewall settings that are not available on earlier versions of Windows, and then try to deploy that rule to computers running the earlier version of Windows, the firewall engine produces this error to indicate that it cannot process the rule.\n\nThe only solution is to remove the incompatible rule, and then deploy a compatible rule.\n\n> **Note**&nbsp;&nbsp;For recommendations, see [Security Monitoring Recommendations](#security-monitoring-recommendations) for this event.\n\n<br clear=\"all\">\n\n***Event XML:***\n```\n- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n- <System>\n <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> \n <EventID>4951</EventID> \n <Version>0</Version> \n <Level>0</Level> \n <Task>13571</Task> \n <Opcode>0</Opcode> \n <Keywords>0x8010000000000000</Keywords> \n <TimeCreated SystemTime=\"2015-10-07T21:49:06.951537900Z\" /> \n <EventRecordID>1052309</EventRecordID> \n <Correlation /> \n <Execution ProcessID=\"524\" ThreadID=\"556\" /> \n <Channel>Security</Channel> \n <Computer>DC01.contoso.local</Computer> \n <Security /> \n </System>\n- <EventData>\n <Data Name=\"Profile\">All</Data> \n <Data Name=\"RuleId\">{08CBB349-D158-46BE-81E1-2ABC59BDD523}</Data> \n <Data Name=\"RuleName\">-</Data> \n </EventData>\n </Event>\n\n```\n\n***Required Server Roles:*** None.\n\n***Minimum OS Version:*** Windows Server 2008, Windows Vista.\n\n***Event Versions:*** 0.\n\n***Field Descriptions:***\n\n**Profile** \\[Type = UnicodeString\\]**:** the name of the profile of the ignored rule. Possible values are:\n\n-   All\n\n-   Domain,Public\n\n-   Domain,Private\n\n-   Private,Public\n\n-   Public\n\n-   Domain\n\n-   Private\n\n**Ignored Rule:**\n\n-   **ID** \\[Type = UnicodeString\\]: the unique identifier for ignored firewall rule.\n\n    To see the unique ID of the rule you need to navigate to “**HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\FirewallRules”** registry key and you will see the list of Windows Firewall rule IDs (Name column) with parameters:\n\n<img src=\"images/registry-editor-firewallrules.png\" alt=\"Registry Editor FirewallRules key illustration\" width=\"1412\" height=\"422\" />\n\n-   **Name** \\[Type = UnicodeString\\]: the name of the rule which was ignored. You can see the name of Windows Firewall rule using Windows Firewall with Advanced Security management console (**wf.msc**), check “Name” column:\n\n<img src=\"images/windows-firewall-with-advanced-security.png\" alt=\"Windows Firewall with Advanced Security illustration\" width=\"1082\" height=\"363\" />\n\n## Security Monitoring Recommendations\n\nFor 4951(F): A rule has been ignored because its major version number was not recognized by Windows Firewall.\n\n-   This event can be a sign of software issues, Windows Firewall registry errors or corruption, or Group Policy setting misconfigurations. We recommend monitoring this event and investigating the reason for the condition. Typically this event indicates configuration issues, not security issues.\n\n"}