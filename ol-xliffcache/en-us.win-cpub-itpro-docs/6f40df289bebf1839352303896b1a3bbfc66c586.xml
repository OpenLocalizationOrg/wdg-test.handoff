{"nodes":[{"content":"Audit File Share (Windows 10)","pos":[11,40]},{"content":"This topic for the IT professional describes the Advanced Security Audit policy setting, Audit File Share, which determines whether the operating system generates audit events when a file share is accessed.","pos":[54,260]},{"content":"Audit File Share","pos":[409,425]},{"content":"Applies to","pos":[429,439]},{"content":"Windows 10","pos":[446,456]},{"content":"Windows Server 2016","pos":[461,480]},{"content":"Audit File Share allows you to audit events related to file shares: creation, deletion, modification, and access attempts.","pos":[483,605]},{"content":"Also, it shows failed SMB SPN checks.","pos":[606,643]},{"content":"There are no system access control lists (SACLs) for shares; therefore, after this setting is enabled, access to all shares on the system will be audited.","pos":[645,799]},{"content":"Combined with File System auditing, File Share auditing enables you to track what content was accessed, the source (IP address and port) of the request, and the user account that was used for the access.","pos":[801,1004]},{"pos":[1006,1023],"content":"<bpt id=\"p1\">**</bpt>Event volume<ept id=\"p1\">**</ept>:"},{"content":"High on file servers.","pos":[1029,1050]},{"content":"High on domain controllers because of SYSVOL network access required by Group Policy.","pos":[1056,1141]},{"content":"Low on member servers and workstations.","pos":[1147,1186]},{"content":"Computer Type","pos":[1190,1203]},{"content":"General Success","pos":[1210,1225]},{"content":"General Failure","pos":[1228,1243]},{"content":"Stronger Success","pos":[1246,1262]},{"content":"Stronger Failure","pos":[1265,1281]},{"content":"Comments","pos":[1284,1292]},{"content":"Domain Controller","pos":[1918,1935]},{"content":"Yes","pos":[1938,1941]},{"content":"Yes","pos":[1956,1959]},{"content":"Yes","pos":[1974,1977]},{"content":"Yes","pos":[1993,1996]},{"content":"We recommend Success auditing for domain controllers, because it’s important to track deletion, creation, and modification events for network shares.","pos":[2012,2161]},{"content":"We recommend Failure auditing to track failed SMB SPN checks and failed access attempts to network shares.","pos":[2165,2271]},{"content":"Member Server","pos":[2276,2289]},{"content":"Yes","pos":[2296,2299]},{"content":"Yes","pos":[2314,2317]},{"content":"Yes","pos":[2332,2335]},{"content":"Yes","pos":[2351,2354]},{"content":"We recommend Success auditing to track deletion, creation, modification, and access attempts to network share objects.","pos":[2370,2488]},{"content":"We recommend Failure auditing to track failed SMB SPN checks and failed access attempts to network shares.","pos":[2492,2598]},{"content":"Workstation","pos":[2634,2645]},{"content":"Yes","pos":[2654,2657]},{"content":"Yes","pos":[2672,2675]},{"content":"Yes","pos":[2690,2693]},{"content":"Yes","pos":[2709,2712]},{"content":"We recommend Success auditing to track deletion, creation, modification and access attempts to network share objects.","pos":[2728,2845]},{"content":"We recommend Failure auditing to track failed SMB SPN checks and failed access attempts to network shares.","pos":[2849,2955]},{"content":"Events List:","pos":[2993,3005]},{"pos":[3013,3078],"content":"<bpt id=\"p1\">[</bpt>5140<ept id=\"p1\">](event-5140.md)</ept>(S, F): A network share object was accessed."},{"pos":[3084,3143],"content":"<bpt id=\"p1\">[</bpt>5142<ept id=\"p1\">](event-5142.md)</ept>(S): A network share object was added."},{"pos":[3149,3211],"content":"<bpt id=\"p1\">[</bpt>5143<ept id=\"p1\">](event-5143.md)</ept>(S): A network share object was modified."},{"pos":[3217,3278],"content":"<bpt id=\"p1\">[</bpt>5144<ept id=\"p1\">](event-5144.md)</ept>(S): A network share object was deleted."},{"pos":[3284,3340],"content":"<bpt id=\"p1\">[</bpt>5168<ept id=\"p1\">](event-5168.md)</ept>(F): SPN check for SMB/SMB2 failed."}],"content":"---\ntitle: Audit File Share (Windows 10)\ndescription: This topic for the IT professional describes the Advanced Security Audit policy setting, Audit File Share, which determines whether the operating system generates audit events when a file share is accessed.\nms.assetid: 9ea985f8-8936-4b79-abdb-35cbb7138f78\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# Audit File Share\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\nAudit File Share allows you to audit events related to file shares: creation, deletion, modification, and access attempts. Also, it shows failed SMB SPN checks.\n\nThere are no system access control lists (SACLs) for shares; therefore, after this setting is enabled, access to all shares on the system will be audited.\n\nCombined with File System auditing, File Share auditing enables you to track what content was accessed, the source (IP address and port) of the request, and the user account that was used for the access.\n\n**Event volume**:\n\n-   High on file servers.\n\n-   High on domain controllers because of SYSVOL network access required by Group Policy.\n\n-   Low on member servers and workstations.\n\n| Computer Type     | General Success | General Failure | Stronger Success | Stronger Failure | Comments                                                                                                                                                                                                                                                                  |\n|-------------------|-----------------|-----------------|------------------|------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Domain Controller | Yes             | Yes             | Yes              | Yes              | We recommend Success auditing for domain controllers, because it’s important to track deletion, creation, and modification events for network shares.<br>We recommend Failure auditing to track failed SMB SPN checks and failed access attempts to network shares. |\n| Member Server     | Yes             | Yes             | Yes              | Yes              | We recommend Success auditing to track deletion, creation, modification, and access attempts to network share objects.<br>We recommend Failure auditing to track failed SMB SPN checks and failed access attempts to network shares.                                |\n| Workstation       | Yes             | Yes             | Yes              | Yes              | We recommend Success auditing to track deletion, creation, modification and access attempts to network share objects.<br>We recommend Failure auditing to track failed SMB SPN checks and failed access attempts to network shares.                                 |\n\n**Events List:**\n\n-   [5140](event-5140.md)(S, F): A network share object was accessed.\n\n-   [5142](event-5142.md)(S): A network share object was added.\n\n-   [5143](event-5143.md)(S): A network share object was modified.\n\n-   [5144](event-5144.md)(S): A network share object was deleted.\n\n-   [5168](event-5168.md)(F): SPN check for SMB/SMB2 failed.\n\n"}