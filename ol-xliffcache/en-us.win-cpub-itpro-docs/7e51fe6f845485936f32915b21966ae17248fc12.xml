{"nodes":[{"content":"Create a custom Windows PE boot image with Configuration Manager (Windows 10)","pos":[11,88]},{"content":"In Microsoft System Center 2012 R2 Configuration Manager, you can create custom Windows Preinstallation Environment (Windows PE) boot images that include extra components and features.","pos":[102,286]},{"content":"Create a custom Windows PE boot image with Configuration Manager","pos":[462,526]},{"content":"Applies to","pos":[531,541]},{"content":"Windows 10","pos":[549,559]},{"content":"In Microsoft System Center 2012 R2 Configuration Manager, you can create custom Windows Preinstallation Environment (Windows PE) boot images that include extra components and features.","pos":[561,745]},{"content":"This topic shows you how to create a custom Windows PE 5.0 boot image with the Microsoft Deployment Toolkit (MDT) 2013 Update 2 wizard.","pos":[746,881]},{"content":"You can also add the Microsoft Diagnostics and Recovery Toolset (DaRT) 10 to the boot image as part of the boot image creation process.","pos":[882,1017]},{"content":"For the purposes of this topic, we will use two machines: DC01 and CM01.","pos":[1019,1091]},{"content":"DC01 is a domain controller and CM01 is a machine running Windows Server 2012 R2 Standard.","pos":[1092,1182]},{"content":"Both are members of the domain contoso.com for the fictitious Contoso Corporation.","pos":[1183,1265]},{"content":"For more details on the setup for this topic, please see <bpt id=\"p1\">[</bpt>Deploy Windows 10 with the Microsoft Deployment Toolkit<ept id=\"p1\">](deploy-windows-10-with-the-microsoft-deployment-toolkit.md)</ept>.","pos":[1266,1441]},{"pos":[1472,1525],"content":"Add DaRT 10 files and prepare to brand the boot image"},{"content":"The steps below outline the process for adding DaRT 10 installation files to the MDT installation directory.","pos":[1528,1636]},{"content":"You also copy a custom background image to be used later.","pos":[1637,1694]},{"content":"We assume you have downloaded Microsoft Desktop Optimization Pack (MDOP) 2015 and copied the x64 version of MSDaRT10.msi to the C:<ph id=\"ph1\">\\\\</ph>Setup<ph id=\"ph2\">\\\\</ph>DaRT 10 folder.","pos":[1695,1849]},{"content":"We also assume you have created a custom background image and saved it in C:<ph id=\"ph1\">\\\\</ph>Setup<ph id=\"ph2\">\\\\</ph>Branding on CM01.","pos":[1850,1952]},{"content":"In this section, we use a custom background image named ContosoBackground.bmp.","pos":[1953,2031]},{"content":"Install DaRT 10 (C:<ph id=\"ph1\">\\\\</ph>Setup<ph id=\"ph2\">\\\\</ph>DaRT 10<ph id=\"ph3\">\\\\</ph>MSDaRT10.msi) using the default settings.","pos":[2037,2115]},{"pos":[2121,2208],"content":"Using File Explorer, navigate to the <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Program Files<ph id=\"ph2\">\\\\</ph>Microsoft DaRT<ph id=\"ph3\">\\\\</ph>v10<ept id=\"p1\">**</ept> folder."},{"pos":[2214,2344],"content":"Copy the Toolsx64.cab file to the <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Program Files<ph id=\"ph2\">\\\\</ph>Microsoft Deployment Toolkit<ph id=\"ph3\">\\\\</ph>Templates<ph id=\"ph4\">\\\\</ph>Distribution<ph id=\"ph5\">\\\\</ph>Tools<ph id=\"ph6\">\\\\</ph>x64<ept id=\"p1\">**</ept> folder."},{"pos":[2350,2480],"content":"Copy the Toolsx86.cab file to the <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Program Files<ph id=\"ph2\">\\\\</ph>Microsoft Deployment Toolkit<ph id=\"ph3\">\\\\</ph>Templates<ph id=\"ph4\">\\\\</ph>Distribution<ph id=\"ph5\">\\\\</ph>Tools<ph id=\"ph6\">\\\\</ph>x86<ept id=\"p1\">**</ept> folder."},{"pos":[2486,2544],"content":"Using File Explorer, navigate to the <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Setup<ept id=\"p1\">**</ept> folder."},{"pos":[2550,2603],"content":"Copy the <bpt id=\"p1\">**</bpt>Branding<ept id=\"p1\">**</ept> folder to <bpt id=\"p2\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>Sources<ph id=\"ph2\">\\\\</ph>OSD<ept id=\"p2\">**</ept>."},{"pos":[2634,2700],"content":"Create a boot image for Configuration Manager using the MDT wizard"},{"content":"By using the MDT wizard to create the boot image in Configuration Manager, you gain additional options for adding components and features to the boot image.","pos":[2703,2859]},{"content":"In this section, you create a boot image for Configuration Manager using the MDT wizard.","pos":[2860,2948]},{"pos":[2954,3132],"content":"Using the Configuration Manager Console, in the Software Library workspace, expand <bpt id=\"p1\">**</bpt>Operating Systems<ept id=\"p1\">**</ept>, right-click <bpt id=\"p2\">**</bpt>Boot Images<ept id=\"p2\">**</ept>, and select <bpt id=\"p3\">**</bpt>Create Boot Image using MDT<ept id=\"p3\">**</ept>."},{"pos":[3138,3319],"content":"On the <bpt id=\"p1\">**</bpt>Package Source<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Package source folder to be created (UNC Path):<ept id=\"p2\">**</ept> text box, type <bpt id=\"p3\">**</bpt><ph id=\"ph1\">\\\\\\\\</ph>CM01<ph id=\"ph2\">\\\\</ph>Sources$<ph id=\"ph3\">\\\\</ph>OSD<ph id=\"ph4\">\\\\</ph>Boot<ph id=\"ph5\">\\\\</ph>Zero Touch WinPE x64<ept id=\"p3\">**</ept> and click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>."},{"pos":[3325,3439],"content":"**Note**  \nThe Zero Touch WinPE x64 folder does not yet exist. The folder will be created later by the wizard.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"The Zero Touch WinPE x64 folder does not yet exist. The folder will be created later by the wizard.","pos":[11,110],"nodes":[{"content":"The Zero Touch WinPE x64 folder does not yet exist.","pos":[0,51]},{"content":"The folder will be created later by the wizard.","pos":[52,99]}]}]},{"pos":[3452,3546],"content":"On the <bpt id=\"p1\">**</bpt>General Settings<ept id=\"p1\">**</ept> page, assign the name <bpt id=\"p2\">**</bpt>Zero Touch WinPE x64<ept id=\"p2\">**</ept> and click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"pos":[3552,3625],"content":"On the <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> page, select the <bpt id=\"p2\">**</bpt>x64<ept id=\"p2\">**</ept> platform, and click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"pos":[3631,3827],"content":"On the <bpt id=\"p1\">**</bpt>Components<ept id=\"p1\">**</ept> page, in addition to the default selected <bpt id=\"p2\">**</bpt>Microsoft Data Access Components (MDAC/ADO)<ept id=\"p2\">**</ept> support, select the <bpt id=\"p3\">**</bpt>Microsoft Diagnostics and Recovery Toolkit (DaRT)<ept id=\"p3\">**</ept> check box."},{"content":"figure 15","pos":[3835,3844]},{"content":"Figure 15.","pos":[3876,3886]},{"content":"Add the DaRT component to the Configuration Manager boot image.","pos":[3887,3950]},{"content":"On the <bpt id=\"p1\">**</bpt>Customization<ept id=\"p1\">**</ept> page, select the <bpt id=\"p2\">**</bpt>Use a custom background bitmap file<ept id=\"p2\">**</ept> check box, and in the <bpt id=\"p3\">**</bpt>UNC path:<ept id=\"p3\">**</ept> text box, browse to <bpt id=\"p4\">**</bpt><ph id=\"ph1\">\\\\\\\\</ph>CM01<ph id=\"ph2\">\\\\</ph>Sources$<ph id=\"ph3\">\\\\</ph>OSD<ph id=\"ph4\">\\\\</ph>Branding<ph id=\"ph5\">\\\\</ph> ContosoBackground.bmp<ept id=\"p4\">**</ept>.","pos":[3956,4156]},{"content":"Then click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept> twice.","pos":[4157,4183]},{"pos":[4189,4258],"content":"**Note**  \nIt will take a few minutes to generate the boot image.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"It will take a few minutes to generate the boot image.","pos":[11,65]}]},{"pos":[4271,4460],"content":"Distribute the boot image to the CM01 distribution point by selecting the <bpt id=\"p1\">**</bpt>Boot images<ept id=\"p1\">**</ept> node, right-clicking the <bpt id=\"p2\">**</bpt>Zero Touch WinPE x64<ept id=\"p2\">**</ept> boot image, and selecting <bpt id=\"p3\">**</bpt>Distribute Content<ept id=\"p3\">**</ept>."},{"content":"In the Distribute Content Wizard, add the CM01 distribution point, and complete the wizard.","pos":[4466,4557]},{"content":"Using Configuration Manager Trace, review the E:<ph id=\"ph1\">\\\\</ph>Program Files<ph id=\"ph2\">\\\\</ph>Microsoft Configuration Manager<ph id=\"ph3\">\\\\</ph>Logs<ph id=\"ph4\">\\\\</ph>distmgr.log file.","pos":[4563,4684]},{"content":"Do not continue until you can see that the boot image is distributed.","pos":[4685,4754]},{"content":"Look for the line that reads STATMSG: ID=2301.","pos":[4755,4801]},{"content":"You also can view Content Status in the Configuration Manager Console by selecting <bpt id=\"p1\">**</bpt>the Zero Touch WinPE x86<ept id=\"p1\">**</ept> boot image.","pos":[4802,4925]},{"content":"figure 16","pos":[4933,4942]},{"content":"Figure 16.","pos":[4981,4991]},{"content":"Content status for the Zero Touch WinPE x64 boot image.","pos":[4992,5047]},{"pos":[5053,5172],"content":"Using the Configuration Manager Console, right-click the <bpt id=\"p1\">**</bpt>Zero Touch WinPE x64<ept id=\"p1\">**</ept> boot image and select <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>."},{"pos":[5178,5312],"content":"In the <bpt id=\"p1\">**</bpt>Data Source<ept id=\"p1\">**</ept> tab, select the <bpt id=\"p2\">**</bpt>Deploy this boot image from the PXE-enabled distribution point<ept id=\"p2\">**</ept> check box, and click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"content":"Using Configuration Manager Trace, review the E:<ph id=\"ph1\">\\\\</ph>Program Files<ph id=\"ph2\">\\\\</ph>Microsoft Configuration Manager<ph id=\"ph3\">\\\\</ph>Logs<ph id=\"ph4\">\\\\</ph>distmgr.log file and look for this text: Expanding PS10000B to E:<ph id=\"ph5\">\\\\</ph>RemoteInstall<ph id=\"ph6\">\\\\</ph>SMSImages.","pos":[5318,5514]},{"content":"Review the <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>RemoteInstall<ph id=\"ph2\">\\\\</ph>SMSImages<ept id=\"p1\">**</ept> folder.","pos":[5520,5571]},{"content":"You should see three folders containing boot images.","pos":[5572,5624]},{"content":"Two are from the default boot images, and the third folder (PS10000B) is from your new boot image with DaRT.","pos":[5625,5733]},{"content":"Related topics","pos":[5738,5752]},{"content":"Integrate Configuration Manager with MDT 2013 Update 2","pos":[5756,5810]},{"content":"Prepare for Zero Touch Installation of Windows 10 with Configuration Manager","pos":[5864,5940]},{"content":"Add a Windows 10 operating system image using Configuration Manager","pos":[6025,6092]},{"content":"Create an application to deploy with Windows 10 using Configuration Manager","pos":[6168,6243]},{"content":"Add drivers to a Windows 10 deployment with Windows PE using Configuration Manager","pos":[6327,6409]},{"content":"Create a task sequence with Configuration Manager and MDT","pos":[6500,6557]},{"content":"Deploy Windows 10 using PXE and Configuration Manager","pos":[6623,6676]},{"content":"Refresh a Windows 7 SP1 client with Windows 10 using Configuration Manager","pos":[6738,6812]},{"content":"Replace a Windows 7 SP1 client with Windows 10 using Configuration Manager","pos":[6891,6965]}],"content":"---\ntitle: Create a custom Windows PE boot image with Configuration Manager (Windows 10)\ndescription: In Microsoft System Center 2012 R2 Configuration Manager, you can create custom Windows Preinstallation Environment (Windows PE) boot images that include extra components and features.\nms.assetid: b9e96974-324d-4fa4-b0ce-33cfc49c4809\nkeywords: tool, customize, deploy, boot image\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: mtniehaus\n---\n\n# Create a custom Windows PE boot image with Configuration Manager\n\n\n**Applies to**\n\n-   Windows 10\n\nIn Microsoft System Center 2012 R2 Configuration Manager, you can create custom Windows Preinstallation Environment (Windows PE) boot images that include extra components and features. This topic shows you how to create a custom Windows PE 5.0 boot image with the Microsoft Deployment Toolkit (MDT) 2013 Update 2 wizard. You can also add the Microsoft Diagnostics and Recovery Toolset (DaRT) 10 to the boot image as part of the boot image creation process.\n\nFor the purposes of this topic, we will use two machines: DC01 and CM01. DC01 is a domain controller and CM01 is a machine running Windows Server 2012 R2 Standard. Both are members of the domain contoso.com for the fictitious Contoso Corporation. For more details on the setup for this topic, please see [Deploy Windows 10 with the Microsoft Deployment Toolkit](deploy-windows-10-with-the-microsoft-deployment-toolkit.md).\n\n## <a href=\"\" id=\"sec01\"></a>Add DaRT 10 files and prepare to brand the boot image\n\n\nThe steps below outline the process for adding DaRT 10 installation files to the MDT installation directory. You also copy a custom background image to be used later. We assume you have downloaded Microsoft Desktop Optimization Pack (MDOP) 2015 and copied the x64 version of MSDaRT10.msi to the C:\\\\Setup\\\\DaRT 10 folder. We also assume you have created a custom background image and saved it in C:\\\\Setup\\\\Branding on CM01. In this section, we use a custom background image named ContosoBackground.bmp.\n\n1.  Install DaRT 10 (C:\\\\Setup\\\\DaRT 10\\\\MSDaRT10.msi) using the default settings.\n\n2.  Using File Explorer, navigate to the **C:\\\\Program Files\\\\Microsoft DaRT\\\\v10** folder.\n\n3.  Copy the Toolsx64.cab file to the **C:\\\\Program Files\\\\Microsoft Deployment Toolkit\\\\Templates\\\\Distribution\\\\Tools\\\\x64** folder.\n\n4.  Copy the Toolsx86.cab file to the **C:\\\\Program Files\\\\Microsoft Deployment Toolkit\\\\Templates\\\\Distribution\\\\Tools\\\\x86** folder.\n\n5.  Using File Explorer, navigate to the **C:\\\\Setup** folder.\n\n6.  Copy the **Branding** folder to **E:\\\\Sources\\\\OSD**.\n\n## <a href=\"\" id=\"sec02\"></a>Create a boot image for Configuration Manager using the MDT wizard\n\n\nBy using the MDT wizard to create the boot image in Configuration Manager, you gain additional options for adding components and features to the boot image. In this section, you create a boot image for Configuration Manager using the MDT wizard.\n\n1.  Using the Configuration Manager Console, in the Software Library workspace, expand **Operating Systems**, right-click **Boot Images**, and select **Create Boot Image using MDT**.\n\n2.  On the **Package Source** page, in the **Package source folder to be created (UNC Path):** text box, type **\\\\\\\\CM01\\\\Sources$\\\\OSD\\\\Boot\\\\Zero Touch WinPE x64** and click **Next**.\n\n    **Note**  \n    The Zero Touch WinPE x64 folder does not yet exist. The folder will be created later by the wizard.\n\n     \n\n3.  On the **General Settings** page, assign the name **Zero Touch WinPE x64** and click **Next**.\n\n4.  On the **Options** page, select the **x64** platform, and click **Next**.\n\n5.  On the **Components** page, in addition to the default selected **Microsoft Data Access Components (MDAC/ADO)** support, select the **Microsoft Diagnostics and Recovery Toolkit (DaRT)** check box.\n\n    ![figure 15](images/mdt-06-fig16.png)\n\n    Figure 15. Add the DaRT component to the Configuration Manager boot image.\n\n6.  On the **Customization** page, select the **Use a custom background bitmap file** check box, and in the **UNC path:** text box, browse to **\\\\\\\\CM01\\\\Sources$\\\\OSD\\\\Branding\\\\ ContosoBackground.bmp**. Then click **Next** twice.\n\n    **Note**  \n    It will take a few minutes to generate the boot image.\n\n     \n\n7.  Distribute the boot image to the CM01 distribution point by selecting the **Boot images** node, right-clicking the **Zero Touch WinPE x64** boot image, and selecting **Distribute Content**.\n\n8.  In the Distribute Content Wizard, add the CM01 distribution point, and complete the wizard.\n\n9.  Using Configuration Manager Trace, review the E:\\\\Program Files\\\\Microsoft Configuration Manager\\\\Logs\\\\distmgr.log file. Do not continue until you can see that the boot image is distributed. Look for the line that reads STATMSG: ID=2301. You also can view Content Status in the Configuration Manager Console by selecting **the Zero Touch WinPE x86** boot image.\n\n    ![figure 16](images/fig16-contentstatus.png)\n\n    Figure 16. Content status for the Zero Touch WinPE x64 boot image.\n\n10. Using the Configuration Manager Console, right-click the **Zero Touch WinPE x64** boot image and select **Properties**.\n\n11. In the **Data Source** tab, select the **Deploy this boot image from the PXE-enabled distribution point** check box, and click **OK**.\n\n12. Using Configuration Manager Trace, review the E:\\\\Program Files\\\\Microsoft Configuration Manager\\\\Logs\\\\distmgr.log file and look for this text: Expanding PS10000B to E:\\\\RemoteInstall\\\\SMSImages.\n\n13. Review the **E:\\\\RemoteInstall\\\\SMSImages** folder. You should see three folders containing boot images. Two are from the default boot images, and the third folder (PS10000B) is from your new boot image with DaRT.\n\n## Related topics\n\n\n[Integrate Configuration Manager with MDT 2013 Update 2](integrate-configuration-manager-with-mdt-2013.md)\n\n[Prepare for Zero Touch Installation of Windows 10 with Configuration Manager](prepare-for-zero-touch-installation-of-windows-10-with-configuration-manager.md)\n\n[Add a Windows 10 operating system image using Configuration Manager](add-a-windows-10-operating-system-image-using-configuration-manager.md)\n\n[Create an application to deploy with Windows 10 using Configuration Manager](create-an-application-to-deploy-with-windows-10-using-configuration-manager.md)\n\n[Add drivers to a Windows 10 deployment with Windows PE using Configuration Manager](add-drivers-to-a-windows-10-deployment-with-windows-pe-using-configuration-manager.md)\n\n[Create a task sequence with Configuration Manager and MDT](create-a-task-sequence-with-configuration-manager-and-mdt.md)\n\n[Deploy Windows 10 using PXE and Configuration Manager](deploy-windows-10-using-pxe-and-configuration-manager.md)\n\n[Refresh a Windows 7 SP1 client with Windows 10 using Configuration Manager](refresh-a-windows-7-client-with-windows-10-using-configuration-manager.md)\n\n[Replace a Windows 7 SP1 client with Windows 10 using Configuration Manager](replace-a-windows-7-client-with-windows-10-using-configuration-manager.md)\n\n \n\n \n\n\n\n\n\n"}