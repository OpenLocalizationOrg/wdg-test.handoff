{"nodes":[{"content":"4771(F) Kerberos pre-authentication failed.","pos":[11,54]},{"content":"(Windows 10)","pos":[55,67]},{"content":"Describes security event 4771(F) Kerberos pre-authentication failed.","pos":[81,149]},{"content":"4771(F): Kerberos pre-authentication failed.","pos":[249,293]},{"content":"Applies to","pos":[297,307]},{"content":"Windows 10","pos":[314,324]},{"content":"Windows Server 2016","pos":[329,348]},{"pos":[468,573],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit Kerberos Authentication Service<ept id=\"p2\">](audit-kerberos-authentication-service.md)</ept>"},{"content":"Event Description:","pos":[578,596]},{"content":"This event generates every time the Key Distribution Center fails to issue a Kerberos Ticket Granting Ticket (TGT).","pos":[601,716]},{"content":"This can occur when a domain controller doesn’t have a certificate installed for smart card authentication (for example, with a “Domain Controller” or “Domain Controller Authentication” template), the user’s password has expired, or the wrong password was provided.","pos":[717,982]},{"content":"This event generates only on domain controllers.","pos":[984,1032]},{"content":"This event is not generated if “Do not require Kerberos preauthentication” option is set for the account.","pos":[1034,1139]},{"pos":[1143,1279],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For recommendations, see <bpt id=\"p2\">[</bpt>Security Monitoring Recommendations<ept id=\"p2\">](#security-monitoring-recommendations)</ept> for this event."},{"content":"Event XML:","pos":[1302,1312]},{"pos":[2449,2513],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> Active Directory domain controller."},{"pos":[2515,2561],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008."},{"pos":[2563,2587],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Field Descriptions:","pos":[2592,2611]},{"content":"Account Information:","pos":[2618,2638]},{"content":"<bpt id=\"p1\">**</bpt>Security ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = SID<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> SID of account object for which (TGT) ticket was requested.","pos":[2646,2741]},{"content":"Event Viewer automatically tries to resolve SIDs and show the account name.","pos":[2742,2817]},{"content":"If the SID cannot be resolved, you will see the source data in the event.","pos":[2818,2891]},{"content":"For example: CONTOSO<ph id=\"ph1\">\\\\</ph>dadmin or CONTOSO<ph id=\"ph2\">\\\\</ph>WIN81$.","pos":[2897,2945]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>A <bpt id=\"p2\">**</bpt>security identifier (SID)<ept id=\"p2\">**</ept> is a unique value of variable length used to identify a trustee (security principal).","pos":[2949,3086]},{"content":"Each account has a unique SID that is issued by an authority, such as an Active Directory domain controller, and stored in a security database.","pos":[3087,3230]},{"content":"Each time a user logs on, the system retrieves the SID for that user from the database and places it in the access token for that user.","pos":[3231,3366]},{"content":"The system uses the SID in the access token to identify the user in all subsequent interactions with Windows security.","pos":[3367,3485]},{"content":"When a SID has been used as the unique identifier for a user or group, it cannot ever be used again to identify another user or group.","pos":[3486,3620]},{"content":"For more information about SIDs, see <bpt id=\"p1\">[</bpt>Security identifiers<ept id=\"p1\">](security-identifiers.md)</ept>.","pos":[3621,3706]},{"content":"<bpt id=\"p1\">**</bpt>Account Name:<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the name of account, for which (TGT) ticket was requested.","pos":[3712,3818]},{"content":"Computer account name ends with <bpt id=\"p1\">**</bpt><ph id=\"ph1\">$</ph><ept id=\"p1\">**</ept> character.","pos":[3819,3867]},{"content":"User account example: dadmin","pos":[3877,3905]},{"content":"Computer account example: WIN81$","pos":[3915,3947]},{"content":"Service Information:","pos":[3951,3971]},{"content":"<bpt id=\"p1\">**</bpt>Service Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the name of the service in the Kerberos Realm to which TGT request was sent.","pos":[3979,4098]},{"content":"Typically has one of the following formats:","pos":[4099,4142]},{"content":"krbtgt/DOMAIN<ph id=\"ph1\">\\_</ph>NETBIOS<ph id=\"ph2\">\\_</ph>NAME.","pos":[4152,4181]},{"content":"Example: krbtgt/CONTOSO","pos":[4182,4205]},{"content":"krbtgt/DOMAIN<ph id=\"ph1\">\\_</ph>FULL<ph id=\"ph2\">\\_</ph>NAME.","pos":[4215,4241]},{"content":"Example: krbtgt/CONTOSO.LOCAL","pos":[4242,4271]},{"content":"Network Information:","pos":[4275,4295]},{"content":"<bpt id=\"p1\">**</bpt>Client Address<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> IP address of the computer from which the TGT request was received.","pos":[4303,4419]},{"content":"Formats vary, and include the following:","pos":[4420,4460]},{"pos":[4470,4499],"content":"<bpt id=\"p1\">**</bpt>IPv6<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>IPv4<ept id=\"p2\">**</ept> address."},{"pos":[4509,4534],"content":"<bpt id=\"p1\">**</bpt>::ffff:IPv4<ph id=\"ph1\">\\_</ph>address<ept id=\"p1\">**</ept>."},{"pos":[4544,4564],"content":"<bpt id=\"p1\">**</bpt>::1<ept id=\"p1\">**</ept> - localhost."},{"pos":[4570,4685],"content":"<bpt id=\"p1\">**</bpt>Client Port<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: source port number of client network connection (TGT request connection)."},{"content":"0 for local (localhost) requests.","pos":[4695,4728]},{"content":"Additional Information:","pos":[4732,4755]},{"pos":[4763,4866],"content":"<bpt id=\"p1\">**</bpt>Ticket Options<ept id=\"p1\">**</ept>: <ph id=\"ph1\">\\[</ph>Type = HexInt32<ph id=\"ph2\">\\]</ph>: this is a set of different Ticket Flags in hexadecimal format."},{"content":"Example:","pos":[4872,4880]},{"content":"Ticket Options: 0x40810010","pos":[4890,4916]},{"content":"Binary view: 01000000100000010000000000010000","pos":[4926,4971]},{"pos":[4981,5096],"content":"Using <bpt id=\"p1\">**</bpt>MSB 0<ept id=\"p1\">**</ept> bit numbering we have bit 1, 8, 15 and 27 set = Forwardable, Renewable, Canonicalize, Renewable-ok."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>In the table below <bpt id=\"p2\">**</bpt>“MSB 0”<ept id=\"p2\">**</ept> bit numbering is used, because RFC documents use this style.","pos":[5100,5211]},{"content":"In “MSB 0” style bit numbering begins from left.","pos":[5212,5260]},{"content":"The most common values:","pos":[5341,5364]},{"content":"0x40810010 - Forwardable, Renewable, Canonicalize, Renewable-ok","pos":[5370,5433]},{"content":"0x40810000 - Forwardable, Renewable, Canonicalize","pos":[5439,5488]},{"content":"0x60810010 - Forwardable, Forwarded, Renewable, Canonicalize, Renewable-ok","pos":[5494,5568]},{"content":"Bit","pos":[5572,5575]},{"content":"Flag Name","pos":[5580,5589]},{"content":"Description","pos":[5607,5618]},{"content":"0","pos":[6924,6925]},{"content":"Reserved","pos":[6932,6940]},{"content":"1","pos":[7600,7601]},{"content":"Forwardable","pos":[7608,7619]},{"content":"(TGT only).","pos":[7635,7646]},{"content":"Tells the ticket-granting service that it can issue a new TGT—based on the presented TGT—with a different network address based on the presented TGT.","pos":[7647,7796]},{"content":"2","pos":[8276,8277]},{"content":"Forwarded","pos":[8284,8293]},{"content":"Indicates either that a TGT has been forwarded or that a ticket was issued from a forwarded TGT.","pos":[8311,8407]},{"content":"3","pos":[8952,8953]},{"content":"Proxiable","pos":[8960,8969]},{"content":"(TGT only).","pos":[8987,8998]},{"content":"Tells the ticket-granting service that it can issue tickets with a network address that differs from the one in the TGT.","pos":[8999,9119]},{"content":"4","pos":[9628,9629]},{"content":"Proxy","pos":[9636,9641]},{"content":"Indicates that the network address in the ticket is different from the one in the TGT used to obtain the ticket.","pos":[9663,9775]},{"content":"5","pos":[10304,10305]},{"content":"Allow-postdate","pos":[10312,10326]},{"pos":[10339,10487],"content":"Postdated tickets SHOULD NOT be supported in <bpt id=\"p1\">[</bpt>KILE<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc233855.aspx)</ept> (Microsoft Kerberos Protocol Extension)."},{"content":"6","pos":[10980,10981]},{"content":"Postdated","pos":[10988,10997]},{"pos":[11015,11163],"content":"Postdated tickets SHOULD NOT be supported in <bpt id=\"p1\">[</bpt>KILE<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc233855.aspx)</ept> (Microsoft Kerberos Protocol Extension)."},{"content":"7","pos":[11656,11657]},{"content":"Invalid","pos":[11664,11671]},{"content":"This flag indicates that a ticket is invalid, and it must be validated by the KDC before use.","pos":[11691,11784]},{"content":"Application servers must reject tickets which have this flag set.","pos":[11785,11850]},{"content":"8","pos":[12332,12333]},{"content":"Renewable","pos":[12340,12349]},{"content":"Used in combination with the End Time and Renew Till fields to cause tickets with long life spans to be renewed at the KDC periodically.","pos":[12367,12503]},{"content":"9","pos":[13008,13009]},{"content":"Initial","pos":[13016,13023]},{"content":"Indicates that a ticket was issued using the authentication service (AS) exchange and not issued based on a TGT.","pos":[13043,13155]},{"content":"10","pos":[13684,13686]},{"content":"Pre-authent","pos":[13692,13703]},{"content":"Indicates that the client was authenticated by the KDC before a ticket was issued.","pos":[13719,13801]},{"content":"This flag usually indicates the presence of an authenticator in the ticket.","pos":[13802,13877]},{"content":"It can also flag the presence of credentials taken from a smart card logon.","pos":[13878,13953]},{"content":"11","pos":[14360,14362]},{"content":"Opt-hardware-auth","pos":[14368,14385]},{"content":"This flag was originally intended to indicate that hardware-supported authentication was used during pre-authentication.","pos":[14395,14515]},{"content":"This flag is no longer recommended in the Kerberos V5 protocol.","pos":[14516,14579]},{"content":"KDCs MUST NOT issue a ticket with this flag set.","pos":[14580,14628]},{"content":"KDCs SHOULD NOT preserve this flag if it is set by another KDC.","pos":[14629,14692]},{"content":"12","pos":[15036,15038]},{"content":"Transited-policy-checked","pos":[15044,15068]},{"content":"KILE MUST NOT check for transited domains on servers or a KDC.","pos":[15071,15133]},{"content":"Application servers MUST ignore the TRANSITED-POLICY-CHECKED flag.","pos":[15134,15200]},{"content":"13","pos":[15712,15714]},{"content":"Ok-as-delegate","pos":[15720,15734]},{"content":"The KDC MUST set the OK-AS-DELEGATE flag if the service account is trusted for delegation.","pos":[15747,15837]},{"content":"14","pos":[16388,16390]},{"content":"Request-anonymous","pos":[16396,16413]},{"content":"KILE not use this flag.","pos":[16423,16446]},{"content":"15","pos":[17064,17066]},{"content":"Name-canonicalize","pos":[17072,17089]},{"content":"In order to request referrals the Kerberos client MUST explicitly request the \"canonicalize\" KDC option for the AS-REQ or TGS-REQ.","pos":[17099,17229]},{"content":"16-25","pos":[17740,17745]},{"content":"Unused","pos":[17748,17754]},{"content":"26","pos":[18416,18418]},{"content":"Disable-transited-check","pos":[18424,18447]},{"content":"By default the KDC will check the transited field of a TGT against the policy of the local realm before it will issue derivative tickets based on the TGT.","pos":[18451,18605]},{"content":"If this flag is set in the request, checking of the transited field is disabled.","pos":[18606,18686]},{"content":"Tickets issued without the performance of this check will be noted by the reset (0) value of the TRANSITED-POLICY-CHECKED flag, indicating to the application server that the transited field must be checked locally.","pos":[18687,18901]},{"content":"KDCs are encouraged but not required to honor","pos":[18902,18947]},{"content":"the DISABLE-TRANSITED-CHECK option.","pos":[18951,18986]},{"content":"Should not be in use, because Transited-policy-checked flag is not supported by KILE.","pos":[18990,19075]},{"content":"27","pos":[19080,19082]},{"content":"Renewable-ok","pos":[19088,19100]},{"content":"The RENEWABLE-OK option indicates that a renewable ticket will be acceptable if a ticket with the requested life cannot otherwise be provided, in which case a renewable ticket may be issued with a renew-till equal to the requested end time.","pos":[19115,19355]},{"content":"The value of the renew-till field may still be limited by local limits, or limits selected by the individual principal or server.","pos":[19356,19485]},{"content":"28","pos":[19756,19758]},{"content":"Enc-tkt-in-skey","pos":[19764,19779]},{"content":"No information.","pos":[19791,19806]},{"content":"29","pos":[20432,20434]},{"content":"Unused","pos":[20440,20446]},{"content":"30","pos":[21108,21110]},{"content":"Renew","pos":[21116,21121]},{"content":"The RENEW option indicates that the present request is for a renewal.","pos":[21143,21212]},{"content":"The ticket provided is encrypted in the secret key for the server on which it is valid.","pos":[21213,21300]},{"content":"This option will only be honored if the ticket to be renewed has its RENEWABLE flag set and if the time in its renew-till field has not passed.","pos":[21301,21444]},{"content":"The ticket to be renewed is passed in the padata field as part of the authentication header.","pos":[21445,21537]},{"content":"31","pos":[21784,21786]},{"content":"Validate","pos":[21792,21800]},{"content":"This option is used only by the ticket-granting service.","pos":[21819,21875]},{"content":"The VALIDATE option indicates that the request is to validate a postdated ticket.","pos":[21876,21957]},{"content":"Should not be in use, because postdated tickets are not supported by KILE.","pos":[21958,22032]},{"content":"Table 6.","pos":[22461,22469]},{"content":"Kerberos ticket flags.","pos":[22470,22492]},{"content":"<bpt id=\"p1\">**</bpt>Failure Code<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = HexInt32<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> hexadecimal failure code of failed TGT issue operation.","pos":[22498,22595]},{"content":"The table below contains the list of the most common error codes for this event:","pos":[22596,22676]},{"content":"Code","pos":[22680,22684]},{"content":"Code Name","pos":[22687,22696]},{"content":"Description","pos":[22720,22731]},{"content":"Possible causes","pos":[22783,22798]},{"content":"0x10","pos":[23858,23862]},{"content":"KDC<ph id=\"ph1\">\\_</ph>ERR<ph id=\"ph2\">\\_</ph>PADATA<ph id=\"ph3\">\\_</ph>TYPE<ph id=\"ph4\">\\_</ph>NOSUPP","pos":[23865,23895]},{"content":"KDC has no support for PADATA type (pre-authentication data)","pos":[23898,23958]},{"content":"Smart card logon is being attempted and the proper certificate cannot be located.","pos":[23961,24042]},{"content":"This can happen because the wrong certification authority (CA) is being queried or the proper CA cannot be contacted in order to get Domain Controller or Domain Controller Authentication certificates for the domain controller.","pos":[24043,24269]},{"content":"It can also happen when a domain controller doesn’t have a certificate installed for smart cards (Domain Controller or Domain Controller Authentication templates).","pos":[24273,24436]},{"content":"0x17","pos":[24441,24445]},{"content":"KDC<ph id=\"ph1\">\\_</ph>ERR<ph id=\"ph2\">\\_</ph>KEY<ph id=\"ph3\">\\_</ph>EXPIRED","pos":[24448,24470]},{"content":"Password has expired—change password to reset","pos":[24481,24526]},{"content":"The user’s password has expired.","pos":[24544,24576]},{"content":"0x18","pos":[25030,25034]},{"content":"KDC<ph id=\"ph1\">\\_</ph>ERR<ph id=\"ph2\">\\_</ph>PREAUTH<ph id=\"ph3\">\\_</ph>FAILED","pos":[25037,25062]},{"content":"Pre-authentication information was invalid","pos":[25070,25112]},{"content":"The wrong password was provided.","pos":[25133,25165]},{"pos":[25622,25812],"content":"<bpt id=\"p1\">**</bpt>Pre-Authentication Type<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the code of <bpt id=\"p2\">[</bpt>pre-Authentication<ept id=\"p2\">](https://technet.microsoft.com/en-us/library/cc772815(v=ws.10).aspx)</ept> type which was used in TGT request."},{"content":"Table 5.","pos":[25864,25872]},{"content":"Kerberos Pre-Authentication types.","pos":[25873,25907]},{"content":"Type","pos":[25911,25915]},{"content":"Type Name","pos":[25918,25927]},{"content":"Description","pos":[25943,25954]},{"content":"0","pos":[26785,26786]},{"content":"Logon without Pre-Authentication.","pos":[26817,26850]},{"content":"2","pos":[27222,27223]},{"content":"PA-ENC-TIMESTAMP","pos":[27229,27245]},{"content":"This is a normal type for standard password authentication.","pos":[27254,27313]},{"content":"11","pos":[27659,27661]},{"content":"PA-ETYPE-INFO","pos":[27666,27679]},{"content":"The ETYPE-INFO pre-authentication type is sent by the KDC in a KRB-ERROR indicating a requirement for additional pre-authentication.","pos":[27691,27823]},{"content":"It is usually used to notify a client of which key to use for the encryption of an encrypted timestamp for the purposes of sending a PA-ENC-TIMESTAMP pre-authentication value.","pos":[27824,27999]},{"content":"Never saw this Pre-Authentication Type in Microsoft Active Directory environment.","pos":[28003,28084]},{"content":"15","pos":[28090,28092]},{"content":"PA-PK-AS-REP<ph id=\"ph1\">\\_</ph>OLD","pos":[28097,28114]},{"content":"Used for Smart Card logon authentication.","pos":[28122,28163]},{"content":"17","pos":[28527,28529]},{"content":"PA-PK-AS-REP","pos":[28534,28546]},{"content":"This type should also be used for Smart Card authentication, but in certain Active Directory environments, it is never seen.","pos":[28559,28683]},{"content":"19","pos":[28964,28966]},{"content":"PA-ETYPE-INFO2","pos":[28971,28985]},{"content":"The ETYPE-INFO2 pre-authentication type is sent by the KDC in a KRB-ERROR indicating a requirement for additional pre-authentication.","pos":[28996,29129]},{"content":"It is usually used to notify a client of which key to use for the encryption of an encrypted timestamp for the purposes of sending a PA-ENC-TIMESTAMP pre-authentication value.","pos":[29130,29305]},{"content":"Never saw this Pre-Authentication Type in Microsoft Active Directory environment.","pos":[29309,29390]},{"content":"20","pos":[29395,29397]},{"content":"PA-SVR-REFERRAL-INFO","pos":[29402,29422]},{"content":"Used in KDC Referrals tickets.","pos":[29427,29457]},{"content":"138","pos":[29832,29835]},{"content":"PA-ENCRYPTED-CHALLENGE","pos":[29839,29861]},{"content":"Logon using Kerberos Armoring (FAST).","pos":[29864,29901]},{"content":"Supported starting from Windows Server 2012 domain controllers and Windows 8 clients.","pos":[29902,29987]},{"content":"This type shows in Audit Failure events.","pos":[30301,30341]},{"content":"Certificate Information:","pos":[30707,30731]},{"content":"<bpt id=\"p1\">**</bpt>Certificate Issuer Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the name of Certification Authority which issued smart card certificate.","pos":[30737,30867]},{"content":"Populated in <bpt id=\"p1\">**</bpt>Issued by<ept id=\"p1\">**</ept> field in certificate.","pos":[30868,30916]},{"content":"Always empty for <bpt id=\"p1\">[</bpt>4771<ept id=\"p1\">](event-4771.md)</ept> events.","pos":[30917,30963]},{"content":"<bpt id=\"p1\">**</bpt>Certificate Serial Number<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> smart card certificate’s serial number.","pos":[30967,31066]},{"content":"Can be found in <bpt id=\"p1\">**</bpt>Serial number<ept id=\"p1\">**</ept> field in the certificate.","pos":[31067,31126]},{"content":"Always empty for <bpt id=\"p1\">[</bpt>4771<ept id=\"p1\">](event-4771.md)</ept> events.","pos":[31127,31173]},{"content":"<bpt id=\"p1\">**</bpt>Certificate Thumbprint<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> smart card certificate’s thumbprint.","pos":[31177,31270]},{"content":"Can be found in <bpt id=\"p1\">**</bpt>Thumbprint<ept id=\"p1\">**</ept> field in the certificate.","pos":[31271,31327]},{"content":"Always empty for <bpt id=\"p1\">[</bpt>4771<ept id=\"p1\">](event-4771.md)</ept> events.","pos":[31328,31374]},{"content":"Security Monitoring Recommendations","pos":[31379,31414]},{"content":"For 4771(F): Kerberos pre-authentication failed.","pos":[31416,31464]},{"content":"Type of monitoring required","pos":[31470,31497]},{"content":"Recommendation","pos":[31778,31792]},{"content":"<bpt id=\"p1\">**</bpt>High-value accounts<ept id=\"p1\">**</ept>: You might have high-value domain or local accounts for which you need to monitor each action.","pos":[32418,32536]},{"content":"Examples of high-value accounts are database administrators, built-in local administrator account, domain administrators, service accounts, domain controller accounts and so on.","pos":[32540,32717]},{"pos":[32720,32821],"content":"Monitor this event with the <bpt id=\"p1\">**</bpt>“Security ID”<ept id=\"p1\">**</ept> that corresponds to the high-value account or accounts."},{"content":"<bpt id=\"p1\">**</bpt>Anomalies or malicious actions<ept id=\"p1\">**</ept>: You might have specific requirements for detecting anomalies or monitoring potential malicious actions.","pos":[32887,33026]},{"content":"For example, you might need to monitor for use of an account outside of working hours.","pos":[33027,33113]},{"pos":[33195,33357],"content":"When you monitor for anomalies or malicious actions, use the <bpt id=\"p1\">**</bpt>“Security ID”<ept id=\"p1\">**</ept> (with other information) to monitor how or when a particular account is being used."},{"pos":[33362,33487],"content":"<bpt id=\"p1\">**</bpt>Non-active accounts<ept id=\"p1\">**</ept>: You might have non-active, disabled, or guest accounts, or other accounts that should never be used."},{"pos":[33670,33775],"content":"Monitor this event with the <bpt id=\"p1\">**</bpt>“Security ID”<ept id=\"p1\">**</ept> that corresponds to the accounts that should never be used."},{"pos":[33837,33993],"content":"<bpt id=\"p1\">**</bpt>Account whitelist<ept id=\"p1\">**</ept>: You might have a specific whitelist of accounts that are the only ones allowed to perform actions corresponding to particular events."},{"pos":[34145,34274],"content":"If this event corresponds to a “whitelist-only” action, review the <bpt id=\"p1\">**</bpt>“Security ID”<ept id=\"p1\">**</ept> for accounts that are outside the whitelist."},{"pos":[34312,34419],"content":"<bpt id=\"p1\">**</bpt>Account naming conventions<ept id=\"p1\">**</ept>: Your organization might have specific naming conventions for account names."},{"pos":[34620,34708],"content":"Monitor “<bpt id=\"p1\">**</bpt>Subject<ph id=\"ph1\">\\\\</ph>Account Name”<ept id=\"p1\">**</ept> for names that don’t comply with naming conventions."},{"pos":[34790,34931],"content":"You can track all <bpt id=\"p1\">[</bpt>4771<ept id=\"p1\">](event-4771.md)</ept> events where the <bpt id=\"p2\">**</bpt>Client Address<ept id=\"p2\">**</ept> is not from your internal IP range or not from private IP ranges."},{"content":"If you know that <bpt id=\"p1\">**</bpt>Account Name<ept id=\"p1\">**</ept> should be used only from known list of IP addresses, track all <bpt id=\"p2\">**</bpt>Client Address<ept id=\"p2\">**</ept> values for this <bpt id=\"p3\">**</bpt>Account Name<ept id=\"p3\">**</ept> in <bpt id=\"p4\">[</bpt>4771<ept id=\"p4\">](event-4771.md)</ept> events.","pos":[34937,35118]},{"content":"If <bpt id=\"p1\">**</bpt>Client Address<ept id=\"p1\">**</ept> is not from the whitelist, generate the alert.","pos":[35119,35187]},{"content":"All <bpt id=\"p1\">**</bpt>Client Address<ept id=\"p1\">**</ept> = ::1 means local authentication.","pos":[35193,35249]},{"content":"If you know the list of accounts which should log on to the domain controllers, then you need to monitor for all possible violations, where <bpt id=\"p1\">**</bpt>Client Address<ept id=\"p1\">**</ept> = ::1 and <bpt id=\"p2\">**</bpt>Account Name<ept id=\"p2\">**</ept> is not allowed to log on to any domain controller.","pos":[35250,35486]},{"pos":[35492,35658],"content":"All <bpt id=\"p1\">[</bpt>4771<ept id=\"p1\">](event-4771.md)</ept> events with <bpt id=\"p2\">**</bpt>Client Port<ept id=\"p2\">**</ept> field value <ph id=\"ph1\">&amp;gt;</ph> 0 and <ph id=\"ph2\">&amp;lt;</ph> 1024 should be examined, because a well-known port was used for outbound connection."},{"content":"Also monitor the fields shown in the following table, to discover the issues listed:","pos":[35664,35748]},{"content":"Field","pos":[35754,35759]},{"content":"Issue to discover","pos":[35784,35801]},{"content":"Pre-Authentication Type","pos":[36264,36287]},{"content":"Value is <bpt id=\"p1\">**</bpt>not 15<ept id=\"p1\">**</ept> when account must use a smart card for authentication.","pos":[36292,36366]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Table 5. Kerberos Pre-Authentication types<ept id=\"p1\">](#kerberos-preauthentication-types)</ept>.","pos":[36367,36473]},{"content":"Pre-Authentication Type","pos":[36519,36542]},{"content":"Value is <bpt id=\"p1\">**</bpt>not 2<ept id=\"p1\">**</ept> when only standard password authentication is in use in the organization.","pos":[36547,36639]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Table 5. Kerberos Pre-Authentication types<ept id=\"p1\">](#kerberos-preauthentication-types)</ept>.","pos":[36640,36746]},{"content":"Pre-Authentication Type","pos":[36774,36797]},{"content":"Value is <bpt id=\"p1\">**</bpt>not 138<ept id=\"p1\">**</ept> when Kerberos Armoring is enabled for all Kerberos communications in the organization.","pos":[36802,36909]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Table 5. Kerberos Pre-Authentication types<ept id=\"p1\">](#kerberos-preauthentication-types)</ept>.","pos":[36910,37016]},{"content":"Result Code","pos":[37029,37040]},{"content":"<bpt id=\"p1\">**</bpt>0x10<ept id=\"p1\">**</ept> (KDC has no support for PADATA type (pre-authentication data)).","pos":[37057,37129]},{"content":"This error can help you to more quickly identify smart-card related problems with Kerberos authentication.","pos":[37130,37236]},{"content":"Result Code","pos":[37284,37295]},{"content":"<bpt id=\"p1\">**</bpt>0x18<ept id=\"p1\">**</ept> ((Pre-authentication information was invalid), if you see, for example N events in last N minutes.","pos":[37312,37419]},{"content":"This can be an indicator of brute-force attack on the account password, especially for highly critical accounts.","pos":[37420,37532]}],"content":"---\ntitle: 4771(F) Kerberos pre-authentication failed. (Windows 10)\ndescription: Describes security event 4771(F) Kerberos pre-authentication failed.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 4771(F): Kerberos pre-authentication failed.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\n<img src=\"images/event-4771.png\" alt=\"Event 4771 illustration\" width=\"496\" height=\"657\" hspace=\"10\" align=\"left\" />\n\n***Subcategory:***&nbsp;[Audit Kerberos Authentication Service](audit-kerberos-authentication-service.md)\n\n***Event Description:***\n\nThis event generates every time the Key Distribution Center fails to issue a Kerberos Ticket Granting Ticket (TGT). This can occur when a domain controller doesn’t have a certificate installed for smart card authentication (for example, with a “Domain Controller” or “Domain Controller Authentication” template), the user’s password has expired, or the wrong password was provided.\n\nThis event generates only on domain controllers.\n\nThis event is not generated if “Do not require Kerberos preauthentication” option is set for the account.\n\n> **Note**&nbsp;&nbsp;For recommendations, see [Security Monitoring Recommendations](#security-monitoring-recommendations) for this event.\n\n<br clear=\"all\">\n\n***Event XML:***\n```\n- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n- <System>\n <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> \n <EventID>4771</EventID> \n <Version>0</Version> \n <Level>0</Level> \n <Task>14339</Task> \n <Opcode>0</Opcode> \n <Keywords>0x8010000000000000</Keywords> \n <TimeCreated SystemTime=\"2015-08-07T18:10:21.495462300Z\" /> \n <EventRecordID>166708</EventRecordID> \n <Correlation /> \n <Execution ProcessID=\"520\" ThreadID=\"1084\" /> \n <Channel>Security</Channel> \n <Computer>DC01.contoso.local</Computer> \n <Security /> \n </System>\n- <EventData>\n <Data Name=\"TargetUserName\">dadmin</Data> \n <Data Name=\"TargetSid\">S-1-5-21-3457937927-2839227994-823803824-1104</Data> \n <Data Name=\"ServiceName\">krbtgt/CONTOSO.LOCAL</Data> \n <Data Name=\"TicketOptions\">0x40810010</Data> \n <Data Name=\"Status\">0x10</Data> \n <Data Name=\"PreAuthType\">15</Data> \n <Data Name=\"IpAddress\">::ffff:10.0.0.12</Data> \n <Data Name=\"IpPort\">49254</Data> \n <Data Name=\"CertIssuerName\" /> \n <Data Name=\"CertSerialNumber\" /> \n <Data Name=\"CertThumbprint\" /> \n </EventData>\n </Event>\n\n```\n\n***Required Server Roles:*** Active Directory domain controller.\n\n***Minimum OS Version:*** Windows Server 2008.\n\n***Event Versions:*** 0.\n\n***Field Descriptions:***\n\n**Account Information:**\n\n-   **Security ID** \\[Type = SID\\]**:** SID of account object for which (TGT) ticket was requested. Event Viewer automatically tries to resolve SIDs and show the account name. If the SID cannot be resolved, you will see the source data in the event.\n\n    For example: CONTOSO\\\\dadmin or CONTOSO\\\\WIN81$.\n\n> **Note**&nbsp;&nbsp;A **security identifier (SID)** is a unique value of variable length used to identify a trustee (security principal). Each account has a unique SID that is issued by an authority, such as an Active Directory domain controller, and stored in a security database. Each time a user logs on, the system retrieves the SID for that user from the database and places it in the access token for that user. The system uses the SID in the access token to identify the user in all subsequent interactions with Windows security. When a SID has been used as the unique identifier for a user or group, it cannot ever be used again to identify another user or group. For more information about SIDs, see [Security identifiers](security-identifiers.md).\n\n-   **Account Name:** \\[Type = UnicodeString\\]**:** the name of account, for which (TGT) ticket was requested. Computer account name ends with **$** character.\n\n    -   User account example: dadmin\n\n    -   Computer account example: WIN81$\n\n**Service Information:**\n\n-   **Service Name** \\[Type = UnicodeString\\]: the name of the service in the Kerberos Realm to which TGT request was sent. Typically has one of the following formats:\n\n    -   krbtgt/DOMAIN\\_NETBIOS\\_NAME. Example: krbtgt/CONTOSO\n\n    -   krbtgt/DOMAIN\\_FULL\\_NAME. Example: krbtgt/CONTOSO.LOCAL\n\n**Network Information:**\n\n-   **Client Address** \\[Type = UnicodeString\\]**:** IP address of the computer from which the TGT request was received. Formats vary, and include the following:\n\n    -   **IPv6** or **IPv4** address.\n\n    -   **::ffff:IPv4\\_address**.\n\n    -   **::1** - localhost.\n\n-   **Client Port** \\[Type = UnicodeString\\]: source port number of client network connection (TGT request connection).\n\n    -   0 for local (localhost) requests.\n\n**Additional Information:**\n\n-   **Ticket Options**: \\[Type = HexInt32\\]: this is a set of different Ticket Flags in hexadecimal format.\n\n    Example:\n\n    -   Ticket Options: 0x40810010\n\n    -   Binary view: 01000000100000010000000000010000\n\n    -   Using **MSB 0** bit numbering we have bit 1, 8, 15 and 27 set = Forwardable, Renewable, Canonicalize, Renewable-ok.\n\n> **Note**&nbsp;&nbsp;In the table below **“MSB 0”** bit numbering is used, because RFC documents use this style. In “MSB 0” style bit numbering begins from left.<br><img src=\"images/msb.png\" alt=\"MSB illustration\" width=\"224\" height=\"57\" />\n\nThe most common values:\n\n-   0x40810010 - Forwardable, Renewable, Canonicalize, Renewable-ok\n\n-   0x40810000 - Forwardable, Renewable, Canonicalize\n\n-   0x60810010 - Forwardable, Forwarded, Renewable, Canonicalize, Renewable-ok\n\n| Bit   | Flag Name                | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n|-------|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| 0     | Reserved                 | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n| 1     | Forwardable              | (TGT only). Tells the ticket-granting service that it can issue a new TGT—based on the presented TGT—with a different network address based on the presented TGT.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n| 2     | Forwarded                | Indicates either that a TGT has been forwarded or that a ticket was issued from a forwarded TGT.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |\n| 3     | Proxiable                | (TGT only). Tells the ticket-granting service that it can issue tickets with a network address that differs from the one in the TGT.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |\n| 4     | Proxy                    | Indicates that the network address in the ticket is different from the one in the TGT used to obtain the ticket.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |\n| 5     | Allow-postdate           | Postdated tickets SHOULD NOT be supported in [KILE](https://msdn.microsoft.com/en-us/library/cc233855.aspx) (Microsoft Kerberos Protocol Extension).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |\n| 6     | Postdated                | Postdated tickets SHOULD NOT be supported in [KILE](https://msdn.microsoft.com/en-us/library/cc233855.aspx) (Microsoft Kerberos Protocol Extension).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |\n| 7     | Invalid                  | This flag indicates that a ticket is invalid, and it must be validated by the KDC before use. Application servers must reject tickets which have this flag set.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |\n| 8     | Renewable                | Used in combination with the End Time and Renew Till fields to cause tickets with long life spans to be renewed at the KDC periodically.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |\n| 9     | Initial                  | Indicates that a ticket was issued using the authentication service (AS) exchange and not issued based on a TGT.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |\n| 10    | Pre-authent              | Indicates that the client was authenticated by the KDC before a ticket was issued. This flag usually indicates the presence of an authenticator in the ticket. It can also flag the presence of credentials taken from a smart card logon.                                                                                                                                                                                                                                                                                                                                                                                                                   |\n| 11    | Opt-hardware-auth        | This flag was originally intended to indicate that hardware-supported authentication was used during pre-authentication. This flag is no longer recommended in the Kerberos V5 protocol. KDCs MUST NOT issue a ticket with this flag set. KDCs SHOULD NOT preserve this flag if it is set by another KDC.                                                                                                                                                                                                                                                                                                                                                    |\n| 12    | Transited-policy-checked | KILE MUST NOT check for transited domains on servers or a KDC. Application servers MUST ignore the TRANSITED-POLICY-CHECKED flag.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n| 13    | Ok-as-delegate           | The KDC MUST set the OK-AS-DELEGATE flag if the service account is trusted for delegation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |\n| 14    | Request-anonymous        | KILE not use this flag.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |\n| 15    | Name-canonicalize        | In order to request referrals the Kerberos client MUST explicitly request the \"canonicalize\" KDC option for the AS-REQ or TGS-REQ.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |\n| 16-25 | Unused                   | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n| 26    | Disable-transited-check  | By default the KDC will check the transited field of a TGT against the policy of the local realm before it will issue derivative tickets based on the TGT. If this flag is set in the request, checking of the transited field is disabled. Tickets issued without the performance of this check will be noted by the reset (0) value of the TRANSITED-POLICY-CHECKED flag, indicating to the application server that the transited field must be checked locally. KDCs are encouraged but not required to honor<br>the DISABLE-TRANSITED-CHECK option.<br>Should not be in use, because Transited-policy-checked flag is not supported by KILE. |\n| 27    | Renewable-ok             | The RENEWABLE-OK option indicates that a renewable ticket will be acceptable if a ticket with the requested life cannot otherwise be provided, in which case a renewable ticket may be issued with a renew-till equal to the requested end time. The value of the renew-till field may still be limited by local limits, or limits selected by the individual principal or server.                                                                                                                                                                                                                                                                           |\n| 28    | Enc-tkt-in-skey          | No information.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |\n| 29    | Unused                   | -                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n| 30    | Renew                    | The RENEW option indicates that the present request is for a renewal. The ticket provided is encrypted in the secret key for the server on which it is valid. This option will only be honored if the ticket to be renewed has its RENEWABLE flag set and if the time in its renew-till field has not passed. The ticket to be renewed is passed in the padata field as part of the authentication header.                                                                                                                                                                                                                                                   |\n| 31    | Validate                 | This option is used only by the ticket-granting service. The VALIDATE option indicates that the request is to validate a postdated ticket. Should not be in use, because postdated tickets are not supported by KILE.                                                                                                                                                                                                                                                                                                                                                                                                                                        |\n\n> Table 6. Kerberos ticket flags.\n\n-   **Failure Code** \\[Type = HexInt32\\]**:** hexadecimal failure code of failed TGT issue operation. The table below contains the list of the most common error codes for this event:\n\n| Code | Code Name                      | Description                                                  | Possible causes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |\n|------|--------------------------------|--------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| 0x10 | KDC\\_ERR\\_PADATA\\_TYPE\\_NOSUPP | KDC has no support for PADATA type (pre-authentication data) | Smart card logon is being attempted and the proper certificate cannot be located. This can happen because the wrong certification authority (CA) is being queried or the proper CA cannot be contacted in order to get Domain Controller or Domain Controller Authentication certificates for the domain controller.<br>It can also happen when a domain controller doesn’t have a certificate installed for smart cards (Domain Controller or Domain Controller Authentication templates). |\n| 0x17 | KDC\\_ERR\\_KEY\\_EXPIRED         | Password has expired—change password to reset                | The user’s password has expired.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n| 0x18 | KDC\\_ERR\\_PREAUTH\\_FAILED      | Pre-authentication information was invalid                   | The wrong password was provided.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n\n-   **Pre-Authentication Type** \\[Type = UnicodeString\\]: the code of [pre-Authentication](https://technet.microsoft.com/en-us/library/cc772815(v=ws.10).aspx) type which was used in TGT request.\n\n<span id=\"kerberos-preauthentication-types\" />\n## Table 5. Kerberos Pre-Authentication types.\n\n| Type | Type Name              | Description                                                                                                                                                                                                                                                                                                                                                                                                      |\n|------|------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| 0    | -                      | Logon without Pre-Authentication.                                                                                                                                                                                                                                                                                                                                                                                |\n| 2    | PA-ENC-TIMESTAMP       | This is a normal type for standard password authentication.                                                                                                                                                                                                                                                                                                                                                      |\n| 11   | PA-ETYPE-INFO          | The ETYPE-INFO pre-authentication type is sent by the KDC in a KRB-ERROR indicating a requirement for additional pre-authentication. It is usually used to notify a client of which key to use for the encryption of an encrypted timestamp for the purposes of sending a PA-ENC-TIMESTAMP pre-authentication value.<br>Never saw this Pre-Authentication Type in Microsoft Active Directory environment.  |\n| 15   | PA-PK-AS-REP\\_OLD      | Used for Smart Card logon authentication.                                                                                                                                                                                                                                                                                                                                                                        |\n| 17   | PA-PK-AS-REP           | This type should also be used for Smart Card authentication, but in certain Active Directory environments, it is never seen.                                                                                                                                                                                                                                                                                     |\n| 19   | PA-ETYPE-INFO2         | The ETYPE-INFO2 pre-authentication type is sent by the KDC in a KRB-ERROR indicating a requirement for additional pre-authentication. It is usually used to notify a client of which key to use for the encryption of an encrypted timestamp for the purposes of sending a PA-ENC-TIMESTAMP pre-authentication value.<br>Never saw this Pre-Authentication Type in Microsoft Active Directory environment. |\n| 20   | PA-SVR-REFERRAL-INFO   | Used in KDC Referrals tickets.                                                                                                                                                                                                                                                                                                                                                                                   |\n| 138  | PA-ENCRYPTED-CHALLENGE | Logon using Kerberos Armoring (FAST). Supported starting from Windows Server 2012 domain controllers and Windows 8 clients.                                                                                                                                                                                                                                                                                      |\n| -    |                        | This type shows in Audit Failure events.                                                                                                                                                                                                                                                                                                                                                                         |\n\n**Certificate Information:**\n\n- **Certificate Issuer Name** \\[Type = UnicodeString\\]**:** the name of Certification Authority which issued smart card certificate. Populated in **Issued by** field in certificate. Always empty for [4771](event-4771.md) events.\n\n- **Certificate Serial Number** \\[Type = UnicodeString\\]**:** smart card certificate’s serial number. Can be found in **Serial number** field in the certificate. Always empty for [4771](event-4771.md) events.\n\n- **Certificate Thumbprint** \\[Type = UnicodeString\\]**:** smart card certificate’s thumbprint. Can be found in **Thumbprint** field in the certificate. Always empty for [4771](event-4771.md) events.\n\n## Security Monitoring Recommendations\n\nFor 4771(F): Kerberos pre-authentication failed.\n\n| **Type of monitoring required**                                                                                                                                                                                                                                                                                   | **Recommendation**                                                                                                                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| **High-value accounts**: You might have high-value domain or local accounts for which you need to monitor each action.<br>Examples of high-value accounts are database administrators, built-in local administrator account, domain administrators, service accounts, domain controller accounts and so on. | Monitor this event with the **“Security ID”** that corresponds to the high-value account or accounts.                                                              |\n| **Anomalies or malicious actions**: You might have specific requirements for detecting anomalies or monitoring potential malicious actions. For example, you might need to monitor for use of an account outside of working hours.                                                                                | When you monitor for anomalies or malicious actions, use the **“Security ID”** (with other information) to monitor how or when a particular account is being used. |\n| **Non-active accounts**: You might have non-active, disabled, or guest accounts, or other accounts that should never be used.                                                                                                                                                                                     | Monitor this event with the **“Security ID”** that corresponds to the accounts that should never be used.                                                          |\n| **Account whitelist**: You might have a specific whitelist of accounts that are the only ones allowed to perform actions corresponding to particular events.                                                                                                                                                      | If this event corresponds to a “whitelist-only” action, review the **“Security ID”** for accounts that are outside the whitelist.                                  |\n| **Account naming conventions**: Your organization might have specific naming conventions for account names.                                                                                                                                                                                                       | Monitor “**Subject\\\\Account Name”** for names that don’t comply with naming conventions.                                                                           |\n\n-   You can track all [4771](event-4771.md) events where the **Client Address** is not from your internal IP range or not from private IP ranges.\n\n-   If you know that **Account Name** should be used only from known list of IP addresses, track all **Client Address** values for this **Account Name** in [4771](event-4771.md) events. If **Client Address** is not from the whitelist, generate the alert.\n\n-   All **Client Address** = ::1 means local authentication. If you know the list of accounts which should log on to the domain controllers, then you need to monitor for all possible violations, where **Client Address** = ::1 and **Account Name** is not allowed to log on to any domain controller.\n\n-   All [4771](event-4771.md) events with **Client Port** field value &gt; 0 and &lt; 1024 should be examined, because a well-known port was used for outbound connection.\n\n-   Also monitor the fields shown in the following table, to discover the issues listed:\n\n| **Field**                   | **Issue to discover**                                                                                                                                                                                                        |\n|-----------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| **Pre-Authentication Type** | Value is **not 15** when account must use a smart card for authentication. For more information, see [Table 5. Kerberos Pre-Authentication types](#kerberos-preauthentication-types).                                        |\n| **Pre-Authentication Type** | Value is **not 2** when only standard password authentication is in use in the organization. For more information, see [Table 5. Kerberos Pre-Authentication types](#kerberos-preauthentication-types).                      |\n| **Pre-Authentication Type** | Value is **not 138** when Kerberos Armoring is enabled for all Kerberos communications in the organization. For more information, see [Table 5. Kerberos Pre-Authentication types](#kerberos-preauthentication-types).       |\n| **Result Code**             | **0x10** (KDC has no support for PADATA type (pre-authentication data)). This error can help you to more quickly identify smart-card related problems with Kerberos authentication.                                          |\n| **Result Code**             | **0x18** ((Pre-authentication information was invalid), if you see, for example N events in last N minutes. This can be an indicator of brute-force attack on the account password, especially for highly critical accounts. |\n\n"}