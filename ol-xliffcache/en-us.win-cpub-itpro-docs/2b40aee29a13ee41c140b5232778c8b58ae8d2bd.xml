{"nodes":[{"content":"Restore files and directories (Windows 10)","pos":[11,53]},{"content":"Describes the best practices, location, values, policy management, and security considerations for the Restore files and directories security policy setting.","pos":[67,224]},{"content":"Restore files and directories","pos":[380,409]},{"content":"Applies to","pos":[413,423]},{"content":"Windows 10","pos":[430,440]},{"pos":[442,603],"content":"Describes the best practices, location, values, policy management, and security considerations for the <bpt id=\"p1\">**</bpt>Restore files and directories<ept id=\"p1\">**</ept> security policy setting."},{"content":"Reference","pos":[608,617]},{"content":"This security setting determines which users can bypass file, directory, registry, and other persistent object permissions when they restore backed up files and directories, and it determines which users can set valid security principals as the owner of an object.","pos":[619,883]},{"content":"Granting this user right to an account is similar to granting the account the following permissions to all files and folders on the system:","pos":[885,1024]},{"content":"Traverse folder / execute file","pos":[1032,1062]},{"content":"Write","pos":[1071,1076]},{"content":"Constant: SeRestorePrivilege","pos":[1080,1108]},{"content":"Possible values","pos":[1114,1129]},{"content":"User-defined list of accounts","pos":[1135,1164]},{"content":"Defaults","pos":[1169,1177]},{"content":"Not Defined","pos":[1182,1193]},{"content":"Best practices","pos":[1199,1213]},{"content":"Users with this user right can overwrite registry settings, hide data, and gain ownership of system objects, so only assign this user right to trusted users.","pos":[1219,1376]},{"content":"Location","pos":[1382,1390]},{"content":"Computer Configuration<ph id=\"ph1\">\\\\</ph>Windows Settings<ph id=\"ph2\">\\\\</ph>Security Settings<ph id=\"ph3\">\\\\</ph>Local Policies<ph id=\"ph4\">\\\\</ph>User Rights Assignment","pos":[1392,1491]},{"content":"Default values","pos":[1497,1511]},{"content":"By default, this right is granted to the Administrators, Backup Operators, and Server Operators groups on domain controllers, and to the Administrators and Backup Operators groups on stand-alone servers.","pos":[1513,1716]},{"content":"The following table lists the actual and effective default policy values.","pos":[1718,1791]},{"content":"Default values are also listed on the policy’s property page.","pos":[1792,1853]},{"content":"Server type or GPO","pos":[1857,1875]},{"content":"Default value","pos":[1878,1891]},{"content":"Default Domain Policy","pos":[1905,1926]},{"content":"Default Domain Controller Policy","pos":[1935,1967]},{"content":"Administrators","pos":[1969,1983]},{"content":"Backup Operators","pos":[1988,2004]},{"content":"Server Operators","pos":[2009,2025]},{"content":"Stand-Alone Server Default Settings","pos":[2030,2065]},{"content":"Administrators","pos":[2068,2082]},{"content":"Backup Operators","pos":[2087,2103]},{"content":"Domain Controller Effective Default Settings","pos":[2108,2152]},{"content":"Administrators","pos":[2155,2169]},{"content":"Backup Operators","pos":[2174,2190]},{"content":"Server Operators","pos":[2195,2211]},{"content":"Member Server Effective Default Settings","pos":[2216,2256]},{"content":"Administrators","pos":[2259,2273]},{"content":"Backup Operators","pos":[2278,2294]},{"content":"Client Computer Effective Default Settings","pos":[2299,2341]},{"content":"Administrators","pos":[2344,2358]},{"content":"Backup Operators","pos":[2363,2379]},{"content":"Policy management","pos":[2387,2404]},{"content":"This section describes features, tools, and guidance to help you manage this policy.","pos":[2406,2490]},{"content":"A restart of the computer is not required for this policy setting to be effective.","pos":[2492,2574]},{"content":"Any change to the user rights assignment for an account becomes effective the next time the owner of the account logs on.","pos":[2576,2697]},{"content":"Group Policy","pos":[2703,2715]},{"content":"Settings are applied in the following order through a Group Policy Object (GPO), which will overwrite settings on the local computer at the next Group Policy update:","pos":[2717,2882]},{"content":"Local policy settings","pos":[2888,2909]},{"content":"Site policy settings","pos":[2914,2934]},{"content":"Domain policy settings","pos":[2939,2961]},{"content":"OU policy settings","pos":[2966,2984]},{"content":"When a local setting is greyed out, it indicates that a GPO currently controls that setting.","pos":[2986,3078]},{"content":"Security considerations","pos":[3083,3106]},{"content":"This section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.","pos":[3108,3302]},{"content":"Vulnerability","pos":[3308,3321]},{"content":"An attacker with the <bpt id=\"p1\">**</bpt>Restore files and directories<ept id=\"p1\">**</ept> user right could restore sensitive data to a computer and overwrite data that is more recent, which could lead to loss of important data, data corruption, or a denial-of-service condition.","pos":[3323,3566]},{"content":"Attackers could overwrite executable files that are used by legitimate administrators or system services with versions that include malicious software to grant themselves elevated privileges, compromise data, or install programs that provide continued access to the device","pos":[3567,3839]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  Even if the following countermeasure is configured, an attacker could restore data to a computer in a domain that is controlled by the attacker.","pos":[3842,3997]},{"content":"Therefore, it is critical that organizations carefully protect the media that are used to back up data.","pos":[3998,4101]},{"content":"Countermeasure","pos":[4108,4122]},{"pos":[4124,4321],"content":"Ensure that only the local Administrators group is assigned the <bpt id=\"p1\">**</bpt>Restore files and directories<ept id=\"p1\">**</ept> user right unless your organization has clearly defined roles for backup and for restore personnel."},{"content":"Potential impact","pos":[4327,4343]},{"content":"If you remove the <bpt id=\"p1\">**</bpt>Restore files and directories<ept id=\"p1\">**</ept> user right from the Backup Operators group and other accounts, users who are not members of the local Administrators group cannot load data backups.","pos":[4345,4545]},{"content":"If restoring backups is delegated to a subset of IT staff in your organization, you should verify that this change does not negatively affect the ability of your organization's personnel to do their jobs.","pos":[4546,4750]},{"content":"Related topics","pos":[4755,4769]},{"content":"User Rights Assignment","pos":[4774,4796]}],"content":"---\ntitle: Restore files and directories (Windows 10)\ndescription: Describes the best practices, location, values, policy management, and security considerations for the Restore files and directories security policy setting.\nms.assetid: c673c0fa-6f49-4edd-8c1f-c5e8513f701d\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Restore files and directories\n\n**Applies to**\n-   Windows 10\n\nDescribes the best practices, location, values, policy management, and security considerations for the **Restore files and directories** security policy setting.\n\n## Reference\n\nThis security setting determines which users can bypass file, directory, registry, and other persistent object permissions when they restore backed up files and directories, and it determines which users can set valid security principals as the owner of an object.\n\nGranting this user right to an account is similar to granting the account the following permissions to all files and folders on the system:\n\n-   **Traverse folder / execute file**\n-   **Write**\n\nConstant: SeRestorePrivilege\n\n### Possible values\n\n-   User-defined list of accounts\n-   Defaults\n-   Not Defined\n\n### Best practices\n\n-   Users with this user right can overwrite registry settings, hide data, and gain ownership of system objects, so only assign this user right to trusted users.\n\n### Location\n\nComputer Configuration\\\\Windows Settings\\\\Security Settings\\\\Local Policies\\\\User Rights Assignment\n\n### Default values\n\nBy default, this right is granted to the Administrators, Backup Operators, and Server Operators groups on domain controllers, and to the Administrators and Backup Operators groups on stand-alone servers.\n\nThe following table lists the actual and effective default policy values. Default values are also listed on the policy’s property page.\n\n| Server type or GPO | Default value |\n| - | - |\n|Default Domain Policy | |  \n| Default Domain Controller Policy| Administrators<br/>Backup Operators<br/>Server Operators| \n| Stand-Alone Server Default Settings | Administrators<br/>Backup Operators| \n| Domain Controller Effective Default Settings | Administrators<br/>Backup Operators<br/>Server Operators| \n| Member Server Effective Default Settings | Administrators<br/>Backup Operators| \n| Client Computer Effective Default Settings | Administrators<br/>Backup Operators| \n \n## Policy management\n\nThis section describes features, tools, and guidance to help you manage this policy.\n\nA restart of the computer is not required for this policy setting to be effective.\n\nAny change to the user rights assignment for an account becomes effective the next time the owner of the account logs on.\n\n### Group Policy\n\nSettings are applied in the following order through a Group Policy Object (GPO), which will overwrite settings on the local computer at the next Group Policy update:\n\n1.  Local policy settings\n2.  Site policy settings\n3.  Domain policy settings\n4.  OU policy settings\n\nWhen a local setting is greyed out, it indicates that a GPO currently controls that setting.\n\n## Security considerations\n\nThis section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.\n\n### Vulnerability\n\nAn attacker with the **Restore files and directories** user right could restore sensitive data to a computer and overwrite data that is more recent, which could lead to loss of important data, data corruption, or a denial-of-service condition. Attackers could overwrite executable files that are used by legitimate administrators or system services with versions that include malicious software to grant themselves elevated privileges, compromise data, or install programs that provide continued access to the device\n\n>**Note:**  Even if the following countermeasure is configured, an attacker could restore data to a computer in a domain that is controlled by the attacker. Therefore, it is critical that organizations carefully protect the media that are used to back up data.\n \n### Countermeasure\n\nEnsure that only the local Administrators group is assigned the **Restore files and directories** user right unless your organization has clearly defined roles for backup and for restore personnel.\n\n### Potential impact\n\nIf you remove the **Restore files and directories** user right from the Backup Operators group and other accounts, users who are not members of the local Administrators group cannot load data backups. If restoring backups is delegated to a subset of IT staff in your organization, you should verify that this change does not negatively affect the ability of your organization's personnel to do their jobs.\n\n## Related topics\n\n- [User Rights Assignment](user-rights-assignment.md)\n"}