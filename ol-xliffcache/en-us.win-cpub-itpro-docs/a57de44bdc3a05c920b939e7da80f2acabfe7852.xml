{"nodes":[{"content":"Create Inbound Rules to Support RPC (Windows 10)","pos":[11,59]},{"content":"Create Inbound Rules to Support RPC","pos":[73,108]},{"content":"Create Inbound Rules to Support RPC","pos":[264,299]},{"content":"Applies to","pos":[303,313]},{"content":"Windows 10","pos":[320,330]},{"content":"Windows Server 2016 Technical Preview","pos":[335,372]},{"content":"To allow inbound remote procedure call (RPC) network traffic, use the Windows Firewall with Advanced Security node in the Group Policy Management console to create two firewall rules.","pos":[374,557]},{"content":"The first rule allows incoming network packets on TCP port 135 to the RPC Endpoint Mapper service.","pos":[558,656]},{"content":"The incoming traffic consists of requests to communicate with a specified network service.","pos":[657,747]},{"content":"The RPC Endpoint Mapper replies with a dynamically-assigned port number that the client must use to communicate with the service.","pos":[748,877]},{"content":"The second rule allows the network traffic that is sent to the dynamically-assigned port number.","pos":[878,974]},{"content":"Using the two rules configured as described in this topic helps to protect your device by allowing network traffic only from devices that have received RPC dynamic port redirection and to only those TCP port numbers assigned by the RPC Endpoint Mapper.","pos":[975,1227]},{"content":"Administrative credentials","pos":[1231,1257]},{"content":"To complete these procedures, you must be a member of the Domain Administrators group, or otherwise be delegated permissions to modify the GPOs.","pos":[1261,1405]},{"content":"This topic describes how to create rules that allow inbound RPC network traffic.","pos":[1407,1487]},{"content":"For other inbound port rule types, see:","pos":[1488,1527]},{"content":"Create an Inbound Port Rule","pos":[1534,1561]},{"content":"Create an Inbound ICMP Rule","pos":[1601,1628]},{"content":"In this topic:","pos":[1663,1677]},{"content":"To create a rule to allow inbound network traffic to the RPC Endpoint Mapper service","pos":[1684,1768]},{"content":"To create a rule to allow inbound network traffic to RPC-enabled network services","pos":[1863,1944]},{"content":"To create a rule to allow inbound network traffic to the RPC Endpoint Mapper service","pos":[2034,2118]},{"pos":[2124,2298],"content":"<bpt id=\"p1\">[</bpt>Open the Group Policy Management Console to Windows Firewall with Advanced Security<ept id=\"p1\">](open-the-group-policy-management-console-to-windows-firewall-with-advanced-security.md)</ept>."},{"pos":[2304,2352],"content":"In the navigation pane, click <bpt id=\"p1\">**</bpt>Inbound Rules<ept id=\"p1\">**</ept>."},{"pos":[2358,2404],"content":"Click <bpt id=\"p1\">**</bpt>Action<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>New rule<ept id=\"p2\">**</ept>."},{"pos":[2410,2510],"content":"On the <bpt id=\"p1\">**</bpt>Rule Type<ept id=\"p1\">**</ept> page of the New Inbound Rule Wizard, click <bpt id=\"p2\">**</bpt>Custom<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"pos":[2516,2624],"content":"On the <bpt id=\"p1\">**</bpt>Program<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>This Program Path<ept id=\"p2\">**</ept>, and then type <bpt id=\"p3\">**</bpt>%systemroot%<ph id=\"ph1\">\\\\</ph>system32<ph id=\"ph2\">\\\\</ph>svchost.exe<ept id=\"p3\">**</ept>."},{"pos":[2630,2650],"content":"Click <bpt id=\"p1\">**</bpt>Customize<ept id=\"p1\">**</ept>."},{"pos":[2656,2848],"content":"In the <bpt id=\"p1\">**</bpt>Customize Service Settings<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Apply to this service<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>Remote Procedure Call (RPC)<ept id=\"p3\">**</ept> with a short name of <bpt id=\"p4\">**</bpt>RpcSs<ept id=\"p4\">**</ept>, click <bpt id=\"p5\">**</bpt>OK<ept id=\"p5\">**</ept>, and then click <bpt id=\"p6\">**</bpt>Next<ept id=\"p6\">**</ept>."},{"pos":[2854,2922],"content":"On the warning about Windows service-hardening rules, click <bpt id=\"p1\">**</bpt>Yes<ept id=\"p1\">**</ept>."},{"pos":[2928,3008],"content":"On the <bpt id=\"p1\">**</bpt>Protocol and Ports<ept id=\"p1\">**</ept> dialog box, for <bpt id=\"p2\">**</bpt>Protocol type<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>TCP<ept id=\"p3\">**</ept>."},{"pos":[3014,3090],"content":"For <bpt id=\"p1\">**</bpt>Local port<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>RPC Endpoint Mapper<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"content":"On the <bpt id=\"p1\">**</bpt>Scope<ept id=\"p1\">**</ept> page, you can specify that the rule applies only to network traffic to or from the IP addresses entered on this page.","pos":[3096,3230]},{"content":"Configure as appropriate for your design, and then click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[3231,3297]},{"pos":[3303,3384],"content":"On the <bpt id=\"p1\">**</bpt>Action<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>Allow the connection<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"pos":[3390,3501],"content":"On the <bpt id=\"p1\">**</bpt>Profile<ept id=\"p1\">**</ept> page, select the network location types to which this rule applies, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"pos":[3510,3601],"content":"On the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> page, type a name and description for your rule, and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept>."},{"content":"To create a rule to allow inbound network traffic to RPC-enabled network services","pos":[3607,3688]},{"pos":[3694,3795],"content":"On the same GPO you edited in the preceding procedure, click <bpt id=\"p1\">**</bpt>Action<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>New rule<ept id=\"p2\">**</ept>."},{"pos":[3801,3901],"content":"On the <bpt id=\"p1\">**</bpt>Rule Type<ept id=\"p1\">**</ept> page of the New Inbound Rule Wizard, click <bpt id=\"p2\">**</bpt>Custom<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"content":"On the <bpt id=\"p1\">**</bpt>Program<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>This Program Path<ept id=\"p2\">**</ept>, and then type the path to the executable file that hosts the network service.","pos":[3907,4038]},{"content":"Click <bpt id=\"p1\">**</bpt>Customize<ept id=\"p1\">**</ept>.","pos":[4039,4059]},{"content":"In the <bpt id=\"p1\">**</bpt>Customize Service Settings<ept id=\"p1\">**</ept> dialog box, click <bpt id=\"p2\">**</bpt>Apply to this service<ept id=\"p2\">**</ept>, and then select the service that you want to allow.","pos":[4065,4199]},{"content":"If the service does not appear in the list, then click <bpt id=\"p1\">**</bpt>Apply to service with this service short name<ept id=\"p1\">**</ept>, and then type the short name of the service in the text box.","pos":[4200,4366]},{"pos":[4372,4410],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"pos":[4416,4496],"content":"On the <bpt id=\"p1\">**</bpt>Protocol and Ports<ept id=\"p1\">**</ept> dialog box, for <bpt id=\"p2\">**</bpt>Protocol type<ept id=\"p2\">**</ept>, select <bpt id=\"p3\">**</bpt>TCP<ept id=\"p3\">**</ept>."},{"pos":[4502,4576],"content":"For <bpt id=\"p1\">**</bpt>Local port<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>RPC Dynamic Ports<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"content":"On the <bpt id=\"p1\">**</bpt>Scope<ept id=\"p1\">**</ept> page, you can specify that the rule applies only to network traffic to or from the IP addresses entered on this page.","pos":[4582,4716]},{"content":"Configure as appropriate for your design, and then click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[4717,4783]},{"pos":[4789,4870],"content":"On the <bpt id=\"p1\">**</bpt>Action<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>Allow the connection<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"pos":[4876,4987],"content":"On the <bpt id=\"p1\">**</bpt>Profile<ept id=\"p1\">**</ept> page, select the network location types to which this rule applies, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"pos":[4993,5084],"content":"On the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> page, type a name and description for your rule, and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept>."}],"content":"---\ntitle: Create Inbound Rules to Support RPC (Windows 10)\ndescription: Create Inbound Rules to Support RPC\nms.assetid: 0b001c2c-12c1-4a30-bb99-0c034d7e6150\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Create Inbound Rules to Support RPC\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016 Technical Preview\n\nTo allow inbound remote procedure call (RPC) network traffic, use the Windows Firewall with Advanced Security node in the Group Policy Management console to create two firewall rules. The first rule allows incoming network packets on TCP port 135 to the RPC Endpoint Mapper service. The incoming traffic consists of requests to communicate with a specified network service. The RPC Endpoint Mapper replies with a dynamically-assigned port number that the client must use to communicate with the service. The second rule allows the network traffic that is sent to the dynamically-assigned port number. Using the two rules configured as described in this topic helps to protect your device by allowing network traffic only from devices that have received RPC dynamic port redirection and to only those TCP port numbers assigned by the RPC Endpoint Mapper.\n\n**Administrative credentials**\n\nTo complete these procedures, you must be a member of the Domain Administrators group, or otherwise be delegated permissions to modify the GPOs.\n\nThis topic describes how to create rules that allow inbound RPC network traffic. For other inbound port rule types, see:\n\n-   [Create an Inbound Port Rule](create-an-inbound-port-rule.md)\n\n-   [Create an Inbound ICMP Rule](create-an-inbound-icmp-rule.md)\n\nIn this topic:\n\n-   [To create a rule to allow inbound network traffic to the RPC Endpoint Mapper service](#to-create-a-rule-to-allow-inbound-network-traffic-to-the-rpc-endpoint-mapper-service)\n\n-   [To create a rule to allow inbound network traffic to RPC-enabled network services](#to-create-a-rule-to-allow-inbound-network-traffic-to-rpc-enabled-network-services)\n\n## To create a rule to allow inbound network traffic to the RPC Endpoint Mapper service\n\n1.  [Open the Group Policy Management Console to Windows Firewall with Advanced Security](open-the-group-policy-management-console-to-windows-firewall-with-advanced-security.md).\n\n2.  In the navigation pane, click **Inbound Rules**.\n\n3.  Click **Action**, and then click **New rule**.\n\n4.  On the **Rule Type** page of the New Inbound Rule Wizard, click **Custom**, and then click **Next**.\n\n5.  On the **Program** page, click **This Program Path**, and then type **%systemroot%\\\\system32\\\\svchost.exe**.\n\n6.  Click **Customize**.\n\n7.  In the **Customize Service Settings** dialog box, click **Apply to this service**, select **Remote Procedure Call (RPC)** with a short name of **RpcSs**, click **OK**, and then click **Next**.\n\n8.  On the warning about Windows service-hardening rules, click **Yes**.\n\n9.  On the **Protocol and Ports** dialog box, for **Protocol type**, select **TCP**.\n\n10. For **Local port**, select **RPC Endpoint Mapper**, and then click **Next**.\n\n11. On the **Scope** page, you can specify that the rule applies only to network traffic to or from the IP addresses entered on this page. Configure as appropriate for your design, and then click **Next**.\n\n12. On the **Action** page, select **Allow the connection**, and then click **Next**.\n\n13. On the **Profile** page, select the network location types to which this rule applies, and then click **Next**.   \n\n14. On the **Name** page, type a name and description for your rule, and then click **Finish**.\n\n\n## To create a rule to allow inbound network traffic to RPC-enabled network services\n\n1.  On the same GPO you edited in the preceding procedure, click **Action**, and then click **New rule**.\n\n2.  On the **Rule Type** page of the New Inbound Rule Wizard, click **Custom**, and then click **Next**.\n\n3.  On the **Program** page, click **This Program Path**, and then type the path to the executable file that hosts the network service. Click **Customize**.\n\n4.  In the **Customize Service Settings** dialog box, click **Apply to this service**, and then select the service that you want to allow. If the service does not appear in the list, then click **Apply to service with this service short name**, and then type the short name of the service in the text box.\n\n5.  Click **OK**, and then click **Next**.\n\n6.  On the **Protocol and Ports** dialog box, for **Protocol type**, select **TCP**.\n\n7.  For **Local port**, select **RPC Dynamic Ports**, and then click **Next**.\n\n8.  On the **Scope** page, you can specify that the rule applies only to network traffic to or from the IP addresses entered on this page. Configure as appropriate for your design, and then click **Next**.\n\n9.  On the **Action** page, select **Allow the connection**, and then click **Next**.\n\n10. On the **Profile** page, select the network location types to which this rule applies, and then click **Next**.\n\n11. On the **Name** page, type a name and description for your rule, and then click **Finish**.\n"}