{"nodes":[{"content":"Certificate-based Isolation Policy Design Example (Windows 10)","pos":[11,73]},{"content":"Certificate-based Isolation Policy Design Example","pos":[87,136]},{"content":"Certificate-based Isolation Policy Design Example","pos":[292,341]},{"content":"Applies to","pos":[345,355]},{"content":"Windows 10","pos":[362,372]},{"content":"Windows Server 2016 Technical Preview","pos":[377,414]},{"pos":[416,763],"content":"This design example continues to use the fictitious company Woodgrove Bank, as described in the sections <bpt id=\"p1\">[</bpt>Firewall Policy Design Example<ept id=\"p1\">](firewall-policy-design-example.md)</ept>, <bpt id=\"p2\">[</bpt>Domain Isolation Policy Design Example<ept id=\"p2\">](domain-isolation-policy-design-example.md)</ept>, and <bpt id=\"p3\">[</bpt>Server Isolation Policy Design Example<ept id=\"p3\">](server-isolation-policy-design-example.md)</ept>."},{"content":"One of the servers that must be included in the domain isolation environment is a device running UNIX that supplies other information to the WGBank dashboard program running on the client devices.","pos":[765,961]},{"content":"This device sends updated information to the WGBank front-end servers as it becomes available, so it is considered unsolicited inbound traffic to the devices that receive this information.","pos":[962,1150]},{"content":"Design requirements","pos":[1155,1174]},{"content":"One possible solution to this is to include an authentication exemption rule in the GPO applied to the WGBank front-end servers.","pos":[1176,1304]},{"content":"This rule would instruct the front-end servers to accept traffic from the non-Windows device even though it cannot authenticate.","pos":[1305,1433]},{"content":"A more secure solution, and the one selected by Woodgrove Bank, is to include the non-Windows device in the domain isolation design.","pos":[1435,1567]},{"content":"Because it cannot join an Active Directory domain, Woodgrove Bank chose to use certificate-based authentication.","pos":[1568,1680]},{"content":"Certificates are cryptographically-protected documents, encrypted in such a way that their origin can be positively confirmed.","pos":[1681,1807]},{"content":"In this case, Woodgrove Bank used Active Directory Certificate Services to create the appropriate certificate.","pos":[1809,1919]},{"content":"They might also have acquired and installed a certificate from a third-party commercial certification authority.","pos":[1920,2032]},{"content":"They then used Group Policy to deploy the certificate to the front-end servers.","pos":[2033,2112]},{"content":"The GPOs applied to the front-end servers also include updated connection security rules that permit certificate-based authentication in addition to Kerberos V5 authentication.","pos":[2113,2289]},{"content":"They then manually installed the certificate on the UNIX server.","pos":[2290,2354]},{"content":"The UNIX server is configured with firewall and IPsec connection security rules using the tools that are provided by the operating system vendor.","pos":[2356,2501]},{"content":"Those rules specify that authentication is performed by using the certificate.","pos":[2502,2580]},{"content":"The creation of the IPsec connection security rules for a non-Windows device is beyond the scope of this document, but support for a certificate that can be used to authenticate such a non-Windows device by using the standard IPsec protocols is the subject of this design.","pos":[2582,2854]},{"content":"The non-Windows device can be effectively made a member of the boundary zone or the encryption zone based on the IPsec rules applied to the device.","pos":[2856,3003]},{"content":"The only constraint is that the main mode and quick mode encryption algorithms supported by the UNIX device must also be supported by the Windows-based devices with which it communicates.","pos":[3004,3191]},{"content":"Other traffic notes:","pos":[3195,3215]},{"content":"None of the capabilities of the other designs discussed in this guide are compromised by the use of certificate authentication by a non-Windows device.","pos":[3223,3374]},{"content":"Design details","pos":[3379,3393]},{"content":"Woodgrove Bank uses Active Directory groups and GPOs to deploy the domain isolation settings and rules to the devices in their organization.","pos":[3395,3535]},{"content":"The inclusion of one or more non-Windows devices to the network requires only a simple addition to the GPOs for devices that must communicate with the non-Windows device.","pos":[3537,3707]},{"content":"The addition is allowing certificate-based authentication in addition to the Active Directoryâ€“supported Kerberos V5 authentication.","pos":[3708,3839]},{"content":"This does not require including new rules, just adding certificate-based authentication as an option to the existing rules.","pos":[3840,3963]},{"content":"When multiple authentication methods are available, two negotiating devices agree on the first one in their lists that match.","pos":[3965,4090]},{"content":"Because the majority of the devices in Woodgrove Bank's network run Windows, Kerberos V5 is listed as the first authentication method in the rules.","pos":[4091,4238]},{"content":"Certificate-based authentication is added as an alternate authentication type.","pos":[4239,4317]},{"content":"By using the Active Directory Users and Computers snap-in, Woodgrove Bank created a group named NAG<ph id=\"ph1\">\\_</ph>COMPUTER<ph id=\"ph2\">\\_</ph>WGBUNIX.","pos":[4319,4438]},{"content":"They then added the device accounts to this group for Windows devices that need to communicate with the non-Windows devices.","pos":[4439,4563]},{"content":"If all the devices in the isolated domain need to be able to access the non-Windows devices, then the <bpt id=\"p1\">**</bpt>Domain Computers<ept id=\"p1\">**</ept> group can be added to the group as a member.","pos":[4564,4731]},{"content":"Woodgrove Bank then created a GPO that contains the certificate, and then attached security group filters to the GPO that allow read and apply permissions to only members of the NAG<ph id=\"ph1\">\\_</ph>COMPUTER<ph id=\"ph2\">\\_</ph>WGBUNIX group.","pos":[4733,4940]},{"content":"The GPO places the certificate in the <bpt id=\"p1\">**</bpt>Local Computer / Personal / Certificates<ept id=\"p1\">**</ept> certificate store.","pos":[4941,5042]},{"content":"The certificate used must chain back to a certificate that is in the <bpt id=\"p1\">**</bpt>Trusted Root Certification Authorities<ept id=\"p1\">**</ept> store on the local device.","pos":[5043,5181]},{"pos":[5183,5320],"content":"<bpt id=\"p1\">**</bpt>Next: <ept id=\"p1\">**</ept><bpt id=\"p2\">[</bpt>Designing a Windows Firewall with Advanced Security Strategy<ept id=\"p2\">](designing-a-windows-firewall-with-advanced-security-strategy.md)</ept>"}],"content":"---\ntitle: Certificate-based Isolation Policy Design Example (Windows 10)\ndescription: Certificate-based Isolation Policy Design Example\nms.assetid: 509b513e-dd49-4234-99f9-636fd2f749e3\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Certificate-based Isolation Policy Design Example\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016 Technical Preview\n\nThis design example continues to use the fictitious company Woodgrove Bank, as described in the sections [Firewall Policy Design Example](firewall-policy-design-example.md), [Domain Isolation Policy Design Example](domain-isolation-policy-design-example.md), and [Server Isolation Policy Design Example](server-isolation-policy-design-example.md).\n\nOne of the servers that must be included in the domain isolation environment is a device running UNIX that supplies other information to the WGBank dashboard program running on the client devices. This device sends updated information to the WGBank front-end servers as it becomes available, so it is considered unsolicited inbound traffic to the devices that receive this information.\n\n## Design requirements\n\nOne possible solution to this is to include an authentication exemption rule in the GPO applied to the WGBank front-end servers. This rule would instruct the front-end servers to accept traffic from the non-Windows device even though it cannot authenticate.\n\nA more secure solution, and the one selected by Woodgrove Bank, is to include the non-Windows device in the domain isolation design. Because it cannot join an Active Directory domain, Woodgrove Bank chose to use certificate-based authentication. Certificates are cryptographically-protected documents, encrypted in such a way that their origin can be positively confirmed.\n\nIn this case, Woodgrove Bank used Active Directory Certificate Services to create the appropriate certificate. They might also have acquired and installed a certificate from a third-party commercial certification authority. They then used Group Policy to deploy the certificate to the front-end servers. The GPOs applied to the front-end servers also include updated connection security rules that permit certificate-based authentication in addition to Kerberos V5 authentication. They then manually installed the certificate on the UNIX server.\n\nThe UNIX server is configured with firewall and IPsec connection security rules using the tools that are provided by the operating system vendor. Those rules specify that authentication is performed by using the certificate.\n\nThe creation of the IPsec connection security rules for a non-Windows device is beyond the scope of this document, but support for a certificate that can be used to authenticate such a non-Windows device by using the standard IPsec protocols is the subject of this design.\n\nThe non-Windows device can be effectively made a member of the boundary zone or the encryption zone based on the IPsec rules applied to the device. The only constraint is that the main mode and quick mode encryption algorithms supported by the UNIX device must also be supported by the Windows-based devices with which it communicates.\n\n**Other traffic notes:**\n\n-   None of the capabilities of the other designs discussed in this guide are compromised by the use of certificate authentication by a non-Windows device.\n\n## Design details\n\nWoodgrove Bank uses Active Directory groups and GPOs to deploy the domain isolation settings and rules to the devices in their organization.\n\nThe inclusion of one or more non-Windows devices to the network requires only a simple addition to the GPOs for devices that must communicate with the non-Windows device. The addition is allowing certificate-based authentication in addition to the Active Directoryâ€“supported Kerberos V5 authentication. This does not require including new rules, just adding certificate-based authentication as an option to the existing rules.\n\nWhen multiple authentication methods are available, two negotiating devices agree on the first one in their lists that match. Because the majority of the devices in Woodgrove Bank's network run Windows, Kerberos V5 is listed as the first authentication method in the rules. Certificate-based authentication is added as an alternate authentication type.\n\nBy using the Active Directory Users and Computers snap-in, Woodgrove Bank created a group named NAG\\_COMPUTER\\_WGBUNIX. They then added the device accounts to this group for Windows devices that need to communicate with the non-Windows devices. If all the devices in the isolated domain need to be able to access the non-Windows devices, then the **Domain Computers** group can be added to the group as a member.\n\nWoodgrove Bank then created a GPO that contains the certificate, and then attached security group filters to the GPO that allow read and apply permissions to only members of the NAG\\_COMPUTER\\_WGBUNIX group. The GPO places the certificate in the **Local Computer / Personal / Certificates** certificate store. The certificate used must chain back to a certificate that is in the **Trusted Root Certification Authorities** store on the local device.\n\n**Next: **[Designing a Windows Firewall with Advanced Security Strategy](designing-a-windows-firewall-with-advanced-security-strategy.md)\n"}