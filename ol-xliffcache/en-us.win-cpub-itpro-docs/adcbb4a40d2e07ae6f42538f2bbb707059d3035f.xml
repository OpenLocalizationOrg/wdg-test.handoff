{"nodes":[{"content":"4738(S) A user account was changed.","pos":[11,46]},{"content":"(Windows 10)","pos":[47,59]},{"content":"Describes security event 4738(S) A user account was changed.","pos":[73,133]},{"content":"4738(S): A user account was changed.","pos":[233,269]},{"content":"Applies to","pos":[273,283]},{"content":"Windows 10","pos":[290,300]},{"content":"Windows Server 2016","pos":[305,324]},{"pos":[444,533],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit User Account Management<ept id=\"p2\">](audit-user-account-management.md)</ept>"},{"content":"Event Description:","pos":[538,556]},{"content":"This event generates every time user object is changed.","pos":[561,616]},{"content":"This event generates on domain controllers, member servers, and workstations.","pos":[618,695]},{"content":"For each change, a separate 4738 event will be generated.","pos":[697,754]},{"content":"You might see this event without any changes inside, that is, where all <bpt id=\"p1\">**</bpt>Changed Attributes<ept id=\"p1\">**</ept> apear as “-“.","pos":[756,864]},{"content":"This usually happens when a change is made to an attribute that is not listed in the event.","pos":[865,956]},{"content":"In this case there is no way to determine which attribute was changed.","pos":[957,1027]},{"content":"For example, if the <bpt id=\"p1\">[</bpt>discretionary access control list<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/windows/desktop/aa374872(v=vs.85).aspx)</ept> (DACL) is changed, a 4738 event will generate, but all attributes will be “-“.","pos":[1028,1243]},{"content":"Some changes do not invoke a 4738 event.","pos":[1245,1285]},{"pos":[1289,1425],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For recommendations, see <bpt id=\"p2\">[</bpt>Security Monitoring Recommendations<ept id=\"p2\">](#security-monitoring-recommendations)</ept> for this event."},{"content":"Event XML:","pos":[1448,1458]},{"pos":[3278,3312],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> None."},{"pos":[3314,3375],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008, Windows Vista."},{"pos":[3377,3401],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Field Descriptions:","pos":[3406,3425]},{"content":"Subject:","pos":[3432,3440]},{"content":"<bpt id=\"p1\">**</bpt>Security ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = SID<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> SID of account that requested the “change user account” operation.","pos":[3448,3550]},{"content":"Event Viewer automatically tries to resolve SIDs and show the account name.","pos":[3551,3626]},{"content":"If the SID cannot be resolved, you will see the source data in the event.","pos":[3627,3700]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>A <bpt id=\"p2\">**</bpt>security identifier (SID)<ept id=\"p2\">**</ept> is a unique value of variable length used to identify a trustee (security principal).","pos":[3704,3841]},{"content":"Each account has a unique SID that is issued by an authority, such as an Active Directory domain controller, and stored in a security database.","pos":[3842,3985]},{"content":"Each time a user logs on, the system retrieves the SID for that user from the database and places it in the access token for that user.","pos":[3986,4121]},{"content":"The system uses the SID in the access token to identify the user in all subsequent interactions with Windows security.","pos":[4122,4240]},{"content":"When a SID has been used as the unique identifier for a user or group, it cannot ever be used again to identify another user or group.","pos":[4241,4375]},{"content":"For more information about SIDs, see <bpt id=\"p1\">[</bpt>Security identifiers<ept id=\"p1\">](security-identifiers.md)</ept>.","pos":[4376,4461]},{"pos":[4467,4589],"content":"<bpt id=\"p1\">**</bpt>Account Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the name of the account that requested the “change user account” operation."},{"content":"<bpt id=\"p1\">**</bpt>Account Domain<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> subject’s domain or computer name.","pos":[4595,4678]},{"content":"Formats vary, and include the following:","pos":[4679,4719]},{"content":"Domain NETBIOS name example: CONTOSO","pos":[4729,4765]},{"content":"Lowercase full domain name: contoso.local","pos":[4775,4816]},{"content":"Uppercase full domain name: CONTOSO.LOCAL","pos":[4826,4867]},{"pos":[4877,5051],"content":"For some <bpt id=\"p1\">[</bpt>well-known security principals<ept id=\"p1\">](https://support.microsoft.com/en-us/kb/243330)</ept>, such as LOCAL SERVICE or ANONYMOUS LOGON, the value of this field is “NT AUTHORITY”."},{"content":"For local user accounts, this field will contain the name of the computer or device that this account belongs to, for example: “Win81”.","pos":[5061,5196]},{"pos":[5202,5430],"content":"<bpt id=\"p1\">**</bpt>Logon ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = HexInt64<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> hexadecimal value that can help you correlate this event with recent events that might contain the same Logon ID, for example, “<bpt id=\"p3\">[</bpt>4624<ept id=\"p3\">](event-4624.md)</ept>: An account was successfully logged on.”"},{"content":"Target Account:","pos":[5434,5449]},{"content":"<bpt id=\"p1\">**</bpt>Security ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = SID<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> SID of account that was changed.","pos":[5457,5525]},{"content":"Event Viewer automatically tries to resolve SIDs and show the account name.","pos":[5526,5601]},{"content":"If the SID cannot be resolved, you will see the source data in the event.","pos":[5602,5675]},{"pos":[5681,5769],"content":"<bpt id=\"p1\">**</bpt>Account Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the name of the account that was changed."},{"content":"<bpt id=\"p1\">**</bpt>Account Domain<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> target account’s domain or computer name.","pos":[5775,5865]},{"content":"Formats vary, and include the following:","pos":[5866,5906]},{"content":"Domain NETBIOS name example: CONTOSO","pos":[5916,5952]},{"content":"Lowercase full domain name: contoso.local","pos":[5962,6003]},{"content":"Uppercase full domain name: CONTOSO.LOCAL","pos":[6013,6054]},{"content":"For local user accounts, this field will contain the name of the computer or device that this account belongs to, for example: “Win81”.","pos":[6064,6199]},{"content":"Changed Attributes:","pos":[6203,6222]},{"content":"If attribute was not changed it will have “–“ value.","pos":[6226,6278]},{"content":"Unfortunately, for local accounts, all fields, except changed attributes, will have previous values populated.","pos":[6280,6390]},{"content":"Also, the User Account Control field will have values only if it was modified.","pos":[6391,6469]},{"content":"Changed attributes will have new values, but it is hard to understand which attribute was really changed.","pos":[6470,6575]},{"content":"<bpt id=\"p1\">**</bpt>SAM Account Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: logon name for account used to support clients and servers from previous versions of Windows (pre-Windows 2000 logon name).","pos":[6581,6751]},{"content":"If the value of <bpt id=\"p1\">**</bpt>sAMAccountName<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[6752,6857]},{"content":"For example: ladmin.","pos":[6858,6878]},{"content":"For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.","pos":[6879,7026]},{"content":"<bpt id=\"p1\">**</bpt>Display Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: it is a name, displayed in the address book for a particular account.","pos":[7032,7144]},{"content":"This is usually the combination of the user's first name, middle initial, and last name.","pos":[7145,7233]},{"content":"You can change this attribute by using Active Directory Users and Computers, or through a script, for example.","pos":[7234,7344]},{"content":"If the value of <bpt id=\"p1\">**</bpt>displayName<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[7345,7447]},{"content":"For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.","pos":[7448,7595]},{"content":"<bpt id=\"p1\">**</bpt>User Principal Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: internet-style login name for the account, based on the Internet standard RFC 822.","pos":[7601,7733]},{"content":"By convention this should map to the account's email name.","pos":[7734,7792]},{"content":"If the value of <bpt id=\"p1\">**</bpt>userPrincipalName<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[7793,7901]},{"content":"You can change this attribute by using Active Directory Users and Computers, or through a script, for example.","pos":[7902,8012]},{"content":"For local accounts, this field is not applicable and always has “-“ value.","pos":[8013,8087]},{"content":"<bpt id=\"p1\">**</bpt>Home Directory<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: user's home directory.","pos":[8093,8160]},{"content":"If <bpt id=\"p1\">**</bpt>homeDrive<ept id=\"p1\">**</ept> attribute is set and specifies a drive letter, <bpt id=\"p2\">**</bpt>homeDirectory<ept id=\"p2\">**</ept> should be a UNC path.","pos":[8161,8264]},{"content":"The path must be a network UNC of the form <ph id=\"ph1\">\\\\\\\\</ph>Server<ph id=\"ph2\">\\\\</ph>Share<ph id=\"ph3\">\\\\</ph>Directory.","pos":[8265,8337]},{"content":"If the value of <bpt id=\"p1\">**</bpt>homeDirectory<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[8338,8442]},{"content":"You can change this attribute by using Active Directory Users and Computers, or through a script, for example.","pos":[8443,8553]},{"content":"For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.","pos":[8554,8701]},{"content":"<bpt id=\"p1\">**</bpt>Home Drive<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> specifies the drive letter to which to map the UNC path specified by <bpt id=\"p3\">**</bpt>homeDirectory<ept id=\"p3\">**</ept> account’s attribute.","pos":[8707,8859]},{"content":"The drive letter must be specified in the form “DRIVE<ph id=\"ph1\">\\_</ph>LETTER:”.","pos":[8860,8924]},{"content":"For example – “H:”.","pos":[8925,8944]},{"content":"If the value of <bpt id=\"p1\">**</bpt>homeDrive<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[8945,9045]},{"content":"You can change this attribute by using Active Directory Users and Computers, or through a script, for example.","pos":[9046,9156]},{"content":"For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.","pos":[9157,9304]},{"content":"<bpt id=\"p1\">**</bpt>Script Path<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> specifies the path of the account’s logon script.","pos":[9310,9405]},{"content":"If the value of <bpt id=\"p1\">**</bpt>scriptPath<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[9406,9507]},{"content":"You can change this attribute by using Active Directory Users and Computers, or through a script, for example.","pos":[9508,9618]},{"content":"For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.","pos":[9619,9766]},{"content":"<bpt id=\"p1\">**</bpt>Profile Path<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: specifies a path to the account's profile.","pos":[9772,9857]},{"content":"This value can be a null string, a local absolute path, or a UNC path.","pos":[9858,9928]},{"content":"If the value of <bpt id=\"p1\">**</bpt>profilePath<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[9929,10031]},{"content":"You can change this attribute by using Active Directory Users and Computers, or through a script, for example.","pos":[10032,10142]},{"content":"For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.","pos":[10143,10290]},{"content":"<bpt id=\"p1\">**</bpt>User Workstations<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: contains the list of NetBIOS or DNS names of the computers from which the user can logon.","pos":[10296,10433]},{"content":"Each computer name is separated by a comma.","pos":[10434,10477]},{"content":"The name of a computer is the <bpt id=\"p1\">**</bpt>sAMAccountName<ept id=\"p1\">**</ept> property of a computer object.","pos":[10478,10557]},{"content":"If the value of <bpt id=\"p1\">**</bpt>userWorkstations<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[10558,10665]},{"content":"You can change this attribute by using Active Directory Users and Computers, or through a script, for example.","pos":[10666,10776]},{"content":"For local accounts, this field is not applicable and always appears as “<bpt id=\"p1\">**</bpt><ph id=\"ph1\">&amp;lt;</ph>value not set<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">**</ept>.“","pos":[10777,10876]},{"content":"<bpt id=\"p1\">**</bpt>Password Last Set<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> last time the account’s password was modified.","pos":[10882,10980]},{"content":"If the value of <bpt id=\"p1\">**</bpt>pwdLastSet<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[10981,11082]},{"content":"For example: 8/12/2015 11:41:39 AM.","pos":[11083,11118]},{"content":"This value will be changed, for example, after manual user account password reset.","pos":[11119,11201]},{"content":"For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.","pos":[11202,11349]},{"content":"<bpt id=\"p1\">**</bpt>Account Expires<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the date when the account expires.","pos":[11355,11435]},{"content":"If the value of <bpt id=\"p1\">**</bpt>accountExpires<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[11436,11541]},{"content":".","pos":[11542,11543]},{"content":"For example, “9/21/2015 12:00:00 AM”.","pos":[11544,11581]},{"content":"You can change this attribute by using Active Directory Users and Computers, or through a script, for example.","pos":[11582,11692]},{"content":"For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.","pos":[11693,11840]},{"pos":[11846,11950],"content":"<bpt id=\"p1\">**</bpt>Primary Group ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: Relative Identifier (RID) of user’s object primary group."},{"pos":[11954,12192],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph><bpt id=\"p2\">**</bpt>Relative identifier (RID)<ept id=\"p2\">**</ept> is a variable length number that is assigned to objects at creation and becomes part of the object's Security Identifier (SID) that uniquely identifies an account or group within a domain."},{"content":"This field will contain some value if user’s object primary group was changed.","pos":[12194,12272]},{"content":"You can change user’s primary group using Active Directory Users and Computers management console in the <bpt id=\"p1\">**</bpt>Member Of<ept id=\"p1\">**</ept> tab of user object properties.","pos":[12273,12422]},{"content":"You will see a RID of new primary group as a field value.","pos":[12423,12480]},{"content":"For example, RID 513 (Domain Users) is a default primary group for users.","pos":[12481,12554]},{"pos":[12556,12607],"content":"Typical <bpt id=\"p1\">**</bpt>Primary Group<ept id=\"p1\">**</ept> values for user accounts:"},{"content":"513 (Domain Users.","pos":[12613,12631]},{"content":"For local accounts this RID means Users) – for domain and local users.","pos":[12632,12702]},{"content":"See this article <bpt id=\"p1\">&lt;</bpt>https://support.microsoft.com/en-us/kb/243330<ept id=\"p1\">&gt;</ept> for more information.","pos":[12708,12794]},{"content":"If the value of <bpt id=\"p1\">**</bpt>primaryGroupID<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[12795,12900]},{"content":"<bpt id=\"p1\">**</bpt>AllowedToDelegateTo<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the list of SPNs to which this account can present delegated credentials.","pos":[12916,13039]},{"content":"Can be changed using Active Directory Users and Computers management console in <bpt id=\"p1\">**</bpt>Delegation<ept id=\"p1\">**</ept> tab of user account, if at least one SPN is registered for user account.","pos":[13040,13207]},{"content":"If the SPNs list on <bpt id=\"p1\">**</bpt>Delegation<ept id=\"p1\">**</ept> tab of a user account was changed, you will see the new SPNs list in <bpt id=\"p2\">**</bpt>AllowedToDelegateTo<ept id=\"p2\">**</ept> field (note that you will see the new list instead of changes) of this event.","pos":[13208,13413]},{"content":"This is an example of <bpt id=\"p1\">**</bpt>AllowedToDelegateTo<ept id=\"p1\">**</ept>:","pos":[13414,13460]},{"content":"dcom/WIN2012","pos":[13470,13482]},{"content":"dcom/WIN2012.contoso.local","pos":[13492,13518]},{"pos":[13528,13643],"content":"If the value of <bpt id=\"p1\">**</bpt>msDS-AllowedToDelegateTo<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here."},{"pos":[13653,13739],"content":"The value can be “<bpt id=\"p1\">**</bpt><ph id=\"ph1\">&amp;lt;</ph>value not set<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">**</ept>”, for example, if delegation was disabled."},{"content":"For local accounts, this field is not applicable and always has “-“ value.","pos":[13749,13823]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph><bpt id=\"p2\">**</bpt>Service Principal Name (SPN)<ept id=\"p2\">**</ept> is the name by which a client uniquely identifies an instance of a service.","pos":[13827,13955]},{"content":"If you install multiple instances of a service on computers throughout a forest, each instance must have its own SPN.","pos":[13956,14073]},{"content":"A given service instance can have multiple SPNs if there are multiple names that clients might use for authentication.","pos":[14074,14192]},{"content":"For example, an SPN always includes the name of the host computer on which the service instance is running, so a service instance might register an SPN for each name or alias of its host.","pos":[14193,14380]},{"content":"<bpt id=\"p1\">**</bpt>Old UAC Value<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: specifies flags that control password, lockout, disable/enable, script, and other behavior for the user account.","pos":[14386,14542]},{"content":"This parameter contains the previous value of <bpt id=\"p1\">**</bpt>userAccountControl<ept id=\"p1\">**</ept> attribute of user object.","pos":[14543,14637]},{"content":"<bpt id=\"p1\">**</bpt>New UAC Value<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: specifies flags that control password, lockout, disable/enable, script, and other behavior for the user account.","pos":[14643,14799]},{"content":"If the value of <bpt id=\"p1\">**</bpt>userAccountControl<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[14800,14909]},{"content":"To decode this value, you can go through the property value definitions in the “Table 7.","pos":[14911,14999]},{"content":"User’s or Computer’s account UAC flags.”","pos":[15000,15040]},{"content":"from largest to smallest.","pos":[15041,15066]},{"content":"Compare each property value to the flags value in the event.","pos":[15067,15127]},{"content":"If the flags value in the event is greater than or equal to the property value, then the property is \"set\" and applies to that event.","pos":[15128,15261]},{"content":"Subtract the property value from the flags value in the event and note that the flag applies and then go on to the next flag.","pos":[15262,15387]},{"content":"Here's an example: Flags value from event: 0x15","pos":[15389,15436]},{"content":"Decoding:","pos":[15438,15447]},{"content":"• PASSWD<ph id=\"ph1\">\\_</ph>NOTREQD 0x0020","pos":[15449,15473]},{"content":"• LOCKOUT 0x0010","pos":[15475,15491]},{"content":"• HOMEDIR<ph id=\"ph1\">\\_</ph>REQUIRED 0x0008","pos":[15493,15519]},{"content":"• (undeclared) 0x0004","pos":[15521,15542]},{"content":"• ACCOUNTDISABLE 0x0002","pos":[15544,15567]},{"content":"• SCRIPT 0x0001","pos":[15569,15584]},{"content":"0x0020 <ph id=\"ph1\">&amp;gt;</ph> 0x15, so PASSWD<ph id=\"ph2\">\\_</ph>NOTREQD does not apply to this event","pos":[15586,15651]},{"content":"0x10 <ph id=\"ph1\">&amp;lt;</ph> 0x15, so LOCKOUT applies to this event.","pos":[15653,15702]},{"content":"0x15 - 0x10 = 0x5","pos":[15703,15720]},{"content":"0x4 <ph id=\"ph1\">&amp;lt;</ph> 0x5, so the undeclared value is set.","pos":[15722,15767]},{"content":"We'll pretend it doesn't mean anything.","pos":[15768,15807]},{"content":"0x5 - 0x4 = 0x1","pos":[15808,15823]},{"content":"0x2 <ph id=\"ph1\">&amp;gt;</ph> 0x1, so ACCOUNTDISABLE does not apply to this event","pos":[15825,15885]},{"content":"0x1 = 0x1, so SCRIPT applies to this event.","pos":[15887,15930]},{"content":"0x1 - 0x1 = 0x0, we're done.","pos":[15931,15959]},{"content":"So this UAC flags value decodes to: LOCKOUT and SCRIPT","pos":[15961,16015]},{"content":"<bpt id=\"p1\">**</bpt>User Account Control<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> shows the list of changes in <bpt id=\"p3\">**</bpt>userAccountControl<ept id=\"p3\">**</ept> attribute.","pos":[16021,16138]},{"content":"You will see a line of text for each change.","pos":[16139,16183]},{"content":"See possible values in here: “Table 7.","pos":[16184,16222]},{"content":"User’s or Computer’s account UAC flags.”.","pos":[16223,16264]},{"content":"In the “User Account Control field text” column, you can see the text that will be displayed in the <bpt id=\"p1\">**</bpt>User Account Control<ept id=\"p1\">**</ept> field in 4738 event.","pos":[16265,16410]},{"content":"<bpt id=\"p1\">**</bpt>User Parameters<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: if you change any setting using Active Directory Users and Computers management console in Dial-in tab of user’s account properties, then you will see <bpt id=\"p2\">**</bpt><ph id=\"ph3\">&amp;lt;</ph>value changed, but not displayed<ph id=\"ph4\">&amp;gt;</ph><ept id=\"p2\">**</ept> in this field.","pos":[16416,16672]},{"content":"For local accounts, this field is not applicable and always has “<ph id=\"ph1\">&amp;lt;</ph>value not set<ph id=\"ph2\">&amp;gt;</ph>“ value.","pos":[16673,16767]},{"content":"<bpt id=\"p1\">**</bpt>SID History<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: contains previous SIDs used for the object if the object was moved from another domain.","pos":[16773,16902]},{"content":"Whenever an object is moved from one domain to another, a new SID is created and becomes the objectSID.","pos":[16903,17006]},{"content":"The previous SID is added to the <bpt id=\"p1\">**</bpt>sIDHistory<ept id=\"p1\">**</ept> property.","pos":[17007,17064]},{"content":"If the value of <bpt id=\"p1\">**</bpt>sIDHistory<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[17065,17166]},{"content":"<bpt id=\"p1\">**</bpt>Logon Hours<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: hours that the account is allowed to logon to the domain.","pos":[17172,17271]},{"content":"If the value of <bpt id=\"p1\">**</bpt>logonHours<ept id=\"p1\">**</ept> attribute of user object was changed, you will see the new value here.","pos":[17272,17373]},{"content":"You can change this attribute by using Active Directory Users and Computers, or through a script, for example.","pos":[17374,17484]},{"content":"Here is an example of this field:","pos":[17485,17518]},{"content":"Sunday 12:00 AM - 7:00 PM","pos":[17524,17549]},{"content":"Sunday 9:00 PM -Monday 1:00 PM","pos":[17555,17585]},{"content":"Monday 2:00 PM -Tuesday 6:00 PM","pos":[17591,17622]},{"content":"Tuesday 8:00 PM -Wednesday 10:00 AM","pos":[17628,17663]},{"pos":[17669,17751],"content":"For local accounts this field is not applicable and typically has value “<bpt id=\"p1\">**</bpt>All<ept id=\"p1\">**</ept>”."},{"content":"Additional Information:","pos":[17755,17778]},{"content":"<bpt id=\"p1\">**</bpt>Privileges<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the list of user privileges which were used during the operation, for example, SeBackupPrivilege.","pos":[17786,17924]},{"content":"This parameter might not be captured in the event, and in that case appears as “-”.","pos":[17925,18008]},{"content":"See full list of user privileges in “Table 8.","pos":[18009,18054]},{"content":"User Privileges.”.","pos":[18055,18073]},{"content":"Security Monitoring Recommendations","pos":[18078,18113]},{"content":"For 4738(S): A user account was changed.","pos":[18115,18155]},{"pos":[18159,18354],"content":"<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For this event, also see <bpt id=\"p2\">[</bpt>Appendix A: Security monitoring recommendations for many audit events<ept id=\"p2\">](appendix-a-security-monitoring-recommendations-for-many-audit-events.md)</ept>."},{"pos":[18360,18421],"content":"Some organizations monitor every <bpt id=\"p1\">[</bpt>4738<ept id=\"p1\">](event-4738.md)</ept> event."},{"pos":[18427,18695],"content":"If you have critical user computer accounts (for example, domain administrator accounts or service accounts) for which you need to monitor each change, monitor this event with the <bpt id=\"p1\">**</bpt>“Target Account<ph id=\"ph1\">\\\\</ph>Account Name”<ept id=\"p1\">**</ept> that corresponds to the critical account or accounts."},{"content":"If you have user accounts for which any change in the services list on the <bpt id=\"p1\">**</bpt>Delegation<ept id=\"p1\">**</ept> tab should be monitored, monitor this event when <bpt id=\"p2\">**</bpt>AllowedToDelegateTo<ept id=\"p2\">**</ept> is not -.","pos":[18701,18873]},{"content":"This value means the services list was changed.","pos":[18874,18921]},{"content":"Consider whether to track the following fields:","pos":[18927,18974]},{"content":"Field to track","pos":[18980,18994]},{"content":"Reason to track","pos":[19277,19292]},{"content":"Display Name","pos":[19934,19946]},{"content":"User Principal Name","pos":[19954,19973]},{"content":"Home Directory","pos":[19981,19995]},{"content":"Home Drive","pos":[20003,20013]},{"content":"Script Path","pos":[20021,20032]},{"content":"Profile Path","pos":[20040,20052]},{"content":"User Workstations","pos":[20060,20077]},{"content":"Password Last Set","pos":[20085,20102]},{"content":"Account Expires","pos":[20110,20125]},{"content":"Primary Group ID<ph id=\"ph1\">&lt;br&gt;</ph>Logon Hours","pos":[20133,20164]},{"content":"We recommend monitoring all changes for these fields for critical domain and local accounts.","pos":[20169,20261]},{"pos":[20349,20380],"content":"<bpt id=\"p1\">**</bpt>Primary Group ID<ept id=\"p1\">**</ept> is not 513"},{"content":"Typically, the <bpt id=\"p1\">**</bpt>Primary Group<ept id=\"p1\">**</ept> value is 513 for domain and local users.","pos":[20646,20719]},{"content":"Other values should be monitored.","pos":[20720,20753]},{"pos":[20826,20981],"content":"For user accounts for which the services list (on the <bpt id=\"p1\">**</bpt>Delegation<ept id=\"p1\">**</ept> tab) should not be empty: <bpt id=\"p2\">**</bpt>AllowedToDelegateTo<ept id=\"p2\">**</ept> is marked <bpt id=\"p3\">**</bpt><ph id=\"ph1\">&amp;lt;</ph>value not set<ph id=\"ph2\">&amp;gt;</ph> <ept id=\"p3\">**</ept>"},{"pos":[21123,21298],"content":"If <bpt id=\"p1\">**</bpt>AllowedToDelegateTo<ept id=\"p1\">**</ept> is marked <bpt id=\"p2\">**</bpt><ph id=\"ph1\">&amp;lt;</ph>value not set<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p2\">**</ept> on user accounts that previously had a services list (on the <bpt id=\"p3\">**</bpt>Delegation<ept id=\"p3\">**</ept> tab), it means the list was cleared."},{"pos":[21303,21327],"content":"<bpt id=\"p1\">**</bpt>SID History<ept id=\"p1\">**</ept> is not -"},{"content":"This field will always be set to - unless the account was migrated from another domain.","pos":[21600,21687]},{"content":"Consider whether to track the following user account control flags:","pos":[21783,21850]},{"content":"User account control flag to track","pos":[21856,21890]},{"content":"Information about the flag","pos":[21914,21940]},{"pos":[22726,22757],"content":"<bpt id=\"p1\">**</bpt>'Normal Account'<ept id=\"p1\">**</ept> – Disabled"},{"content":"Should not be disabled for user accounts.","pos":[22784,22825]},{"pos":[23162,23199],"content":"<bpt id=\"p1\">**</bpt>'Password Not Required'<ept id=\"p1\">**</ept> – Enabled"},{"content":"Should not typically be enabled for user accounts because it weakens security for the account.","pos":[23220,23314]},{"pos":[23598,23645],"content":"<bpt id=\"p1\">**</bpt>'Encrypted Text Password Allowed'<ept id=\"p1\">**</ept> – Enabled"},{"content":"Should not typically be enabled for user accounts because it weakens security for the account.","pos":[23656,23750]},{"pos":[24034,24070],"content":"<bpt id=\"p1\">**</bpt>'Server Trust Account'<ept id=\"p1\">**</ept> – Enabled"},{"content":"Should never be enabled for user accounts.","pos":[24092,24134]},{"content":"Applies only to domain controller (computer) accounts.","pos":[24135,24189]},{"pos":[24470,24507],"content":"<bpt id=\"p1\">**</bpt>'Don't Expire Password'<ept id=\"p1\">**</ept> – Enabled"},{"content":"Should be monitored for critical accounts, or all accounts if your organization does not allow this flag.","pos":[24528,24633]},{"pos":[24906,24940],"content":"<bpt id=\"p1\">**</bpt>'Smartcard Required'<ept id=\"p1\">**</ept> – Enabled"},{"content":"Should be monitored for critical accounts.","pos":[24964,25006]},{"pos":[25342,25380],"content":"<bpt id=\"p1\">**</bpt>'Password Not Required'<ept id=\"p1\">**</ept> – Disabled"},{"pos":[25400,25479],"content":"Should be monitored for all accounts where the setting should be “<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>.”"},{"pos":[25778,25826],"content":"<bpt id=\"p1\">**</bpt>'Encrypted Text Password Allowed'<ept id=\"p1\">**</ept> – Disabled"},{"pos":[25836,25915],"content":"Should be monitored for all accounts where the setting should be “<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>.”"},{"pos":[26214,26252],"content":"<bpt id=\"p1\">**</bpt>'Don't Expire Password'<ept id=\"p1\">**</ept> – Disabled"},{"pos":[26272,26351],"content":"Should be monitored for all accounts where the setting should be “<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>.”"},{"pos":[26650,26685],"content":"<bpt id=\"p1\">**</bpt>'Smartcard Required'<ept id=\"p1\">**</ept> – Disabled"},{"pos":[26708,26787],"content":"Should be monitored for all accounts where the setting should be “<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>.”"},{"pos":[27086,27124],"content":"<bpt id=\"p1\">**</bpt>'Trusted For Delegation'<ept id=\"p1\">**</ept> – Enabled"},{"content":"Means that Kerberos Constraint or Unconstraint delegation was enabled for the user account.","pos":[27144,27235]},{"content":"We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.","pos":[27236,27371]},{"pos":[27522,27561],"content":"<bpt id=\"p1\">**</bpt>'Trusted For Delegation'<ept id=\"p1\">**</ept> – Disabled"},{"content":"Means that Kerberos Constraint or Unconstraint delegation was disabled for the user account.","pos":[27580,27672]},{"content":"We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.","pos":[27673,27808]},{"content":"Also, if you have a list of user accounts for which delegation is critical and should not be disabled, monitor this for those accounts.","pos":[27812,27947]},{"pos":[27952,28006],"content":"<bpt id=\"p1\">**</bpt>'Trusted To Authenticate For Delegation'<ept id=\"p1\">**</ept> – Enabled"},{"content":"Means that Protocol Transition delegation was enabled for the user account.","pos":[28010,28085]},{"content":"We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.","pos":[28086,28221]},{"pos":[28388,28443],"content":"<bpt id=\"p1\">**</bpt>'Trusted To Authenticate For Delegation'<ept id=\"p1\">**</ept> – Disabled"},{"content":"Means that Protocol Transition delegation was disabled for the user account.","pos":[28446,28522]},{"content":"We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.","pos":[28523,28658]},{"content":"Also, if you have a list of user accounts for which delegation is critical and should not be disabled, monitor this for those accounts.","pos":[28662,28797]},{"pos":[28818,28847],"content":"<bpt id=\"p1\">**</bpt>'Not Delegated'<ept id=\"p1\">**</ept> – Enabled"},{"content":"Means that <bpt id=\"p1\">**</bpt>Account is sensitive and cannot be delegated<ept id=\"p1\">**</ept> was checked for the user account.","pos":[28876,28969]},{"content":"We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.","pos":[28970,29105]},{"pos":[29254,29284],"content":"<bpt id=\"p1\">**</bpt>'Not Delegated'<ept id=\"p1\">**</ept> – Disabled"},{"content":"Should be monitored for all accounts where the setting should be “<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>.”","pos":[29312,29391]},{"content":"Means that <bpt id=\"p1\">**</bpt>Account is sensitive and cannot be delegated<ept id=\"p1\">**</ept> was unchecked for the user account.","pos":[29392,29487]},{"content":"We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.","pos":[29488,29623]},{"pos":[29690,29722],"content":"<bpt id=\"p1\">**</bpt>'Use DES Key Only'<ept id=\"p1\">**</ept> – Enabled"},{"content":"Should not typically be enabled for user accounts because it weakens security for the account’s Kerberos authentication.","pos":[29748,29868]},{"pos":[30126,30163],"content":"<bpt id=\"p1\">**</bpt>'Don't Require Preauth'<ept id=\"p1\">**</ept> – Enabled"},{"content":"Should not be enabled for user accounts because it weakens security for the account’s Kerberos authentication.","pos":[30184,30294]},{"pos":[30562,30595],"content":"<bpt id=\"p1\">**</bpt>'Use DES Key Only'<ept id=\"p1\">**</ept> – Disabled"},{"pos":[30620,30699],"content":"Should be monitored for all accounts where the setting should be “<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>.”"},{"pos":[30998,31036],"content":"<bpt id=\"p1\">**</bpt>'Don't Require Preauth'<ept id=\"p1\">**</ept> – Disabled"},{"pos":[31056,31135],"content":"Should be monitored for all accounts where the setting should be “<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>.”"}],"content":"---\ntitle: 4738(S) A user account was changed. (Windows 10)\ndescription: Describes security event 4738(S) A user account was changed.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 4738(S): A user account was changed.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\n<img src=\"images/event-4738.png\" alt=\"Event 4738 illustration\" width=\"449\" height=\"771\" hspace=\"10\" align=\"left\" />\n\n***Subcategory:***&nbsp;[Audit User Account Management](audit-user-account-management.md)\n\n***Event Description:***\n\nThis event generates every time user object is changed.\n\nThis event generates on domain controllers, member servers, and workstations.\n\nFor each change, a separate 4738 event will be generated.\n\nYou might see this event without any changes inside, that is, where all **Changed Attributes** apear as “-“. This usually happens when a change is made to an attribute that is not listed in the event. In this case there is no way to determine which attribute was changed. For example, if the [discretionary access control list](https://msdn.microsoft.com/en-us/library/windows/desktop/aa374872(v=vs.85).aspx) (DACL) is changed, a 4738 event will generate, but all attributes will be “-“.\n\nSome changes do not invoke a 4738 event.\n\n> **Note**&nbsp;&nbsp;For recommendations, see [Security Monitoring Recommendations](#security-monitoring-recommendations) for this event.\n\n<br clear=\"all\">\n\n***Event XML:***\n```\n- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n- <System>\n <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> \n <EventID>4738</EventID> \n <Version>0</Version> \n <Level>0</Level> \n <Task>13824</Task> \n <Opcode>0</Opcode> \n <Keywords>0x8020000000000000</Keywords> \n <TimeCreated SystemTime=\"2015-08-20T16:22:02.792454100Z\" /> \n <EventRecordID>175413</EventRecordID> \n <Correlation /> \n <Execution ProcessID=\"520\" ThreadID=\"1508\" /> \n <Channel>Security</Channel> \n <Computer>DC01.contoso.local</Computer> \n <Security /> \n </System>\n- <EventData>\n <Data Name=\"Dummy\">-</Data> \n <Data Name=\"TargetUserName\">ksmith</Data> \n <Data Name=\"TargetDomainName\">CONTOSO</Data> \n <Data Name=\"TargetSid\">S-1-5-21-3457937927-2839227994-823803824-6609</Data> \n <Data Name=\"SubjectUserSid\">S-1-5-21-3457937927-2839227994-823803824-1104</Data> \n <Data Name=\"SubjectUserName\">dadmin</Data> \n <Data Name=\"SubjectDomainName\">CONTOSO</Data> \n <Data Name=\"SubjectLogonId\">0x30dc2</Data> \n <Data Name=\"PrivilegeList\">-</Data> \n <Data Name=\"SamAccountName\">-</Data> \n <Data Name=\"DisplayName\">-</Data> \n <Data Name=\"UserPrincipalName\">-</Data> \n <Data Name=\"HomeDirectory\">-</Data> \n <Data Name=\"HomePath\">-</Data> \n <Data Name=\"ScriptPath\">-</Data> \n <Data Name=\"ProfilePath\">-</Data> \n <Data Name=\"UserWorkstations\">-</Data> \n <Data Name=\"PasswordLastSet\">-</Data> \n <Data Name=\"AccountExpires\">-</Data> \n <Data Name=\"PrimaryGroupId\">-</Data> \n <Data Name=\"AllowedToDelegateTo\">-</Data> \n <Data Name=\"OldUacValue\">0x15</Data> \n <Data Name=\"NewUacValue\">0x211</Data> \n <Data Name=\"UserAccountControl\">%%2050 %%2089</Data> \n <Data Name=\"UserParameters\">-</Data> \n <Data Name=\"SidHistory\">-</Data> \n <Data Name=\"LogonHours\">-</Data> \n </EventData>\n </Event>\n\n```\n\n***Required Server Roles:*** None.\n\n***Minimum OS Version:*** Windows Server 2008, Windows Vista.\n\n***Event Versions:*** 0.\n\n***Field Descriptions:***\n\n**Subject:**\n\n-   **Security ID** \\[Type = SID\\]**:** SID of account that requested the “change user account” operation. Event Viewer automatically tries to resolve SIDs and show the account name. If the SID cannot be resolved, you will see the source data in the event.\n\n> **Note**&nbsp;&nbsp;A **security identifier (SID)** is a unique value of variable length used to identify a trustee (security principal). Each account has a unique SID that is issued by an authority, such as an Active Directory domain controller, and stored in a security database. Each time a user logs on, the system retrieves the SID for that user from the database and places it in the access token for that user. The system uses the SID in the access token to identify the user in all subsequent interactions with Windows security. When a SID has been used as the unique identifier for a user or group, it cannot ever be used again to identify another user or group. For more information about SIDs, see [Security identifiers](security-identifiers.md).\n\n-   **Account Name** \\[Type = UnicodeString\\]**:** the name of the account that requested the “change user account” operation.\n\n-   **Account Domain** \\[Type = UnicodeString\\]**:** subject’s domain or computer name. Formats vary, and include the following:\n\n    -   Domain NETBIOS name example: CONTOSO\n\n    -   Lowercase full domain name: contoso.local\n\n    -   Uppercase full domain name: CONTOSO.LOCAL\n\n    -   For some [well-known security principals](https://support.microsoft.com/en-us/kb/243330), such as LOCAL SERVICE or ANONYMOUS LOGON, the value of this field is “NT AUTHORITY”.\n\n    -   For local user accounts, this field will contain the name of the computer or device that this account belongs to, for example: “Win81”.\n\n-   **Logon ID** \\[Type = HexInt64\\]**:** hexadecimal value that can help you correlate this event with recent events that might contain the same Logon ID, for example, “[4624](event-4624.md): An account was successfully logged on.”\n\n**Target Account:**\n\n-   **Security ID** \\[Type = SID\\]**:** SID of account that was changed. Event Viewer automatically tries to resolve SIDs and show the account name. If the SID cannot be resolved, you will see the source data in the event.\n\n-   **Account Name** \\[Type = UnicodeString\\]**:** the name of the account that was changed.\n\n-   **Account Domain** \\[Type = UnicodeString\\]**:** target account’s domain or computer name. Formats vary, and include the following:\n\n    -   Domain NETBIOS name example: CONTOSO\n\n    -   Lowercase full domain name: contoso.local\n\n    -   Uppercase full domain name: CONTOSO.LOCAL\n\n    -   For local user accounts, this field will contain the name of the computer or device that this account belongs to, for example: “Win81”.\n\n**Changed Attributes:**\n\nIf attribute was not changed it will have “–“ value.\n\nUnfortunately, for local accounts, all fields, except changed attributes, will have previous values populated. Also, the User Account Control field will have values only if it was modified. Changed attributes will have new values, but it is hard to understand which attribute was really changed.\n\n-   **SAM Account Name** \\[Type = UnicodeString\\]: logon name for account used to support clients and servers from previous versions of Windows (pre-Windows 2000 logon name). If the value of **sAMAccountName** attribute of user object was changed, you will see the new value here. For example: ladmin. For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.\n\n-   **Display Name** \\[Type = UnicodeString\\]: it is a name, displayed in the address book for a particular account. This is usually the combination of the user's first name, middle initial, and last name. You can change this attribute by using Active Directory Users and Computers, or through a script, for example. If the value of **displayName** attribute of user object was changed, you will see the new value here. For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.\n\n-   **User Principal Name** \\[Type = UnicodeString\\]: internet-style login name for the account, based on the Internet standard RFC 822. By convention this should map to the account's email name. If the value of **userPrincipalName** attribute of user object was changed, you will see the new value here. You can change this attribute by using Active Directory Users and Computers, or through a script, for example. For local accounts, this field is not applicable and always has “-“ value.\n\n-   **Home Directory** \\[Type = UnicodeString\\]: user's home directory. If **homeDrive** attribute is set and specifies a drive letter, **homeDirectory** should be a UNC path. The path must be a network UNC of the form \\\\\\\\Server\\\\Share\\\\Directory. If the value of **homeDirectory** attribute of user object was changed, you will see the new value here. You can change this attribute by using Active Directory Users and Computers, or through a script, for example. For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.\n\n-   **Home Drive** \\[Type = UnicodeString\\]**:** specifies the drive letter to which to map the UNC path specified by **homeDirectory** account’s attribute. The drive letter must be specified in the form “DRIVE\\_LETTER:”. For example – “H:”. If the value of **homeDrive** attribute of user object was changed, you will see the new value here. You can change this attribute by using Active Directory Users and Computers, or through a script, for example. For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.\n\n-   **Script Path** \\[Type = UnicodeString\\]**:** specifies the path of the account’s logon script. If the value of **scriptPath** attribute of user object was changed, you will see the new value here. You can change this attribute by using Active Directory Users and Computers, or through a script, for example. For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.\n\n-   **Profile Path** \\[Type = UnicodeString\\]: specifies a path to the account's profile. This value can be a null string, a local absolute path, or a UNC path. If the value of **profilePath** attribute of user object was changed, you will see the new value here. You can change this attribute by using Active Directory Users and Computers, or through a script, for example. For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.\n\n-   **User Workstations** \\[Type = UnicodeString\\]: contains the list of NetBIOS or DNS names of the computers from which the user can logon. Each computer name is separated by a comma. The name of a computer is the **sAMAccountName** property of a computer object. If the value of **userWorkstations** attribute of user object was changed, you will see the new value here. You can change this attribute by using Active Directory Users and Computers, or through a script, for example. For local accounts, this field is not applicable and always appears as “**&lt;value not set&gt;**.“\n\n-   **Password Last Set** \\[Type = UnicodeString\\]**:** last time the account’s password was modified. If the value of **pwdLastSet** attribute of user object was changed, you will see the new value here. For example: 8/12/2015 11:41:39 AM. This value will be changed, for example, after manual user account password reset. For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.\n\n-   **Account Expires** \\[Type = UnicodeString\\]: the date when the account expires. If the value of **accountExpires** attribute of user object was changed, you will see the new value here. . For example, “9/21/2015 12:00:00 AM”. You can change this attribute by using Active Directory Users and Computers, or through a script, for example. For local accounts, this field always has some value—if the account's attribute was not changed it will contain the current value of the attribute.\n\n-   **Primary Group ID** \\[Type = UnicodeString\\]: Relative Identifier (RID) of user’s object primary group.\n\n> **Note**&nbsp;&nbsp;**Relative identifier (RID)** is a variable length number that is assigned to objects at creation and becomes part of the object's Security Identifier (SID) that uniquely identifies an account or group within a domain.\n\nThis field will contain some value if user’s object primary group was changed. You can change user’s primary group using Active Directory Users and Computers management console in the **Member Of** tab of user object properties. You will see a RID of new primary group as a field value. For example, RID 513 (Domain Users) is a default primary group for users.\n\nTypical **Primary Group** values for user accounts:\n\n-   513 (Domain Users. For local accounts this RID means Users) – for domain and local users.\n\n    See this article <https://support.microsoft.com/en-us/kb/243330> for more information. If the value of **primaryGroupID** attribute of user object was changed, you will see the new value here.\n\n<!-- -->\n\n-   **AllowedToDelegateTo** \\[Type = UnicodeString\\]: the list of SPNs to which this account can present delegated credentials. Can be changed using Active Directory Users and Computers management console in **Delegation** tab of user account, if at least one SPN is registered for user account. If the SPNs list on **Delegation** tab of a user account was changed, you will see the new SPNs list in **AllowedToDelegateTo** field (note that you will see the new list instead of changes) of this event. This is an example of **AllowedToDelegateTo**:\n\n    -   dcom/WIN2012\n\n    -   dcom/WIN2012.contoso.local\n\n        If the value of **msDS-AllowedToDelegateTo** attribute of user object was changed, you will see the new value here.\n\n        The value can be “**&lt;value not set&gt;**”, for example, if delegation was disabled.\n\n        For local accounts, this field is not applicable and always has “-“ value.\n\n> **Note**&nbsp;&nbsp;**Service Principal Name (SPN)** is the name by which a client uniquely identifies an instance of a service. If you install multiple instances of a service on computers throughout a forest, each instance must have its own SPN. A given service instance can have multiple SPNs if there are multiple names that clients might use for authentication. For example, an SPN always includes the name of the host computer on which the service instance is running, so a service instance might register an SPN for each name or alias of its host.\n\n-   **Old UAC Value** \\[Type = UnicodeString\\]: specifies flags that control password, lockout, disable/enable, script, and other behavior for the user account. This parameter contains the previous value of **userAccountControl** attribute of user object.\n\n-   **New UAC Value** \\[Type = UnicodeString\\]: specifies flags that control password, lockout, disable/enable, script, and other behavior for the user account. If the value of **userAccountControl** attribute of user object was changed, you will see the new value here.\n\nTo decode this value, you can go through the property value definitions in the “Table 7. User’s or Computer’s account UAC flags.” from largest to smallest. Compare each property value to the flags value in the event. If the flags value in the event is greater than or equal to the property value, then the property is \"set\" and applies to that event. Subtract the property value from the flags value in the event and note that the flag applies and then go on to the next flag.\n\nHere's an example: Flags value from event: 0x15\n\nDecoding:\n\n• PASSWD\\_NOTREQD 0x0020\n\n• LOCKOUT 0x0010\n\n• HOMEDIR\\_REQUIRED 0x0008\n\n• (undeclared) 0x0004\n\n• ACCOUNTDISABLE 0x0002\n\n• SCRIPT 0x0001\n\n0x0020 &gt; 0x15, so PASSWD\\_NOTREQD does not apply to this event\n\n0x10 &lt; 0x15, so LOCKOUT applies to this event. 0x15 - 0x10 = 0x5\n\n0x4 &lt; 0x5, so the undeclared value is set. We'll pretend it doesn't mean anything. 0x5 - 0x4 = 0x1\n\n0x2 &gt; 0x1, so ACCOUNTDISABLE does not apply to this event\n\n0x1 = 0x1, so SCRIPT applies to this event. 0x1 - 0x1 = 0x0, we're done.\n\nSo this UAC flags value decodes to: LOCKOUT and SCRIPT\n\n-   **User Account Control** \\[Type = UnicodeString\\]**:** shows the list of changes in **userAccountControl** attribute. You will see a line of text for each change. See possible values in here: “Table 7. User’s or Computer’s account UAC flags.”. In the “User Account Control field text” column, you can see the text that will be displayed in the **User Account Control** field in 4738 event.\n\n-   **User Parameters** \\[Type = UnicodeString\\]: if you change any setting using Active Directory Users and Computers management console in Dial-in tab of user’s account properties, then you will see **&lt;value changed, but not displayed&gt;** in this field. For local accounts, this field is not applicable and always has “&lt;value not set&gt;“ value.\n\n-   **SID History** \\[Type = UnicodeString\\]: contains previous SIDs used for the object if the object was moved from another domain. Whenever an object is moved from one domain to another, a new SID is created and becomes the objectSID. The previous SID is added to the **sIDHistory** property. If the value of **sIDHistory** attribute of user object was changed, you will see the new value here.\n\n-   **Logon Hours** \\[Type = UnicodeString\\]: hours that the account is allowed to logon to the domain. If the value of **logonHours** attribute of user object was changed, you will see the new value here. You can change this attribute by using Active Directory Users and Computers, or through a script, for example. Here is an example of this field:\n\n    Sunday 12:00 AM - 7:00 PM\n\n    Sunday 9:00 PM -Monday 1:00 PM\n\n    Monday 2:00 PM -Tuesday 6:00 PM\n\n    Tuesday 8:00 PM -Wednesday 10:00 AM\n\n    For local accounts this field is not applicable and typically has value “**All**”.\n\n**Additional Information:**\n\n-   **Privileges** \\[Type = UnicodeString\\]: the list of user privileges which were used during the operation, for example, SeBackupPrivilege. This parameter might not be captured in the event, and in that case appears as “-”. See full list of user privileges in “Table 8. User Privileges.”.\n\n## Security Monitoring Recommendations\n\nFor 4738(S): A user account was changed.\n\n> **Important**&nbsp;&nbsp;For this event, also see [Appendix A: Security monitoring recommendations for many audit events](appendix-a-security-monitoring-recommendations-for-many-audit-events.md).\n\n-   Some organizations monitor every [4738](event-4738.md) event.\n\n-   If you have critical user computer accounts (for example, domain administrator accounts or service accounts) for which you need to monitor each change, monitor this event with the **“Target Account\\\\Account Name”** that corresponds to the critical account or accounts.\n\n-   If you have user accounts for which any change in the services list on the **Delegation** tab should be monitored, monitor this event when **AllowedToDelegateTo** is not -. This value means the services list was changed.\n\n-   Consider whether to track the following fields:\n\n| **Field to track**                                                                                                                                                                                                                                                                                     | **Reason to track**                                                                                                                                                             |\n|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| **Display Name**<br>**User Principal Name**<br>**Home Directory**<br>**Home Drive**<br>**Script Path**<br>**Profile Path**<br>**User Workstations**<br>**Password Last Set**<br>**Account Expires**<br>**Primary Group ID<br>Logon Hours** | We recommend monitoring all changes for these fields for critical domain and local accounts.                                                                                    |\n| **Primary Group ID** is not 513                                                                                                                                                                                                                                                                        | Typically, the **Primary Group** value is 513 for domain and local users. Other values should be monitored.                                                                     |\n| For user accounts for which the services list (on the **Delegation** tab) should not be empty: **AllowedToDelegateTo** is marked **&lt;value not set&gt; **                                                                                                                                            | If **AllowedToDelegateTo** is marked **&lt;value not set&gt;** on user accounts that previously had a services list (on the **Delegation** tab), it means the list was cleared. |\n| **SID History** is not -                                                                                                                                                                                                                                                                               | This field will always be set to - unless the account was migrated from another domain.                                                                                         |\n\n-   Consider whether to track the following user account control flags:\n\n| **User account control flag to track**                  | **Information about the flag**                                                                                                                                                                                                                                                                                                                                                        |\n|---------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| **'Normal Account'** – Disabled                         | Should not be disabled for user accounts.                                                                                                                                                                                                                                                                                                                                             |\n| **'Password Not Required'** – Enabled                   | Should not typically be enabled for user accounts because it weakens security for the account.                                                                                                                                                                                                                                                                                        |\n| **'Encrypted Text Password Allowed'** – Enabled         | Should not typically be enabled for user accounts because it weakens security for the account.                                                                                                                                                                                                                                                                                        |\n| **'Server Trust Account'** – Enabled                    | Should never be enabled for user accounts. Applies only to domain controller (computer) accounts.                                                                                                                                                                                                                                                                                     |\n| **'Don't Expire Password'** – Enabled                   | Should be monitored for critical accounts, or all accounts if your organization does not allow this flag.                                                                                                                                                                                                                                                                             |\n| **'Smartcard Required'** – Enabled                      | Should be monitored for critical accounts.                                                                                                                                                                                                                                                                                                                                            |\n| **'Password Not Required'** – Disabled                  | Should be monitored for all accounts where the setting should be “**Enabled**.”                                                                                                                                                                                                                                                                                                       |\n| **'Encrypted Text Password Allowed'** – Disabled        | Should be monitored for all accounts where the setting should be “**Enabled**.”                                                                                                                                                                                                                                                                                                       |\n| **'Don't Expire Password'** – Disabled                  | Should be monitored for all accounts where the setting should be “**Enabled**.”                                                                                                                                                                                                                                                                                                       |\n| **'Smartcard Required'** – Disabled                     | Should be monitored for all accounts where the setting should be “**Enabled**.”                                                                                                                                                                                                                                                                                                       |\n| **'Trusted For Delegation'** – Enabled                  | Means that Kerberos Constraint or Unconstraint delegation was enabled for the user account. We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.                                                                                                                                                   |\n| **'Trusted For Delegation'** – Disabled                 | Means that Kerberos Constraint or Unconstraint delegation was disabled for the user account. We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.<br>Also, if you have a list of user accounts for which delegation is critical and should not be disabled, monitor this for those accounts. |\n| **'Trusted To Authenticate For Delegation'** – Enabled  | Means that Protocol Transition delegation was enabled for the user account. We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.                                                                                                                                                                   |\n| **'Trusted To Authenticate For Delegation'** – Disabled | Means that Protocol Transition delegation was disabled for the user account. We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.<br>Also, if you have a list of user accounts for which delegation is critical and should not be disabled, monitor this for those accounts.                 |\n| **'Not Delegated'** – Enabled                           | Means that **Account is sensitive and cannot be delegated** was checked for the user account. We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.                                                                                                                                                 |\n| **'Not Delegated'** – Disabled                          | Should be monitored for all accounts where the setting should be “**Enabled**.” Means that **Account is sensitive and cannot be delegated** was unchecked for the user account. We recommend monitoring this to discover whether it is an approved action (done by an administrator), a mistake, or a malicious action.                                                               |\n| **'Use DES Key Only'** – Enabled                        | Should not typically be enabled for user accounts because it weakens security for the account’s Kerberos authentication.                                                                                                                                                                                                                                                              |\n| **'Don't Require Preauth'** – Enabled                   | Should not be enabled for user accounts because it weakens security for the account’s Kerberos authentication.                                                                                                                                                                                                                                                                        |\n| **'Use DES Key Only'** – Disabled                       | Should be monitored for all accounts where the setting should be “**Enabled**.”                                                                                                                                                                                                                                                                                                       |\n| **'Don't Require Preauth'** – Disabled                  | Should be monitored for all accounts where the setting should be “**Enabled**.”                                                                                                                                                                                                                                                                                                       |\n\n"}