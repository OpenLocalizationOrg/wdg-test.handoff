{"nodes":[{"content":"Deploy Required Features for UE-V 2.x","pos":[11,48]},{"content":"Deploy Required Features for UE-V 2.x","pos":[62,99]},{"content":"Deploy Required Features for UE-V 2.x","pos":[263,300]},{"content":"All Microsoft User Experience Virtualization (UE-V) 2.0, 2.1, and 2.1 SP1 deployments require these features","pos":[303,411]},{"pos":[417,492],"content":"<bpt id=\"p1\">[</bpt>Deploy a Settings Storage Location<ept id=\"p1\">](#ssl)</ept> that is accessible to end users."},{"content":"This is a standard network share that stores and retrieves user settings.","pos":[498,571]},{"content":"Choose the Configuration Method for UE-V","pos":[578,618]},{"content":"UE-V can be deployed and configured using common management tools including group policy, Configuration Manager, or Windows Management Infrastructure and Powershell.","pos":[634,799]},{"pos":[805,896],"content":"<bpt id=\"p1\">[</bpt>Deploy a UE-V Agent<ept id=\"p1\">](#agent)</ept> to be installed on every computer that synchronizes settings."},{"content":"This monitors registered applications and the operating system for any settings changes and synchronizes those settings between computers.","pos":[902,1040]},{"content":"The topics in this section describe how to deploy these features.","pos":[1042,1107]},{"pos":[1136,1175],"content":"Deploy a UE-V Settings Storage Location"},{"content":"UE-V requires a location in which to store user settings in settings package files.","pos":[1178,1261]},{"content":"You can configure this settings storage location in one of these ways:","pos":[1262,1332]},{"content":"Create your own settings storage location","pos":[1338,1379]},{"content":"Use existing Active Directory for your settings storage location","pos":[1385,1449]},{"content":"If you don’t create a settings storage location, the UE-V Agent will use Active Directory (AD) by default.","pos":[1451,1557]},{"content":"Note","pos":[1561,1565]},{"content":"As a matter of <bpt id=\"p1\">[</bpt>performance and capacity planning<ept id=\"p1\">](http://technet.microsoft.com/library/dn458932.aspx#capacity)</ept> and to reduce problems with network latency, create settings storage locations on the same local networks where the users’ computers reside.","pos":[1570,1822]},{"content":"We recommend 20 MB of disk space per user for the settings storage location.","pos":[1823,1899]},{"content":"Create a UE-V Settings Storage Location","pos":[1908,1947]},{"content":"Before you define the settings storage location, you must create a root directory with read/write permissions for users who store settings on the share.","pos":[1949,2101]},{"content":"The UE-V Agent creates user-specific folders under this root directory.","pos":[2102,2173]},{"content":"The settings storage location is defined by setting the SettingsStoragePath configuration option, which you can configure by using one of these methods:","pos":[2175,2327]},{"pos":[2333,2427],"content":"When you <bpt id=\"p1\">[</bpt>Deploy the UE-V Agent<ept id=\"p1\">](#agent)</ept> through a command-line parameter or in a batch script"},{"pos":[2433,2516],"content":"Through <bpt id=\"p1\">[</bpt>Group Policy<ept id=\"p1\">](http://technet.microsoft.com/library/dn458893.aspx)</ept> settings"},{"pos":[2522,2626],"content":"With the <bpt id=\"p1\">[</bpt>System Center Configuration Pack<ept id=\"p1\">](http://technet.microsoft.com/library/dn458917.aspx)</ept> for UE-V"},{"pos":[2632,2795],"content":"After installation of the UE-V Agent, by using <bpt id=\"p1\">[</bpt>Windows PowerShell or Windows Management Instrumentation (WMI)<ept id=\"p1\">](http://technet.microsoft.com/library/dn458937.aspx)</ept>"},{"content":"The path must be in a universal naming convention (UNC) path of the server and share.","pos":[2797,2882]},{"content":"For example, <bpt id=\"p1\">**</bpt><ph id=\"ph1\">\\\\\\\\</ph>Server<ph id=\"ph2\">\\\\</ph>Settingsshare<ph id=\"ph3\">\\\\</ph><ept id=\"p1\">**</ept>.","pos":[2883,2928]},{"content":"This configuration option supports the use of variables to enable specific synchronization scenarios.","pos":[2929,3030]},{"content":"For example, you can use the <ph id=\"ph1\">`%username%\\%computername%`</ph> variables to preserve the end user settings experience in these scenarios:","pos":[3031,3162]},{"content":"End users that use multiple physical computers in your enterprise","pos":[3168,3233]},{"content":"Enterprise computers that are used by multiple end users","pos":[3239,3295]},{"content":"The UE-V Agent dynamically creates a user-specific settings storage path, with a hidden system folder named <ph id=\"ph1\">`SettingsPackages`</ph>, based on the configuration setting of <bpt id=\"p1\">**</bpt>SettingsStoragePath<ept id=\"p1\">**</ept>.","pos":[3297,3487]},{"content":"The agent reads and writes settings to this location as defined by the registered UE-V settings location templates.","pos":[3488,3603]},{"content":"<bpt id=\"p1\">**</bpt>UE-V settings are determined by a \"Last write wins\" rule:<ept id=\"p1\">**</ept> If the settings storage location is the same for user with multiple managed computers, one UE-V Agent reads and writes to the settings location independently of agents running on other computers.","pos":[3605,3862]},{"content":"The last written settings and values are the ones applied when the next agent reads from the settings storage location.","pos":[3863,3982]},{"content":"<bpt id=\"p1\">**</bpt>Deploy the settings storage location:<ept id=\"p1\">**</ept> Follow these steps to define the settings storage location rather than using your existing Active Directory service.","pos":[3984,4142]},{"content":"You should limit access to the settings storage share to those users that require it, as shown in the tables below.","pos":[4143,4258]},{"content":"To deploy the UE-V network share","pos":[4262,4294]},{"content":"Create a new security group for UE-V users.","pos":[4302,4345]},{"content":"Create a new folder on the centrally located computer that stores the UE-V settings packages, and then grant the UE-V users access with group permissions to the folder.","pos":[4351,4519]},{"content":"The administrator who supports UE-V must have permissions to this shared folder.","pos":[4520,4600]},{"content":"Set the following share-level Server Message Block (SMB) permissions for the settings storage location folder.","pos":[4606,4716]},{"pos":[4722,5289],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\"><strong>User account</strong></th>\n<th align=\"left\"><strong>Recommended permissions</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Everyone</p></td>\n<td align=\"left\"><p>No permissions</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Security group of UE-V users</p></td>\n<td align=\"left\"><p>Full control</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"User account","pos":[124,136]},{"content":"Recommended permissions","pos":[176,199]},{"content":"Everyone","pos":[274,282]},{"content":"No permissions","pos":[312,326]},{"content":"Security group of UE-V users","pos":[380,408]},{"content":"Full control","pos":[438,450]}]},{"content":"Set the following NTFS file system permissions for the settings storage location folder.","pos":[5302,5390]},{"pos":[5396,6186],"content":"<table>\n<colgroup>\n<col width=\"33%\" />\n<col width=\"33%\" />\n<col width=\"33%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\"><strong>User account</strong></th>\n<th align=\"left\"><strong>Recommended permissions</strong></th>\n<th align=\"left\"><strong>Folder</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Creator/owner</p></td>\n<td align=\"left\"><p>Full control</p></td>\n<td align=\"left\"><p>Subfolders and files only</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Security group of UE-V users</p></td>\n<td align=\"left\"><p>List folder/read data, create folders/append data</p></td>\n<td align=\"left\"><p>This folder only</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"User account","pos":[144,156]},{"content":"Recommended permissions","pos":[196,219]},{"content":"Folder","pos":[259,265]},{"content":"Creator/owner","pos":[340,353]},{"content":"Full control","pos":[383,395]},{"content":"Subfolders and files only","pos":[425,450]},{"content":"Security group of UE-V users","pos":[504,532]},{"content":"List folder/read data, create folders/append data","pos":[562,611]},{"content":"This folder only","pos":[641,657]}]},{"content":"With this configuration, the UE-V Agent creates and secures a Settingspackage folder while it runs in the context of the user, and grants each user permission to create folders for settings storage.","pos":[6195,6393]},{"content":"Users receive full control to their Settingspackage folder while other users cannot access it.","pos":[6394,6488]},{"content":"Note","pos":[6492,6496]},{"content":"If you create the settings storage share on a computer running a Windows Server operating system, configure UE-V to verify that either the local Administrators group or the current user is the owner of the folder where settings packages are stored.","pos":[6501,6749]},{"content":"To enable this additional security, specify this setting in the Windows Server Registry Editor:","pos":[6750,6845]},{"pos":[6851,7001],"content":"Add a <bpt id=\"p1\">**</bpt>REG<ph id=\"ph1\">\\_</ph>DWORD<ept id=\"p1\">**</ept> registry key named <bpt id=\"p2\">**</bpt>\"RepositoryOwnerCheckEnabled\"<ept id=\"p2\">**</ept> to <bpt id=\"p3\">**</bpt>HKEY<ph id=\"ph2\">\\_</ph>LOCAL<ph id=\"ph3\">\\_</ph>MACHINE<ph id=\"ph4\">\\\\</ph>Software<ph id=\"ph5\">\\\\</ph>Microsoft<ph id=\"ph6\">\\\\</ph>UEV<ph id=\"ph7\">\\\\</ph>Agent<ph id=\"ph8\">\\\\</ph>Configuration<ept id=\"p3\">**</ept>."},{"pos":[7007,7041],"content":"Set the registry key value to <bpt id=\"p1\">*</bpt>1<ept id=\"p1\">*</ept>."},{"content":"Use Active Directory with UE-V 2.x","pos":[7050,7084]},{"content":"The UE-V Agent uses Active Directory (AD) by default if a settings storage location is not otherwise defined.","pos":[7086,7195]},{"content":"In these cases, the UE-V Agent dynamically creates the settings storage folder under the root of the AD home directory of each user.","pos":[7196,7328]},{"content":"But, if a custom directory setting is configured in AD, then that directory is used instead.","pos":[7329,7421]},{"pos":[7453,7497],"content":"Choose the Configuration Method for UE-V 2.x"},{"content":"You want to figure out which configuration method you'll use to manage UE-V after deployment since this will be the configuration method you use to deploy the UE-V Agent.","pos":[7500,7670]},{"content":"Typically, this is the configuration method that you already use in your environment, such as Windows PowerShell or Configuration Manager.","pos":[7671,7809]},{"content":"You can configure UE-V before, during, or after UE-V Agent installation, depending on the configuration method that you use.","pos":[7811,7935]},{"content":"<bpt id=\"p1\">[</bpt>Group Policy<ept id=\"p1\">](http://technet.microsoft.com/library/dn458893.aspx)</ept><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> You can use your existing Group Policy infrastructure to configure UE-V before or after UE-V Agent deployment.","pos":[7941,8123]},{"content":"The UE-V Group Policy ADMX template enables the central management of common UE-V Agent configuration options, and it includes settings to configure UE-V synchronization.","pos":[8124,8294]},{"pos":[8300,8575],"content":"<bpt id=\"p1\">**</bpt>Installing the UE-V Group Policy ADMX Templates:<ept id=\"p1\">**</ept> Group Policy ADMX templates for UE-V configure the synchronization settings for the UE-V Agent and enable the central management of common UE-V Agent configuration settings by using an existing Group Policy infrastructure."},{"content":"Supported operating systems for the domain controller that deploys the Group Policy Objects include the following:","pos":[8581,8695]},{"content":"Windows Server 2008 R2","pos":[8701,8723]},{"content":"Windows Server 2012 and Windows Server 2012 R2","pos":[8729,8775]},{"pos":[8781,9091],"content":"<bpt id=\"p1\">[</bpt>Configuration Manager<ept id=\"p1\">](http://technet.microsoft.com/library/dn458917.aspx)</ept><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> The UE-V Configuration Pack lets you use the Compliance Settings feature of System Center Configuration Manager 2012 SP1 or later to apply consistent configurations across sites where UE-V and Configuration Manager are installed."},{"pos":[9097,9339],"content":"<bpt id=\"p1\">[</bpt>Windows PowerShell and WMI<ept id=\"p1\">](http://technet.microsoft.com/library/dn458937.aspx)</ept><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> You can use scripted commands for Windows PowerShell and Windows Management Instrumentation (WMI) to modify configurations after you install the UE-V Agent."},{"pos":[9345,9499],"content":"**Note**  \nRegistry modification can result in data loss, or the computer becomes unresponsive. We recommend that you use other configuration methods.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"Registry modification can result in data loss, or the computer becomes unresponsive. We recommend that you use other configuration methods.","pos":[11,150],"nodes":[{"content":"Registry modification can result in data loss, or the computer becomes unresponsive.","pos":[0,84]},{"content":"We recommend that you use other configuration methods.","pos":[85,139]}]}]},{"content":"<bpt id=\"p1\">**</bpt>Command-line or Batch Script Installation:<ept id=\"p1\">**</ept> Parameters that are used when you <bpt id=\"p2\">[</bpt>Deploy the UE-V Agent<ept id=\"p2\">](#agent)</ept> configure many UE-V settings.","pos":[9512,9654]},{"content":"Electronic software distribution systems, such as System Center 2012 Configuration Manager, use these parameters to configure their clients when they deploy and install the UE-V Agent software.","pos":[9655,9848]},{"pos":[9879,9904],"content":"Deploy the UE-V 2.x Agent"},{"content":"The UE-V Agent is the core of a UE-V deployment and must run on each computer that uses UE-V to synchronize application and Windows settings.","pos":[9907,10048]},{"content":"<bpt id=\"p1\">**</bpt>UE-V Agent Installation Files:<ept id=\"p1\">**</ept> A single installation file, AgentSetup.exe, installs the UE-V Agent on both 32-bit and 64-bit operating systems.","pos":[10050,10197]},{"content":"In addition, AgentSetupx86.msi or AgentSetupx64.msi architecture-specific Windows Installer files are provided, and since they are smaller, they might streamline the agent deployments.","pos":[10198,10382]},{"content":"The <bpt id=\"p1\">[</bpt>command-line parameters for the AgentSetup.exe installer<ept id=\"p1\">](#params)</ept> are supported for the Windows Installer installation as well.","pos":[10383,10516]},{"content":"Important","pos":[10520,10529]},{"content":"During UE-V Agent installation or uninstallation, you can either use the AgentSetup.exe file or the AgentSetup<ph id=\"ph1\">&amp;lt;</ph>arch<ph id=\"ph2\">&amp;gt;</ph>.msi file, but not both.","pos":[10534,10680]},{"content":"The same file must be used to uninstall the UE-V Agent that was used to install the UE-V Agent.","pos":[10681,10776]},{"content":"To Deploy the UE-V Agent","pos":[10785,10809]},{"content":"You can use the following methods to deploy the UE-V Agent:","pos":[10811,10870]},{"content":"An electronic software distribution (ESD) solution system, such as Configuration Manager, that can install a Windows Installer (.msi) file.","pos":[10876,11015]},{"content":"An installation script that references the Windows Installer (.msi) file that is stored centrally on a share.","pos":[11021,11130]},{"content":"An installation program that you run manually on the computer.","pos":[11136,11198]},{"content":"Use the following procedure to deploy the UE-V Agent from a network share.","pos":[11200,11274]},{"content":"To install and configure the UE-V Agent from a network share","pos":[11278,11338]},{"content":"Stage the UE-V Agent installation file AgentSetup.exe on a network share to which users have Read permission.","pos":[11346,11455]},{"content":"Deploy a script to user computers that installs the UE-V Agent.","pos":[11461,11524]},{"content":"The script should specify the settings storage location.","pos":[11525,11581]},{"content":"<bpt id=\"p1\">**</bpt>Deployment options:<ept id=\"p1\">**</ept> Be sure to use the correct variable format when you install the UE-V Agent.","pos":[11583,11682]},{"content":"The following table provides examples of deployment options for using the AgentSetup.exe or the Windows Installer (.msi) files.","pos":[11683,11810]},{"content":"Deployment type","pos":[11956,11971]},{"content":"Deployment description","pos":[12011,12033]},{"content":"Example","pos":[12073,12080]},{"content":"Command prompt","pos":[12155,12169]},{"content":"When you install the UE-V Agent at a command prompt, use the <ph id=\"ph1\">&lt;em&gt;</ph>%^username%<ph id=\"ph2\">&lt;/em&gt;</ph> variable format.","pos":[12199,12297]},{"content":"If quotation marks are required because of spaces in the settings storage path, use a batch script file for deployment.","pos":[12298,12417]},{"content":"Batch script","pos":[12856,12868]},{"content":"When you install the UE-V Agent from a batch script file, use the <ph id=\"ph1\">&lt;em&gt;</ph>%%username%%<ph id=\"ph2\">&lt;/em&gt;</ph> variable format.","pos":[12898,13002]},{"content":"If you use this installation method, you must escape the variable with the %% characters.","pos":[13003,13092]},{"content":"Without this character, the script expands the <ph id=\"ph1\">&lt;em&gt;</ph>username<ph id=\"ph2\">&lt;/em&gt;</ph> variable at installation time, rather than at run time, which causes UE-V to use a single settings storage location for all users.","pos":[13093,13288]},{"content":"Windows PowerShell","pos":[13752,13770]},{"content":"When you install the UE-V Agent from a Windows PowerShell prompt or a Windows PowerShell script, use the <ph id=\"ph1\">&lt;em&gt;</ph>%username%<ph id=\"ph2\">&lt;/em&gt;</ph> variable format.","pos":[13800,13941]},{"content":"Electronic software distribution, such as deployment of Configuration Manager Software Deployment","pos":[14390,14487]},{"content":"When you install the UE-V Agent by using Configuration Manager, use the <ph id=\"ph1\">&lt;em&gt;</ph>^%username^%<ph id=\"ph2\">&lt;/em&gt;</ph> variable format.","pos":[14517,14627]},{"content":"Note","pos":[15046,15050]},{"content":"The installation of the UE-V Agent requires administrator rights, and the computer requires a restart before the UE-V Agent can run.","pos":[15055,15187]},{"pos":[15223,15272],"content":"Command-line parameters for UE-V Agent deployment"},{"content":"The command-line parameters of the UE-V Agent are as follows.","pos":[15274,15335]},{"content":"Command-line parameter","pos":[15481,15503]},{"content":"Definition","pos":[15543,15553]},{"content":"Notes","pos":[15593,15598]},{"content":"/help or /h or /?","pos":[15673,15690]},{"content":"Displays the AgentSetup.exe usage dialog box.","pos":[15720,15765]},{"content":"SettingsStoragePath","pos":[15849,15868]},{"content":"Indicates the Universal Naming Convention (UNC) path that defines where settings are stored.","pos":[15898,15990]},{"content":"Important","pos":[16045,16054]},{"content":"You must specify a SettingsStoragePath in UE-V 2.1 and UE-V 2.1 SP1.","pos":[16069,16137]},{"content":"You can set the AdHomePath string to specify that the user's Active Directory home path is used.","pos":[16138,16234]},{"content":"For example, <ph id=\"ph1\">&lt;code&gt;SettingsStoragePath = \\\\share\\path|AdHomePath&lt;/code&gt;</ph>.","pos":[16235,16307]},{"content":"In UE-V 2.0, you can leave SettingsStoragePath blank to use the Active Directory home path instead.","pos":[16315,16414]},{"content":"%username% or %computername% environment variables are accepted.","pos":[16444,16508]},{"content":"Scripting can require escaped variables.","pos":[16509,16549]},{"content":"Default<ph id=\"ph1\">&lt;/strong&gt;</ph>: <ph id=\"ph2\">&amp;lt;</ph>none","pos":[16565,16591]},{"content":"SettingsStoragePathReg","pos":[16648,16670]},{"content":"Gets the SettingsStoragePath value from the registry during installation.","pos":[16700,16773]},{"content":"At the command prompt, type the following example to force UE-V to use the Active Directory home path instead of a specific UNC.","pos":[16803,16931]},{"content":"SettingsTemplateCatalogPath","pos":[17108,17135]},{"content":"Indicates the Universal Naming Convention (UNC) path that defines the location that was checked for new settings location templates.","pos":[17165,17297]},{"content":"Only required for custom settings location templates","pos":[17327,17379]},{"content":"RegisterMSTemplates","pos":[17432,17451]},{"content":"Specifies whether the default Microsoft templates should be registered during installation.","pos":[17481,17572]},{"content":"True | False","pos":[17602,17614]},{"content":"Default<ph id=\"ph1\">&lt;/strong&gt;</ph>: True","pos":[17630,17652]},{"content":"SyncMethod","pos":[17706,17716]},{"content":"Specifies which synchronization method should be used.","pos":[17746,17800]},{"content":"SyncProvider | None","pos":[17830,17849]},{"content":"Default<ph id=\"ph1\">&lt;/strong&gt;</ph>: SyncProvider","pos":[17865,17895]},{"content":"SyncTimeoutInMilliseconds","pos":[17948,17973]},{"content":"Specifies the number of milliseconds that the computer waits before time-out when it retrieves user settings from the settings storage location.","pos":[18003,18147]},{"content":"Default<ph id=\"ph1\">&lt;/strong&gt;</ph>: 2000 milliseconds","pos":[18185,18220]},{"content":"(wait up to 2 seconds)","pos":[18228,18250]},{"content":"SyncEnabled","pos":[18304,18315]},{"content":"Specifies whether UE-V synchronization is enabled or disabled.","pos":[18345,18407]},{"content":"True | False","pos":[18437,18449]},{"content":"Default<ph id=\"ph1\">&lt;/strong&gt;</ph>: True","pos":[18465,18487]},{"content":"MaxPackageSizeInBytes","pos":[18540,18561]},{"content":"Specifies a settings package file size in bytes when the UE-V Agent reports that files exceed the threshold.","pos":[18591,18699]},{"content":"size","pos":[18733,18737]},{"content":"Default<ph id=\"ph1\">&lt;/strong&gt;</ph>: none (no warning threshold)","pos":[18757,18802]},{"content":"CEIPEnabled","pos":[18856,18867]},{"content":"Specifies the setting for participation in the Customer Experience Improvement program.","pos":[18897,18984]},{"content":"If set to <ph id=\"ph1\">&lt;strong&gt;</ph>True<ph id=\"ph2\">&lt;/strong&gt;</ph>, installer information is uploaded to the Microsoft Customer Experience Improvement Program site.","pos":[18985,19114]},{"content":"If set to <ph id=\"ph1\">&lt;strong&gt;</ph>False<ph id=\"ph2\">&lt;/strong&gt;</ph>, no information is uploaded.","pos":[19115,19176]},{"content":"True | False","pos":[19206,19218]},{"content":"Default<ph id=\"ph1\">&lt;/strong&gt;</ph>: False","pos":[19234,19257]},{"content":"NoRestart","pos":[19310,19319]},{"content":"Supports deferral of the restart of the computer after the UE-V Agent is installed.","pos":[19349,19432]},{"content":"INSTALLFOLDER","pos":[19516,19529]},{"content":"Enables a different installation folder to be set for the UE-V Agent or UE-V Generator.","pos":[19559,19646]},{"content":"MUENABLED","pos":[19729,19738]},{"content":"Enables Setup to accept the option to be included in the Microsoft Update program.","pos":[19768,19850]},{"content":"ACCEPTLICENSETERMS","pos":[19934,19952]},{"content":"Lets UE-V be installed silently.","pos":[19982,20014]},{"content":"This must be set to <ph id=\"ph1\">&lt;strong&gt;</ph>True<ph id=\"ph2\">&lt;/strong&gt;</ph> to install UE-V silently and bypass the requirement that the user accepts the UE-V license terms.","pos":[20015,20154]},{"content":"If set to <ph id=\"ph1\">&lt;strong&gt;</ph>False<ph id=\"ph2\">&lt;/strong&gt;</ph> or left empty, the user receives an error message and UE-V is not installed.","pos":[20155,20264]},{"content":"Important","pos":[20319,20328]},{"content":"This parameter is required to install UE-V silently.","pos":[20343,20395]},{"content":"NORESTART","pos":[20470,20479]},{"content":"Prevents a mandatory restart after the UE-V Agent is installed.","pos":[20509,20572]},{"content":"Update the UE-V Agent","pos":[20644,20665]},{"content":"Updates for the UE-V Agent software are provided through Microsoft Update.","pos":[20667,20741]},{"content":"You can deploy UE-V Agent updates by using Enterprise Software Distribution (ESD) infrastructure systems.","pos":[20742,20847]},{"content":"During a UE-V Agent upgrade, the default group of settings location templates for common Microsoft applications and Windows settings can be updated.","pos":[20849,20997]},{"content":"Upgrade the UE-V 2.x Agent","pos":[21003,21029]},{"content":"The UE-V 2.x Agent introduces many new features and modifies how and when the agent uploads content to the settings storage share.","pos":[21031,21161]},{"content":"The upgrade process automates these changes.","pos":[21162,21206]},{"content":"To upgrade the UE-V Agent, run the UE-V Agent install package (AgentSetup.exe, AgentSetupx86.msi, or AgentSetupx64.msi) on users’ computers.","pos":[21207,21347]},{"content":"Note","pos":[21351,21355]},{"content":"When you upgrade the UE-V Agent, you must use the same installer type (.exe file or .msi packet) that installed the previous UE-V Agent.","pos":[21360,21496]},{"content":"For example, use the UE-V 2 AgentSetup.exe to upgrade UE-V 1.0 Agents that were installed by using AgentSetup.exe.","pos":[21497,21611]},{"content":"The following configurations are preserved when the Agent Setup program runs:","pos":[21616,21693]},{"content":"Settings storage path","pos":[21699,21720]},{"content":"Registry settings","pos":[21726,21743]},{"content":"Scheduled tasks (Interval settings are reset to their defaults)","pos":[21749,21812]},{"content":"Note","pos":[21816,21820]},{"content":"A computer with UE-V 2.x settings location templates that are registered in the UE-V 1.0 Agent register errors in the Windows Event Log.","pos":[21825,21961]},{"content":"You can use Microsoft System Center 2012 Configuration Manager or another enterprise software distribution tool to automate and distribute the UE-V Agent upgrade.","pos":[21966,22128]},{"content":"<bpt id=\"p1\">**</bpt>Recommendations:<ept id=\"p1\">**</ept> We recommend that you upgrade all of the UE-V 1.0 Agents in a computing environment, but it is not required.","pos":[22130,22259]},{"content":"UE-V 2.x settings location templates can interact with a UE-V 1.0 Agent because they only share the settings from the settings storage path.","pos":[22260,22400]},{"content":"We recommend, however, that you move the deployments to a single agent version to simplify management and to support UE-V.","pos":[22401,22523]},{"content":"Repair the UE-V Agent after an unsuccessful upgrade","pos":[22529,22580]},{"content":"You might experience errors after you attempt one of the following operations:","pos":[22582,22660]},{"content":"Upgrade from UE-V 1.0 to UE-V 2","pos":[22666,22697]},{"content":"Upgrade to a newer version of Windows, for example, from Windows 7 to Windows 8 or from Windows 8 to Windows 8.1.","pos":[22703,22816]},{"content":"Uninstall the agent after upgrading the UE-V Agent","pos":[22822,22872]},{"content":"To resolve any issues, attempt to repair the UE-V Agent by entering this command at a command prompt on the computer where the agent is installed.","pos":[22874,23020]},{"content":"You can then retry the uninstall process or upgrade by installing the newer version of the UE-V Agent.","pos":[23128,23230]},{"content":"Got a suggestion for UE-V?","pos":[23235,23261]},{"content":"Add or vote on suggestions <bpt id=\"p1\">[</bpt>here<ept id=\"p1\">](http://uev.uservoice.com/forums/280428-microsoft-user-experience-virtualization)</ept>.","pos":[23264,23379]},{"content":"For UE-V issues, use the <bpt id=\"p1\">[</bpt>UE-V TechNet Forum<ept id=\"p1\">](https://social.technet.microsoft.com/Forums/home?forum=mdopuev)</ept>.","pos":[23380,23490]},{"content":"Related topics","pos":[23495,23509]},{"content":"Prepare a UE-V 2.x Deployment","pos":[23513,23542]},{"content":"Deploy UE-V 2.x for Custom Applications","pos":[23589,23628]}],"content":"---\ntitle: Deploy Required Features for UE-V 2.x\ndescription: Deploy Required Features for UE-V 2.x\nauthor: jamiejdt\nms.assetid: 10399bb3-cc7b-4578-bc0c-2f6b597abe4d\nms.pagetype: mdop, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w10\n---\n\n\n# Deploy Required Features for UE-V 2.x\n\n\nAll Microsoft User Experience Virtualization (UE-V) 2.0, 2.1, and 2.1 SP1 deployments require these features\n\n-   [Deploy a Settings Storage Location](#ssl) that is accessible to end users.\n\n    This is a standard network share that stores and retrieves user settings.\n\n-   [Choose the Configuration Method for UE-V](#config)\n\n    UE-V can be deployed and configured using common management tools including group policy, Configuration Manager, or Windows Management Infrastructure and Powershell.\n\n-   [Deploy a UE-V Agent](#agent) to be installed on every computer that synchronizes settings.\n\n    This monitors registered applications and the operating system for any settings changes and synchronizes those settings between computers.\n\nThe topics in this section describe how to deploy these features.\n\n## <a href=\"\" id=\"ssl\"></a>Deploy a UE-V Settings Storage Location\n\n\nUE-V requires a location in which to store user settings in settings package files. You can configure this settings storage location in one of these ways:\n\n-   Create your own settings storage location\n\n-   Use existing Active Directory for your settings storage location\n\nIf you don’t create a settings storage location, the UE-V Agent will use Active Directory (AD) by default.\n\n**Note**  \nAs a matter of [performance and capacity planning](http://technet.microsoft.com/library/dn458932.aspx#capacity) and to reduce problems with network latency, create settings storage locations on the same local networks where the users’ computers reside. We recommend 20 MB of disk space per user for the settings storage location.\n\n \n\n### Create a UE-V Settings Storage Location\n\nBefore you define the settings storage location, you must create a root directory with read/write permissions for users who store settings on the share. The UE-V Agent creates user-specific folders under this root directory.\n\nThe settings storage location is defined by setting the SettingsStoragePath configuration option, which you can configure by using one of these methods:\n\n-   When you [Deploy the UE-V Agent](#agent) through a command-line parameter or in a batch script\n\n-   Through [Group Policy](http://technet.microsoft.com/library/dn458893.aspx) settings\n\n-   With the [System Center Configuration Pack](http://technet.microsoft.com/library/dn458917.aspx) for UE-V\n\n-   After installation of the UE-V Agent, by using [Windows PowerShell or Windows Management Instrumentation (WMI)](http://technet.microsoft.com/library/dn458937.aspx)\n\nThe path must be in a universal naming convention (UNC) path of the server and share. For example, **\\\\\\\\Server\\\\Settingsshare\\\\**. This configuration option supports the use of variables to enable specific synchronization scenarios. For example, you can use the `%username%\\%computername%` variables to preserve the end user settings experience in these scenarios:\n\n-   End users that use multiple physical computers in your enterprise\n\n-   Enterprise computers that are used by multiple end users\n\nThe UE-V Agent dynamically creates a user-specific settings storage path, with a hidden system folder named `SettingsPackages`, based on the configuration setting of **SettingsStoragePath**. The agent reads and writes settings to this location as defined by the registered UE-V settings location templates.\n\n**UE-V settings are determined by a \"Last write wins\" rule:** If the settings storage location is the same for user with multiple managed computers, one UE-V Agent reads and writes to the settings location independently of agents running on other computers. The last written settings and values are the ones applied when the next agent reads from the settings storage location.\n\n**Deploy the settings storage location:** Follow these steps to define the settings storage location rather than using your existing Active Directory service. You should limit access to the settings storage share to those users that require it, as shown in the tables below.\n\n**To deploy the UE-V network share**\n\n1.  Create a new security group for UE-V users.\n\n2.  Create a new folder on the centrally located computer that stores the UE-V settings packages, and then grant the UE-V users access with group permissions to the folder. The administrator who supports UE-V must have permissions to this shared folder.\n\n3.  Set the following share-level Server Message Block (SMB) permissions for the settings storage location folder.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\"><strong>User account</strong></th>\n    <th align=\"left\"><strong>Recommended permissions</strong></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Everyone</p></td>\n    <td align=\"left\"><p>No permissions</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Security group of UE-V users</p></td>\n    <td align=\"left\"><p>Full control</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n4.  Set the following NTFS file system permissions for the settings storage location folder.\n\n    <table>\n    <colgroup>\n    <col width=\"33%\" />\n    <col width=\"33%\" />\n    <col width=\"33%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\"><strong>User account</strong></th>\n    <th align=\"left\"><strong>Recommended permissions</strong></th>\n    <th align=\"left\"><strong>Folder</strong></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Creator/owner</p></td>\n    <td align=\"left\"><p>Full control</p></td>\n    <td align=\"left\"><p>Subfolders and files only</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Security group of UE-V users</p></td>\n    <td align=\"left\"><p>List folder/read data, create folders/append data</p></td>\n    <td align=\"left\"><p>This folder only</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\nWith this configuration, the UE-V Agent creates and secures a Settingspackage folder while it runs in the context of the user, and grants each user permission to create folders for settings storage. Users receive full control to their Settingspackage folder while other users cannot access it.\n\n**Note**  \nIf you create the settings storage share on a computer running a Windows Server operating system, configure UE-V to verify that either the local Administrators group or the current user is the owner of the folder where settings packages are stored. To enable this additional security, specify this setting in the Windows Server Registry Editor:\n\n1.  Add a **REG\\_DWORD** registry key named **\"RepositoryOwnerCheckEnabled\"** to **HKEY\\_LOCAL\\_MACHINE\\\\Software\\\\Microsoft\\\\UEV\\\\Agent\\\\Configuration**.\n\n2.  Set the registry key value to *1*.\n\n \n\n### Use Active Directory with UE-V 2.x\n\nThe UE-V Agent uses Active Directory (AD) by default if a settings storage location is not otherwise defined. In these cases, the UE-V Agent dynamically creates the settings storage folder under the root of the AD home directory of each user. But, if a custom directory setting is configured in AD, then that directory is used instead.\n\n## <a href=\"\" id=\"config\"></a>Choose the Configuration Method for UE-V 2.x\n\n\nYou want to figure out which configuration method you'll use to manage UE-V after deployment since this will be the configuration method you use to deploy the UE-V Agent. Typically, this is the configuration method that you already use in your environment, such as Windows PowerShell or Configuration Manager.\n\nYou can configure UE-V before, during, or after UE-V Agent installation, depending on the configuration method that you use.\n\n-   [Group Policy](http://technet.microsoft.com/library/dn458893.aspx)**:** You can use your existing Group Policy infrastructure to configure UE-V before or after UE-V Agent deployment. The UE-V Group Policy ADMX template enables the central management of common UE-V Agent configuration options, and it includes settings to configure UE-V synchronization.\n\n    **Installing the UE-V Group Policy ADMX Templates:** Group Policy ADMX templates for UE-V configure the synchronization settings for the UE-V Agent and enable the central management of common UE-V Agent configuration settings by using an existing Group Policy infrastructure.\n\n    Supported operating systems for the domain controller that deploys the Group Policy Objects include the following:\n\n    Windows Server 2008 R2\n\n    Windows Server 2012 and Windows Server 2012 R2\n\n-   [Configuration Manager](http://technet.microsoft.com/library/dn458917.aspx)**:** The UE-V Configuration Pack lets you use the Compliance Settings feature of System Center Configuration Manager 2012 SP1 or later to apply consistent configurations across sites where UE-V and Configuration Manager are installed.\n\n-   [Windows PowerShell and WMI](http://technet.microsoft.com/library/dn458937.aspx)**:** You can use scripted commands for Windows PowerShell and Windows Management Instrumentation (WMI) to modify configurations after you install the UE-V Agent.\n\n    **Note**  \n    Registry modification can result in data loss, or the computer becomes unresponsive. We recommend that you use other configuration methods.\n\n     \n\n-   **Command-line or Batch Script Installation:** Parameters that are used when you [Deploy the UE-V Agent](#agent) configure many UE-V settings. Electronic software distribution systems, such as System Center 2012 Configuration Manager, use these parameters to configure their clients when they deploy and install the UE-V Agent software.\n\n## <a href=\"\" id=\"agent\"></a>Deploy the UE-V 2.x Agent\n\n\nThe UE-V Agent is the core of a UE-V deployment and must run on each computer that uses UE-V to synchronize application and Windows settings.\n\n**UE-V Agent Installation Files:** A single installation file, AgentSetup.exe, installs the UE-V Agent on both 32-bit and 64-bit operating systems. In addition, AgentSetupx86.msi or AgentSetupx64.msi architecture-specific Windows Installer files are provided, and since they are smaller, they might streamline the agent deployments. The [command-line parameters for the AgentSetup.exe installer](#params) are supported for the Windows Installer installation as well.\n\n**Important**  \nDuring UE-V Agent installation or uninstallation, you can either use the AgentSetup.exe file or the AgentSetup&lt;arch&gt;.msi file, but not both. The same file must be used to uninstall the UE-V Agent that was used to install the UE-V Agent.\n\n \n\n### To Deploy the UE-V Agent\n\nYou can use the following methods to deploy the UE-V Agent:\n\n-   An electronic software distribution (ESD) solution system, such as Configuration Manager, that can install a Windows Installer (.msi) file.\n\n-   An installation script that references the Windows Installer (.msi) file that is stored centrally on a share.\n\n-   An installation program that you run manually on the computer.\n\nUse the following procedure to deploy the UE-V Agent from a network share.\n\n**To install and configure the UE-V Agent from a network share**\n\n1.  Stage the UE-V Agent installation file AgentSetup.exe on a network share to which users have Read permission.\n\n2.  Deploy a script to user computers that installs the UE-V Agent. The script should specify the settings storage location.\n\n**Deployment options:** Be sure to use the correct variable format when you install the UE-V Agent. The following table provides examples of deployment options for using the AgentSetup.exe or the Windows Installer (.msi) files.\n\n<table>\n<colgroup>\n<col width=\"33%\" />\n<col width=\"33%\" />\n<col width=\"33%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\"><strong>Deployment type</strong></th>\n<th align=\"left\"><strong>Deployment description</strong></th>\n<th align=\"left\"><strong>Example</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Command prompt</p></td>\n<td align=\"left\"><p>When you install the UE-V Agent at a command prompt, use the <em>%^username%</em> variable format. If quotation marks are required because of spaces in the settings storage path, use a batch script file for deployment.</p>\n<p></p></td>\n<td align=\"left\"><p><code>AgentSetup.exe /quiet /norestart /log &quot;%temp%\\UE-VAgentInstaller.log&quot; SettingsStoragePath=\\\\server\\settingsshare\\%^username%</code></p>\n<p></p>\n<p><code>msiexec.exe /i &quot;&lt;path to msi file&gt;&quot; /quiet /norestart /l*v &quot;%temp%\\UE-VAgentInstaller.log&quot; SettingsStoragePath=\\\\server\\settingsshare\\%^username%</code></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Batch script</p></td>\n<td align=\"left\"><p>When you install the UE-V Agent from a batch script file, use the <em>%%username%%</em> variable format. If you use this installation method, you must escape the variable with the %% characters. Without this character, the script expands the <em>username</em> variable at installation time, rather than at run time, which causes UE-V to use a single settings storage location for all users.</p></td>\n<td align=\"left\"><p><code>AgentSetup.exe /quiet /norestart /log &quot;%temp%\\UE-VAgentInstaller.log&quot; SettingsStoragePath=&quot;\\\\server\\settingsshare\\%%username%%&quot;</code></p>\n<p></p>\n<p><code>msiexec.exe /i &quot;&lt;path to msi file&gt;&quot; /quiet /norestart /l*v &quot;%temp%\\UE-VAgentInstaller.log&quot; SettingsStoragePath=&quot;\\\\server\\settingsshare\\%%username%%&quot;</code></p>\n<p></p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Windows PowerShell</p></td>\n<td align=\"left\"><p>When you install the UE-V Agent from a Windows PowerShell prompt or a Windows PowerShell script, use the <em>%username%</em> variable format.</p></td>\n<td align=\"left\"><p><code>&amp; AgentSetup.exe /quiet /norestart /log &quot;%temp%\\UE-VAgentInstaller.log&quot; SettingsStoragePath=\\\\server\\settingsshare\\%username%</code></p>\n<p></p>\n<p><code>&amp; msiexec.exe /i &quot;&lt;path to msi file&gt;&quot; /quiet /norestart /l*v &quot;%temp%\\UE-VAgentInstaller.log&quot; SettingsStoragePath=\\\\server\\settingsshare\\%username%</code></p>\n<p></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Electronic software distribution, such as deployment of Configuration Manager Software Deployment</p></td>\n<td align=\"left\"><p>When you install the UE-V Agent by using Configuration Manager, use the <em>^%username^%</em> variable format.</p></td>\n<td align=\"left\"><p><code>AgentSetup.exe /quiet /norestart /log &quot;%temp%\\UE-VAgentInstaller.log&quot; SettingsStoragePath=\\\\server\\settingsshare\\^%username^%</code></p>\n<p></p>\n<p><code>msiexec.exe /i &quot;&lt;path to msi file&gt;&quot; /quiet /norestart /l*v &quot;%temp%\\UE-VAgentInstaller.log&quot; SettingsStoragePath=\\\\server\\settingsshare\\^%username^%</code></p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n**Note**  \nThe installation of the UE-V Agent requires administrator rights, and the computer requires a restart before the UE-V Agent can run.\n\n \n\n### <a href=\"\" id=\"params\"></a>Command-line parameters for UE-V Agent deployment\n\nThe command-line parameters of the UE-V Agent are as follows.\n\n<table>\n<colgroup>\n<col width=\"33%\" />\n<col width=\"33%\" />\n<col width=\"33%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\"><strong>Command-line parameter</strong></th>\n<th align=\"left\"><strong>Definition</strong></th>\n<th align=\"left\"><strong>Notes</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>/help or /h or /?</p></td>\n<td align=\"left\"><p>Displays the AgentSetup.exe usage dialog box.</p></td>\n<td align=\"left\"><p></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>SettingsStoragePath</p></td>\n<td align=\"left\"><p>Indicates the Universal Naming Convention (UNC) path that defines where settings are stored.</p></td>\n<td align=\"left\"><div class=\"alert\">\n<strong>Important</strong>  \n<p>You must specify a SettingsStoragePath in UE-V 2.1 and UE-V 2.1 SP1. You can set the AdHomePath string to specify that the user's Active Directory home path is used. For example, <code>SettingsStoragePath = \\\\share\\path|AdHomePath</code>.</p>\n<p>In UE-V 2.0, you can leave SettingsStoragePath blank to use the Active Directory home path instead.</p>\n</div>\n<div>\n \n</div>\n<p>%username% or %computername% environment variables are accepted. Scripting can require escaped variables.</p>\n<p><strong>Default</strong>: &lt;none&gt;</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>SettingsStoragePathReg</p></td>\n<td align=\"left\"><p>Gets the SettingsStoragePath value from the registry during installation.</p></td>\n<td align=\"left\"><p>At the command prompt, type the following example to force UE-V to use the Active Directory home path instead of a specific UNC.</p>\n<p><code>msiexec.exe /i AgentSetupx64.msi acceptlicenseterms=true SettingsStoragePathReg=TRUE /quiet /norestart</code></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>SettingsTemplateCatalogPath</p></td>\n<td align=\"left\"><p>Indicates the Universal Naming Convention (UNC) path that defines the location that was checked for new settings location templates.</p></td>\n<td align=\"left\"><p>Only required for custom settings location templates</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>RegisterMSTemplates</p></td>\n<td align=\"left\"><p>Specifies whether the default Microsoft templates should be registered during installation.</p></td>\n<td align=\"left\"><p>True | False</p>\n<p><strong>Default</strong>: True</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>SyncMethod</p></td>\n<td align=\"left\"><p>Specifies which synchronization method should be used.</p></td>\n<td align=\"left\"><p>SyncProvider | None</p>\n<p><strong>Default</strong>: SyncProvider</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>SyncTimeoutInMilliseconds</p></td>\n<td align=\"left\"><p>Specifies the number of milliseconds that the computer waits before time-out when it retrieves user settings from the settings storage location.</p></td>\n<td align=\"left\"><p><strong>Default</strong>: 2000 milliseconds</p>\n<p>(wait up to 2 seconds)</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>SyncEnabled</p></td>\n<td align=\"left\"><p>Specifies whether UE-V synchronization is enabled or disabled.</p></td>\n<td align=\"left\"><p>True | False</p>\n<p><strong>Default</strong>: True</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>MaxPackageSizeInBytes</p></td>\n<td align=\"left\"><p>Specifies a settings package file size in bytes when the UE-V Agent reports that files exceed the threshold.</p></td>\n<td align=\"left\"><p>&lt;size&gt;</p>\n<p><strong>Default</strong>: none (no warning threshold)</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>CEIPEnabled</p></td>\n<td align=\"left\"><p>Specifies the setting for participation in the Customer Experience Improvement program. If set to <strong>True</strong>, installer information is uploaded to the Microsoft Customer Experience Improvement Program site. If set to <strong>False</strong>, no information is uploaded.</p></td>\n<td align=\"left\"><p>True | False</p>\n<p><strong>Default</strong>: False</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>NoRestart</p></td>\n<td align=\"left\"><p>Supports deferral of the restart of the computer after the UE-V Agent is installed.</p></td>\n<td align=\"left\"><p></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>INSTALLFOLDER</p></td>\n<td align=\"left\"><p>Enables a different installation folder to be set for the UE-V Agent or UE-V Generator.</p></td>\n<td align=\"left\"><p></p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>MUENABLED</p></td>\n<td align=\"left\"><p>Enables Setup to accept the option to be included in the Microsoft Update program.</p></td>\n<td align=\"left\"><p></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>ACCEPTLICENSETERMS</p></td>\n<td align=\"left\"><p>Lets UE-V be installed silently. This must be set to <strong>True</strong> to install UE-V silently and bypass the requirement that the user accepts the UE-V license terms. If set to <strong>False</strong> or left empty, the user receives an error message and UE-V is not installed.</p></td>\n<td align=\"left\"><div class=\"alert\">\n<strong>Important</strong>  \n<p>This parameter is required to install UE-V silently.</p>\n</div>\n<div>\n \n</div></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>NORESTART</p></td>\n<td align=\"left\"><p>Prevents a mandatory restart after the UE-V Agent is installed.</p></td>\n<td align=\"left\"><p></p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n### Update the UE-V Agent\n\nUpdates for the UE-V Agent software are provided through Microsoft Update. You can deploy UE-V Agent updates by using Enterprise Software Distribution (ESD) infrastructure systems.\n\nDuring a UE-V Agent upgrade, the default group of settings location templates for common Microsoft applications and Windows settings can be updated.\n\n### Upgrade the UE-V 2.x Agent\n\nThe UE-V 2.x Agent introduces many new features and modifies how and when the agent uploads content to the settings storage share. The upgrade process automates these changes. To upgrade the UE-V Agent, run the UE-V Agent install package (AgentSetup.exe, AgentSetupx86.msi, or AgentSetupx64.msi) on users’ computers.\n\n**Note**  \nWhen you upgrade the UE-V Agent, you must use the same installer type (.exe file or .msi packet) that installed the previous UE-V Agent. For example, use the UE-V 2 AgentSetup.exe to upgrade UE-V 1.0 Agents that were installed by using AgentSetup.exe.\n\n \n\nThe following configurations are preserved when the Agent Setup program runs:\n\n-   Settings storage path\n\n-   Registry settings\n\n-   Scheduled tasks (Interval settings are reset to their defaults)\n\n**Note**  \nA computer with UE-V 2.x settings location templates that are registered in the UE-V 1.0 Agent register errors in the Windows Event Log.\n\n \n\nYou can use Microsoft System Center 2012 Configuration Manager or another enterprise software distribution tool to automate and distribute the UE-V Agent upgrade.\n\n**Recommendations:** We recommend that you upgrade all of the UE-V 1.0 Agents in a computing environment, but it is not required. UE-V 2.x settings location templates can interact with a UE-V 1.0 Agent because they only share the settings from the settings storage path. We recommend, however, that you move the deployments to a single agent version to simplify management and to support UE-V.\n\n### Repair the UE-V Agent after an unsuccessful upgrade\n\nYou might experience errors after you attempt one of the following operations:\n\n-   Upgrade from UE-V 1.0 to UE-V 2\n\n-   Upgrade to a newer version of Windows, for example, from Windows 7 to Windows 8 or from Windows 8 to Windows 8.1.\n\n-   Uninstall the agent after upgrading the UE-V Agent\n\nTo resolve any issues, attempt to repair the UE-V Agent by entering this command at a command prompt on the computer where the agent is installed.\n\n``` syntax\nmsiexec.exe /f \"<path to msi file>\" /quiet /norestart /l*v \"%temp%\\UE-VAgentInstaller.log\n```\n\nYou can then retry the uninstall process or upgrade by installing the newer version of the UE-V Agent.\n\n## Got a suggestion for UE-V?\n\n\nAdd or vote on suggestions [here](http://uev.uservoice.com/forums/280428-microsoft-user-experience-virtualization). For UE-V issues, use the [UE-V TechNet Forum](https://social.technet.microsoft.com/Forums/home?forum=mdopuev).\n\n## Related topics\n\n\n[Prepare a UE-V 2.x Deployment](prepare-a-ue-v-2x-deployment-new-uevv2.md)\n\n[Deploy UE-V 2.x for Custom Applications](deploy-ue-v-2x-for-custom-applications-new-uevv2.md)\n\n \n\n \n\n\n\n\n\n"}