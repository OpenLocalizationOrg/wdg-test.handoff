{"nodes":[{"content":"Update and manage Windows Defender in Windows 10 (Windows 10)","pos":[11,72]},{"content":"IT professionals can manage Windows Defender on Windows 10 endpoints in their organization using Microsoft Active Directory or Windows Server Update Services (WSUS), apply updates to endpoints, and manage scans using Group Policy SettingsWindows Management Instrumentation (WMI)PowerShell.","pos":[86,375]},{"content":"Update and manage Windows Defender in Windows 10","pos":[525,573]},{"content":"Applies to","pos":[577,587]},{"content":"Windows 10","pos":[594,604]},{"content":"IT professionals can manage Windows Defender on Windows 10 endpoints in their organization using Microsoft Active Directory or Windows Server Update Services (WSUS), apply updates to endpoints, and manage scans using:","pos":[606,823]},{"content":"Group Policy Settings","pos":[829,850]},{"content":"Windows Management Instrumentation (WMI)","pos":[855,895]},{"content":"PowerShell","pos":[900,910]},{"content":"Manage Windows Defender endpoints through Active Directory and WSUS","pos":[915,982]},{"content":"All Windows 10 endpoints are installed with Windows Defender and include support for management through:","pos":[984,1088]},{"content":"Active Directory","pos":[1093,1109]},{"content":"WSUS","pos":[1114,1118]},{"content":"You can use the Active Directory to configure the settings; Group policies can be used for centralized configuration and enforcement of many Windows Defender settings including client user interface, scan settings, and exclusions.","pos":[1120,1350]},{"content":"WSUS can be used to view basic update compliance and deploy updates manually or through automatic rules.","pos":[1351,1455]},{"content":"Note that System Center 2012 R2 Configuration Manager SP1, System Center 2012 Configuration Manager SP2, and Microsoft Intune can provide centralized management of Windows Defender, including:","pos":[1457,1649]},{"content":"Settings management","pos":[1655,1674]},{"content":"Definition update management","pos":[1679,1707]},{"content":"Alerts and alert management","pos":[1712,1739]},{"content":"Reports and reporting","pos":[1744,1765]},{"content":"When you enable <bpt id=\"p1\">*</bpt>Endpoint Protection<ept id=\"p1\">*</ept> on your clients, it will install an additional management layer on Windows Defender to manage the in-box Windows Defender agent.","pos":[1767,1933]},{"content":"While the client user interface will still appear as Windows Defender, the management layer for System Center Endpoint Protection or Intune will be listed in the <bpt id=\"p1\">**</bpt>Add/Remove Programs<ept id=\"p1\">**</ept> control panel, though it will appear as if the full product is installed.","pos":[1934,2193]},{"content":"Learn more about managing <bpt id=\"p1\">*</bpt>Endpoint Protection<ept id=\"p1\">*</ept>:","pos":[2194,2242]},{"content":"Help secure Windows PCs with Endpoint Protection for Microsoft Intune","pos":[2249,2318]},{"content":"Endpoint Protection in Configuration Manager","pos":[2378,2422]},{"pos":[2478,2649],"content":"Read more about System Center Configuration Manager in <bpt id=\"p1\">[</bpt>Introduction to Endpoint Protection in Configuration Manager<ept id=\"p1\">](https://technet.microsoft.com/library/hh508781.aspx)</ept>."},{"pos":[2652,2776],"content":"<bpt id=\"p1\">**</bpt>Important:<ept id=\"p1\">**</ept>  You must be licensed to use <bpt id=\"p2\">*</bpt>Endpoint Protection<ept id=\"p2\">*</ept> to manage clients in your Configuration Manager hierarchy."},{"content":"Apply updates to Windows Defender endpoints","pos":[2782,2825]},{"content":"It is important to keep Windows Defender endpoints updated to ensure they are protected.","pos":[2827,2915]},{"content":"All Windows Defender updates, including General Distribution Release (GDR) updates, are now applied as operating system updates.","pos":[2916,3044]},{"content":"You can manage the distribution of updates through the <bpt id=\"p1\">[</bpt>Windows Server Update Services (WSUS)<ept id=\"p1\">](https://technet.microsoft.com/windowsserver/bb332157)</ept>.","pos":[3045,3194]},{"content":"Manage email scans in Windows Defender","pos":[3199,3237]},{"content":"You can use Windows Defender to scan email files.","pos":[3239,3288]},{"content":"Malware can install itself and hide in email files, and although real-time protection offers you the best protection from email malware, you can also scan emails stored on your PC or server with Windows Defender.","pos":[3289,3501]},{"pos":[3504,3601],"content":"<bpt id=\"p1\">**</bpt>Important:<ept id=\"p1\">**</ept>  Mail scanning only applies to on-demand and scheduled scans, not on-access scans."},{"content":"Windows Defender scans Microsoft Office Outlook 2003 and older email files.","pos":[3604,3679]},{"content":"We identify the file type at run-time based on the content of the file, not on location or extension.","pos":[3680,3781]},{"pos":[3784,3869],"content":"<bpt id=\"p1\">**</bpt>Note: <ept id=\"p1\">**</ept>  Scanning email files might increase the time required to complete a scan."},{"content":"Windows Defender can extract embedded objects within a file (attachments and archived files, for example) and scan internally.","pos":[3872,3998]},{"pos":[4001,4147],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  While Windows Defender can be configured to scan email files, it can only remediate threats detected inside certain files, for example:"},{"content":"DBX","pos":[4152,4155]},{"content":"MBX","pos":[4160,4163]},{"content":"MIME","pos":[4168,4172]},{"content":"You can configure Windows Defender to scan PST files used by Outlook 2003 or older versions (where the archive type is set to non-uni-code), but Windows Defender cannot remediate threats detected inside PST files.","pos":[4175,4388]},{"content":"We recommend using real-time protection to protect against email malware.","pos":[4389,4462]},{"content":"If Windows Defender detects a threat inside an email, it will show you the following information to assist you in identifying the compromised email, so you can remediate the threat:","pos":[4464,4645]},{"content":"Email subject","pos":[4650,4663]},{"content":"Attachment name Email scanning in Windows Defender is turned off by default.","pos":[4668,4744]},{"content":"There are three ways you can manage scans through Windows Defender:","pos":[4745,4812]},{"pos":[4817,4840],"content":"<bpt id=\"p1\">*</bpt>Group Policy<ept id=\"p1\">*</ept> settings"},{"content":"WMI","pos":[4845,4848]},{"content":"PowerShell","pos":[4853,4863]},{"content":"<bpt id=\"p1\">**</bpt>Important:<ept id=\"p1\">**</ept>  There are some risks associated with scanning some Microsoft Outlook files and email messages.","pos":[4866,4976]},{"content":"You can read about tips and risks associated with scanning Outlook files and email messages in the following articles:","pos":[4977,5095]},{"content":"Scanning Outlook files in Outlook 2013","pos":[5101,5139]},{"content":"Scanning email messages in Outlook 2013","pos":[5206,5245]},{"pos":[5312,5361],"content":"Use <bpt id=\"p1\">*</bpt>Group Policy<ept id=\"p1\">*</ept> settings to enable email scans"},{"content":"This policy setting allows you to turn on email scanning.","pos":[5363,5420]},{"content":"When email scanning is enabled, the engine will parse the mailbox and mail files to analyze the mail bodies and attachments.","pos":[5421,5545]},{"pos":[5547,5613],"content":"Turn on email scanning with the following <bpt id=\"p1\">*</bpt>Group Policy<ept id=\"p1\">*</ept> settings:"},{"pos":[5618,5651],"content":"Open the <bpt id=\"p1\">**</bpt>Group Policy Editor<ept id=\"p1\">**</ept>."},{"pos":[5656,5820],"content":"In the <bpt id=\"p1\">**</bpt>Local Computer Policy<ept id=\"p1\">**</ept> tree, expand <bpt id=\"p2\">**</bpt>Computer Configuration<ept id=\"p2\">**</ept>, then <bpt id=\"p3\">**</bpt>Administrative Templates<ept id=\"p3\">**</ept>, then <bpt id=\"p4\">**</bpt>Windows Components<ept id=\"p4\">**</ept>, then <bpt id=\"p5\">**</bpt>Windows Defender<ept id=\"p5\">**</ept>."},{"pos":[5825,5840],"content":"Click <bpt id=\"p1\">**</bpt>Scan<ept id=\"p1\">**</ept>."},{"pos":[5845,5886],"content":"Double-click <bpt id=\"p1\">**</bpt>Turn on e-mail scanning<ept id=\"p1\">**</ept>."},{"pos":[5892,5946],"content":"This will open the <bpt id=\"p1\">**</bpt>Turn on e-mail scanning<ept id=\"p1\">**</ept> window:"},{"content":"turn on e-mail scanning window","pos":[5958,5988]},{"pos":[6035,6054],"content":"Select <bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>."},{"pos":[6059,6089],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to apply changes."},{"content":"Use WMI to disable email scans","pos":[6094,6124]},{"content":"You can write a WMI script or application to disable email scanning.","pos":[6126,6194]},{"content":"Read more about <bpt id=\"p1\">[</bpt>WMI in this article<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/dn439477.aspx)</ept>, and read about <bpt id=\"p2\">[</bpt>Windows Preference classes in this article<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/desktop/dn455323.aspx)</ept>.","pos":[6195,6426]},{"pos":[6428,6678],"content":"Use the <bpt id=\"p1\">**</bpt>DisableEmailScanning<ept id=\"p1\">**</ept> property of the <bpt id=\"p2\">**</bpt>MSFT<ph id=\"ph1\">\\_</ph>MpPreference<ept id=\"p2\">**</ept> class (part of the Windows DefenderWMI provider) to enable or disable this setting: <bpt id=\"p3\">**</bpt>DisableEmailScanning<ept id=\"p3\">**</ept> Data type: <bpt id=\"p4\">**</bpt>boolean<ept id=\"p4\">**</ept> Access type: Read-only Disable email scanning."},{"content":"Use PowerShell to enable email scans","pos":[6683,6719]},{"content":"You can also enable email scanning using the following PowerShell parameter:","pos":[6721,6797]},{"content":"Open PowerShell or PowerShellIntegrated Scripting Environment (ISE).","pos":[6802,6870]},{"pos":[6875,6930],"content":"Type <bpt id=\"p1\">**</bpt>Set-MpPreference -DisableEmailScanning $false<ept id=\"p1\">**</ept>."},{"content":"Read more about this in:","pos":[6932,6956]},{"pos":[6961,7051],"content":"• <bpt id=\"p1\">[</bpt>Scripting with Windows PowerShell<ept id=\"p1\">](https://technet.microsoft.com/library/bb978526.aspx)</ept>"},{"pos":[7056,7129],"content":"• <bpt id=\"p1\">[</bpt>Defender Cmdlets<ept id=\"p1\">](https://technet.microsoft.com/library/dn433280.aspx)</ept>"},{"content":"Manage archive scans in Windows Defender","pos":[7134,7174]},{"content":"You can use Windows Defender to scan archive files.","pos":[7176,7227]},{"content":"Malware can install itself and hide in archive files, and although real-time protection offers you the best protection from malware, you can also scan archives stored on your PC or server with Windows Defender.","pos":[7228,7438]},{"pos":[7441,7541],"content":"<bpt id=\"p1\">**</bpt>Important:<ept id=\"p1\">**</ept>  Archive scanning only applies to on-demand and scheduled scans, not on-access scans."},{"content":"Archive scanning in Windows Defender is turned on by default.","pos":[7544,7605]},{"content":"There are four ways you can manage scans through Windows Defender:","pos":[7606,7672]},{"pos":[7677,7700],"content":"<bpt id=\"p1\">*</bpt>Group Policy<ept id=\"p1\">*</ept> settings"},{"content":"WMI","pos":[7705,7708]},{"content":"PowerShell","pos":[7713,7723]},{"content":"Endpoint Protection","pos":[7728,7747]},{"pos":[7750,7836],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  Scanning archive files might increase the time required to complete a scan."},{"content":"If you exclude an archive file type by using the <bpt id=\"p1\">**</bpt>Extensions<ept id=\"p1\">**</ept> box, Windows Defender will not scan files with that extension (no matter what the content is), even when you have selected the <bpt id=\"p2\">**</bpt>Scan archive files<ept id=\"p2\">**</ept> check box.","pos":[7839,8063]},{"content":"For example, if you exclude .rar files but there’s a .r00 file that’s actually .rar content, it will still be scanned if archive scanning is enabled.","pos":[8064,8213]},{"pos":[8218,8269],"content":"Use <bpt id=\"p1\">*</bpt>Group Policy<ept id=\"p1\">*</ept> settings to enable archive scans"},{"content":"This policy setting allows you to turn on archive scanning.","pos":[8271,8330]},{"pos":[8332,8398],"content":"Turn on email scanning with the following <bpt id=\"p1\">*</bpt>Group Policy<ept id=\"p1\">*</ept> settings:"},{"pos":[8403,8436],"content":"Open the <bpt id=\"p1\">**</bpt>Group Policy Editor<ept id=\"p1\">**</ept>."},{"pos":[8441,8605],"content":"In the <bpt id=\"p1\">**</bpt>Local Computer Policy<ept id=\"p1\">**</ept> tree, expand <bpt id=\"p2\">**</bpt>Computer Configuration<ept id=\"p2\">**</ept>, then <bpt id=\"p3\">**</bpt>Administrative Templates<ept id=\"p3\">**</ept>, then <bpt id=\"p4\">**</bpt>Windows Components<ept id=\"p4\">**</ept>, then <bpt id=\"p5\">**</bpt>Windows Defender<ept id=\"p5\">**</ept>."},{"pos":[8610,8625],"content":"Click <bpt id=\"p1\">**</bpt>Scan<ept id=\"p1\">**</ept>."},{"pos":[8630,8666],"content":"Double-click <bpt id=\"p1\">**</bpt>Scan archive files<ept id=\"p1\">**</ept>."},{"pos":[8672,8721],"content":"This will open the <bpt id=\"p1\">**</bpt>Scan archive files<ept id=\"p1\">**</ept> window:"},{"content":"scan archive files window","pos":[8733,8758]},{"pos":[8807,8826],"content":"Select <bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>."},{"pos":[8831,8861],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept> to apply changes."},{"pos":[8863,8988],"content":"There are a number of archive scan settings in the <bpt id=\"p1\">**</bpt>Scan<ept id=\"p1\">**</ept> repository you can configure through <bpt id=\"p2\">*</bpt>Group Policy<ept id=\"p2\">*</ept>, for example:"},{"content":"Maximum directory depth level into which archive files are unpacked during scanning","pos":[8993,9076]},{"content":"specify the maximum depth to scan archive files window","pos":[9084,9138]},{"content":"Maximum size of archive files that will be scanned","pos":[9187,9237]},{"content":"specify the maximum size of archive files to be scanned window","pos":[9245,9307]},{"content":"Maximum percentage CPU utilization permitted during a scan","pos":[9355,9413]},{"content":"specify the maximum percentage od cpu utilization during a scan window","pos":[9421,9491]},{"content":"Use WMI to disable archive scans","pos":[9533,9565]},{"content":"You can write a WMI script or application to disable archive scanning.","pos":[9567,9637]},{"content":"Read more about <bpt id=\"p1\">[</bpt>WMI in this article<ept id=\"p1\">](https://msdn.microsoft.com/library/windows/desktop/dn439477.aspx)</ept>, and read about <bpt id=\"p2\">[</bpt>Windows Preference classes in this article<ept id=\"p2\">](https://msdn.microsoft.com/library/windows/desktop/dn455323.aspx)</ept>.","pos":[9638,9869]},{"pos":[9871,10127],"content":"Use the <bpt id=\"p1\">**</bpt>DisableArchiveScanning<ept id=\"p1\">**</ept> property of the <bpt id=\"p2\">**</bpt>MSFT<ph id=\"ph1\">\\_</ph>MpPreference<ept id=\"p2\">**</ept> class (part of the Windows DefenderWMI provider) to enable or disable this setting: <bpt id=\"p3\">**</bpt>DisableArchiveScanning<ept id=\"p3\">**</ept> Data type: <bpt id=\"p4\">**</bpt>boolean<ept id=\"p4\">**</ept> Access type: Read-only Disable archive scanning."},{"content":"Use PowerShell to enable archive scans","pos":[10132,10170]},{"content":"You can also enable archive scanning using the following PowerShell parameter:","pos":[10172,10250]},{"content":"Open PowerShell or PowerShellISE.","pos":[10255,10288]},{"pos":[10293,10350],"content":"Type <bpt id=\"p1\">**</bpt>Set-MpPreference -DisableArchiveScanning $false<ept id=\"p1\">**</ept>."},{"content":"Read more about this in:","pos":[10352,10376]},{"content":"Scripting with Windows PowerShell","pos":[10382,10415]},{"content":"Defender Cmdlets","pos":[10475,10491]},{"content":"Use Endpoint Protection to configure archive scans","pos":[10550,10600]},{"content":"In Endpoint Protection, you can use the advanced scanning options to configure archive scanning.","pos":[10602,10698]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>What are advanced scanning options?<ept id=\"p1\">](https://technet.microsoft.com/library/ff823807.aspx)</ept>","pos":[10699,10815]},{"content":"Related topics","pos":[10820,10834]},{"pos":[10836,11017],"content":"<bpt id=\"p1\">[</bpt>Configure Windows Defender in Windows 10<ept id=\"p1\">](configure-windows-defender-in-windows-10.md)</ept><ph id=\"ph1\">\n</ph><bpt id=\"p2\">[</bpt>Troubleshoot Windows Defender in Windows 10<ept id=\"p2\">](troubleshoot-windows-defender-in-windows-10.md)</ept>"}],"content":"---\ntitle: Update and manage Windows Defender in Windows 10 (Windows 10)\ndescription: IT professionals can manage Windows Defender on Windows 10 endpoints in their organization using Microsoft Active Directory or Windows Server Update Services (WSUS), apply updates to endpoints, and manage scans using Group Policy SettingsWindows Management Instrumentation (WMI)PowerShell.\nms.assetid: 045F5BF2-87D7-4522-97E1-C1D508E063A7\nms.prod: w10\nms.mktglfcycl: manage\nms.sitesec: library\nms.pagetype: security\nauthor: jasesso\n---\n\n# Update and manage Windows Defender in Windows 10\n\n**Applies to**\n-   Windows 10\n\nIT professionals can manage Windows Defender on Windows 10 endpoints in their organization using Microsoft Active Directory or Windows Server Update Services (WSUS), apply updates to endpoints, and manage scans using:\n\n-   Group Policy Settings\n-   Windows Management Instrumentation (WMI)\n-   PowerShell\n\n## Manage Windows Defender endpoints through Active Directory and WSUS\n\nAll Windows 10 endpoints are installed with Windows Defender and include support for management through:\n-   Active Directory\n-   WSUS\n\nYou can use the Active Directory to configure the settings; Group policies can be used for centralized configuration and enforcement of many Windows Defender settings including client user interface, scan settings, and exclusions.\nWSUS can be used to view basic update compliance and deploy updates manually or through automatic rules.\n\nNote that System Center 2012 R2 Configuration Manager SP1, System Center 2012 Configuration Manager SP2, and Microsoft Intune can provide centralized management of Windows Defender, including:\n\n-   Settings management\n-   Definition update management\n-   Alerts and alert management\n-   Reports and reporting\n\nWhen you enable *Endpoint Protection* on your clients, it will install an additional management layer on Windows Defender to manage the in-box Windows Defender agent. While the client user interface will still appear as Windows Defender, the management layer for System Center Endpoint Protection or Intune will be listed in the **Add/Remove Programs** control panel, though it will appear as if the full product is installed. Learn more about managing *Endpoint Protection*:\n\n-   [Help secure Windows PCs with Endpoint Protection for Microsoft Intune](https://technet.microsoft.com/library/dn646970.aspx)\n-   [Endpoint Protection in Configuration Manager](https://technet.microsoft.com/library/hh508760.aspx)\n\nRead more about System Center Configuration Manager in [Introduction to Endpoint Protection in Configuration Manager](https://technet.microsoft.com/library/hh508781.aspx).\n> **Important:**  You must be licensed to use *Endpoint Protection* to manage clients in your Configuration Manager hierarchy.\n \n## Apply updates to Windows Defender endpoints\n\nIt is important to keep Windows Defender endpoints updated to ensure they are protected. All Windows Defender updates, including General Distribution Release (GDR) updates, are now applied as operating system updates.\nYou can manage the distribution of updates through the [Windows Server Update Services (WSUS)](https://technet.microsoft.com/windowsserver/bb332157).\n\n## Manage email scans in Windows Defender\n\nYou can use Windows Defender to scan email files. Malware can install itself and hide in email files, and although real-time protection offers you the best protection from email malware, you can also scan emails stored on your PC or server with Windows Defender.\n> **Important:**  Mail scanning only applies to on-demand and scheduled scans, not on-access scans.\n \nWindows Defender scans Microsoft Office Outlook 2003 and older email files. We identify the file type at run-time based on the content of the file, not on location or extension.\n> **Note: **  Scanning email files might increase the time required to complete a scan.\n \nWindows Defender can extract embedded objects within a file (attachments and archived files, for example) and scan internally.\n> **Note:**  While Windows Defender can be configured to scan email files, it can only remediate threats detected inside certain files, for example:\n-   DBX\n-   MBX\n-   MIME\n \nYou can configure Windows Defender to scan PST files used by Outlook 2003 or older versions (where the archive type is set to non-uni-code), but Windows Defender cannot remediate threats detected inside PST files. We recommend using real-time protection to protect against email malware.\n\nIf Windows Defender detects a threat inside an email, it will show you the following information to assist you in identifying the compromised email, so you can remediate the threat:\n-   Email subject\n-   Attachment name\nEmail scanning in Windows Defender is turned off by default. There are three ways you can manage scans through Windows Defender:\n-   *Group Policy* settings\n-   WMI\n-   PowerShell\n> **Important:**  There are some risks associated with scanning some Microsoft Outlook files and email messages. You can read about tips and risks associated with scanning Outlook files and email messages in the following articles:\n-   [Scanning Outlook files in Outlook 2013](https://technet.microsoft.com/library/dn769141.aspx#bkmk-1)\n-   [Scanning email messages in Outlook 2013](https://technet.microsoft.com/library/dn769141.aspx#bkmk-2)\n \n## Use *Group Policy* settings to enable email scans\n\nThis policy setting allows you to turn on email scanning. When email scanning is enabled, the engine will parse the mailbox and mail files to analyze the mail bodies and attachments.\n\nTurn on email scanning with the following *Group Policy* settings:\n1.  Open the **Group Policy Editor**.\n2.  In the **Local Computer Policy** tree, expand **Computer Configuration**, then **Administrative Templates**, then **Windows Components**, then **Windows Defender**.\n3.  Click **Scan**.\n4.  Double-click **Turn on e-mail scanning**.\n\n    This will open the **Turn on e-mail scanning** window:\n    \n    ![turn on e-mail scanning window](images/defender-scanemailfiles.png)\n    \n5.  Select **Enabled**.\n6.  Click **OK** to apply changes.\n\n## Use WMI to disable email scans\n\nYou can write a WMI script or application to disable email scanning. Read more about [WMI in this article](https://msdn.microsoft.com/library/windows/desktop/dn439477.aspx), and read about [Windows Preference classes in this article](https://msdn.microsoft.com/library/windows/desktop/dn455323.aspx).\n\nUse the **DisableEmailScanning** property of the **MSFT\\_MpPreference** class (part of the Windows DefenderWMI provider) to enable or disable this setting:\n**DisableEmailScanning**\nData type: **boolean**\nAccess type: Read-only\nDisable email scanning.\n\n## Use PowerShell to enable email scans\n\nYou can also enable email scanning using the following PowerShell parameter:\n1.  Open PowerShell or PowerShellIntegrated Scripting Environment (ISE).\n2.  Type **Set-MpPreference -DisableEmailScanning $false**.\n\nRead more about this in:\n-   • [Scripting with Windows PowerShell](https://technet.microsoft.com/library/bb978526.aspx)\n-   • [Defender Cmdlets](https://technet.microsoft.com/library/dn433280.aspx)\n\n## Manage archive scans in Windows Defender\n\nYou can use Windows Defender to scan archive files. Malware can install itself and hide in archive files, and although real-time protection offers you the best protection from malware, you can also scan archives stored on your PC or server with Windows Defender.\n> **Important:**  Archive scanning only applies to on-demand and scheduled scans, not on-access scans.\n \nArchive scanning in Windows Defender is turned on by default. There are four ways you can manage scans through Windows Defender:\n-   *Group Policy* settings\n-   WMI\n-   PowerShell\n-   Endpoint Protection\n> **Note:**  Scanning archive files might increase the time required to complete a scan.\n \nIf you exclude an archive file type by using the **Extensions** box, Windows Defender will not scan files with that extension (no matter what the content is), even when you have selected the **Scan archive files** check box. For example, if you exclude .rar files but there’s a .r00 file that’s actually .rar content, it will still be scanned if archive scanning is enabled.\n\n## Use *Group Policy* settings to enable archive scans\n\nThis policy setting allows you to turn on archive scanning.\n\nTurn on email scanning with the following *Group Policy* settings:\n1.  Open the **Group Policy Editor**.\n2.  In the **Local Computer Policy** tree, expand **Computer Configuration**, then **Administrative Templates**, then **Windows Components**, then **Windows Defender**.\n3.  Click **Scan**.\n4.  Double-click **Scan archive files**.\n\n    This will open the **Scan archive files** window:\n    \n    ![scan archive files window](images/defender-scanarchivefiles.png)\n    \n5.  Select **Enabled**.\n6.  Click **OK** to apply changes.\n\nThere are a number of archive scan settings in the **Scan** repository you can configure through *Group Policy*, for example:\n-   Maximum directory depth level into which archive files are unpacked during scanning\n\n    ![specify the maximum depth to scan archive files window](images/defender-scanarchivedepth.png)\n    \n-   Maximum size of archive files that will be scanned\n\n    ![specify the maximum size of archive files to be scanned window](images/defender-scanarchivesize.png)\n    \n-   Maximum percentage CPU utilization permitted during a scan\n\n    ![specify the maximum percentage od cpu utilization during a scan window](images/defender-scanarchivecpu.png)\n\n## Use WMI to disable archive scans\n\nYou can write a WMI script or application to disable archive scanning. Read more about [WMI in this article](https://msdn.microsoft.com/library/windows/desktop/dn439477.aspx), and read about [Windows Preference classes in this article](https://msdn.microsoft.com/library/windows/desktop/dn455323.aspx).\n\nUse the **DisableArchiveScanning** property of the **MSFT\\_MpPreference** class (part of the Windows DefenderWMI provider) to enable or disable this setting:\n**DisableArchiveScanning**\nData type: **boolean**\nAccess type: Read-only\nDisable archive scanning.\n\n## Use PowerShell to enable archive scans\n\nYou can also enable archive scanning using the following PowerShell parameter:\n1.  Open PowerShell or PowerShellISE.\n2.  Type **Set-MpPreference -DisableArchiveScanning $false**.\n\nRead more about this in:\n-   [Scripting with Windows PowerShell](https://technet.microsoft.com/library/bb978526.aspx)\n-   [Defender Cmdlets](https://technet.microsoft.com/library/dn433280.aspx)\n\n## Use Endpoint Protection to configure archive scans\n\nIn Endpoint Protection, you can use the advanced scanning options to configure archive scanning. For more information, see [What are advanced scanning options?](https://technet.microsoft.com/library/ff823807.aspx)\n\n## Related topics\n\n[Configure Windows Defender in Windows 10](configure-windows-defender-in-windows-10.md)\n[Troubleshoot Windows Defender in Windows 10](troubleshoot-windows-defender-in-windows-10.md)\n \n \n"}