{"nodes":[{"content":"Deploy a Windows 10 image using MDT 2013 Update 2 (Windows 10)","pos":[11,73]},{"content":"This topic will show you how to take your reference image for Windows 10, and deploy that image to your environment using the Microsoft Deployment Toolkit (MDT), and MDT 2013 Update 2 specifically.","pos":[87,284]},{"content":"Deploy a Windows 10 image using MDT 2013 Update 2","pos":[480,529]},{"content":"Applies to","pos":[533,543]},{"content":"Windows 10","pos":[550,560]},{"content":"This topic will show you how to take your reference image for Windows 10, and deploy that image to your environment using the Microsoft Deployment Toolkit (MDT), and MDT 2013 Update 2 specifically.","pos":[562,759]},{"content":"You will prepare for this by creating a MDT deployment share that is used solely for image deployment.","pos":[760,862]},{"content":"Separating the processes of creating reference images from the processes used to deploy them in production allows greater control of on both processes.","pos":[863,1014]},{"content":"You will then configure the deployment share, create a new task sequence, add applications, add drivers, add rules, and configure Active Directory permissions for deployment.","pos":[1015,1189]},{"content":"For the purposes of this topic, we will use three machines: DC01, MDT01, and PC0005.","pos":[1191,1275]},{"content":"DC01 is a domain controller, MDT01 is a Windows Server 2012 R2 standard server, and PC0005 is a blank machine to which you deploy Windows 10.","pos":[1276,1417]},{"content":"MDT01 and PC0005 are members of the domain contoso.com for the fictitious Contoso Corporation.","pos":[1418,1512]},{"content":"Note","pos":[1516,1520]},{"content":"For important details about the setup for the steps outlined in this article, please see <bpt id=\"p1\">[</bpt>Deploy Windows 10 with the Microsoft Deployment Toolkit<ept id=\"p1\">](deploy-windows-10-with-the-microsoft-deployment-toolkit.md)</ept>.","pos":[1525,1732]},{"content":"figure 1","pos":[1737,1745]},{"content":"Figure 1.","pos":[1773,1782]},{"content":"The machines used in this topic.","pos":[1783,1815]},{"pos":[1846,1892],"content":"Step 1: Configure Active Directory permissions"},{"content":"These steps will show you how to configure an Active Directory account with the permissions required to deploy a Windows 10 machine to the domain using MDT.","pos":[1894,2050]},{"content":"These steps assume you have downloaded the sample <bpt id=\"p1\">[</bpt>Set-OUPermissions.ps1 script<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619362)</ept> and copied it to C:<ph id=\"ph1\">\\\\</ph>Setup<ph id=\"ph2\">\\\\</ph>Scripts on DC01.","pos":[2051,2225]},{"content":"The account is used for Windows Preinstallation Environment (Windows PE) to connect to MDT01.","pos":[2226,2319]},{"content":"In order for MDT to join machines into the contoso.com domain you need to create an account and configure permissions in Active Directory.","pos":[2320,2458]},{"pos":[2463,2570],"content":"On DC01, using Active Directory User and Computers, browse to <bpt id=\"p1\">**</bpt>contoso.com / Contoso / Service Accounts<ept id=\"p1\">**</ept>."},{"pos":[2575,2692],"content":"Select the <bpt id=\"p1\">**</bpt>Service Accounts<ept id=\"p1\">**</ept> organizational unit (OU) and create the MDT<ph id=\"ph1\">\\_</ph>JD account using the following settings:"},{"content":"Name: MDT<ph id=\"ph1\">\\_</ph>JD","pos":[2701,2714]},{"content":"User logon name: MDT<ph id=\"ph1\">\\_</ph>JD","pos":[2723,2747]},{"content":"Password: P@ssw0rd","pos":[2756,2774]},{"content":"User must change password at next logon: Clear","pos":[2783,2829]},{"content":"User cannot change password: Select","pos":[2838,2873]},{"content":"Password never expires: Select","pos":[2882,2912]},{"pos":[2917,3048],"content":"In an elevated Windows PowerShell prompt (run as Administrator), run the following commands and press <bpt id=\"p1\">**</bpt>Enter<ept id=\"p1\">**</ept> after each command:"},{"content":"The Set-OUPermissions.ps1 script allows the MDT<ph id=\"ph1\">\\_</ph>JD user account permissions to manage computer accounts in the Contoso / Computers OU.","pos":[3272,3407]},{"content":"Below you find a list of the permissions being granted:","pos":[3408,3463]},{"content":"Scope: This object and all descendant objects","pos":[3472,3517]},{"content":"Create Computer objects","pos":[3530,3553]},{"content":"Delete Computer objects","pos":[3566,3589]},{"content":"Scope: Descendant Computer objects","pos":[3598,3632]},{"content":"Read All Properties","pos":[3645,3664]},{"content":"Write All Properties","pos":[3677,3697]},{"content":"Read Permissions","pos":[3710,3726]},{"content":"Modify Permissions","pos":[3739,3757]},{"content":"Change Password","pos":[3770,3785]},{"content":"Reset Password","pos":[3798,3812]},{"content":"Validated write to DNS host name","pos":[3825,3857]},{"content":"Validated write to service principal name","pos":[3870,3911]},{"pos":[3942,3992],"content":"Step 2: Set up the MDT production deployment share"},{"content":"When you are ready to deploy Windows 10 in a production environment, you will first create a new MDT deployment share.","pos":[3994,4112]},{"content":"You should not use the same deployment share that you used to create the reference image for a production deployment.","pos":[4113,4230]},{"content":"For guidance on creating a custom Windows 10 image, see <bpt id=\"p1\">[</bpt>Create a Windows 10 reference image<ept id=\"p1\">](create-a-windows-10-reference-image.md)</ept>.","pos":[4231,4366]},{"content":"Create the MDT production deployment share","pos":[4372,4414]},{"content":"The steps for creating the deployment share for production are the same as when you created the deployment share for creating the custom reference image:","pos":[4416,4569]},{"pos":[4574,4663],"content":"On MDT01, log on as Administrator in the CONTOSO domain using a password of <bpt id=\"p1\">**</bpt>P@ssw0rd.<ept id=\"p1\">**</ept>"},{"pos":[4668,4770],"content":"Using the Deployment Workbench, right-click <bpt id=\"p1\">**</bpt>Deployment Shares<ept id=\"p1\">**</ept> and select <bpt id=\"p2\">**</bpt>New Deployment Share<ept id=\"p2\">**</ept>."},{"pos":[4775,4886],"content":"On the <bpt id=\"p1\">**</bpt>Path<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Deployment share path<ept id=\"p2\">**</ept> text box, type <bpt id=\"p3\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>MDTProduction<ept id=\"p3\">**</ept> and click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>."},{"pos":[4891,4989],"content":"On the <bpt id=\"p1\">**</bpt>Share<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Share name<ept id=\"p2\">**</ept> text box, type <bpt id=\"p3\">**</bpt>MDTProduction$<ept id=\"p3\">**</ept> and click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>."},{"pos":[4994,5121],"content":"On the <bpt id=\"p1\">**</bpt>Descriptive Name<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Deployment share description<ept id=\"p2\">**</ept> text box, type <bpt id=\"p3\">**</bpt>MDT Production<ept id=\"p3\">**</ept> and click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>."},{"pos":[5126,5231],"content":"On the <bpt id=\"p1\">**</bpt>Options<ept id=\"p1\">**</ept> page, accept the default settings and click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> twice, and then click <bpt id=\"p3\">**</bpt>Finish<ept id=\"p3\">**</ept>."},{"pos":[5236,5324],"content":"Using File Explorer, verify that you can access the <bpt id=\"p1\">**</bpt><ph id=\"ph1\">\\\\\\\\</ph>MDT01<ph id=\"ph2\">\\\\</ph>MDTProduction$<ept id=\"p1\">**</ept> share."},{"pos":[5355,5381],"content":"Step 3: Add a custom image"},{"content":"The next step is to add a reference image into the deployment share with the setup files required to successfully deploy Windows 10.","pos":[5383,5515]},{"content":"When adding a custom image, you still need to copy setup files (an option in the wizard) because Windows 10 stores additional components in the Sources<ph id=\"ph1\">\\\\</ph>SxS folder which is outside the image and may be required when installing components.","pos":[5516,5754]},{"content":"Add the Windows 10 Enterprise x64 RTM custom image","pos":[5760,5810]},{"pos":[5812,6054],"content":"In these steps, we assume that you have completed the steps in the <bpt id=\"p1\">[</bpt>Create a Windows 10 reference image<ept id=\"p1\">](create-a-windows-10-reference-image.md)</ept> topic, so you have a Windows 10 reference image in the E:<ph id=\"ph1\">\\\\</ph>MDTBuildLab<ph id=\"ph2\">\\\\</ph>Captures folder on MDT01."},{"pos":[6059,6246],"content":"Using the Deployment Workbench, expand the <bpt id=\"p1\">**</bpt>Deployment Shares<ept id=\"p1\">**</ept> node, and then expand <bpt id=\"p2\">**</bpt>MDT Production<ept id=\"p2\">**</ept>; select the <bpt id=\"p3\">**</bpt>Operating Systems<ept id=\"p3\">**</ept> node, and create a folder named <bpt id=\"p4\">**</bpt>Windows 10<ept id=\"p4\">**</ept>."},{"pos":[6251,6328],"content":"Right-click the <bpt id=\"p1\">**</bpt>Windows 10<ept id=\"p1\">**</ept> folder and select <bpt id=\"p2\">**</bpt>Import Operating System<ept id=\"p2\">**</ept>."},{"pos":[6333,6406],"content":"On the <bpt id=\"p1\">**</bpt>OS Type<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>Custom image file<ept id=\"p2\">**</ept> and click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"pos":[6411,6545],"content":"On the <bpt id=\"p1\">**</bpt>Image<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Source file<ept id=\"p2\">**</ept> text box, browse to <bpt id=\"p3\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>MDTBuildLab<ph id=\"ph2\">\\\\</ph>Captures<ph id=\"ph3\">\\\\</ph>REFW10X64-001.wim<ept id=\"p3\">**</ept> and click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>."},{"pos":[6550,6805],"content":"On the <bpt id=\"p1\">**</bpt>Setup<ept id=\"p1\">**</ept> page, select the <bpt id=\"p2\">**</bpt>Copy Windows 7, Windows Server 2008 R2, or later setup files from the specified path<ept id=\"p2\">**</ept> option; in the <bpt id=\"p3\">**</bpt>Setup source directory<ept id=\"p3\">**</ept> text box, browse to <bpt id=\"p4\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>MDTBuildLab<ph id=\"ph2\">\\\\</ph>Operating Systems<ph id=\"ph3\">\\\\</ph>W10EX64RTM<ept id=\"p4\">**</ept> and click <bpt id=\"p5\">**</bpt>Next<ept id=\"p5\">**</ept>."},{"pos":[6810,6956],"content":"On the <bpt id=\"p1\">**</bpt>Destination<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Destination directory name<ept id=\"p2\">**</ept> text box, type <bpt id=\"p3\">**</bpt>W10EX64RTM<ept id=\"p3\">**</ept>, click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept> twice, and then click <bpt id=\"p5\">**</bpt>Finish<ept id=\"p5\">**</ept>."},{"pos":[6961,7179],"content":"After adding the operating system, double-click the added operating system name in the <bpt id=\"p1\">**</bpt>Operating Systems / Windows 10<ept id=\"p1\">**</ept> node and change the name to match the following: <bpt id=\"p2\">**</bpt>Windows 10 Enterprise x64 RTM Custom Image<ept id=\"p2\">**</ept>."},{"content":"Note","pos":[7183,7187]},{"content":"The reason for adding the setup files has changed since earlier versions of MDT.","pos":[7192,7272]},{"content":"MDT 2010 used the setup files to install Windows.","pos":[7273,7322]},{"content":"MDT uses DISM to apply the image; however, you still need the setup files because some components in roles and features are stored outside the main image.","pos":[7323,7477]},{"content":"figure 2","pos":[7482,7490]},{"content":"Figure 2.","pos":[7521,7530]},{"content":"The imported operating system after renaming it.","pos":[7531,7579]},{"pos":[7610,7636],"content":"Step 4: Add an application"},{"content":"When you configure your MDT Build Lab deployment share, you will also add any applications to the new deployment share before creating your task sequence.","pos":[7638,7792]},{"content":"This section walks you through the process of adding an application to the MDT Production deployment share using Adobe Reader as an example.","pos":[7793,7933]},{"content":"Create the install: Adobe Reader XI x86","pos":[7939,7978]},{"content":"In this example, we assume that you have downloaded the Adobe Reader XI installation file (AdbeRdr11000<ph id=\"ph1\">\\_</ph>eu<ph id=\"ph2\">\\_</ph>ES.msi) to E:<ph id=\"ph3\">\\\\</ph>Setup<ph id=\"ph4\">\\\\</ph>Adobe Reader on MDT01.","pos":[7980,8133]},{"pos":[8138,8247],"content":"Using the Deployment Workbench, expand the <bpt id=\"p1\">**</bpt>MDT Production<ept id=\"p1\">**</ept> node and navigate to the <bpt id=\"p2\">**</bpt>Applications<ept id=\"p2\">**</ept> node."},{"pos":[8252,8331],"content":"Right-click the <bpt id=\"p1\">**</bpt>Applications<ept id=\"p1\">**</ept> node, and create a new folder named <bpt id=\"p2\">**</bpt>Adobe<ept id=\"p2\">**</ept>."},{"pos":[8336,8430],"content":"In the <bpt id=\"p1\">**</bpt>Applications<ept id=\"p1\">**</ept> node, right-click the <bpt id=\"p2\">**</bpt>Adobe<ept id=\"p2\">**</ept> folder and select <bpt id=\"p3\">**</bpt>New Application<ept id=\"p3\">**</ept>."},{"pos":[8435,8540],"content":"On the <bpt id=\"p1\">**</bpt>Application Type<ept id=\"p1\">**</ept> page, select the <bpt id=\"p2\">**</bpt>Application with source files<ept id=\"p2\">**</ept> option and click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"pos":[8545,8668],"content":"On the <bpt id=\"p1\">**</bpt>Details<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Application<ept id=\"p2\">**</ept> name text box, type <bpt id=\"p3\">**</bpt>Install - Adobe Reader XI - x86<ept id=\"p3\">**</ept> and click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>."},{"pos":[8673,8795],"content":"On the <bpt id=\"p1\">**</bpt>Source<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Source Directory<ept id=\"p2\">**</ept> text box, browse to <bpt id=\"p3\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>Setup<ph id=\"ph2\">\\\\</ph>Adobe Reader XI<ept id=\"p3\">**</ept> and click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>."},{"pos":[8800,8967],"content":"On the <bpt id=\"p1\">**</bpt>Destination<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Specify the name of the directory that should be created<ept id=\"p2\">**</ept> text box, type <bpt id=\"p3\">**</bpt>Install - Adobe Reader XI - x86<ept id=\"p3\">**</ept> and click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>."},{"pos":[8972,9136],"content":"On the <bpt id=\"p1\">**</bpt>Command Details<ept id=\"p1\">**</ept> page, in the <bpt id=\"p2\">**</bpt>Command Line<ept id=\"p2\">**</ept> text box, type <bpt id=\"p3\">**</bpt>msiexec /i AdbeRdr11000<ph id=\"ph1\">\\_</ph>eu<ph id=\"ph2\">\\_</ph>ES.msi /q<ept id=\"p3\">**</ept>, click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept> twice, and then click <bpt id=\"p5\">**</bpt>Finish<ept id=\"p5\">**</ept>."},{"content":"figure 3","pos":[9140,9148]},{"content":"Figure 3.","pos":[9176,9185]},{"content":"The Adobe Reader application added to the Deployment Workbench.","pos":[9186,9249]},{"pos":[9280,9318],"content":"Step 5: Prepare the drivers repository"},{"content":"In order to deploy Windows 10 with MDT 2013 Update 2 successfully, you need drivers for the boot images and for the actual operating system.","pos":[9320,9460]},{"content":"This section will show you how to add drivers for the boot image and operating system, using the following hardware models as examples:","pos":[9461,9596]},{"content":"Lenovo ThinkPad T420","pos":[9601,9621]},{"content":"Dell Latitude E6440","pos":[9626,9645]},{"content":"HP EliteBook 8560w","pos":[9650,9668]},{"pos":[9673,9827],"content":"Microsoft Surface Pro For boot images, you need to have storage and network drivers; for the operating system, you need to have the full suite of drivers."},{"content":"Note","pos":[9831,9835]},{"content":"You should only add drivers to the Windows PE images if the default drivers don't work.","pos":[9840,9927]},{"content":"Adding drivers that are not necessary will only make the boot image larger and potentially delay the download time.","pos":[9928,10043]},{"content":"Create the driver source structure in the file system","pos":[10050,10103]},{"content":"The key to successful management of drivers for MDT 2013 Update 2, as well as for any other deployment solution, is to have a really good driver repository.","pos":[10105,10261]},{"content":"From this repository, you import drivers into MDT for deployment, but you should always maintain the repository for future use.","pos":[10262,10389]},{"pos":[10395,10460],"content":"On MDT01, using File Explorer, create the <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>Drivers<ept id=\"p1\">**</ept> folder."},{"pos":[10465,10534],"content":"In the <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>Drivers<ept id=\"p1\">**</ept> folder, create the following folder structure:"},{"content":"WinPE x86","pos":[10543,10552]},{"content":"WinPE x64","pos":[10561,10570]},{"content":"Windows 10 x64","pos":[10579,10593]},{"content":"In the new Windows 10 x64 folder, create the following folder structure:","pos":[10598,10670]},{"content":"Dell","pos":[10679,10683]},{"content":"Latitude E6440","pos":[10696,10710]},{"content":"HP","pos":[10719,10721]},{"content":"HP EliteBook 8560w","pos":[10734,10752]},{"content":"Lenovo","pos":[10761,10767]},{"content":"ThinkPad T420 (4178)","pos":[10780,10800]},{"content":"Microsoft Corporation","pos":[10809,10830]},{"content":"Surface Pro 3","pos":[10843,10856]},{"content":"Note","pos":[10860,10864]},{"content":"Even if you are not going to use both x86 and x64 boot images, we still recommend that you add the support structure for future use.","pos":[10869,11001]},{"content":"Create the logical driver structure in MDT 2013 Update 2","pos":[11008,11064]},{"content":"When you import drivers to the MDT 2013 Update 2 driver repository, MDT creates a single instance folder structure based on driver class names.","pos":[11066,11209]},{"content":"However, you can, and should, mimic the driver structure of your driver source repository in the Deployment Workbench.","pos":[11210,11328]},{"content":"This is done by creating logical folders in the Deployment Workbench.","pos":[11329,11398]},{"pos":[11403,11480],"content":"On MDT01, using Deployment Workbench, select the <bpt id=\"p1\">**</bpt>Out-of-Box Drivers<ept id=\"p1\">**</ept> node."},{"pos":[11485,11559],"content":"In the <bpt id=\"p1\">**</bpt>Out-Of-Box Drivers<ept id=\"p1\">**</ept> node, create the following folder structure:"},{"content":"WinPE x86","pos":[11568,11577]},{"content":"WinPE x64","pos":[11586,11595]},{"content":"Windows 10 x64","pos":[11604,11618]},{"pos":[11623,11695],"content":"In the <bpt id=\"p1\">**</bpt>Windows 10 x64<ept id=\"p1\">**</ept> folder, create the following folder structure:"},{"content":"Dell Inc.","pos":[11704,11713]},{"content":"Latitude E6440","pos":[11726,11740]},{"content":"Hewlett-Packard","pos":[11749,11764]},{"content":"HP EliteBook 8560w","pos":[11777,11795]},{"content":"Lenovo","pos":[11804,11810]},{"content":"4178","pos":[11823,11827]},{"content":"Microsoft Corporation","pos":[11836,11857]},{"content":"Surface Pro 3","pos":[11870,11883]},{"content":"The preceding folder names are selected because they match the actual make and model values that MDT reads from the machines during deployment.","pos":[11885,12028]},{"content":"You can find out the model values for your machines via the following command in Windows PowerShell:","pos":[12029,12129]},{"content":"Or, you can use this command in a normal command prompt:","pos":[12187,12243]},{"pos":[12284,12545],"content":"If you want a more standardized naming convention, try the ModelAliasExit.vbs script from the Deployment Guys blog post entitled <bpt id=\"p1\">[</bpt>Using and Extending Model Aliases for Hardware Specific Application Installation<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619536)</ept>."},{"content":"figure 4","pos":[12549,12557]},{"content":"Figure 4.","pos":[12589,12598]},{"content":"The Out-of-Box Drivers structure in Deployment Workbench.","pos":[12599,12656]},{"content":"Create the selection profiles for boot image drivers","pos":[12662,12714]},{"content":"By default, MDT adds any storage and network drivers that you import to the boot images.","pos":[12716,12804]},{"content":"However, you should add only the drivers that are necessary to the boot image.","pos":[12805,12883]},{"content":"You can control which drivers are added by using selection profiles.","pos":[12884,12952]},{"content":"The drivers that are used for the boot images (Windows PE) are Windows 10 drivers.","pos":[12953,13035]},{"content":"If you can’t locate Windows 10 drivers for your device, a Windows 7 or Windows 8.1 driver will most likely work, but Windows 10 drivers should be your first choice.","pos":[13036,13200]},{"pos":[13205,13405],"content":"On MDT01, using the Deployment Workbench, in the <bpt id=\"p1\">**</bpt>MDT Production<ept id=\"p1\">**</ept> node, expand the <bpt id=\"p2\">**</bpt>Advanced Configuration<ept id=\"p2\">**</ept> node, right-click the <bpt id=\"p3\">**</bpt>Selection Profiles<ept id=\"p3\">**</ept> node, and select <bpt id=\"p4\">**</bpt>New Selection Profile<ept id=\"p4\">**</ept>."},{"content":"In the New Selection Profile Wizard, create a selection profile with the following settings:","pos":[13410,13502]},{"content":"Selection Profile name: WinPE x86","pos":[13511,13544]},{"content":"Folders: Select the WinPE x86 folder in Out-of-Box Drivers.","pos":[13553,13612]},{"pos":[13617,13706],"content":"Again, right-click the <bpt id=\"p1\">**</bpt>Selection Profiles<ept id=\"p1\">**</ept> node, and select <bpt id=\"p2\">**</bpt>New Selection Profile<ept id=\"p2\">**</ept>."},{"content":"In the New Selection Profile Wizard, create a selection profile with the following settings:","pos":[13711,13803]},{"content":"Selection Profile name: WinPE x64","pos":[13812,13845]},{"content":"Folders: Select the WinPE x64 folder in Out-of-Box Drivers.","pos":[13854,13913]},{"content":"figure 5","pos":[13917,13925]},{"content":"Figure 5.","pos":[13959,13968]},{"content":"Creating the WinPE x64 selection profile.","pos":[13969,14010]},{"content":"Extract and import drivers for the x64 boot image","pos":[14016,14065]},{"content":"Windows PE supports all the hardware models that we have, but here you learn to add boot image drivers to accommodate any new hardware that might require additional drivers.","pos":[14067,14240]},{"content":"In this example, you add the latest Intel network drivers to the x64 boot image.","pos":[14241,14321]},{"content":"In these steps, we assume you have downloaded PROWinx64.exe from Intel.com and saved it to a temporary folder.","pos":[14322,14432]},{"pos":[14438,14537],"content":"Extract PROWinx64.exe to a temporary folder - in this example to the <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Tmp<ph id=\"ph2\">\\\\</ph>ProWinx64<ept id=\"p1\">**</ept> folder."},{"pos":[14542,14623],"content":"Using File Explorer, create the <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>Drivers<ph id=\"ph2\">\\\\</ph>WinPE x64<ph id=\"ph3\">\\\\</ph>Intel PRO1000<ept id=\"p1\">**</ept> folder."},{"pos":[14628,14763],"content":"Copy the content of the <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Tmp<ph id=\"ph2\">\\\\</ph>PROWinx64<ph id=\"ph3\">\\\\</ph>PRO1000<ph id=\"ph4\">\\\\</ph>Winx64<ph id=\"ph5\">\\\\</ph>NDIS64<ept id=\"p1\">**</ept> folder to the <bpt id=\"p2\">**</bpt>E:<ph id=\"ph6\">\\\\</ph>Drivers<ph id=\"ph7\">\\\\</ph>WinPE x64<ph id=\"ph8\">\\\\</ph>Intel PRO1000<ept id=\"p2\">**</ept> folder."},{"content":"Using Deployment Workbench, expand the <bpt id=\"p1\">**</bpt>Out-of-Box Drivers<ept id=\"p1\">**</ept> node, right-click the <bpt id=\"p2\">**</bpt>WinPE x64<ept id=\"p2\">**</ept> node, and select <bpt id=\"p3\">**</bpt>Import Drivers<ept id=\"p3\">**</ept>.","pos":[14768,14902]},{"content":"Use the following setting for the Import Drivers Wizard:","pos":[14903,14959]},{"pos":[14968,15034],"content":"Driver source directory: <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>Drivers<ph id=\"ph2\">\\\\</ph>WinPE x64<ph id=\"ph3\">\\\\</ph>Intel PRO1000<ept id=\"p1\">**</ept>"},{"content":"Download, extract, and import drivers","pos":[15040,15077]},{"content":"For the ThinkPad T420","pos":[15083,15104]},{"content":"For the Lenovo T420 model, you use the Lenovo ThinkVantage Update Retriever software to download the drivers.","pos":[15106,15215]},{"content":"With Update Retriever, you need to specify the correct Lenovo Machine Type for the actual hardware (the first four characters of the model name).","pos":[15216,15361]},{"content":"As an example, the Lenovo T420 model has the 4178B9G model name, meaning the Machine Type is 4178.","pos":[15362,15460]},{"content":"To get the updates, you download the drivers from the Lenovo ThinkVantage Update Retriever using its export function.","pos":[15462,15579]},{"content":"You can download the drivers from the <bpt id=\"p1\">[</bpt>Lenovo website<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619543)</ept>.","pos":[15580,15684]},{"content":"In these steps, we assume you have downloaded and extracted the drivers using ThinkVantage Update Retriever v5.0 to the E:<ph id=\"ph1\">\\\\</ph>Drivers<ph id=\"ph2\">\\\\</ph>Lenovo<ph id=\"ph3\">\\\\</ph>ThinkPad T420 (4178) folder.","pos":[15686,15855]},{"pos":[15861,16006],"content":"On MDT01, using the Deployment Workbench, in the <bpt id=\"p1\">**</bpt>MDT Production<ept id=\"p1\">**</ept> node, expand the <bpt id=\"p2\">**</bpt>Out-Of-Box Drivers<ept id=\"p2\">**</ept> node, and expand the <bpt id=\"p3\">**</bpt>Lenovo<ept id=\"p3\">**</ept> node."},{"pos":[16011,16130],"content":"Right-click the <bpt id=\"p1\">**</bpt>4178<ept id=\"p1\">**</ept> folder and select <bpt id=\"p2\">**</bpt>Import Drivers<ept id=\"p2\">**</ept>; use the following setting for the Import Drivers Wizard:"},{"pos":[16139,16225],"content":"Driver source directory: <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>Drivers<ph id=\"ph2\">\\\\</ph>Windows 10 x64<ph id=\"ph3\">\\\\</ph>Lenovo<ph id=\"ph4\">\\\\</ph>ThinkPad T420 (4178)<ept id=\"p1\">**</ept>"},{"content":"For the Latitude E6440","pos":[16231,16253]},{"pos":[16255,16427],"content":"For the Dell Latitude E6440 model, you use the Dell Driver CAB file, which is accessible via the <bpt id=\"p1\">[</bpt>Dell TechCenter website<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619544)</ept>."},{"content":"In these steps, we assume you have downloaded and extracted the CAB file for the Latitude E6440 model to the E:<ph id=\"ph1\">\\\\</ph>Drivers<ph id=\"ph2\">\\\\</ph>Dell<ph id=\"ph3\">\\\\</ph>Latitude E6440 folder.","pos":[16429,16579]},{"pos":[16585,16736],"content":"On <bpt id=\"p1\">**</bpt>MDT01<ept id=\"p1\">**</ept>, using the <bpt id=\"p2\">**</bpt>Deployment Workbench<ept id=\"p2\">**</ept>, in the <bpt id=\"p3\">**</bpt>MDT Production<ept id=\"p3\">**</ept> node, expand the <bpt id=\"p4\">**</bpt>Out-Of-Box Drivers<ept id=\"p4\">**</ept> node, and expand the <bpt id=\"p5\">**</bpt>Dell<ept id=\"p5\">**</ept> node."},{"pos":[16741,16870],"content":"Right-click the <bpt id=\"p1\">**</bpt>Latitude E6440<ept id=\"p1\">**</ept> folder and select <bpt id=\"p2\">**</bpt>Import Drivers<ept id=\"p2\">**</ept>; use the following setting for the Import Drivers Wizard:"},{"pos":[16879,16957],"content":"Driver source directory: <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>Drivers<ph id=\"ph2\">\\\\</ph>Windows 10 x64<ph id=\"ph3\">\\\\</ph>Dell<ph id=\"ph4\">\\\\</ph>Latitude E6440<ept id=\"p1\">**</ept>"},{"content":"For the HP EliteBook 8560w","pos":[16963,16989]},{"content":"For the HP EliteBook 8560w, you use HP SoftPaq Download Manager to get the drivers.","pos":[16991,17074]},{"content":"The HP SoftPaq Download Manager can be accessed on the <bpt id=\"p1\">[</bpt>HP Support site<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619545)</ept>.","pos":[17075,17197]},{"content":"In these steps, we assume you have downloaded and extracted the drivers for the HP EliteBook 8650w model to the E:<ph id=\"ph1\">\\\\</ph>Drivers<ph id=\"ph2\">\\\\</ph>Windows 10 x64<ph id=\"ph3\">\\\\</ph>HP<ph id=\"ph4\">\\\\</ph>HP EliteBook 8560w folder.","pos":[17199,17370]},{"pos":[17376,17538],"content":"On <bpt id=\"p1\">**</bpt>MDT01<ept id=\"p1\">**</ept>, using the <bpt id=\"p2\">**</bpt>Deployment Workbench<ept id=\"p2\">**</ept>, in the <bpt id=\"p3\">**</bpt>MDT Production<ept id=\"p3\">**</ept> node, expand the <bpt id=\"p4\">**</bpt>Out-Of-Box Drivers<ept id=\"p4\">**</ept> node, and expand the <bpt id=\"p5\">**</bpt>Hewlett-Packard<ept id=\"p5\">**</ept> node."},{"pos":[17543,17676],"content":"Right-click the <bpt id=\"p1\">**</bpt>HP EliteBook 8560w<ept id=\"p1\">**</ept> folder and select <bpt id=\"p2\">**</bpt>Import Drivers<ept id=\"p2\">**</ept>; use the following setting for the Import Drivers Wizard:"},{"pos":[17685,17765],"content":"Driver source directory: <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>Drivers<ph id=\"ph2\">\\\\</ph>Windows 10 x64<ph id=\"ph3\">\\\\</ph>HP<ph id=\"ph4\">\\\\</ph>HP EliteBook 8560w<ept id=\"p1\">**</ept>"},{"content":"For the Microsoft Surface Pro 3","pos":[17771,17802]},{"content":"For the Microsoft Surface Pro model, you find the drivers on the Microsoft website.","pos":[17804,17887]},{"content":"In these steps we assume you have downloaded and extracted the Surface Pro 3 drivers to the E:<ph id=\"ph1\">\\\\</ph>Drivers<ph id=\"ph2\">\\\\</ph>Windows 10 x64<ph id=\"ph3\">\\\\</ph>Microsoft<ph id=\"ph4\">\\\\</ph>Surface Pro 3 folder.","pos":[17888,18041]},{"pos":[18047,18195],"content":"On MDT01, using the Deployment Workbench, in the <bpt id=\"p1\">**</bpt>MDT Production<ept id=\"p1\">**</ept> node, expand the <bpt id=\"p2\">**</bpt>Out-Of-Box Drivers<ept id=\"p2\">**</ept> node, and expand the <bpt id=\"p3\">**</bpt>Microsoft<ept id=\"p3\">**</ept> node."},{"pos":[18200,18328],"content":"Right-click the <bpt id=\"p1\">**</bpt>Surface Pro 3<ept id=\"p1\">**</ept> folder and select <bpt id=\"p2\">**</bpt>Import Drivers<ept id=\"p2\">**</ept>; use the following setting for the Import Drivers Wizard:"},{"pos":[18337,18419],"content":"Driver source directory: <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>Drivers<ph id=\"ph2\">\\\\</ph>Windows 10 x64<ph id=\"ph3\">\\\\</ph>Microsoft<ph id=\"ph4\">\\\\</ph>Surface Pro 3<ept id=\"p1\">**</ept>"},{"pos":[18450,18493],"content":"Step 6: Create the deployment task sequence"},{"content":"This section will show you how to create the task sequence used to deploy your production Windows 10 reference image.","pos":[18495,18612]},{"content":"You will then configure the tasks sequence to enable patching via a Windows Server Update Services (WSUS) server.","pos":[18613,18726]},{"content":"Create a task sequence for Windows 10 Enterprise","pos":[18732,18780]},{"pos":[18786,18917],"content":"Using the Deployment Workbench, select <bpt id=\"p1\">**</bpt>Task Sequences<ept id=\"p1\">**</ept> in the <bpt id=\"p2\">**</bpt>MDT Production<ept id=\"p2\">**</ept> node, and create a folder named <bpt id=\"p3\">**</bpt>Windows 10<ept id=\"p3\">**</ept>."},{"content":"Right-click the new <bpt id=\"p1\">**</bpt>Windows 10<ept id=\"p1\">**</ept> folder and select <bpt id=\"p2\">**</bpt>New Task Sequence<ept id=\"p2\">**</ept>.","pos":[18922,18997]},{"content":"Use the following settings for the New Task Sequence Wizard:","pos":[18998,19058]},{"content":"Task sequence ID: W10-X64-001","pos":[19067,19096]},{"content":"Task sequence name: Windows 10 Enterprise x64 RTM Custom Image","pos":[19105,19167]},{"content":"Task sequence comments: Production Image","pos":[19176,19216]},{"content":"Template: Standard Client Task Sequence","pos":[19225,19264]},{"content":"Select OS: Windows 10 Enterprise x64 RTM Custom Image","pos":[19273,19326]},{"content":"Specify Product Key: Do not specify a product key at this time","pos":[19335,19397]},{"content":"Full Name: Contoso","pos":[19406,19424]},{"content":"Organization: Contoso","pos":[19433,19454]},{"content":"Internet Explorer home page: about:blank","pos":[19463,19503]},{"content":"Admin Password: Do not specify an Administrator Password at this time","pos":[19512,19581]},{"content":"Edit the Windows 10 task sequence","pos":[19586,19619]},{"pos":[19625,19729],"content":"Right-click the <bpt id=\"p1\">**</bpt>Windows 10 Enterprise x64 RTM Custom Image<ept id=\"p1\">**</ept> task sequence, and select <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>."},{"pos":[19734,19867],"content":"On the <bpt id=\"p1\">**</bpt>Task Sequence<ept id=\"p1\">**</ept> tab, configure the <bpt id=\"p2\">**</bpt>Windows 10 Enterprise x64 RTM Custom Image<ept id=\"p2\">**</ept> task sequence with the following settings:"},{"content":"Preinstall.","pos":[19876,19887]},{"content":"After the <bpt id=\"p1\">**</bpt>Enable BitLocker (Offline)<ept id=\"p1\">**</ept> action, add a <bpt id=\"p2\">**</bpt>Set Task Sequence Variable<ept id=\"p2\">**</ept> action with the following settings:","pos":[19888,20009]},{"content":"Name: Set DriverGroup001","pos":[20022,20046]},{"content":"Task Sequence Variable: DriverGroup001","pos":[20059,20097]},{"content":"Value: Windows 10 x64<ph id=\"ph1\">\\\\</ph>%Make%<ph id=\"ph2\">\\\\</ph>%Model%","pos":[20110,20148]},{"pos":[20157,20225],"content":"Configure the <bpt id=\"p1\">**</bpt>Inject Drivers<ept id=\"p1\">**</ept> action with the following settings:"},{"content":"Choose a selection profile: Nothing","pos":[20238,20273]},{"pos":[20286,20723],"content":"Install all drivers from the selection profile\n**Note**  \nThe configuration above indicates that MDT should only use drivers from the folder specified by the DriverGroup001 property, which is defined by the \"Choose a selection profile: Nothing\" setting, and that MDT should not use plug and play to determine which drivers to copy, which is defined by the \"Install all drivers from the selection profile\" setting.","leadings":["","            ","            "],"nodes":[{"content":"Install all drivers from the selection profile <bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>","pos":[0,55]},{"content":"The configuration above indicates that MDT should only use drivers from the folder specified by the DriverGroup001 property, which is defined by the \"Choose a selection profile: Nothing\" setting, and that MDT should not use plug and play to determine which drivers to copy, which is defined by the \"Install all drivers from the selection profile\" setting.","pos":[58,413]}]},{"content":"State Restore.","pos":[20746,20760]},{"content":"Enable the <bpt id=\"p1\">**</bpt>Windows Update (Pre-Application Installation)<ept id=\"p1\">**</ept> action.","pos":[20761,20829]},{"content":"State Restore.","pos":[20838,20852]},{"content":"Enable the <bpt id=\"p1\">**</bpt>Windows Update (Post-Application Installation)<ept id=\"p1\">**</ept> action.","pos":[20853,20922]},{"pos":[20927,20940],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"figure 6","pos":[20944,20952]},{"content":"Figure 6.","pos":[20980,20989]},{"content":"The task sequence for production deployment.","pos":[20990,21034]},{"pos":[21065,21118],"content":"Step 7: Configure the MDT production deployment share"},{"content":"In this section, you will learn how to configure the MDT Build Lab deployment share with the rules required to create a simple and dynamic deployment process.","pos":[21120,21278]},{"content":"This includes configuring commonly used rules and an explanation of how these rules work.","pos":[21279,21368]},{"content":"Configure the rules","pos":[21374,21393]},{"content":"On MDT01, using File Explorer, copy the following files from the <bpt id=\"p1\">**</bpt>D:<ph id=\"ph1\">\\\\</ph>Setup<ph id=\"ph2\">\\\\</ph>Sample Files<ph id=\"ph3\">\\\\</ph>MDT Production<ph id=\"ph4\">\\\\</ph>Control<ept id=\"p1\">**</ept> folder to <bpt id=\"p2\">**</bpt>E:<ph id=\"ph5\">\\\\</ph>MDTProduction<ph id=\"ph6\">\\\\</ph>Control<ept id=\"p2\">**</ept>.","pos":[21399,21558]},{"content":"Overwrite the existing files.","pos":[21559,21588]},{"content":"Bootstrap.ini","pos":[21597,21610]},{"content":"CustomSettings.ini","pos":[21619,21637]},{"pos":[21642,21720],"content":"Right-click the <bpt id=\"p1\">**</bpt>MDT Production<ept id=\"p1\">**</ept> deployment share and select <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>."},{"pos":[21725,21793],"content":"Select the <bpt id=\"p1\">**</bpt>Rules<ept id=\"p1\">**</ept> tab and modify using the following information:"},{"pos":[22713,22785],"content":"Click <bpt id=\"p1\">**</bpt>Edit Bootstrap.ini<ept id=\"p1\">**</ept> and modify using the following information:"},{"pos":[22965,23058],"content":"In the <bpt id=\"p1\">**</bpt>Windows PE<ept id=\"p1\">**</ept> tab, in the <bpt id=\"p2\">**</bpt>Platform<ept id=\"p2\">**</ept> drop-down list, make sure <bpt id=\"p3\">**</bpt>x86<ept id=\"p3\">**</ept> is selected."},{"pos":[23063,23124],"content":"In the <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> sub tab, configure the following settings:"},{"pos":[23133,23180],"content":"In the <bpt id=\"p1\">**</bpt>Lite Touch Boot Image Settings<ept id=\"p1\">**</ept> area:"},{"content":"Image description: MDT Production x86","pos":[23193,23230]},{"pos":[23243,23552],"content":"ISO file name: MDT Production x86.iso\n**Note**  \nBecause you are going to use Pre-Boot Execution Environment (PXE) later to deploy the machines, you do not need the ISO file; however, we recommend creating ISO files because they are useful when troubleshooting deployments and for quick tests.","leadings":["","        ","        "],"nodes":[{"content":"ISO file name: MDT Production x86.iso <bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>","pos":[0,46]},{"content":"Because you are going to use Pre-Boot Execution Environment (PXE) later to deploy the machines, you do not need the ISO file; however, we recommend creating ISO files because they are useful when troubleshooting deployments and for quick tests.","pos":[49,293]}]},{"pos":[23567,23723],"content":"In the <bpt id=\"p1\">**</bpt>Drivers and Patches<ept id=\"p1\">**</ept> sub tab, select the <bpt id=\"p2\">**</bpt>WinPE x86<ept id=\"p2\">**</ept> selection profile and select the <bpt id=\"p3\">**</bpt>Include all drivers from the selection profile<ept id=\"p3\">**</ept> option."},{"pos":[23728,23806],"content":"In the <bpt id=\"p1\">**</bpt>Windows PE<ept id=\"p1\">**</ept> tab, in the <bpt id=\"p2\">**</bpt>Platform<ept id=\"p2\">**</ept> drop-down list, select <bpt id=\"p3\">**</bpt>x64<ept id=\"p3\">**</ept>."},{"pos":[23811,23872],"content":"In the <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> sub tab, configure the following settings:"},{"pos":[23881,23928],"content":"In the <bpt id=\"p1\">**</bpt>Lite Touch Boot Image Settings<ept id=\"p1\">**</ept> area:"},{"content":"Image description: MDT Production x64","pos":[23941,23978]},{"content":"ISO file name: MDT Production x64.iso","pos":[23991,24028]},{"pos":[24033,24189],"content":"In the <bpt id=\"p1\">**</bpt>Drivers and Patches<ept id=\"p1\">**</ept> sub tab, select the <bpt id=\"p2\">**</bpt>WinPE x64<ept id=\"p2\">**</ept> selection profile and select the <bpt id=\"p3\">**</bpt>Include all drivers from the selection profile<ept id=\"p3\">**</ept> option."},{"pos":[24194,24290],"content":"In the <bpt id=\"p1\">**</bpt>Monitoring<ept id=\"p1\">**</ept> tab, select the <bpt id=\"p2\">**</bpt>Enable monitoring for this deployment share<ept id=\"p2\">**</ept> check box."},{"pos":[24295,24308],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"Note","pos":[24312,24316]},{"content":"It will take a while for the Deployment Workbench to create the monitoring database and web service.","pos":[24321,24421]},{"content":"figure 8","pos":[24427,24435]},{"content":"Figure 7.","pos":[24463,24472]},{"content":"The Windows PE tab for the x64 boot image.","pos":[24473,24515]},{"content":"The rules explained","pos":[24521,24540]},{"content":"The rules for the MDT Production deployment share are somewhat different from those for the MDT Build Lab deployment share.","pos":[24542,24665]},{"content":"The biggest differences are that you deploy the machines into a domain instead of a workgroup and that you do not automate the logon.","pos":[24666,24799]},{"content":"The Bootstrap.ini file","pos":[24805,24827]},{"content":"This is the MDT Production Bootstrap.ini without the user credentials (except domain information):","pos":[24829,24927]},{"content":"The CustomSettings.ini file","pos":[25071,25098]},{"content":"This is the CustomSettings.ini file with the new join domain information:","pos":[25100,25173]},{"content":"The additional properties to use in the MDT Production rules file are as follows:","pos":[25985,26066]},{"content":"JoinDomain.","pos":[26073,26084]},{"content":"The domain to join.","pos":[26087,26106]},{"content":"DomainAdmin.","pos":[26113,26125]},{"content":"The account to use when joining the machine to the domain.","pos":[26128,26186]},{"content":"DomainAdminDomain.","pos":[26193,26211]},{"content":"The domain for the join domain account.","pos":[26214,26253]},{"content":"DomainAdminPassword.","pos":[26260,26280]},{"content":"The password for the join domain account.","pos":[26283,26324]},{"content":"MachineObjectOU.","pos":[26331,26347]},{"content":"The organizational unit (OU) to which to add the computer account.","pos":[26350,26416]},{"content":"ScanStateArgs.","pos":[26423,26437]},{"content":"Arguments for the User State Migration Tool (USMT) ScanState command.","pos":[26440,26509]},{"content":"USMTMigFiles(<ph id=\"ph1\">\\*</ph>).","pos":[26516,26533]},{"content":"List of USMT templates (controlling what to backup and restore).","pos":[26536,26600]},{"content":"EventService.","pos":[26607,26620]},{"content":"Activates logging information to the MDT monitoring web service.","pos":[26623,26687]},{"content":"Optional deployment share configuration","pos":[26693,26732]},{"content":"If your organization has a Microsoft Software Assurance agreement, you also can subscribe to the additional Microsoft Desktop Optimization Package (MDOP) license (at an additional cost).","pos":[26734,26920]},{"content":"Included in MDOP is Microsoft Diagnostics and Recovery Toolkit (DaRT), which contains tools that can help you troubleshoot MDT deployments, as well as troubleshoot Windows itself.","pos":[26921,27101]},{"content":"Add DaRT 10 to the boot images","pos":[27107,27137]},{"content":"If you have licensing for MDOP and DaRT, you can add DaRT to the boot images using the steps in this section.","pos":[27139,27248]},{"content":"If you do not have DaRT licensing, or don't want to use it, simply skip to the next section, <bpt id=\"p1\">[</bpt>Update the Deployment Share<ept id=\"p1\">](#bkmk-update-deployment)</ept>.","pos":[27249,27397]},{"content":"To enable the remote connection feature in MDT 2013 Update 2, you need to do the following:","pos":[27398,27489]},{"content":"Install DaRT 10 (part of MDOP 2015 R1).","pos":[27494,27533]},{"content":"Copy the two tools CAB files (Toolsx86.cab and Toolsx64.cab) to the deployment share.","pos":[27538,27623]},{"content":"Configure the deployment share to add DaRT.","pos":[27628,27671]},{"content":"In these steps, we assume that you downloaded MDOP 2015 R1 and copied DaRT 10 to the E:<ph id=\"ph1\">\\\\</ph>Setup<ph id=\"ph2\">\\\\</ph>DaRT 10 folder on MDT01.","pos":[27672,27792]},{"content":"On MDT01, install DaRT 10 (MSDaRT10.msi) using the default settings.","pos":[27797,27865]},{"pos":[27870,27957],"content":"Using File Explorer, navigate to the <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>Program Files<ph id=\"ph2\">\\\\</ph>Microsoft DaRT<ph id=\"ph3\">\\\\</ph>v10<ept id=\"p1\">**</ept> folder."},{"pos":[27962,28026],"content":"Copy the Toolsx64.cab file to <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>MDTProduction<ph id=\"ph2\">\\\\</ph>Tools<ph id=\"ph3\">\\\\</ph>x64<ept id=\"p1\">**</ept>."},{"pos":[28031,28095],"content":"Copy the Toolsx86.cab file to <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>MDTProduction<ph id=\"ph2\">\\\\</ph>Tools<ph id=\"ph3\">\\\\</ph>x86<ept id=\"p1\">**</ept>."},{"pos":[28100,28210],"content":"Using the Deployment Workbench, right-click the <bpt id=\"p1\">**</bpt>MDT Production<ept id=\"p1\">**</ept> deployment share and select <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>."},{"pos":[28215,28308],"content":"In the <bpt id=\"p1\">**</bpt>Windows PE<ept id=\"p1\">**</ept> tab, in the <bpt id=\"p2\">**</bpt>Platform<ept id=\"p2\">**</ept> drop-down list, make sure <bpt id=\"p3\">**</bpt>x86<ept id=\"p3\">**</ept> is selected."},{"pos":[28313,28417],"content":"In the <bpt id=\"p1\">**</bpt>Features<ept id=\"p1\">**</ept> sub tab, select the <bpt id=\"p2\">**</bpt>Microsoft Diagnostics and Recovery Toolkit (DaRT)<ept id=\"p2\">**</ept> check box."},{"content":"figure 8","pos":[28425,28433]},{"content":"Figure 8.","pos":[28465,28474]},{"content":"Selecting the DaRT 10 feature in the deployment share.","pos":[28475,28529]},{"pos":[28535,28613],"content":"In the <bpt id=\"p1\">**</bpt>Windows PE<ept id=\"p1\">**</ept> tab, in the <bpt id=\"p2\">**</bpt>Platform<ept id=\"p2\">**</ept> drop-down list, select <bpt id=\"p3\">**</bpt>x64<ept id=\"p3\">**</ept>."},{"pos":[28618,28772],"content":"In the <bpt id=\"p1\">**</bpt>Features<ept id=\"p1\">**</ept> sub tab, in addition to the default selected feature pack, select the <bpt id=\"p2\">**</bpt>Microsoft Diagnostics and Recovery Toolkit (DaRT)<ept id=\"p2\">**</ept> check box."},{"pos":[28777,28790],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"pos":[28839,28866],"content":"Update the deployment share"},{"content":"Like the MDT Build Lab deployment share, the MDT Production deployment share needs to be updated after it has been configured.","pos":[28868,28994]},{"content":"This is the process during which the Windows PE boot images are created.","pos":[28995,29067]},{"pos":[29072,29163],"content":"Right-click the <bpt id=\"p1\">**</bpt>MDT Production<ept id=\"p1\">**</ept> deployment share and select <bpt id=\"p2\">**</bpt>Update Deployment Share<ept id=\"p2\">**</ept>."},{"content":"Use the default options for the Update Deployment Share Wizard.","pos":[29168,29231]},{"content":"Note","pos":[29235,29239]},{"content":"The update process will take 5 to 10 minutes.","pos":[29244,29289]},{"pos":[29321,29363],"content":"Step 8: Deploy the Windows 10 client image"},{"content":"These steps will walk you throug the process of using task sequences to deploy Windows 10 images through a fully automated process.","pos":[29365,29496]},{"content":"First, you need to add the boot image to Windows Deployment Services (WDS) and then start the deployment.","pos":[29497,29602]},{"content":"In contrast with deploying images from the MDT Build Lab deployment share, we recommend using the Pre-Installation Execution Environment (PXE) to start the full deployments in the datacenter, even though you technically can use an ISO/CD or USB to start the process.","pos":[29603,29869]},{"content":"Configure Windows Deployment Services","pos":[29875,29912]},{"content":"You need to add the MDT Production Lite Touch x64 Boot image to WDS in preparation for the deployment.","pos":[29914,30016]},{"content":"For the following steps, we assume that Windows Deployment Services has already been installed on MDT01.","pos":[30017,30121]},{"pos":[30126,30207],"content":"Using the WDS console, right-click <bpt id=\"p1\">**</bpt>Boot Images<ept id=\"p1\">**</ept> and select <bpt id=\"p2\">**</bpt>Add Boot Image<ept id=\"p2\">**</ept>."},{"content":"Browse to the E:<ph id=\"ph1\">\\\\</ph>MDTProduction<ph id=\"ph2\">\\\\</ph>Boot<ph id=\"ph3\">\\\\</ph>LiteTouchPE<ph id=\"ph4\">\\_</ph>x64.wim file and add the image with the default settings.","pos":[30212,30321]},{"content":"figure 9","pos":[30325,30333]},{"content":"Figure 9.","pos":[30361,30370]},{"content":"The boot image added to the WDS console.","pos":[30371,30411]},{"content":"Deploy the Windows 10 client","pos":[30417,30445]},{"content":"At this point, you should have a solution ready for deploying the Windows 10 client.","pos":[30447,30531]},{"content":"We recommend starting by trying a few deployments at a time until you are confident that your configuration works as expected.","pos":[30532,30658]},{"content":"We find it useful to try some initial tests on virtual machines before testing on physical hardware.","pos":[30659,30759]},{"content":"This helps rule out hardware issues when testing or troubleshooting.","pos":[30760,30828]},{"content":"Here are the steps to deploy your Windows 10 image to a virtual machine:","pos":[30829,30901]},{"content":"Create a virtual machine with the following settings:","pos":[30906,30959]},{"content":"Name: PC0005","pos":[30968,30980]},{"content":"Location: C:<ph id=\"ph1\">\\\\</ph>VMs","pos":[30989,31006]},{"content":"Generation: 2","pos":[31015,31028]},{"content":"Memory: 2048 MB","pos":[31037,31052]},{"content":"Hard disk: 60 GB (dynamic disk)","pos":[31061,31092]},{"content":"Start the PC0005 virtual machine, and press <bpt id=\"p1\">**</bpt>Enter<ept id=\"p1\">**</ept> to start the PXE boot.","pos":[31097,31173]},{"content":"The machine will now load the Windows PE boot image from the WDS server.","pos":[31174,31246]},{"content":"figure 10","pos":[31254,31263]},{"content":"Figure 10.","pos":[31295,31305]},{"content":"The initial PXE boot process of PC0005.","pos":[31306,31345]},{"content":"After Windows PE has booted, complete the Windows Deployment Wizard using the following setting:","pos":[31351,31447]},{"content":"Password: P@ssw0rd","pos":[31456,31474]},{"content":"Select a task sequence to execute on this computer: Windows 10 Enterprise x64 RTM Custom Image","pos":[31483,31577]},{"content":"Computer Name: PC0005","pos":[31586,31607]},{"content":"Applications: Select the Install - Adobe Reader XI - x86 application.","pos":[31616,31685]},{"content":"The setup now starts and does the following:","pos":[31690,31734]},{"content":"Installs the Windows 10 Enterprise operating system.","pos":[31743,31795]},{"content":"Installs the added application.","pos":[31804,31835]},{"content":"Updates the operating system via your local Windows Server Update Services (WSUS) server.","pos":[31844,31933]},{"content":"Use the MDT 2013 monitoring feature","pos":[31939,31974]},{"content":"Now that you have enabled the monitoring on the MDT Production deployment share, you can follow your deployment of PC0005 via the monitoring node.","pos":[31976,32122]},{"pos":[32128,32220],"content":"On MDT01, using Deployment Workbench, expand the <bpt id=\"p1\">**</bpt>MDT Production<ept id=\"p1\">**</ept> deployment share folder."},{"pos":[32225,32287],"content":"Select the <bpt id=\"p1\">**</bpt>Monitoring<ept id=\"p1\">**</ept> node, and wait until you see PC0005."},{"content":"Double-click PC0005, and review the information.","pos":[32292,32340]},{"content":"figure 11","pos":[32344,32353]},{"content":"Figure 11.","pos":[32381,32391]},{"content":"The Monitoring node, showing the deployment progress of PC0005.","pos":[32392,32455]},{"content":"Use information in the Event Viewer","pos":[32461,32496]},{"content":"When monitoring is enabled, MDT also writes information to the event viewer on MDT01.","pos":[32498,32583]},{"content":"This information can be used to trigger notifications via scheduled tasks when deployment is completed.","pos":[32584,32687]},{"content":"For example, you can configure scheduled tasks to send an email when a certain event is created in the event log.","pos":[32688,32801]},{"content":"figure 12","pos":[32805,32814]},{"content":"Figure 12.","pos":[32842,32852]},{"content":"The Event Viewer showing a successful deployment of PC0005.","pos":[32853,32912]},{"pos":[32943,32964],"content":"Multicast deployments"},{"content":"Multicast deployment allows for image deployment with reduced network load during simultaneous deployments.","pos":[32966,33073]},{"content":"Multicast is a useful operating system deployment feature in MDT deployments, however it is important to ensure that your network supports it and is designed for it.","pos":[33074,33239]},{"content":"Requirements","pos":[33245,33257]},{"content":"Multicast requires that Windows Deployment Services (WDS) is running on Windows Server 2008 or later.","pos":[33259,33360]},{"content":"In addition to the core MDT 2013 setup for multicast, the network needs to be configured to support multicast.","pos":[33361,33471]},{"content":"In general, this means involving the organization networking team to make sure that Internet Group Management Protocol (IGMP) snooping is turned on and that the network is designed for multicast traffic.","pos":[33472,33676]},{"content":"The multicast solution uses IGMPv3.","pos":[33677,33712]},{"content":"Set up MDT for multicast","pos":[33718,33742]},{"content":"Setting up MDT for multicast is straightforward.","pos":[33744,33792]},{"content":"You enable multicast on the deployment share, and MDT takes care of the rest.","pos":[33793,33870]},{"pos":[33876,33971],"content":"On MDT01, right-click the <bpt id=\"p1\">**</bpt>MDT Production<ept id=\"p1\">**</ept> deployment share folder and select <bpt id=\"p2\">**</bpt>Properties<ept id=\"p2\">**</ept>."},{"pos":[33976,34148],"content":"In the <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> tab, select the <bpt id=\"p2\">**</bpt>Enable multicast for this deployment share (requires Windows Server 2008 R2 Windows Deployment Services)<ept id=\"p2\">**</ept> check box, and click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>."},{"pos":[34153,34251],"content":"Right-click the <bpt id=\"p1\">**</bpt>MDT Production<ept id=\"p1\">**</ept> deployment share folder and select <bpt id=\"p2\">**</bpt>Update Deployment Share<ept id=\"p2\">**</ept>."},{"content":"After updating the deployment share, use the Windows Deployment Services console to, verify that the multicast namespace was created.","pos":[34256,34389]},{"content":"figure 13","pos":[34393,34402]},{"content":"Figure 13.","pos":[34430,34440]},{"content":"The newly created multicast namespace.","pos":[34441,34479]},{"pos":[34510,34548],"content":"Use offline media to deploy Windows 10"},{"content":"In addition to network-based deployments, MDT supports the use of offline media-based deployments of Windows 10.","pos":[34550,34662]},{"content":"You can very easily generate an offline version of your deployment share - either the full deployment share or a subset of it - by the use of selection profiles.","pos":[34663,34824]},{"content":"The generated offline media can be burned to a DVD or copied to a USB stick for deployment.","pos":[34825,34916]},{"content":"Offline media are useful not only when you do not have network connectivity to the deployment share, but also when you have limited connection to the deployment share and do not want to copy 5 GB of data over the wire.","pos":[34918,35136]},{"content":"Offline media can still join the domain, but you save the transfer of operating system images, drivers, and applications over the wire.","pos":[35137,35272]},{"content":"Create the offline media selection profile","pos":[35278,35320]},{"content":"To filter what is being added to the media, you create a selection profile.","pos":[35322,35397]},{"content":"When creating selection profiles, you quickly realize the benefits of having created a good logical folder structure in the Deployment Workbench.","pos":[35398,35543]},{"pos":[35548,35715],"content":"On MDT01, using Deployment Workbench, in the <bpt id=\"p1\">**</bpt>MDT Production / Advanced Configuration<ept id=\"p1\">**</ept> node, right-click <bpt id=\"p2\">**</bpt>Selection Profile<ept id=\"p2\">**</ept>, and select <bpt id=\"p3\">**</bpt>New Selection Profile<ept id=\"p3\">**</ept>."},{"content":"Use the following settings for the New Selection Profile Wizard:","pos":[35720,35784]},{"content":"General Settings","pos":[35793,35809]},{"content":"Selection profile name: Windows 10 Offline Media","pos":[35822,35870]},{"content":"Folders","pos":[35879,35886]},{"content":"Applications / Adobe","pos":[35899,35919]},{"content":"Operating Systems / Windows 10","pos":[35932,35962]},{"content":"Out-Of-Box Drivers / WinPE x64","pos":[35975,36005]},{"content":"Out-Of-Box Drivers / Windows 10 x64","pos":[36018,36053]},{"content":"Task Sequences / Windows 10","pos":[36066,36093]},{"content":"Create the offline media","pos":[36099,36123]},{"content":"In these steps, you generate offline media from the MDT Production deployment share.","pos":[36125,36209]},{"content":"To filter what is being added to the media, you use the previously created selection profile.","pos":[36210,36303]},{"pos":[36309,36599],"content":"On MDT01, using File Explorer, create the **E:\\\\MDTOfflineMedia** folder.\n**Note**  \nWhen creating offline media, you need to create the target folder first. It is crucial that you do not create a subfolder inside the deployment share folder because it will break the offline media.","leadings":["","    ","    "],"nodes":[{"content":"On MDT01, using File Explorer, create the **E:\\\\MDTOfflineMedia** folder.\n**Note**","pos":[0,82],"nodes":[{"content":"On MDT01, using File Explorer, create the <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>MDTOfflineMedia<ept id=\"p1\">**</ept> folder.","pos":[0,73]},{"content":"Note","pos":[76,80]}]},{"content":"When creating offline media, you need to create the target folder first. It is crucial that you do not create a subfolder inside the deployment share folder because it will break the offline media.","pos":[85,282],"nodes":[{"content":"When creating offline media, you need to create the target folder first.","pos":[0,72]},{"content":"It is crucial that you do not create a subfolder inside the deployment share folder because it will break the offline media.","pos":[73,197]}]}]},{"pos":[36610,36752],"content":"Using Deployment Workbench, in the <bpt id=\"p1\">**</bpt>MDT Production / Advanced Configuration<ept id=\"p1\">**</ept> node, right-click the <bpt id=\"p2\">**</bpt>Media<ept id=\"p2\">**</ept> node, and select <bpt id=\"p3\">**</bpt>New Media<ept id=\"p3\">**</ept>."},{"content":"Use the following settings for the New Media Wizard:","pos":[36757,36809]},{"content":"General Settings","pos":[36818,36834]},{"pos":[36847,36882],"content":"Media path: <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>MDTOfflineMedia<ept id=\"p1\">**</ept>"},{"content":"Selection profile: Windows 10 Offline Media","pos":[36895,36938]},{"content":"Configure the offline media","pos":[36944,36971]},{"content":"Offline media has its own rules, its own Bootstrap.ini and CustomSettings.ini files.","pos":[36973,37057]},{"content":"These files are stored in the Control folder of the offline media; they also can be accessed via properties of the offline media in the Deployment Workbench.","pos":[37058,37215]},{"content":"On MDT01, using File Explorer, copy the CustomSettings.ini file from the <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>MDTBuildLab<ph id=\"ph2\">\\\\</ph>Control<ept id=\"p1\">**</ept> folder to <bpt id=\"p2\">**</bpt>E:<ph id=\"ph3\">\\\\</ph>MDTOfflineMedia<ph id=\"ph4\">\\\\</ph>Content<ph id=\"ph5\">\\\\</ph>Deploy<ph id=\"ph6\">\\\\</ph>Control<ept id=\"p2\">**</ept>.","pos":[37221,37383]},{"content":"Overwrite the existing files.","pos":[37384,37413]},{"pos":[37418,37573],"content":"Using Deployment Workbench, in the <bpt id=\"p1\">**</bpt>MDT Production / Advanced Configuration / Media<ept id=\"p1\">**</ept> node, right-click the <bpt id=\"p2\">**</bpt>MEDIA001<ept id=\"p2\">**</ept> media, and select <bpt id=\"p3\">**</bpt>Properties<ept id=\"p3\">**</ept>."},{"pos":[37578,37626],"content":"In the <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> tab, configure the following:"},{"content":"Clear the Generate x86 boot image check box.","pos":[37635,37679]},{"content":"ISO file name: Windows 10 Offline Media.iso","pos":[37688,37731]},{"pos":[37736,37820],"content":"Still in the <bpt id=\"p1\">**</bpt>Windows PE<ept id=\"p1\">**</ept> tab, in the <bpt id=\"p2\">**</bpt>Platform<ept id=\"p2\">**</ept> drop-down list, select <bpt id=\"p3\">**</bpt>x64<ept id=\"p3\">**</ept>."},{"pos":[37825,37886],"content":"In the <bpt id=\"p1\">**</bpt>General<ept id=\"p1\">**</ept> sub tab, configure the following settings:"},{"pos":[37895,37942],"content":"In the <bpt id=\"p1\">**</bpt>Lite Touch Boot Image Settings<ept id=\"p1\">**</ept> area:"},{"content":"Image description: MDT Production x64","pos":[37955,37992]},{"pos":[38001,38078],"content":"In the <bpt id=\"p1\">**</bpt>Windows PE Customizations<ept id=\"p1\">**</ept> area, set the Scratch space size to 128."},{"pos":[38083,38239],"content":"In the <bpt id=\"p1\">**</bpt>Drivers and Patches<ept id=\"p1\">**</ept> sub tab, select the <bpt id=\"p2\">**</bpt>WinPE x64<ept id=\"p2\">**</ept> selection profile and select the <bpt id=\"p3\">**</bpt>Include all drivers from the selection profile<ept id=\"p3\">**</ept> option."},{"pos":[38244,38257],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"Generate the offline media","pos":[38263,38289]},{"content":"You have now configured the offline media deployment share however the share has not yet been populated with the files required for deployment.","pos":[38291,38434]},{"content":"Now everything is ready you populate the deployment share content folder and generate the offline media ISO.","pos":[38435,38543]},{"pos":[38549,38660],"content":"On MDT01, using Deployment Workbench, navigate to the <bpt id=\"p1\">**</bpt>MDT Production / Advanced Configuration / Media<ept id=\"p1\">**</ept> node."},{"content":"Right-click the <bpt id=\"p1\">**</bpt>MEDIA001<ept id=\"p1\">**</ept> media, and select <bpt id=\"p2\">**</bpt>Update Media Content<ept id=\"p2\">**</ept>.","pos":[38665,38737]},{"content":"The Update Media Content process now generates the offline media in the <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>MDTOfflineMedia<ph id=\"ph2\">\\\\</ph>Content<ept id=\"p1\">**</ept> folder.","pos":[38738,38850]},{"content":"Create a bootable USB stick","pos":[38856,38883]},{"content":"The ISO that you got when updating the offline media item can be burned to a DVD and used directly (it will be bootable), but it is often more efficient to use USB sticks instead since they are faster and can hold more data.","pos":[38885,39109]},{"content":"(A dual-layer DVD is limited to 8.5 GB.) Follow these steps to create a bootable USB stick from the offline media content:","pos":[39110,39232]},{"content":"On a physical machine running Windows 7 or later, insert the USB stick you want to use.","pos":[39238,39325]},{"pos":[39330,39419],"content":"Copy the content of the <bpt id=\"p1\">**</bpt>MDTOfflineMedia<ph id=\"ph1\">\\\\</ph>Content<ept id=\"p1\">**</ept> folder to the root of the USB stick."},{"pos":[39424,39558],"content":"Start an elevated command prompt (run as Administrator), and start the Diskpart utility by typing <bpt id=\"p1\">**</bpt>Diskpart<ept id=\"p1\">**</ept> and pressing <bpt id=\"p2\">**</bpt>Enter<ept id=\"p2\">**</ept>."},{"content":"In the Diskpart utility, you can type <bpt id=\"p1\">**</bpt>list volume<ept id=\"p1\">**</ept> (or the shorter <bpt id=\"p2\">**</bpt>list vol<ept id=\"p2\">**</ept>) to list the volumes, but you really only need to remember the drive letter of the USB stick to which you copied the content.","pos":[39563,39771]},{"content":"In our example, the USB stick had the drive letter F.","pos":[39772,39825]},{"pos":[39830,39925],"content":"In the Diskpart utility, type <bpt id=\"p1\">**</bpt>select volume F<ept id=\"p1\">**</ept> (replace F with your USB stick drive letter)."},{"pos":[39930,39995],"content":"In the Diskpart utility, type <bpt id=\"p1\">**</bpt>active<ept id=\"p1\">**</ept>, and then type <bpt id=\"p2\">**</bpt>exit<ept id=\"p2\">**</ept>."},{"pos":[40026,40088],"content":"Unified Extensible Firmware Interface (UEFI)-based deployments"},{"content":"As referenced in <bpt id=\"p1\">[</bpt>Windows 10 deployment tools<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619546)</ept>, Unified Extensible Firmware Interface (UEFI)-based deployments are becoming more common.","pos":[40090,40275]},{"content":"In fact, when you create a generation 2 virtual machine in Hyper-V, you get a UEFI-based computer.","pos":[40276,40374]},{"content":"During deployment, MDT automatically detects that you have an UEFI-based machine and creates the partitions UEFI requires.","pos":[40375,40497]},{"content":"You do not need to update or change your task sequences in any way to accommodate UFEI.","pos":[40498,40585]},{"content":"figure 14","pos":[40589,40598]},{"content":"Figure 14.","pos":[40626,40636]},{"content":"The partitions when deploying an UEFI-based machine.","pos":[40637,40689]},{"content":"Related topics","pos":[40694,40708]},{"content":"Get started with the Microsoft Deployment Toolkit (MDT)","pos":[40711,40766]},{"content":"Create a Windows 10 reference image","pos":[40824,40859]},{"content":"Build a distributed environment for Windows 10 deployment","pos":[40903,40960]},{"content":"Refresh a Windows 7 computer with Windows 10","pos":[41026,41070]},{"content":"Replace a Windows 7 computer with a Windows 10 computer","pos":[41123,41178]},{"content":"Configure MDT settings","pos":[41242,41264]}],"content":"---\ntitle: Deploy a Windows 10 image using MDT 2013 Update 2 (Windows 10)\ndescription: This topic will show you how to take your reference image for Windows 10, and deploy that image to your environment using the Microsoft Deployment Toolkit (MDT), and MDT 2013 Update 2 specifically.\nms.assetid: 1d70a3d8-1b1d-4051-b656-c0393a93f83c\nkeywords: deployment, automate, tools, configure\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: mdt\nauthor: mtniehaus\n---\n\n# Deploy a Windows 10 image using MDT 2013 Update 2\n\n**Applies to**\n-   Windows 10\n\nThis topic will show you how to take your reference image for Windows 10, and deploy that image to your environment using the Microsoft Deployment Toolkit (MDT), and MDT 2013 Update 2 specifically. You will prepare for this by creating a MDT deployment share that is used solely for image deployment. Separating the processes of creating reference images from the processes used to deploy them in production allows greater control of on both processes. You will then configure the deployment share, create a new task sequence, add applications, add drivers, add rules, and configure Active Directory permissions for deployment.\n\nFor the purposes of this topic, we will use three machines: DC01, MDT01, and PC0005. DC01 is a domain controller, MDT01 is a Windows Server 2012 R2 standard server, and PC0005 is a blank machine to which you deploy Windows 10. MDT01 and PC0005 are members of the domain contoso.com for the fictitious Contoso Corporation.\n\n**Note**  \nFor important details about the setup for the steps outlined in this article, please see [Deploy Windows 10 with the Microsoft Deployment Toolkit](deploy-windows-10-with-the-microsoft-deployment-toolkit.md).\n \n![figure 1](images/mdt-07-fig01.png)\n\nFigure 1. The machines used in this topic.\n\n## <a href=\"\" id=\"sec01\"></a>Step 1: Configure Active Directory permissions\n\nThese steps will show you how to configure an Active Directory account with the permissions required to deploy a Windows 10 machine to the domain using MDT. These steps assume you have downloaded the sample [Set-OUPermissions.ps1 script](http://go.microsoft.com/fwlink/p/?LinkId=619362) and copied it to C:\\\\Setup\\\\Scripts on DC01. The account is used for Windows Preinstallation Environment (Windows PE) to connect to MDT01. In order for MDT to join machines into the contoso.com domain you need to create an account and configure permissions in Active Directory.\n1.  On DC01, using Active Directory User and Computers, browse to **contoso.com / Contoso / Service Accounts**.\n2.  Select the **Service Accounts** organizational unit (OU) and create the MDT\\_JD account using the following settings:\n    1.  Name: MDT\\_JD\n    2.  User logon name: MDT\\_JD\n    3.  Password: P@ssw0rd\n    4.  User must change password at next logon: Clear\n    5.  User cannot change password: Select\n    6.  Password never expires: Select\n3.  In an elevated Windows PowerShell prompt (run as Administrator), run the following commands and press **Enter** after each command:\n    ``` syntax\n    Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force\n    Set-Location C:\\Setup\\Scripts\n    .\\Set-OUPermissions.ps1 -Account MDT_JD \n    -TargetOU \"OU=Workstations,OU=Computers,OU=Contoso\"\n    ```\n4.  The Set-OUPermissions.ps1 script allows the MDT\\_JD user account permissions to manage computer accounts in the Contoso / Computers OU. Below you find a list of the permissions being granted:\n    1.  Scope: This object and all descendant objects\n        1.  Create Computer objects\n        2.  Delete Computer objects\n    2.  Scope: Descendant Computer objects\n        1.  Read All Properties\n        2.  Write All Properties\n        3.  Read Permissions\n        4.  Modify Permissions\n        5.  Change Password\n        6.  Reset Password\n        7.  Validated write to DNS host name\n        8.  Validated write to service principal name\n\n## <a href=\"\" id=\"sec02\"></a>Step 2: Set up the MDT production deployment share\n\nWhen you are ready to deploy Windows 10 in a production environment, you will first create a new MDT deployment share. You should not use the same deployment share that you used to create the reference image for a production deployment. For guidance on creating a custom Windows 10 image, see \n[Create a Windows 10 reference image](create-a-windows-10-reference-image.md).\n\n### Create the MDT production deployment share\n\nThe steps for creating the deployment share for production are the same as when you created the deployment share for creating the custom reference image:\n1.  On MDT01, log on as Administrator in the CONTOSO domain using a password of **P@ssw0rd.**\n2.  Using the Deployment Workbench, right-click **Deployment Shares** and select **New Deployment Share**.\n3.  On the **Path** page, in the **Deployment share path** text box, type **E:\\\\MDTProduction** and click **Next**.\n4.  On the **Share** page, in the **Share name** text box, type **MDTProduction$** and click **Next**.\n5.  On the **Descriptive Name** page, in the **Deployment share description** text box, type **MDT Production** and click **Next**.\n6.  On the **Options** page, accept the default settings and click **Next** twice, and then click **Finish**.\n7.  Using File Explorer, verify that you can access the **\\\\\\\\MDT01\\\\MDTProduction$** share.\n\n## <a href=\"\" id=\"sec03\"></a>Step 3: Add a custom image\n\nThe next step is to add a reference image into the deployment share with the setup files required to successfully deploy Windows 10. When adding a custom image, you still need to copy setup files (an option in the wizard) because Windows 10 stores additional components in the Sources\\\\SxS folder which is outside the image and may be required when installing components.\n\n### Add the Windows 10 Enterprise x64 RTM custom image\n\nIn these steps, we assume that you have completed the steps in the [Create a Windows 10 reference image](create-a-windows-10-reference-image.md) topic, so you have a Windows 10 reference image in the E:\\\\MDTBuildLab\\\\Captures folder on MDT01.\n1.  Using the Deployment Workbench, expand the **Deployment Shares** node, and then expand **MDT Production**; select the **Operating Systems** node, and create a folder named **Windows 10**.\n2.  Right-click the **Windows 10** folder and select **Import Operating System**.\n3.  On the **OS Type** page, select **Custom image file** and click **Next**.\n4.  On the **Image** page, in the **Source file** text box, browse to **E:\\\\MDTBuildLab\\\\Captures\\\\REFW10X64-001.wim** and click **Next**.\n5.  On the **Setup** page, select the **Copy Windows 7, Windows Server 2008 R2, or later setup files from the specified path** option; in the **Setup source directory** text box, browse to **E:\\\\MDTBuildLab\\\\Operating Systems\\\\W10EX64RTM** and click **Next**.\n6.  On the **Destination** page, in the **Destination directory name** text box, type **W10EX64RTM**, click **Next** twice, and then click **Finish**.\n7.  After adding the operating system, double-click the added operating system name in the **Operating Systems / Windows 10** node and change the name to match the following: **Windows 10 Enterprise x64 RTM Custom Image**.\n\n**Note**  \nThe reason for adding the setup files has changed since earlier versions of MDT. MDT 2010 used the setup files to install Windows. MDT uses DISM to apply the image; however, you still need the setup files because some components in roles and features are stored outside the main image.\n \n![figure 2](images/fig2-importedos.png)\n\nFigure 2. The imported operating system after renaming it.\n\n## <a href=\"\" id=\"sec04\"></a>Step 4: Add an application\n\nWhen you configure your MDT Build Lab deployment share, you will also add any applications to the new deployment share before creating your task sequence. This section walks you through the process of adding an application to the MDT Production deployment share using Adobe Reader as an example.\n\n### Create the install: Adobe Reader XI x86\n\nIn this example, we assume that you have downloaded the Adobe Reader XI installation file (AdbeRdr11000\\_eu\\_ES.msi) to E:\\\\Setup\\\\Adobe Reader on MDT01.\n1.  Using the Deployment Workbench, expand the **MDT Production** node and navigate to the **Applications** node.\n2.  Right-click the **Applications** node, and create a new folder named **Adobe**.\n3.  In the **Applications** node, right-click the **Adobe** folder and select **New Application**.\n4.  On the **Application Type** page, select the **Application with source files** option and click **Next**.\n5.  On the **Details** page, in the **Application** name text box, type **Install - Adobe Reader XI - x86** and click **Next**.\n6.  On the **Source** page, in the **Source Directory** text box, browse to **E:\\\\Setup\\\\Adobe Reader XI** and click **Next**.\n7.  On the **Destination** page, in the **Specify the name of the directory that should be created** text box, type **Install - Adobe Reader XI - x86** and click **Next**.\n8.  On the **Command Details** page, in the **Command Line** text box, type **msiexec /i AdbeRdr11000\\_eu\\_ES.msi /q**, click **Next** twice, and then click **Finish**.\n\n![figure 3](images/mdt-07-fig03.png)\n\nFigure 3. The Adobe Reader application added to the Deployment Workbench.\n\n## <a href=\"\" id=\"sec05\"></a>Step 5: Prepare the drivers repository\n\nIn order to deploy Windows 10 with MDT 2013 Update 2 successfully, you need drivers for the boot images and for the actual operating system. This section will show you how to add drivers for the boot image and operating system, using the following hardware models as examples:\n-   Lenovo ThinkPad T420\n-   Dell Latitude E6440\n-   HP EliteBook 8560w\n-   Microsoft Surface Pro\nFor boot images, you need to have storage and network drivers; for the operating system, you need to have the full suite of drivers.\n\n**Note**  \nYou should only add drivers to the Windows PE images if the default drivers don't work. Adding drivers that are not necessary will only make the boot image larger and potentially delay the download time.\n \n### Create the driver source structure in the file system\n\nThe key to successful management of drivers for MDT 2013 Update 2, as well as for any other deployment solution, is to have a really good driver repository. From this repository, you import drivers into MDT for deployment, but you should always maintain the repository for future use.\n\n1.  On MDT01, using File Explorer, create the **E:\\\\Drivers** folder.\n2.  In the **E:\\\\Drivers** folder, create the following folder structure:\n    1.  WinPE x86\n    2.  WinPE x64\n    3.  Windows 10 x64\n3.  In the new Windows 10 x64 folder, create the following folder structure:\n    -   Dell\n        -   Latitude E6440\n    -   HP\n        -   HP EliteBook 8560w\n    -   Lenovo\n        -   ThinkPad T420 (4178)\n    -   Microsoft Corporation\n        -   Surface Pro 3\n\n**Note**  \nEven if you are not going to use both x86 and x64 boot images, we still recommend that you add the support structure for future use.\n \n### Create the logical driver structure in MDT 2013 Update 2\n\nWhen you import drivers to the MDT 2013 Update 2 driver repository, MDT creates a single instance folder structure based on driver class names. However, you can, and should, mimic the driver structure of your driver source repository in the Deployment Workbench. This is done by creating logical folders in the Deployment Workbench.\n1.  On MDT01, using Deployment Workbench, select the **Out-of-Box Drivers** node.\n2.  In the **Out-Of-Box Drivers** node, create the following folder structure:\n    1.  WinPE x86\n    2.  WinPE x64\n    3.  Windows 10 x64\n3.  In the **Windows 10 x64** folder, create the following folder structure:\n    -   Dell Inc.\n        -   Latitude E6440\n    -   Hewlett-Packard\n        -   HP EliteBook 8560w\n    -   Lenovo\n        -   4178\n    -   Microsoft Corporation\n        -   Surface Pro 3\n\nThe preceding folder names are selected because they match the actual make and model values that MDT reads from the machines during deployment. You can find out the model values for your machines via the following command in Windows PowerShell:\n``` syntax\nGet-WmiObject -Class:Win32_ComputerSystem\n```\nOr, you can use this command in a normal command prompt:\n``` syntax\nwmic csproduct get name\n```\n\nIf you want a more standardized naming convention, try the ModelAliasExit.vbs script from the Deployment Guys blog post entitled [Using and Extending Model Aliases for Hardware Specific Application Installation](http://go.microsoft.com/fwlink/p/?LinkId=619536).\n\n![figure 4](images/fig4-oob-drivers.png)\n\nFigure 4. The Out-of-Box Drivers structure in Deployment Workbench.\n\n### Create the selection profiles for boot image drivers\n\nBy default, MDT adds any storage and network drivers that you import to the boot images. However, you should add only the drivers that are necessary to the boot image. You can control which drivers are added by using selection profiles.\nThe drivers that are used for the boot images (Windows PE) are Windows 10 drivers. If you can’t locate Windows 10 drivers for your device, a Windows 7 or Windows 8.1 driver will most likely work, but Windows 10 drivers should be your first choice.\n1.  On MDT01, using the Deployment Workbench, in the **MDT Production** node, expand the **Advanced Configuration** node, right-click the **Selection Profiles** node, and select **New Selection Profile**.\n2.  In the New Selection Profile Wizard, create a selection profile with the following settings:\n    1.  Selection Profile name: WinPE x86\n    2.  Folders: Select the WinPE x86 folder in Out-of-Box Drivers.\n3.  Again, right-click the **Selection Profiles** node, and select **New Selection Profile**.\n4.  In the New Selection Profile Wizard, create a selection profile with the following settings:\n    1.  Selection Profile name: WinPE x64\n    2.  Folders: Select the WinPE x64 folder in Out-of-Box Drivers.\n\n![figure 5](images/fig5-selectprofile.png)\n\nFigure 5. Creating the WinPE x64 selection profile.\n\n### Extract and import drivers for the x64 boot image\n\nWindows PE supports all the hardware models that we have, but here you learn to add boot image drivers to accommodate any new hardware that might require additional drivers. In this example, you add the latest Intel network drivers to the x64 boot image.\nIn these steps, we assume you have downloaded PROWinx64.exe from Intel.com and saved it to a temporary folder.\n\n1.  Extract PROWinx64.exe to a temporary folder - in this example to the **C:\\\\Tmp\\\\ProWinx64** folder.\n2.  Using File Explorer, create the **E:\\\\Drivers\\\\WinPE x64\\\\Intel PRO1000** folder.\n3.  Copy the content of the **C:\\\\Tmp\\\\PROWinx64\\\\PRO1000\\\\Winx64\\\\NDIS64** folder to the **E:\\\\Drivers\\\\WinPE x64\\\\Intel PRO1000** folder.\n4.  Using Deployment Workbench, expand the **Out-of-Box Drivers** node, right-click the **WinPE x64** node, and select **Import Drivers**. Use the following setting for the Import Drivers Wizard:\n    -   Driver source directory: **E:\\\\Drivers\\\\WinPE x64\\\\Intel PRO1000**\n\n### Download, extract, and import drivers\n\n### For the ThinkPad T420\n\nFor the Lenovo T420 model, you use the Lenovo ThinkVantage Update Retriever software to download the drivers. With Update Retriever, you need to specify the correct Lenovo Machine Type for the actual hardware (the first four characters of the model name). As an example, the Lenovo T420 model has the 4178B9G model name, meaning the Machine Type is 4178.\n\nTo get the updates, you download the drivers from the Lenovo ThinkVantage Update Retriever using its export function. You can download the drivers from the [Lenovo website](http://go.microsoft.com/fwlink/p/?LinkId=619543).\n\nIn these steps, we assume you have downloaded and extracted the drivers using ThinkVantage Update Retriever v5.0 to the E:\\\\Drivers\\\\Lenovo\\\\ThinkPad T420 (4178) folder.\n\n1.  On MDT01, using the Deployment Workbench, in the **MDT Production** node, expand the **Out-Of-Box Drivers** node, and expand the **Lenovo** node.\n2.  Right-click the **4178** folder and select **Import Drivers**; use the following setting for the Import Drivers Wizard:\n    -   Driver source directory: **E:\\\\Drivers\\\\Windows 10 x64\\\\Lenovo\\\\ThinkPad T420 (4178)**\n\n### For the Latitude E6440\n\nFor the Dell Latitude E6440 model, you use the Dell Driver CAB file, which is accessible via the [Dell TechCenter website](http://go.microsoft.com/fwlink/p/?LinkId=619544).\n\nIn these steps, we assume you have downloaded and extracted the CAB file for the Latitude E6440 model to the E:\\\\Drivers\\\\Dell\\\\Latitude E6440 folder.\n\n1.  On **MDT01**, using the **Deployment Workbench**, in the **MDT Production** node, expand the **Out-Of-Box Drivers** node, and expand the **Dell** node.\n2.  Right-click the **Latitude E6440** folder and select **Import Drivers**; use the following setting for the Import Drivers Wizard:\n    -   Driver source directory: **E:\\\\Drivers\\\\Windows 10 x64\\\\Dell\\\\Latitude E6440**\n\n### For the HP EliteBook 8560w\n\nFor the HP EliteBook 8560w, you use HP SoftPaq Download Manager to get the drivers. The HP SoftPaq Download Manager can be accessed on the [HP Support site](http://go.microsoft.com/fwlink/p/?LinkId=619545).\n\nIn these steps, we assume you have downloaded and extracted the drivers for the HP EliteBook 8650w model to the E:\\\\Drivers\\\\Windows 10 x64\\\\HP\\\\HP EliteBook 8560w folder.\n\n1.  On **MDT01**, using the **Deployment Workbench**, in the **MDT Production** node, expand the **Out-Of-Box Drivers** node, and expand the **Hewlett-Packard** node.\n2.  Right-click the **HP EliteBook 8560w** folder and select **Import Drivers**; use the following setting for the Import Drivers Wizard:\n    -   Driver source directory: **E:\\\\Drivers\\\\Windows 10 x64\\\\HP\\\\HP EliteBook 8560w**\n\n### For the Microsoft Surface Pro 3\n\nFor the Microsoft Surface Pro model, you find the drivers on the Microsoft website. In these steps we assume you have downloaded and extracted the Surface Pro 3 drivers to the E:\\\\Drivers\\\\Windows 10 x64\\\\Microsoft\\\\Surface Pro 3 folder.\n\n1.  On MDT01, using the Deployment Workbench, in the **MDT Production** node, expand the **Out-Of-Box Drivers** node, and expand the **Microsoft** node.\n2.  Right-click the **Surface Pro 3** folder and select **Import Drivers**; use the following setting for the Import Drivers Wizard:\n    -   Driver source directory: **E:\\\\Drivers\\\\Windows 10 x64\\\\Microsoft\\\\Surface Pro 3**\n\n## <a href=\"\" id=\"sec06\"></a>Step 6: Create the deployment task sequence\n\nThis section will show you how to create the task sequence used to deploy your production Windows 10 reference image. You will then configure the tasks sequence to enable patching via a Windows Server Update Services (WSUS) server.\n\n### Create a task sequence for Windows 10 Enterprise\n\n1.  Using the Deployment Workbench, select **Task Sequences** in the **MDT Production** node, and create a folder named **Windows 10**.\n2.  Right-click the new **Windows 10** folder and select **New Task Sequence**. Use the following settings for the New Task Sequence Wizard:\n    1.  Task sequence ID: W10-X64-001\n    2.  Task sequence name: Windows 10 Enterprise x64 RTM Custom Image\n    3.  Task sequence comments: Production Image\n    4.  Template: Standard Client Task Sequence\n    5.  Select OS: Windows 10 Enterprise x64 RTM Custom Image\n    6.  Specify Product Key: Do not specify a product key at this time\n    7.  Full Name: Contoso\n    8.  Organization: Contoso\n    9.  Internet Explorer home page: about:blank\n    10. Admin Password: Do not specify an Administrator Password at this time\n### Edit the Windows 10 task sequence\n\n1.  Right-click the **Windows 10 Enterprise x64 RTM Custom Image** task sequence, and select **Properties**.\n2.  On the **Task Sequence** tab, configure the **Windows 10 Enterprise x64 RTM Custom Image** task sequence with the following settings:\n    1.  Preinstall. After the **Enable BitLocker (Offline)** action, add a **Set Task Sequence Variable** action with the following settings:\n        1.  Name: Set DriverGroup001\n        2.  Task Sequence Variable: DriverGroup001\n        3.  Value: Windows 10 x64\\\\%Make%\\\\%Model%\n    2.  Configure the **Inject Drivers** action with the following settings:\n        1.  Choose a selection profile: Nothing\n        2.  Install all drivers from the selection profile\n            **Note**  \n            The configuration above indicates that MDT should only use drivers from the folder specified by the DriverGroup001 property, which is defined by the \"Choose a selection profile: Nothing\" setting, and that MDT should not use plug and play to determine which drivers to copy, which is defined by the \"Install all drivers from the selection profile\" setting.\n             \n    3.  State Restore. Enable the **Windows Update (Pre-Application Installation)** action.\n    4.  State Restore. Enable the **Windows Update (Post-Application Installation)** action.\n3.  Click **OK**.\n\n![figure 6](images/fig6-taskseq.png)\n\nFigure 6. The task sequence for production deployment.\n\n## <a href=\"\" id=\"sec07\"></a>Step 7: Configure the MDT production deployment share\n\nIn this section, you will learn how to configure the MDT Build Lab deployment share with the rules required to create a simple and dynamic deployment process. This includes configuring commonly used rules and an explanation of how these rules work.\n\n### Configure the rules\n\n1.  On MDT01, using File Explorer, copy the following files from the **D:\\\\Setup\\\\Sample Files\\\\MDT Production\\\\Control** folder to **E:\\\\MDTProduction\\\\Control**. Overwrite the existing files.\n    1.  Bootstrap.ini\n    2.  CustomSettings.ini\n2.  Right-click the **MDT Production** deployment share and select **Properties**.\n3.  Select the **Rules** tab and modify using the following information:\n    ``` syntax\n    [Settings]\n    Priority=Default\n    [Default]\n    _SMSTSORGNAME=Contoso\n    OSInstall=YES\n    UserDataLocation=AUTO\n    TimeZoneName=Pacific Standard Time \n    AdminPassword=P@ssw0rd\n    JoinDomain=contoso.com\n    DomainAdmin=CONTOSO\\MDT_JD\n    DomainAdminPassword=P@ssw0rd\n    MachineObjectOU=OU=Workstations,OU=Computers,OU=Contoso,DC=contoso,DC=com\n    SLShare=\\\\MDT01\\Logs$\n    ScanStateArgs=/ue:*\\* /ui:CONTOSO\\*\n    USMTMigFiles001=MigApp.xml\n    USMTMigFiles002=MigUser.xml\n    HideShell=YES\n    ApplyGPOPack=NO\n    WSUSServer=mdt01.contoso.com:8530\n    SkipAppsOnUpgrade=NO\n    SkipAdminPassword=YES\n    SkipProductKey=YES\n    SkipComputerName=NO\n    SkipDomainMembership=YES\n    SkipUserData=YES\n    SkipLocaleSelection=YES\n    SkipTaskSequence=NO\n    SkipTimeZone=YES\n    SkipApplications=NO\n    SkipBitLocker=YES\n    SkipSummary=YES\n    SkipCapture=YES\n    SkipFinalSummary=NO\n    ```\n4.  Click **Edit Bootstrap.ini** and modify using the following information:\n    ``` syntax\n    [Settings]\n    Priority=Default\n    [Default]\n    DeployRoot=\\\\MDT01\\MDTProduction$\n    UserDomain=CONTOSO\n    UserID=MDT_BA\n    SkipBDDWelcome=YES\n    ```\n5.  In the **Windows PE** tab, in the **Platform** drop-down list, make sure **x86** is selected.\n6.  In the **General** sub tab, configure the following settings:\n    -   In the **Lite Touch Boot Image Settings** area:\n        1.  Image description: MDT Production x86\n        2.  ISO file name: MDT Production x86.iso\n        **Note**  \n        Because you are going to use Pre-Boot Execution Environment (PXE) later to deploy the machines, you do not need the ISO file; however, we recommend creating ISO files because they are useful when troubleshooting deployments and for quick tests.\n         \n7.  In the **Drivers and Patches** sub tab, select the **WinPE x86** selection profile and select the **Include all drivers from the selection profile** option.\n8.  In the **Windows PE** tab, in the **Platform** drop-down list, select **x64**.\n9.  In the **General** sub tab, configure the following settings:\n    -   In the **Lite Touch Boot Image Settings** area:\n        1.  Image description: MDT Production x64\n        2.  ISO file name: MDT Production x64.iso\n10. In the **Drivers and Patches** sub tab, select the **WinPE x64** selection profile and select the **Include all drivers from the selection profile** option.\n11. In the **Monitoring** tab, select the **Enable monitoring for this deployment share** check box.\n12. Click **OK**.\n\n**Note**  \nIt will take a while for the Deployment Workbench to create the monitoring database and web service.\n \n\n![figure 8](images/mdt-07-fig08.png)\n\nFigure 7. The Windows PE tab for the x64 boot image.\n\n### The rules explained\n\nThe rules for the MDT Production deployment share are somewhat different from those for the MDT Build Lab deployment share. The biggest differences are that you deploy the machines into a domain instead of a workgroup and that you do not automate the logon.\n\n### The Bootstrap.ini file\n\nThis is the MDT Production Bootstrap.ini without the user credentials (except domain information):\n``` syntax\n[Settings]\nPriority=Default\n[Default]\nDeployRoot=\\\\MDT01\\MDTProduction$\nUserDomain=CONTOSO\nUserID=MDT_BA\nSkipBDDWelcome=YES\n```\n### The CustomSettings.ini file\n\nThis is the CustomSettings.ini file with the new join domain information:\n``` syntax\n[Settings]\nPriority=Default\n[Default]\n_SMSTSORGNAME=Contoso\nOSInstall=Y\nUserDataLocation=AUTO\nTimeZoneName=Pacific Standard Time \nAdminPassword=P@ssw0rd\nJoinDomain=contoso.com\nDomainAdmin=CONTOSO\\MDT_JD\nDomainAdminPassword=P@ssw0rd\nMachineObjectOU=OU=Workstations,OU=Computers,OU=Contoso,DC=contoso,DC=com\nSLShare=\\\\MDT01\\Logs$\nScanStateArgs=/ue:*\\* /ui:CONTOSO\\*\nUSMTMigFiles001=MigApp.xml\nUSMTMigFiles002=MigUser.xml\nHideShell=YES\nApplyGPOPack=NO\nWSUSServer=http://mdt01.contoso.com:8530\nSkipAppsOnUpgrade=NO\nSkipAdminPassword=YES\nSkipProductKey=YES\nSkipComputerName=NO\nSkipDomainMembership=YES\nSkipUserData=YES\nSkipLocaleSelection=YES\nSkipTaskSequence=NO\nSkipTimeZone=YES\nSkipApplications=NO\nSkipBitLocker=YES\nSkipSummary=YES\nSkipCapture=YES\nSkipFinalSummary=NO\nEventService=http://MDT01:9800\n```\nThe additional properties to use in the MDT Production rules file are as follows:\n-   **JoinDomain.** The domain to join.\n-   **DomainAdmin.** The account to use when joining the machine to the domain.\n-   **DomainAdminDomain.** The domain for the join domain account.\n-   **DomainAdminPassword.** The password for the join domain account.\n-   **MachineObjectOU.** The organizational unit (OU) to which to add the computer account.\n-   **ScanStateArgs.** Arguments for the User State Migration Tool (USMT) ScanState command.\n-   **USMTMigFiles(\\*).** List of USMT templates (controlling what to backup and restore).\n-   **EventService.** Activates logging information to the MDT monitoring web service.\n\n### Optional deployment share configuration\n\nIf your organization has a Microsoft Software Assurance agreement, you also can subscribe to the additional Microsoft Desktop Optimization Package (MDOP) license (at an additional cost). Included in MDOP is Microsoft Diagnostics and Recovery Toolkit (DaRT), which contains tools that can help you \ntroubleshoot MDT deployments, as well as troubleshoot Windows itself.\n\n### Add DaRT 10 to the boot images\n\nIf you have licensing for MDOP and DaRT, you can add DaRT to the boot images using the steps in this section. If you do not have DaRT licensing, or don't want to use it, simply skip to the next section, [Update the Deployment Share](#bkmk-update-deployment). To enable the remote connection feature in MDT 2013 Update 2, you need to do the following:\n-   Install DaRT 10 (part of MDOP 2015 R1).\n-   Copy the two tools CAB files (Toolsx86.cab and Toolsx64.cab) to the deployment share.\n-   Configure the deployment share to add DaRT.\nIn these steps, we assume that you downloaded MDOP 2015 R1 and copied DaRT 10 to the E:\\\\Setup\\\\DaRT 10 folder on MDT01.\n1.  On MDT01, install DaRT 10 (MSDaRT10.msi) using the default settings.\n2.  Using File Explorer, navigate to the **C:\\\\Program Files\\\\Microsoft DaRT\\\\v10** folder.\n3.  Copy the Toolsx64.cab file to **E:\\\\MDTProduction\\\\Tools\\\\x64**.\n4.  Copy the Toolsx86.cab file to **E:\\\\MDTProduction\\\\Tools\\\\x86**.\n5.  Using the Deployment Workbench, right-click the **MDT Production** deployment share and select **Properties**.\n6.  In the **Windows PE** tab, in the **Platform** drop-down list, make sure **x86** is selected.\n7.  In the **Features** sub tab, select the **Microsoft Diagnostics and Recovery Toolkit (DaRT)** check box.\n\n    ![figure 8](images/mdt-07-fig09.png)\n\n    Figure 8. Selecting the DaRT 10 feature in the deployment share.\n\n8.  In the **Windows PE** tab, in the **Platform** drop-down list, select **x64**.\n9.  In the **Features** sub tab, in addition to the default selected feature pack, select the **Microsoft Diagnostics and Recovery Toolkit (DaRT)** check box.\n10. Click **OK**.\n\n### <a href=\"\" id=\"bkmk-update-deployment\"></a>Update the deployment share\n\nLike the MDT Build Lab deployment share, the MDT Production deployment share needs to be updated after it has been configured. This is the process during which the Windows PE boot images are created.\n1.  Right-click the **MDT Production** deployment share and select **Update Deployment Share**.\n2.  Use the default options for the Update Deployment Share Wizard.\n\n**Note**  \nThe update process will take 5 to 10 minutes.\n \n## <a href=\"\" id=\"sec08\"></a>Step 8: Deploy the Windows 10 client image\n\nThese steps will walk you throug the process of using task sequences to deploy Windows 10 images through a fully automated process. First, you need to add the boot image to Windows Deployment Services (WDS) and then start the deployment. In contrast with deploying images from the MDT Build Lab deployment share, we recommend using the Pre-Installation Execution Environment (PXE) to start the full deployments in the datacenter, even though you technically can use an ISO/CD or USB to start the process.\n\n### Configure Windows Deployment Services\n\nYou need to add the MDT Production Lite Touch x64 Boot image to WDS in preparation for the deployment. For the following steps, we assume that Windows Deployment Services has already been installed on MDT01.\n1.  Using the WDS console, right-click **Boot Images** and select **Add Boot Image**.\n2.  Browse to the E:\\\\MDTProduction\\\\Boot\\\\LiteTouchPE\\_x64.wim file and add the image with the default settings.\n\n![figure 9](images/mdt-07-fig10.png)\n\nFigure 9. The boot image added to the WDS console.\n\n### Deploy the Windows 10 client\n\nAt this point, you should have a solution ready for deploying the Windows 10 client. We recommend starting by trying a few deployments at a time until you are confident that your configuration works as expected. We find it useful to try some initial tests on virtual machines before testing on physical hardware. This helps rule out hardware issues when testing or troubleshooting. Here are the steps to deploy your Windows 10 image to a virtual machine:\n1.  Create a virtual machine with the following settings:\n    1.  Name: PC0005\n    2.  Location: C:\\\\VMs\n    3.  Generation: 2\n    4.  Memory: 2048 MB\n    5.  Hard disk: 60 GB (dynamic disk)\n2.  Start the PC0005 virtual machine, and press **Enter** to start the PXE boot. The machine will now load the Windows PE boot image from the WDS server.\n\n    ![figure 10](images/mdt-07-fig11.png)\n\n    Figure 10. The initial PXE boot process of PC0005.\n\n3.  After Windows PE has booted, complete the Windows Deployment Wizard using the following setting:\n    1.  Password: P@ssw0rd\n    2.  Select a task sequence to execute on this computer: Windows 10 Enterprise x64 RTM Custom Image\n    3.  Computer Name: PC0005\n    4.  Applications: Select the Install - Adobe Reader XI - x86 application.\n4.  The setup now starts and does the following:\n    1.  Installs the Windows 10 Enterprise operating system.\n    2.  Installs the added application.\n    3.  Updates the operating system via your local Windows Server Update Services (WSUS) server.\n\n### Use the MDT 2013 monitoring feature\n\nNow that you have enabled the monitoring on the MDT Production deployment share, you can follow your deployment of PC0005 via the monitoring node.\n\n1.  On MDT01, using Deployment Workbench, expand the **MDT Production** deployment share folder.\n2.  Select the **Monitoring** node, and wait until you see PC0005.\n3.  Double-click PC0005, and review the information.\n\n![figure 11](images/mdt-07-fig13.png)\n\nFigure 11. The Monitoring node, showing the deployment progress of PC0005.\n\n### Use information in the Event Viewer\n\nWhen monitoring is enabled, MDT also writes information to the event viewer on MDT01. This information can be used to trigger notifications via scheduled tasks when deployment is completed. For example, you can configure scheduled tasks to send an email when a certain event is created in the event log.\n\n![figure 12](images/mdt-07-fig14.png)\n\nFigure 12. The Event Viewer showing a successful deployment of PC0005.\n\n## <a href=\"\" id=\"sec09\"></a>Multicast deployments\n\nMulticast deployment allows for image deployment with reduced network load during simultaneous deployments. Multicast is a useful operating system deployment feature in MDT deployments, however it is important to ensure that your network supports it and is designed for it.\n\n### Requirements\n\nMulticast requires that Windows Deployment Services (WDS) is running on Windows Server 2008 or later. In addition to the core MDT 2013 setup for multicast, the network needs to be configured to support multicast. In general, this means involving the organization networking team to make sure that \nInternet Group Management Protocol (IGMP) snooping is turned on and that the network is designed for multicast traffic. The multicast solution uses IGMPv3.\n\n### Set up MDT for multicast\n\nSetting up MDT for multicast is straightforward. You enable multicast on the deployment share, and MDT takes care of the rest.\n\n1.  On MDT01, right-click the **MDT Production** deployment share folder and select **Properties**.\n2.  In the **General** tab, select the **Enable multicast for this deployment share (requires Windows Server 2008 R2 Windows Deployment Services)** check box, and click **OK**.\n3.  Right-click the **MDT Production** deployment share folder and select **Update Deployment Share**.\n4.  After updating the deployment share, use the Windows Deployment Services console to, verify that the multicast namespace was created.\n\n![figure 13](images/mdt-07-fig15.png)\n\nFigure 13. The newly created multicast namespace.\n\n## <a href=\"\" id=\"sec10\"></a>Use offline media to deploy Windows 10\n\nIn addition to network-based deployments, MDT supports the use of offline media-based deployments of Windows 10. You can very easily generate an offline version of your deployment share - either the full deployment share or a subset of it - by the use of selection profiles. The generated offline media can be burned to a DVD or copied to a USB stick for deployment.\n\nOffline media are useful not only when you do not have network connectivity to the deployment share, but also when you have limited connection to the deployment share and do not want to copy 5 GB of data over the wire. Offline media can still join the domain, but you save the transfer of operating system images, drivers, and applications over the wire.\n\n### Create the offline media selection profile\n\nTo filter what is being added to the media, you create a selection profile. When creating selection profiles, you quickly realize the benefits of having created a good logical folder structure in the Deployment Workbench.\n1.  On MDT01, using Deployment Workbench, in the **MDT Production / Advanced Configuration** node, right-click **Selection Profile**, and select **New Selection Profile**.\n2.  Use the following settings for the New Selection Profile Wizard:\n    1.  General Settings\n        -   Selection profile name: Windows 10 Offline Media\n    2.  Folders\n        1.  Applications / Adobe\n        2.  Operating Systems / Windows 10\n        3.  Out-Of-Box Drivers / WinPE x64\n        4.  Out-Of-Box Drivers / Windows 10 x64\n        5.  Task Sequences / Windows 10\n\n### Create the offline media\n\nIn these steps, you generate offline media from the MDT Production deployment share. To filter what is being added to the media, you use the previously created selection profile.\n\n1.  On MDT01, using File Explorer, create the **E:\\\\MDTOfflineMedia** folder.\n    **Note**  \n    When creating offline media, you need to create the target folder first. It is crucial that you do not create a subfolder inside the deployment share folder because it will break the offline media.\n     \n2.  Using Deployment Workbench, in the **MDT Production / Advanced Configuration** node, right-click the **Media** node, and select **New Media**.\n3.  Use the following settings for the New Media Wizard:\n    -   General Settings\n        1.  Media path: **E:\\\\MDTOfflineMedia**\n        2.  Selection profile: Windows 10 Offline Media\n\n### Configure the offline media\n\nOffline media has its own rules, its own Bootstrap.ini and CustomSettings.ini files. These files are stored in the Control folder of the offline media; they also can be accessed via properties of the offline media in the Deployment Workbench.\n\n1.  On MDT01, using File Explorer, copy the CustomSettings.ini file from the **E:\\\\MDTBuildLab\\\\Control** folder to **E:\\\\MDTOfflineMedia\\\\Content\\\\Deploy\\\\Control**. Overwrite the existing files.\n2.  Using Deployment Workbench, in the **MDT Production / Advanced Configuration / Media** node, right-click the **MEDIA001** media, and select **Properties**.\n3.  In the **General** tab, configure the following:\n    1.  Clear the Generate x86 boot image check box.\n    2.  ISO file name: Windows 10 Offline Media.iso\n4.  Still in the **Windows PE** tab, in the **Platform** drop-down list, select **x64**.\n5.  In the **General** sub tab, configure the following settings:\n    1.  In the **Lite Touch Boot Image Settings** area:\n        -   Image description: MDT Production x64\n    2.  In the **Windows PE Customizations** area, set the Scratch space size to 128.\n6.  In the **Drivers and Patches** sub tab, select the **WinPE x64** selection profile and select the **Include all drivers from the selection profile** option.\n7.  Click **OK**.\n\n### Generate the offline media\n\nYou have now configured the offline media deployment share however the share has not yet been populated with the files required for deployment. Now everything is ready you populate the deployment share content folder and generate the offline media ISO.\n\n1.  On MDT01, using Deployment Workbench, navigate to the **MDT Production / Advanced Configuration / Media** node.\n2.  Right-click the **MEDIA001** media, and select **Update Media Content**. The Update Media Content process now generates the offline media in the **E:\\\\MDTOfflineMedia\\\\Content** folder.\n\n### Create a bootable USB stick\n\nThe ISO that you got when updating the offline media item can be burned to a DVD and used directly (it will be bootable), but it is often more efficient to use USB sticks instead since they are faster and can hold more data. (A dual-layer DVD is limited to 8.5 GB.)\nFollow these steps to create a bootable USB stick from the offline media content:\n\n1.  On a physical machine running Windows 7 or later, insert the USB stick you want to use.\n2.  Copy the content of the **MDTOfflineMedia\\\\Content** folder to the root of the USB stick.\n3.  Start an elevated command prompt (run as Administrator), and start the Diskpart utility by typing **Diskpart** and pressing **Enter**.\n4.  In the Diskpart utility, you can type **list volume** (or the shorter **list vol**) to list the volumes, but you really only need to remember the drive letter of the USB stick to which you copied the content. In our example, the USB stick had the drive letter F.\n5.  In the Diskpart utility, type **select volume F** (replace F with your USB stick drive letter).\n6.  In the Diskpart utility, type **active**, and then type **exit**.\n\n## <a href=\"\" id=\"sec11\"></a>Unified Extensible Firmware Interface (UEFI)-based deployments\n\nAs referenced in [Windows 10 deployment tools](http://go.microsoft.com/fwlink/p/?LinkId=619546), Unified Extensible Firmware Interface (UEFI)-based deployments are becoming more common. In fact, when you create a generation 2 virtual machine in Hyper-V, you get a UEFI-based computer. During deployment, MDT automatically detects that you have an UEFI-based machine and creates the partitions UEFI requires. You do not need to update or change your task sequences in any way to accommodate UFEI.\n\n![figure 14](images/mdt-07-fig16.png)\n\nFigure 14. The partitions when deploying an UEFI-based machine.\n\n## Related topics\n\n[Get started with the Microsoft Deployment Toolkit (MDT)](get-started-with-the-microsoft-deployment-toolkit.md)\n\n[Create a Windows 10 reference image](create-a-windows-10-reference-image.md)\n\n[Build a distributed environment for Windows 10 deployment](build-a-distributed-environment-for-windows-10-deployment.md)\n\n[Refresh a Windows 7 computer with Windows 10](refresh-a-windows-7-computer-with-windows-10.md)\n\n[Replace a Windows 7 computer with a Windows 10 computer](replace-a-windows-7-computer-with-a-windows-10-computer.md)\n\n[Configure MDT settings](configure-mdt-2013-settings.md)\n"}