{"nodes":[{"content":"Test an AppLocker policy by using Test-AppLockerPolicy (Windows 10)","pos":[11,78]},{"content":"This topic for IT professionals describes the steps to test an AppLocker policy prior to importing it into a Group Policy Object (GPO) or another computer.","pos":[92,247]},{"content":"Test an AppLocker policy by using Test-AppLockerPolicy","pos":[403,457]},{"content":"Applies to","pos":[461,471]},{"content":"Windows 10","pos":[478,488]},{"content":"This topic for IT professionals describes the steps to test an AppLocker policy prior to importing it into a Group Policy Object (GPO) or another computer.","pos":[490,645]},{"content":"The <bpt id=\"p1\">**</bpt>Test-AppLockerPolicy<ept id=\"p1\">**</ept> Windows PowerShell cmdlet can be used to determine whether any of the rules in your rule collections will be blocked on your reference computer or the computer on which you maintain policies.","pos":[647,867]},{"content":"Perform the following steps on any computer where the AppLocker policies are applied.","pos":[868,953]},{"content":"Any user account can be used to complete this procedure.","pos":[955,1011]},{"content":"To test an AppLocker policy by using Test-AppLockerPolicy","pos":[1015,1072]},{"content":"Export the effective AppLocker policy.","pos":[1080,1118]},{"content":"To do this, you must use the <bpt id=\"p1\">**</bpt>Get-AppLockerPolicy<ept id=\"p1\">**</ept> Windows PowerShell cmdlet.","pos":[1119,1198]},{"content":"Open a Windows PowerShell command prompt window as an administrator.","pos":[1208,1276]},{"pos":[1285,1380],"content":"Use the <bpt id=\"p1\">**</bpt>Get-AppLockerPolicy<ept id=\"p1\">**</ept> cmdlet to export the effective AppLocker policy to an XML file:"},{"pos":[1460,1727],"content":"Use the <bpt id=\"p1\">**</bpt>Get-ChildItem<ept id=\"p1\">**</ept> cmdlet to specify the directory that you want to test, specify the <bpt id=\"p2\">**</bpt>Test-AppLockerPolicy<ept id=\"p2\">**</ept> cmdlet with the XML file from the previous step to test the policy, and use the <bpt id=\"p3\">**</bpt>Export-CSV<ept id=\"p3\">**</ept> cmdlet to export the results to a file to be analyzed:"},{"pos":[1986,2049],"content":"The following shows example input for <bpt id=\"p1\">**</bpt>Test-AppLockerPolicy<ept id=\"p1\">**</ept>:"},{"content":"In the example, the effective AppLocker policy is exported to the file C:<ph id=\"ph1\">\\\\</ph>Effective.xml.","pos":[2358,2447]},{"content":"The <bpt id=\"p1\">**</bpt>Get-ChildItem<ept id=\"p1\">**</ept> cmdlet is used to recursively gather path names for the .exe files in C:<ph id=\"ph1\">\\\\</ph>Program Files<ph id=\"ph2\">\\\\</ph>Microsoft Office<ph id=\"ph3\">\\\\</ph>.","pos":[2448,2578]},{"content":"The XMLPolicy parameter specifies that the C:<ph id=\"ph1\">\\\\</ph>Effective.xml file is an XML AppLocker policy file.","pos":[2579,2677]},{"content":"By specifying the User parameter, you can test the rules for specific users, and the <bpt id=\"p1\">**</bpt>Export-CSV<ept id=\"p1\">**</ept> cmdlet allows the results to be exported to a comma-separated file.","pos":[2678,2845]},{"content":"In the example, <ph id=\"ph1\">`-FilterDenied,DeniedByDefault`</ph> displays only those files that will be blocked for the user under the policy.","pos":[2846,2971]}],"content":"---\ntitle: Test an AppLocker policy by using Test-AppLockerPolicy (Windows 10)\ndescription: This topic for IT professionals describes the steps to test an AppLocker policy prior to importing it into a Group Policy Object (GPO) or another computer.\nms.assetid: 048bfa38-6825-4a9a-ab20-776cf79f402a\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Test an AppLocker policy by using Test-AppLockerPolicy\n\n**Applies to**\n-   Windows 10\n\nThis topic for IT professionals describes the steps to test an AppLocker policy prior to importing it into a Group Policy Object (GPO) or another computer.\n\nThe **Test-AppLockerPolicy** Windows PowerShell cmdlet can be used to determine whether any of the rules in your rule collections will be blocked on your reference computer or the computer on which you maintain policies. Perform the following steps on any computer where the AppLocker policies are applied.\n\nAny user account can be used to complete this procedure.\n\n**To test an AppLocker policy by using Test-AppLockerPolicy**\n\n1.  Export the effective AppLocker policy. To do this, you must use the **Get-AppLockerPolicy** Windows PowerShell cmdlet.\n\n    1.  Open a Windows PowerShell command prompt window as an administrator.\n    2.  Use the **Get-AppLockerPolicy** cmdlet to export the effective AppLocker policy to an XML file:\n\n        `Get-AppLockerPolicy –Effective –XML > <PathofFiletoExport.XML>`\n\n2.  Use the **Get-ChildItem** cmdlet to specify the directory that you want to test, specify the **Test-AppLockerPolicy** cmdlet with the XML file from the previous step to test the policy, and use the **Export-CSV** cmdlet to export the results to a file to be analyzed:\n\n    `Get-ChildItem <DirectoryPathtoReview> -Filter <FileExtensionFilter> -Recurse | Convert-Path | Test-AppLockerPolicy –XMLPolicy <PathToExportedPolicyFile> -User <domain\\username> -Filter <TypeofRuletoFilterFor> | Export-CSV <PathToExportResultsTo.CSV>`\n\nThe following shows example input for **Test-AppLockerPolicy**:\n\n```syntax\nPS C:\\ Get-AppLockerPolicy –Effective –XML > C:\\Effective.xml\nPS C:\\ Get-ChildItem 'C:\\Program Files\\Microsoft Office\\' –filter *.exe –Recurse | Convert-Path | Test-AppLockerPolicy –XMLPolicy C:\\Effective.xml –User contoso\\zwie –Filter Denied,DeniedByDefault | Export-CSV C:\\BlockedFiles.csv\n```\n\nIn the example, the effective AppLocker policy is exported to the file C:\\\\Effective.xml. The **Get-ChildItem** cmdlet is used to recursively gather path names for the .exe files in C:\\\\Program Files\\\\Microsoft Office\\\\. The XMLPolicy parameter specifies that the C:\\\\Effective.xml file is an XML AppLocker policy file. By specifying the User parameter, you can test the rules for specific users, and the **Export-CSV** cmdlet allows the results to be exported to a comma-separated file. In the example, `-FilterDenied,DeniedByDefault` displays only those files that will be blocked for the user under the policy.\n"}