{"nodes":[{"content":"Create an Outbound Program or Service Rule (Windows 10)","pos":[11,66]},{"content":"Create an Outbound Program or Service Rule","pos":[80,122]},{"content":"Create an Outbound Program or Service Rule","pos":[278,320]},{"content":"Applies to","pos":[324,334]},{"content":"Windows 10","pos":[341,351]},{"content":"Windows Server 2016 Technical Preview","pos":[356,393]},{"content":"By default, Windows Firewall with Advanced Security allows all outbound network traffic unless it matches a rule that prohibits the traffic.","pos":[395,535]},{"content":"To block outbound network traffic for a specified program or service, use the Windows Firewall with Advanced Security node in the Group Policy Management console to create firewall rules.","pos":[536,723]},{"content":"This type of rule prevents the program from sending any outbound network traffic on any port.","pos":[724,817]},{"content":"Administrative credentials","pos":[821,847]},{"content":"To complete these procedures, you must be a member of the Domain Administrators group, or otherwise be delegated permissions to modify the GPOs.","pos":[851,995]},{"content":"To create an outbound firewall rule for a program or service","pos":[997,1057]},{"pos":[1063,1237],"content":"<bpt id=\"p1\">[</bpt>Open the Group Policy Management Console to Windows Firewall with Advanced Security<ept id=\"p1\">](open-the-group-policy-management-console-to-windows-firewall-with-advanced-security.md)</ept>."},{"pos":[1243,1292],"content":"In the navigation pane, click <bpt id=\"p1\">**</bpt>Outbound Rules<ept id=\"p1\">**</ept>."},{"pos":[1298,1344],"content":"Click <bpt id=\"p1\">**</bpt>Action<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>New rule<ept id=\"p2\">**</ept>."},{"pos":[1350,1451],"content":"On the <bpt id=\"p1\">**</bpt>Rule Type<ept id=\"p1\">**</ept> page of the New Outbound Rule Wizard, click <bpt id=\"p2\">**</bpt>Custom<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  Although you can create many rules by selecting <bpt id=\"p2\">**</bpt>Program<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Port<ept id=\"p3\">**</ept>, those choices limit the number of pages presented by the wizard.","pos":[1458,1606]},{"content":"If you select <bpt id=\"p1\">**</bpt>Custom<ept id=\"p1\">**</ept>, you see all of the pages, and have the most flexibility in creating your rules.","pos":[1607,1712]},{"pos":[1718,1771],"content":"On the <bpt id=\"p1\">**</bpt>Program<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>This program path<ept id=\"p2\">**</ept>."},{"content":"Type the path to the program in the text box.","pos":[1777,1822]},{"content":"Use environment variables as appropriate to ensure that programs installed in different locations on different computers work correctly.","pos":[1823,1959]},{"content":"Do one of the following:","pos":[1965,1989]},{"pos":[1999,2064],"content":"If the executable file contains a single program, click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>."},{"pos":[2074,2292],"content":"If the executable file is a container for multiple services that must all be blocked from sending outbound network traffic, click <bpt id=\"p1\">**</bpt>Customize<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Apply to services only<ept id=\"p2\">**</ept>, click <bpt id=\"p3\">**</bpt>OK<ept id=\"p3\">**</ept>, and then click <bpt id=\"p4\">**</bpt>Next<ept id=\"p4\">**</ept>."},{"content":"If the executable file is a container for a single service or contains multiple services but the rule only applies to one of them, click <bpt id=\"p1\">**</bpt>Customize<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Apply to this service<ept id=\"p2\">**</ept>, and then select the service from the list.","pos":[2302,2530]},{"content":"If the service does not appear in the list, then click <bpt id=\"p1\">**</bpt>Apply to service with this service short name<ept id=\"p1\">**</ept>, and type the short name for the service in the text box.","pos":[2531,2693]},{"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","pos":[2694,2732]},{"content":"If you want the program to be allowed to send on some ports, but blocked from sending on others, then you can restrict the firewall rule to block only the specified ports or protocols.","pos":[2738,2922]},{"content":"On the <bpt id=\"p1\">**</bpt>Protocols and Ports<ept id=\"p1\">**</ept> page, you can specify the port numbers or protocol numbers for the blocked traffic.","pos":[2923,3037]},{"content":"If the program tries to send to or from a port number different from the one specified here, or by using a protocol number different from the one specified here, then the default outbound firewall behavior allows the traffic.","pos":[3038,3263]},{"content":"For more information about the protocol and port options, see <bpt id=\"p1\">[</bpt>Create an Outbound Port Rule<ept id=\"p1\">](create-an-outbound-port-rule.md)</ept>.","pos":[3264,3390]},{"content":"When you have configured the protocol and port options, click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[3391,3462]},{"content":"On the <bpt id=\"p1\">**</bpt>Scope<ept id=\"p1\">**</ept> page, you can specify that the rule applies only to network traffic to or from the IP addresses entered on this page.","pos":[3468,3602]},{"content":"Configure as appropriate for your design, and then click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>.","pos":[3603,3669]},{"pos":[3675,3756],"content":"On the <bpt id=\"p1\">**</bpt>Action<ept id=\"p1\">**</ept> page, select <bpt id=\"p2\">**</bpt>Block the connection<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Next<ept id=\"p3\">**</ept>."},{"pos":[3762,3873],"content":"On the <bpt id=\"p1\">**</bpt>Profile<ept id=\"p1\">**</ept> page, select the network location types to which this rule applies, and then click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>."},{"pos":[3879,3970],"content":"On the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> page, type a name and description for your rule, and then click <bpt id=\"p2\">**</bpt>Finish<ept id=\"p2\">**</ept>."}],"content":"---\ntitle: Create an Outbound Program or Service Rule (Windows 10)\ndescription: Create an Outbound Program or Service Rule\nms.assetid: f71db4fb-0228-4df2-a95d-b9c056aa9311\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Create an Outbound Program or Service Rule\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016 Technical Preview\n\nBy default, Windows Firewall with Advanced Security allows all outbound network traffic unless it matches a rule that prohibits the traffic. To block outbound network traffic for a specified program or service, use the Windows Firewall with Advanced Security node in the Group Policy Management console to create firewall rules. This type of rule prevents the program from sending any outbound network traffic on any port.\n\n**Administrative credentials**\n\nTo complete these procedures, you must be a member of the Domain Administrators group, or otherwise be delegated permissions to modify the GPOs.\n\nTo create an outbound firewall rule for a program or service\n\n1.  [Open the Group Policy Management Console to Windows Firewall with Advanced Security](open-the-group-policy-management-console-to-windows-firewall-with-advanced-security.md).\n\n2.  In the navigation pane, click **Outbound Rules**.\n\n3.  Click **Action**, and then click **New rule**.\n\n4.  On the **Rule Type** page of the New Outbound Rule Wizard, click **Custom**, and then click **Next**.\n\n    >**Note:**  Although you can create many rules by selecting **Program** or **Port**, those choices limit the number of pages presented by the wizard. If you select **Custom**, you see all of the pages, and have the most flexibility in creating your rules.\n\n5.  On the **Program** page, click **This program path**.\n\n6.  Type the path to the program in the text box. Use environment variables as appropriate to ensure that programs installed in different locations on different computers work correctly.\n\n7.  Do one of the following:\n\n    -   If the executable file contains a single program, click **Next**.\n\n    -   If the executable file is a container for multiple services that must all be blocked from sending outbound network traffic, click **Customize**, select **Apply to services only**, click **OK**, and then click **Next**.\n\n    -   If the executable file is a container for a single service or contains multiple services but the rule only applies to one of them, click **Customize**, select **Apply to this service**, and then select the service from the list. If the service does not appear in the list, then click **Apply to service with this service short name**, and type the short name for the service in the text box. Click **OK**, and then click **Next**.\n\n8.  If you want the program to be allowed to send on some ports, but blocked from sending on others, then you can restrict the firewall rule to block only the specified ports or protocols. On the **Protocols and Ports** page, you can specify the port numbers or protocol numbers for the blocked traffic. If the program tries to send to or from a port number different from the one specified here, or by using a protocol number different from the one specified here, then the default outbound firewall behavior allows the traffic. For more information about the protocol and port options, see [Create an Outbound Port Rule](create-an-outbound-port-rule.md). When you have configured the protocol and port options, click **Next**.\n\n9.  On the **Scope** page, you can specify that the rule applies only to network traffic to or from the IP addresses entered on this page. Configure as appropriate for your design, and then click **Next**.\n\n10. On the **Action** page, select **Block the connection**, and then click **Next**.\n\n11. On the **Profile** page, select the network location types to which this rule applies, and then click **Next**.\n\n12. On the **Name** page, type a name and description for your rule, and then click **Finish**.\n"}