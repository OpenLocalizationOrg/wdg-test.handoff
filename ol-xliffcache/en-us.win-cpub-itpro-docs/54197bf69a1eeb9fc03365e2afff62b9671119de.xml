{"nodes":[{"content":"Investigate Windows Defender Advanced Threat Protection files","pos":[11,72]},{"content":"Use the investigation options to get details on files associated with alerts, behaviours, or events.","pos":[86,186]},{"content":"Investigate a file associated with a Windows Defender ATP alert","pos":[444,507]},{"content":"Applies to:","pos":[511,522]},{"content":"Windows 10 Insider Preview Build 14332 or later","pos":[528,575]},{"content":"Windows Defender Advanced Threat Protection (Windows Defender ATP)","pos":[578,644]},{"content":"[Some information relates to pre-released product which may be substantially modified before it's commercially released.","pos":[675,795]},{"content":"Microsoft makes no warranties, express or implied, with respect to the information provided here.]","pos":[796,894]},{"content":"Investigate the details of a file associated with a specific alert, behavior, or event to help determine if the file exhibits malicious activities, identify the attack motivation, and understand the potential scope of the breach.","pos":[903,1132]},{"content":"You can get information from the following sections in the file view:","pos":[1134,1203]},{"content":"File details","pos":[1207,1219]},{"content":"Deep analysis","pos":[1222,1235]},{"content":"File in organization","pos":[1238,1258]},{"content":"Observed in organization","pos":[1261,1285]},{"content":"The file details section shows attributes of the file such as its MD5 hash or number and its prevalence worldwide.","pos":[1287,1401]},{"content":"The <bpt id=\"p1\">**</bpt>Deep analysis<ept id=\"p1\">**</ept> section provides the option of submitting a file for deep analysis to gain detailed visibility on observed suspicious behaviors, and associated artifacts.","pos":[1403,1579]},{"content":"For more information on submitting files for deep analysis, see the <bpt id=\"p1\">**</bpt>Deep analysis<ept id=\"p1\">**</ept> topic.","pos":[1580,1672]},{"pos":[1674,1800],"content":"The <bpt id=\"p1\">**</bpt>File in organization<ept id=\"p1\">**</ept> section provides details on the prevalence of the file and the name observed in the organization."},{"pos":[1802,1940],"content":"The <bpt id=\"p1\">**</bpt>Observed in organization<ept id=\"p1\">**</ept> section provides a chronological view on the events and associated alerts that were observed on the file."},{"content":"You'll see a list of machines associated with the file and a description of the action taken by the file.","pos":[1942,2047]},{"content":"Investigate a file","pos":[2051,2069]},{"content":"Select the file you want to investigate.","pos":[2076,2116]},{"content":"You can select a file from any of the following views or use the Search box:","pos":[2117,2193]},{"pos":[2198,2289],"content":"Alerts - click the file links from the <bpt id=\"p1\">**</bpt>Description<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Details<ept id=\"p2\">**</ept> in the Alert timeline"},{"pos":[2294,2415],"content":"Machines view - click the file links in the <bpt id=\"p1\">**</bpt>Description<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Details<ept id=\"p2\">**</ept> columns in the <bpt id=\"p3\">**</bpt>Observed on machine<ept id=\"p3\">**</ept> section"},{"pos":[2420,2496],"content":"Search box - select <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> from the drop-down menu and enter the file name"},{"content":"View the file details.","pos":[2500,2522]},{"content":"Use the search filters to define the search criteria.","pos":[2526,2579]},{"content":"You can also use the timeline search box to further filter displayed search results.","pos":[2580,2664]},{"content":"Deep analysis","pos":[2668,2681]},{"content":"Cyber security investigations are typically triggered by an alert.","pos":[2682,2748]},{"content":"Alerts are related to one or more observed files that are often new or unknown.","pos":[2749,2828]},{"content":"Clicking a file takes you to the file view where you can see the file's metadata.","pos":[2829,2910]},{"content":"To enrich the data related to the file, you can submit the file for deep analysis.","pos":[2911,2993]},{"content":"The deep analysis feature executes a file in a secure, fully instrumented cloud environment.","pos":[2995,3087]},{"content":"Deep analysis results show the file's activities, observed behaviors, and associated artifacts, such as dropped files, registry modifications, and communication with IPs.","pos":[3088,3258]},{"content":"Deep analysis currently supports extensive analysis of PE (portable executable) files (including <bpt id=\"p1\">_</bpt>.exe<ept id=\"p1\">_</ept> and <bpt id=\"p2\">_</bpt>.dll<ept id=\"p2\">_</ept> files).","pos":[3259,3381]},{"content":"Deep analysis of a file takes several minutes.","pos":[3383,3429]},{"content":"When the file analysis is complete, results are made available in the File view page, under a new <bpt id=\"p1\">**</bpt>Deep analysis summary<ept id=\"p1\">**</ept> section.","pos":[3430,3562]},{"content":"The summary includes a list of observed <bpt id=\"p1\">*</bpt>behaviors<ept id=\"p1\">*</ept>, some of which can indicate malicious activity, and <bpt id=\"p2\">*</bpt>observables<ept id=\"p2\">*</ept>, including contacted IPs and files created on the disk.","pos":[3563,3736]},{"content":"Results of deep analysis are matched against threat intelligence and any matches will generate appropriate alerts.","pos":[3738,3852]},{"content":"Submit files for analysis","pos":[3857,3882]},{"content":"Use the deep analysis feature to investigate the details of any file, usually during an investigation of an alert or for any other reason where you suspect malicious behavior.","pos":[3884,4059]},{"content":"This feature is available in the context of the file view.","pos":[4060,4118]},{"pos":[4120,4349],"content":"In the file's page, <bpt id=\"p1\">**</bpt>Submit for deep analysis<ept id=\"p1\">**</ept> is enabled when the file is available in the Windows Defender ATP backend sample collection or if it was observed on a Windows 10 machine that supports submitting to deep analysis."},{"pos":[4353,4431],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Only files from Windows 10 can be automatically collected."},{"pos":[4433,4713],"content":"You can also manually submit a sample through the <bpt id=\"p1\">[</bpt>Malware Protection Center Portal<ept id=\"p1\">](https://www.microsoft.com/en-us/security/portal/submission/submit.aspx)</ept> if the file was not observed on a Windows 10 machine, and wait for <bpt id=\"p2\">**</bpt>Submit for deep analysis<ept id=\"p2\">**</ept> button to become available."},{"pos":[4717,4947],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Due to backend processing flows in the Malware Protection Center Portal, there could be up to 10 minutes of latency between file submission and availability of the deep analysis feature in Windows Defender ATP."},{"content":"When the sample is collected, Windows Defender ATP runs the file in is a secure environment and creates a detailed report of observed behaviors and associated artifacts, such as files dropped on machines, communication to IPs, and registry modifications.","pos":[4949,5203]},{"content":"Submit files for deep analysis:","pos":[5207,5238]},{"content":"Select the file that you want to submit for deep analysis.","pos":[5245,5303]},{"content":"You can select or search a file from any of the following views:","pos":[5304,5368]},{"pos":[5373,5464],"content":"Alerts - click the file links from the <bpt id=\"p1\">**</bpt>Description<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>Details<ept id=\"p2\">**</ept> in the Alert timeline"},{"pos":[5469,5592],"content":"<bpt id=\"p1\">**</bpt>Machines View<ept id=\"p1\">**</ept> - click the file links from the <bpt id=\"p2\">**</bpt>Description<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Details<ept id=\"p3\">**</ept> in the <bpt id=\"p4\">**</bpt>Machine in organization<ept id=\"p4\">**</ept> section"},{"pos":[5597,5673],"content":"Search box - select <bpt id=\"p1\">**</bpt>File<ept id=\"p1\">**</ept> from the drop-down menu and enter the file name"},{"pos":[5677,5745],"content":"In the <bpt id=\"p1\">**</bpt>Deep analysis<ept id=\"p1\">**</ept> section of the file view, click <bpt id=\"p2\">**</bpt>Submit<ept id=\"p2\">**</ept>."},{"content":"You can only submit PE files in the file details seciton","pos":[5749,5805]},{"pos":[5833,5937],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Only portable executable (PE) files are supported, including <bpt id=\"p2\">_</bpt>.exe<ept id=\"p2\">_</ept> and <bpt id=\"p3\">_</bpt>.dll<ept id=\"p3\">_</ept> files"},{"content":"A progress bar is displayed and provides information on the different stages of the analysis.","pos":[5939,6032]},{"content":"You can then view the report when the analysis is done.","pos":[6033,6088]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>Depending on machine availability, sample collection time can vary.","pos":[6092,6179]},{"content":"There is a 1-hour timeout for sample collection.","pos":[6180,6228]},{"content":"The collection will fail and the operation will abort if there is no online Windows 10 machine reporting at that time.","pos":[6229,6347]},{"content":"You can re-submit files for deep analysis to get fresh data on the file.","pos":[6348,6420]},{"content":"View deep analysis report","pos":[6425,6450]},{"content":"View the deep analysis report that Windows Defender ATP provides to see the details of the deep analysis that was conducted on the file you submitted.","pos":[6452,6602]},{"content":"This feature is available in the file view context.","pos":[6603,6654]},{"content":"You can view the comprehensive report that provides details on:","pos":[6656,6719]},{"content":"Observed behaviors","pos":[6723,6741]},{"content":"Associated artifacts","pos":[6744,6764]},{"content":"The details provided can help you investigate if there are indications of a potential attack.","pos":[6766,6859]},{"content":"View deep analysis reports:","pos":[6863,6890]},{"content":"Select the file you submitted for deep analysis.","pos":[6897,6945]},{"content":"Click <bpt id=\"p1\">**</bpt>See the report below<ept id=\"p1\">**</ept>.","pos":[6949,6980]},{"content":"Information on the analysis is displayed.","pos":[6981,7022]},{"content":"The deep analysis report shows detailed information across a number of categories","pos":[7026,7107]},{"content":"Troubleshooting deep analysis","pos":[7142,7171]},{"content":"If you encounter a problem when trying to submit a file, try each of the following troubleshooting steps.","pos":[7173,7278]},{"content":"Troubleshoot deep analysis:","pos":[7282,7309]},{"content":"Ensure the file is a PE.","pos":[7316,7340]},{"content":"PE files typically have <bpt id=\"p1\">_</bpt>.exe<ept id=\"p1\">_</ept> or <bpt id=\"p2\">_</bpt>.dll<ept id=\"p2\">_</ept> extensions (executable programs or applications).","pos":[7341,7431]},{"content":"Ensure the service has access to the file, that it still exists, and has not been corrupted or modified.","pos":[7435,7539]},{"content":"You can wait a short while and try to submit the file again, in case the queue is full or there was a temporary connection or communication error.","pos":[7543,7689]},{"content":"Verify the policy setting enables sample collection and try to submit the file again.","pos":[7693,7778]},{"content":"a.","pos":[7782,7784]},{"content":"Change the following registry entry and values to change the policy on specific endpoints:","pos":[7785,7875]},{"content":"Change the organizational unit through the Group Policy.","pos":[8025,8081]},{"content":"See <bpt id=\"p1\">[</bpt>Configure with Group Policy<ept id=\"p1\">](additional-configuration-windows-defender-advanced-threat-protection.md#configure-with-group-policy)</ept>.","pos":[8082,8217]},{"pos":[8221,8322],"content":"If these steps do not resolve the issue, contact <bpt id=\"p1\">[</bpt>winatp@microsoft.com<ept id=\"p1\">](mailto:winatp@microsoft.com)</ept>."},{"pos":[8326,8452],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>If the value <bpt id=\"p2\">*</bpt>AllowSampleCollection<ept id=\"p2\">*</ept> is not available, the client will allow sample collection by default."},{"content":"Related topics","pos":[8458,8472]},{"content":"View the Windows Defender Advanced Threat Protection Dashboard","pos":[8476,8538]},{"content":"View and organize the Windows Defender Advanced Threat Protection Alerts queue","pos":[8601,8679]},{"content":"Investigate Windows Defender Advanced Threat Protection alerts","pos":[8745,8807]},{"content":"Investigate machines in the Windows Defender ATP Machines view","pos":[8879,8941]},{"content":"Investigate an IP address associated with a Windows Defender ATP alert","pos":[9015,9085]},{"content":"Investigate a domain associated with a Windows Defender ATP alert","pos":[9153,9218]},{"content":"Manage Windows Defender Advanced Threat Protection alerts","pos":[9290,9347]}],"content":"---\ntitle: Investigate Windows Defender Advanced Threat Protection files\ndescription: Use the investigation options to get details on files associated with alerts, behaviours, or events.\nkeywords: investigate, investigation, file, malicious activity, attack motivation, deep analysis, deep analysis report\nsearch.product: eADQiWindows 10XVcnh\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: mjcaparas\n---\n# Investigate a file associated with a Windows Defender ATP alert\n\n**Applies to:**\n\n- Windows 10 Insider Preview Build 14332 or later\n- Windows Defender Advanced Threat Protection (Windows Defender ATP)\n\n<span style=\"color:#ED1C24;\">[Some information relates to pre-released product which may be substantially modified before it's commercially released. Microsoft makes no warranties, express or implied, with respect to the information provided here.]</span>\n\nInvestigate the details of a file associated with a specific alert, behavior, or event to help determine if the file exhibits malicious activities, identify the attack motivation, and understand the potential scope of the breach.\n\nYou can get information from the following sections in the file view:\n\n- File details\n- Deep analysis\n- File in organization\n- Observed in organization\n\nThe file details section shows attributes of the file such as its MD5 hash or number and its prevalence worldwide.\n\nThe **Deep analysis** section provides the option of submitting a file for deep analysis to gain detailed visibility on observed suspicious behaviors, and associated artifacts. For more information on submitting files for deep analysis, see the **Deep analysis** topic.\n\nThe **File in organization** section provides details on the prevalence of the file and the name observed in the organization.\n\nThe **Observed in organization** section provides a chronological view on the events and associated alerts that were observed on the file.\n\nYou'll see a list of machines associated with the file and a description of the action taken by the file.\n\n**Investigate a file**\n\n1. Select the file you want to investigate. You can select a file from any of the following views or use the Search box:\n  - Alerts - click the file links from the **Description** or **Details** in the Alert timeline\n  - Machines view - click the file links in the **Description** or **Details** columns in the **Observed on machine** section\n  - Search box - select **File** from the drop-down menu and enter the file name\n2. View the file details.\n3. Use the search filters to define the search criteria. You can also use the timeline search box to further filter displayed search results.\n\n##Deep analysis\nCyber security investigations are typically triggered by an alert. Alerts are related to one or more observed files that are often new or unknown. Clicking a file takes you to the file view where you can see the file's metadata. To enrich the data related to the file, you can submit the file for deep analysis.\n\nThe deep analysis feature executes a file in a secure, fully instrumented cloud environment. Deep analysis results show the file's activities, observed behaviors, and associated artifacts, such as dropped files, registry modifications, and communication with IPs.\nDeep analysis currently supports extensive analysis of PE (portable executable) files (including _.exe_ and _.dll_ files).\n\nDeep analysis of a file takes several minutes. When the file analysis is complete, results are made available in the File view page, under a new **Deep analysis summary** section. The summary includes a list of observed *behaviors*, some of which can indicate malicious activity, and *observables*, including contacted IPs and files created on the disk.\n\nResults of deep analysis are matched against threat intelligence and any matches will generate appropriate alerts.\n\n## Submit files for analysis\n\nUse the deep analysis feature to investigate the details of any file, usually during an investigation of an alert or for any other reason where you suspect malicious behavior. This feature is available in the context of the file view.\n\nIn the file's page, **Submit for deep analysis** is enabled when the file is available in the Windows Defender ATP backend sample collection or if it was observed on a Windows 10 machine that supports submitting to deep analysis.\n\n> **Note**&nbsp;&nbsp;Only files from Windows 10 can be automatically collected.\n\nYou can also manually submit a sample through the [Malware Protection Center Portal](https://www.microsoft.com/en-us/security/portal/submission/submit.aspx) if the file was not observed on a Windows 10 machine, and wait for **Submit for deep analysis** button to become available.\n\n> **Note**&nbsp;&nbsp;Due to backend processing flows in the Malware Protection Center Portal, there could be up to 10 minutes of latency between file submission and availability of the deep analysis feature in Windows Defender ATP.\n\nWhen the sample is collected, Windows Defender ATP runs the file in is a secure environment and creates a detailed report of observed behaviors and associated artifacts, such as files dropped on machines, communication to IPs, and registry modifications.\n\n**Submit files for deep analysis:**\n\n1. Select the file that you want to submit for deep analysis. You can select or search a file from any of the following views:\n  - Alerts - click the file links from the **Description** or **Details** in the Alert timeline\n  - **Machines View** - click the file links from the **Description** or **Details** in the **Machine in organization** section\n  - Search box - select **File** from the drop-down menu and enter the file name\n2. In the **Deep analysis** section of the file view, click **Submit**.\n\n![You can only submit PE files in the file details seciton](images/submit-file.png)\n\n>**Note**&nbsp;&nbsp;Only portable executable (PE) files are supported, including _.exe_ and _.dll_ files\n\nA progress bar is displayed and provides information on the different stages of the analysis. You can then view the report when the analysis is done.\n\n> **Note**&nbsp;&nbsp;Depending on machine availability, sample collection time can vary. There is a 1-hour timeout for sample collection. The collection will fail and the operation will abort if there is no online Windows 10 machine reporting at that time. You can re-submit files for deep analysis to get fresh data on the file.\n\n## View deep analysis report\n\nView the deep analysis report that Windows Defender ATP provides to see the details of the deep analysis that was conducted on the file you submitted. This feature is available in the file view context.\n\nYou can view the comprehensive report that provides details on:\n\n- Observed behaviors\n- Associated artifacts\n\nThe details provided can help you investigate if there are indications of a potential attack.\n\n**View deep analysis reports:**\n\n1. Select the file you submitted for deep analysis.\n2. Click **See the report below**. Information on the analysis is displayed.\n\n![The deep analysis report shows detailed information across a number of categories](images/analysis-results.png)\n\n## Troubleshooting deep analysis\n\nIf you encounter a problem when trying to submit a file, try each of the following troubleshooting steps.\n\n**Troubleshoot deep analysis:**\n\n1. Ensure the file is a PE. PE files typically have _.exe_ or _.dll_ extensions (executable programs or applications).\n2. Ensure the service has access to the file, that it still exists, and has not been corrupted or modified.\n3. You can wait a short while and try to submit the file again, in case the queue is full or there was a temporary connection or communication error.\n4. Verify the policy setting enables sample collection and try to submit the file again.\n\n  a. Change the following registry entry and values to change the policy on specific endpoints:\n ```\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Sense\\AllowSampleCollection\n  Value = 0 - block sample collection\n  Value = 1 - allow sample collection\n```\n5. Change the organizational unit through the Group Policy. See [Configure with Group Policy](additional-configuration-windows-defender-advanced-threat-protection.md#configure-with-group-policy).\n6. If these steps do not resolve the issue, contact [winatp@microsoft.com](mailto:winatp@microsoft.com).\n\n> **Note**&nbsp;&nbsp;If the value *AllowSampleCollection* is not available, the client will allow sample collection by default.\n\n### Related topics\n- [View the Windows Defender Advanced Threat Protection Dashboard](dashboard-windows-defender-advanced-threat-protection.md)\n- [View and organize the Windows Defender Advanced Threat Protection Alerts queue](alerts-queue-windows-defender-advanced-threat-protection.md)\n- [Investigate Windows Defender Advanced Threat Protection alerts](investigate-alerts-windows-defender-advanced-threat-protection.md)\n- [Investigate machines in the Windows Defender ATP Machines view](investigate-machines-windows-defender-advanced-threat-protection.md)\n- [Investigate an IP address associated with a Windows Defender ATP alert](investigate-ip-windows-defender-advanced-threat-protection.md)\n- [Investigate a domain associated with a Windows Defender ATP alert](investigate-domain-windows-defender-advanced-threat-protection.md)\n- [Manage Windows Defender Advanced Threat Protection alerts](manage-alerts-windows-defender-advanced-threat-protection.md)\n"}