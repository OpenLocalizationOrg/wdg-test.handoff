{"nodes":[{"content":"User Account Control Only elevate UIAccess applications that are installed in secure locations (Windows 10)","pos":[11,118]},{"content":"Describes the best practices, location, values, policy management and security considerations for the User Account Control Only elevate UIAccess applications that are installed in secure locations security policy setting.","pos":[132,353]},{"content":"User Account Control: Only elevate UIAccess applications that are installed in secure locations","pos":[509,604]},{"content":"Applies to","pos":[608,618]},{"content":"Windows 10","pos":[625,635]},{"pos":[637,863],"content":"Describes the best practices, location, values, policy management and security considerations for the <bpt id=\"p1\">**</bpt>User Account Control: Only elevate UIAccess applications that are installed in secure locations<ept id=\"p1\">**</ept> security policy setting."},{"content":"Reference","pos":[868,877]},{"content":"This policy setting enforces the requirement that apps that request running with a UIAccess integrity level (by means of a marking of UIAccess=true in their app manifest), must reside in a secure location on the file system.","pos":[879,1103]},{"content":"Relatively secure locations are limited to the following directories:","pos":[1104,1173]},{"content":"Program Files<ph id=\"ph1\">\\\\</ph> including subdirectories","pos":[1181,1221]},{"content":"Windows<ph id=\"ph1\">\\\\</ph>system32","pos":[1228,1245]},{"content":"Program Files (x86)<ph id=\"ph1\">\\\\</ph> including subdirectories for 64-bit versions of Windows","pos":[1254,1331]},{"pos":[1334,1519],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  Windows enforces a PKI signature check on any interactive application that requests running with a UIAccess integrity level, regardless of the state of this security setting."},{"content":"Background","pos":[1524,1534]},{"content":"User Interface Privilege Isolation (UIPI) implements restrictions in the Windows subsystem that prevent lower-privilege applications from sending messages or installing hooks in higher-privilege processes.","pos":[1538,1743]},{"content":"Higher-privilege applications are permitted to send messages to lower-privilege processes.","pos":[1744,1834]},{"content":"UIPI does not interfere with or change the behavior of messages between applications at the same privilege (or integrity) level.","pos":[1835,1963]},{"content":"Microsoft UI Automation is the current model to support accessibility requirements in the Windows operating systems.","pos":[1965,2081]},{"content":"Applications that are designed to support an accessible user experience control the behavior of other Windows applications on behalf of the user.","pos":[2082,2227]},{"content":"When all applications on the automation client computer and server are running as a standard user (that is, at a medium integrity level), the UIPI restrictions do not interfere with the Microsoft UI automation model.","pos":[2228,2444]},{"content":"However, there might be times when an administrative user runs an application with elevated privilege based on UAC in Admin Approval Mode.","pos":[2446,2584]},{"content":"Microsoft UI Automation cannot drive the UI graphics of elevated applications on the desktop without the ability to bypass the restrictions that UIPI implements.","pos":[2585,2746]},{"content":"The ability to bypass UIPI restrictions across privilege levels is available for UI automation programs by using UIAccess.","pos":[2747,2869]},{"content":"If an application presents a UIAccess attribute when it requests privileges, the application is stating a requirement to bypass UIPI restrictions for sending messages across privilege levels.","pos":[2871,3062]},{"content":"Devices implement the following policy checks before starting an application with UIAccess privilege.","pos":[3063,3164]},{"content":"The application must have a digital signature that can be verified by using a digital certificate that is associated with the Trusted Root Certification Authorities store on the local device","pos":[3170,3360]},{"content":"The application must be installed in a local folder that is writeable only by administrators, such as the Program Files directory.","pos":[3365,3495]},{"content":"The allowed directories for UI automation applications are:","pos":[3496,3555]},{"content":"%ProgramFiles% and its subdirectories.","pos":[3565,3603]},{"content":"%WinDir% and its subdirectories, except a few subdirectories that are excluded because standard users have write access.","pos":[3612,3732]},{"content":"Possible values","pos":[3738,3753]},{"content":"Enabled","pos":[3761,3768]},{"content":"An application can start with UIAccess integrity only if it resides in a secure location in the file system.","pos":[3776,3884]},{"content":"Disabled","pos":[3892,3900]},{"content":"An application can start with UIAccess integrity even if it does not reside in a secure location in the file system.","pos":[3908,4024]},{"content":"Best practices","pos":[4030,4044]},{"pos":[4050,4196],"content":"Set this policy to <bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept> to permit applications that are located in one of the designated secure directories to run with UIAccess integrity."},{"content":"Location","pos":[4202,4210]},{"content":"Computer Configuration<ph id=\"ph1\">\\\\</ph>Windows Settings<ph id=\"ph2\">\\\\</ph>Security Settings<ph id=\"ph3\">\\\\</ph>Local Policies<ph id=\"ph4\">\\\\</ph>Security Options","pos":[4212,4305]},{"content":"Default values","pos":[4311,4325]},{"content":"The following table lists the actual and effective default values for this policy.","pos":[4327,4409]},{"content":"Default values are also listed on the policyâ€™s property page.","pos":[4410,4471]},{"content":"Server type or GPO","pos":[4475,4493]},{"content":"Default value","pos":[4496,4509]},{"content":"Default Domain Policy","pos":[4524,4545]},{"content":"Not defined","pos":[4547,4558]},{"content":"Default Domain Controller Policy","pos":[4563,4595]},{"content":"Not defined","pos":[4598,4609]},{"content":"Stand-Alone Server Default Settings","pos":[4614,4649]},{"content":"Enabled","pos":[4652,4659]},{"content":"DC Effective Default Settings","pos":[4664,4693]},{"content":"Enabled","pos":[4696,4703]},{"content":"Member Server Effective Default Settings","pos":[4708,4748]},{"content":"Enabled","pos":[4750,4757]},{"content":"Client Computer Effective Default Settings","pos":[4762,4804]},{"content":"Enabled","pos":[4807,4814]},{"content":"Policy management","pos":[4822,4839]},{"content":"This section describes features and tools that are available to help you manage this policy.","pos":[4841,4933]},{"content":"Restart requirement","pos":[4939,4958]},{"content":"None.","pos":[4960,4965]},{"content":"Changes to this policy become effective without a device restart when they aresaved locally or distributed through Group Policy.","pos":[4966,5094]},{"content":"Group Policy","pos":[5100,5112]},{"content":"All auditing capabilities are integrated in Group Policy.","pos":[5114,5171]},{"content":"You can configure, deploy, and manage these settings in the Group Policy Management Console (GPMC) or Local Security Policy snap-in for a domain, site, or organizational unit (OU).","pos":[5172,5352]},{"content":"Security considerations","pos":[5357,5380]},{"content":"This section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.","pos":[5382,5576]},{"content":"Vulnerability","pos":[5582,5595]},{"content":"UIAccess integrity allows an application to bypass User Interface Privilege Isolation (UIPI) restrictions when an application is elevated in privilege from a standard user to an administrator.","pos":[5597,5789]},{"content":"When this setting is enabled, an application that has the UIAccess flag set to true in its manifest can interchange information with applications that are running at a higher privilege level, such as logon prompts and privilege elevation prompts.","pos":[5790,6036]},{"content":"This ability is required to support accessibility features such as screen readers that are transmitting user interfaces to alternative forms, but it is not required by most applications.","pos":[6037,6223]},{"content":"A process that is started with UIAccess rights has the following abilities:","pos":[6224,6299]},{"content":"Set the foreground window.","pos":[6305,6331]},{"content":"Drive any application window by using the SendInput function.","pos":[6336,6397]},{"content":"Use read input for all integrity levels by using low-level hooks, raw input, GetKeyState, GetAsyncKeyState, and GetKeyboardInput.","pos":[6402,6531]},{"content":"Set journal hooks.","pos":[6536,6554]},{"content":"Use AttachThreadInput to attach a thread to a higher integrity input queue.","pos":[6559,6634]},{"content":"Countermeasure","pos":[6640,6654]},{"pos":[6656,6775],"content":"Enable the <bpt id=\"p1\">**</bpt>User Account Control: Only elevate UIAccess applications that are installed in secure locations<ept id=\"p1\">**</ept> setting."},{"content":"Potential impact","pos":[6781,6797]},{"content":"If the application that requests UIAccess meets the UIAccess setting requirements, computers running at least the Windows Vista operating system start the application with the ability to bypass most of the UIPI restrictions.","pos":[6799,7023]},{"content":"If the application does not meet the security restrictions, the application is started without UIAccess rights, and it can interact only with applications at the same or lower privilege level.","pos":[7024,7216]},{"content":"Related topics","pos":[7221,7235]},{"content":"Security Options","pos":[7240,7256]}],"content":"---\ntitle: User Account Control Only elevate UIAccess applications that are installed in secure locations (Windows 10)\ndescription: Describes the best practices, location, values, policy management and security considerations for the User Account Control Only elevate UIAccess applications that are installed in secure locations security policy setting.\nms.assetid: 4333409e-a5be-4f2f-8808-618f53abd22c\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# User Account Control: Only elevate UIAccess applications that are installed in secure locations\n\n**Applies to**\n-   Windows 10\n\nDescribes the best practices, location, values, policy management and security considerations for the **User Account Control: Only elevate UIAccess applications that are installed in secure locations** security policy setting.\n\n## Reference\n\nThis policy setting enforces the requirement that apps that request running with a UIAccess integrity level (by means of a marking of UIAccess=true in their app manifest), must reside in a secure location on the file system. Relatively secure locations are limited to the following directories:\n\n-   \\\\Program Files\\\\ including subdirectories\n-   \\\\Windows\\\\system32\\\\\n-   \\\\Program Files (x86)\\\\ including subdirectories for 64-bit versions of Windows\n\n>**Note:**  Windows enforces a PKI signature check on any interactive application that requests running with a UIAccess integrity level, regardless of the state of this security setting.\n \n**Background**\n\nUser Interface Privilege Isolation (UIPI) implements restrictions in the Windows subsystem that prevent lower-privilege applications from sending messages or installing hooks in higher-privilege processes. Higher-privilege applications are permitted to send messages to lower-privilege processes. UIPI does not interfere with or change the behavior of messages between applications at the same privilege (or integrity) level.\n\nMicrosoft UI Automation is the current model to support accessibility requirements in the Windows operating systems. Applications that are designed to support an accessible user experience control the behavior of other Windows applications on behalf of the user. When all applications on the automation client computer and server are running as a standard user (that is, at a medium integrity level), the UIPI restrictions do not interfere with the Microsoft UI automation model.\n\nHowever, there might be times when an administrative user runs an application with elevated privilege based on UAC in Admin Approval Mode. Microsoft UI Automation cannot drive the UI graphics of elevated applications on the desktop without the ability to bypass the restrictions that UIPI implements. The ability to bypass UIPI restrictions across privilege levels is available for UI automation programs by using UIAccess.\n\nIf an application presents a UIAccess attribute when it requests privileges, the application is stating a requirement to bypass UIPI restrictions for sending messages across privilege levels. Devices implement the following policy checks before starting an application with UIAccess privilege.\n\n1.  The application must have a digital signature that can be verified by using a digital certificate that is associated with the Trusted Root Certification Authorities store on the local device\n2.  The application must be installed in a local folder that is writeable only by administrators, such as the Program Files directory. The allowed directories for UI automation applications are:\n\n    1.  %ProgramFiles% and its subdirectories.\n    2.  %WinDir% and its subdirectories, except a few subdirectories that are excluded because standard users have write access.\n\n### Possible values\n\n-   **Enabled**\n\n    An application can start with UIAccess integrity only if it resides in a secure location in the file system.\n\n-   **Disabled**\n\n    An application can start with UIAccess integrity even if it does not reside in a secure location in the file system.\n\n### Best practices\n\n-   Set this policy to **Enabled** to permit applications that are located in one of the designated secure directories to run with UIAccess integrity.\n\n### Location\n\nComputer Configuration\\\\Windows Settings\\\\Security Settings\\\\Local Policies\\\\Security Options\n\n### Default values\n\nThe following table lists the actual and effective default values for this policy. Default values are also listed on the policyâ€™s property page.\n\n| Server type or GPO | Default value |\n| - | - |\n| Default Domain Policy| Not defined| \n| Default Domain Controller Policy | Not defined| \n| Stand-Alone Server Default Settings | Enabled| \n| DC Effective Default Settings | Enabled| \n| Member Server Effective Default Settings| Enabled| \n| Client Computer Effective Default Settings | Enabled| \n \n## Policy management\n\nThis section describes features and tools that are available to help you manage this policy.\n\n### Restart requirement\n\nNone. Changes to this policy become effective without a device restart when they aresaved locally or distributed through Group Policy.\n\n### Group Policy\n\nAll auditing capabilities are integrated in Group Policy. You can configure, deploy, and manage these settings in the Group Policy Management Console (GPMC) or Local Security Policy snap-in for a domain, site, or organizational unit (OU).\n\n## Security considerations\n\nThis section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.\n\n### Vulnerability\n\nUIAccess integrity allows an application to bypass User Interface Privilege Isolation (UIPI) restrictions when an application is elevated in privilege from a standard user to an administrator. When this setting is enabled, an application that has the UIAccess flag set to true in its manifest can interchange information with applications that are running at a higher privilege level, such as logon prompts and privilege elevation prompts. This ability is required to support accessibility features such as screen readers that are transmitting user interfaces to alternative forms, but it is not required by most applications. A process that is started with UIAccess rights has the following abilities:\n\n-   Set the foreground window.\n-   Drive any application window by using the SendInput function.\n-   Use read input for all integrity levels by using low-level hooks, raw input, GetKeyState, GetAsyncKeyState, and GetKeyboardInput.\n-   Set journal hooks.\n-   Use AttachThreadInput to attach a thread to a higher integrity input queue.\n\n### Countermeasure\n\nEnable the **User Account Control: Only elevate UIAccess applications that are installed in secure locations** setting.\n\n### Potential impact\n\nIf the application that requests UIAccess meets the UIAccess setting requirements, computers running at least the Windows Vista operating system start the application with the ability to bypass most of the UIPI restrictions. If the application does not meet the security restrictions, the application is started without UIAccess rights, and it can interact only with applications at the same or lower privilege level.\n\n## Related topics\n\n- [Security Options](security-options.md)\n"}