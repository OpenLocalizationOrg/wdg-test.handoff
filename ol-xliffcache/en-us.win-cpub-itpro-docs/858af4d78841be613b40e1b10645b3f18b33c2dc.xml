{"nodes":[{"content":"5038(F) Code integrity determined that the image hash of a file is not valid.","pos":[11,88]},{"content":"(Windows 10)","pos":[89,101]},{"content":"Describes security event 5038(F) Code integrity determined that the image hash of a file is not valid.","pos":[115,217]},{"content":"5038(F): Code integrity determined that the image hash of a file is not valid.","pos":[317,395]},{"content":"The file could be corrupt due to unauthorized modification or the invalid hash could indicate a potential disk device error.","pos":[396,520]},{"content":"Applies to","pos":[524,534]},{"content":"Windows 10","pos":[541,551]},{"content":"Windows Server 2016","pos":[556,575]},{"content":"The file could be corrupt due to unauthorized modification or the invalid hash could indicate a potential disk device error.","pos":[579,703]},{"pos":[705,859],"content":"This event generates by <bpt id=\"p1\">[</bpt>Code Integrity<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd348642(v=ws.10).aspx)</ept> feature, if signature of a file is not valid."},{"content":"Code Integrity is a feature that improves the security of the operating system by validating the integrity of a driver or system file each time it is loaded into memory.","pos":[861,1030]},{"content":"Code Integrity detects whether an unsigned driver or system file is being loaded into the kernel, or whether a system file has been modified by malicious software that is being run by a user account with administrative permissions.","pos":[1031,1262]},{"content":"On x64-based versions of the operating system, kernel-mode drivers must be digitally signed.","pos":[1263,1355]},{"content":"There is no example of this event in this document.","pos":[1357,1408]},{"pos":[1410,1485],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit System Integrity<ept id=\"p2\">](audit-system-integrity.md)</ept>"},{"content":"Event Schema:","pos":[1490,1503]},{"content":"Code integrity determined that the image hash of a file is not valid.","pos":[1509,1578]},{"content":"The file could be corrupt due to unauthorized modification or the invalid hash could indicate a potential disk device error.","pos":[1579,1703]},{"content":"File Name: %filepath<ph id=\"ph1\">\\\\</ph>filename%","pos":[1707,1738]},{"content":"Security Monitoring Recommendations","pos":[1744,1779]},{"content":"We recommend monitoring for this event, especially on high value assets or computers, because it can be a sign of a software or configuration issue, or a malicious action.","pos":[1785,1956]}],"content":"---\ntitle: 5038(F) Code integrity determined that the image hash of a file is not valid. (Windows 10)\ndescription: Describes security event 5038(F) Code integrity determined that the image hash of a file is not valid.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 5038(F): Code integrity determined that the image hash of a file is not valid. The file could be corrupt due to unauthorized modification or the invalid hash could indicate a potential disk device error.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n \n\nThe file could be corrupt due to unauthorized modification or the invalid hash could indicate a potential disk device error.\n\nThis event generates by [Code Integrity](https://technet.microsoft.com/en-us/library/dd348642(v=ws.10).aspx) feature, if signature of a file is not valid.\n\nCode Integrity is a feature that improves the security of the operating system by validating the integrity of a driver or system file each time it is loaded into memory. Code Integrity detects whether an unsigned driver or system file is being loaded into the kernel, or whether a system file has been modified by malicious software that is being run by a user account with administrative permissions. On x64-based versions of the operating system, kernel-mode drivers must be digitally signed.\n\nThere is no example of this event in this document.\n\n***Subcategory:***&nbsp;[Audit System Integrity](audit-system-integrity.md)\n\n***Event Schema:***\n\n*Code integrity determined that the image hash of a file is not valid. The file could be corrupt due to unauthorized modification or the invalid hash could indicate a potential disk device error.*\n\n*File Name: %filepath\\\\filename%*\n\n## Security Monitoring Recommendations\n\n-   We recommend monitoring for this event, especially on high value assets or computers, because it can be a sign of a software or configuration issue, or a malicious action.\n\n"}