{"nodes":[{"content":"Managing the UE-V 1.0 Agent and Packages with PowerShell and WMI","pos":[11,75]},{"content":"Managing the UE-V 1.0 Agent and Packages with PowerShell and WMI","pos":[89,153]},{"content":"Managing the UE-V 1.0 Agent and Packages with PowerShell and WMI","pos":[316,380]},{"content":"You can use WMI and PowerShell to manage Microsoft User Experience Virtualization (UE-V) Agent configuration and synchronization behavior.","pos":[383,521]},{"content":"How to deploy the UE-V agent with PowerShell","pos":[525,569]},{"content":"Stage the UE-V installer file in an accessible network share.","pos":[577,638]},{"pos":[644,956],"content":"**Note**  \nUse AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent. Windows Installer Files versions, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture. To uninstall the UE-V Agent at a later time using the installation file, you must use the same file type.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"Use AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent. Windows Installer Files versions, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture. To uninstall the UE-V Agent at a later time using the installation file, you must use the same file type.","pos":[11,308],"nodes":[{"content":"Use AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent.","pos":[0,79]},{"content":"Windows Installer Files versions, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture.","pos":[80,191]},{"content":"To uninstall the UE-V Agent at a later time using the installation file, you must use the same file type.","pos":[192,297]}]}]},{"content":"Use one of the following PowerShell commands to install the agent.","pos":[969,1035]},{"content":"How to configure the UE-V Agent with PowerShell","pos":[1326,1373]},{"content":"Use an account with administrator rights to open a PowerShell window.","pos":[1381,1450]},{"content":"Import the UE-V PowerShell module by using the following command.","pos":[1451,1516]},{"content":"Use the following PowerShell commands to configure the agent.","pos":[1568,1629]},{"pos":[1635,7425],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><strong>PowerShell command</strong></p></td>\n<td align=\"left\"><p><strong>Description</strong></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Get-UevConfiguration</p>\n<p></p></td>\n<td align=\"left\"><p>View the effective UE-V agent settings. User-specific settings have precedence over the computer settings.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Get-UevConfiguration - CurrentComputerUser</p>\n<p></p></td>\n<td align=\"left\"><p>View the UE-V agent settings values for the current user only.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Get-UevConfiguration -Computer</p></td>\n<td align=\"left\"><p>View the UE-V agent configuration settings values for all users on the computer.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Set-UevConfiguration -Computer -SettingsStoragePath &lt;path to _settings_storage_location&gt;</p></td>\n<td align=\"left\"><p>Define a per-computer settings storage location.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Set-UevConfiguration -CurrentComputerUser -SettingsStoragePath &lt;path to _settings_storage_location&gt;</p></td>\n<td align=\"left\"><p>Define a per-user settings storage location.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Set-UevConfiguration -Computer -SyncTimeoutInMilliseconds &lt;timeout in milliseconds&gt;</p></td>\n<td align=\"left\"><p>Set the synchronization timeout in milliseconds</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Set-UevConfiguration -CurrentComputerUser -SyncTimeoutInMilliseconds &lt;timeout in milliseconds&gt;</p></td>\n<td align=\"left\"><p>Set the synchronization timeout for the current user.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Set-UevConfiguration -Computer -MaxPackageSizeInBytes &lt;size in bytes&gt;</p></td>\n<td align=\"left\"><p>Configure the UE-V agent to report when a settings package file size reaches a defined threshold. Set the threshold package size in bytes.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Set-UevConfiguration -CurrentComputerUser -MaxPackageSizeInBytes &lt;size in bytes&gt;</p></td>\n<td align=\"left\"><p>Set the package size warning threshold for the current user.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Set-UevConfiguration –Computer –SettingsTemplateCatalogPath &lt;path to catalog&gt;</p></td>\n<td align=\"left\"><p>Set the settings template catalog path.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Set-UevConfiguration -Computer -SyncMethod &lt;sync method&gt;</p></td>\n<td align=\"left\"><p>Set the synchronization method: OfflineFiles or None.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Set-UevConfiguration -CurrentComputerUser -SyncMethod &lt;sync method&gt;</p></td>\n<td align=\"left\"><p>Set the synchronization method for the current user: OfflineFiles or None.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Set-UEVConfiguration -Computer –EnableSettingsImportNotify</p></td>\n<td align=\"left\"><p>Enable notification to occur when the import of user settings is delayed.</p>\n<p>Use –DisableSettingsImportNotify to disable notification.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Set-UEVConfiguration - CurrentComputerUser -EnableSettingsImportNotify</p></td>\n<td align=\"left\"><p>Enable notification for the current user when the import of user settings is delayed.</p>\n<p>Use –DisableSettingsImportNotify to disable notification.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Set-UEVConfiguration -Computer -SettingsImportNotifyDelayInSeconds</p></td>\n<td align=\"left\"><p>Specify the time in seconds before the user is notified</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Set-UEVConfiguration - CurrentComputerUser -SettingsImportNotifyDelayInSeconds</p></td>\n<td align=\"left\"><p>Specify the time in seconds before notification for the current user.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Set-UevConfiguration –Computer –DisableSync</p></td>\n<td align=\"left\"><p>Disable UE-V for all the users on the computer.</p>\n<p>Use –EnableSync to enable or re-enable.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Set-UevConfiguration –CurrentComputerUser -DisableSync</p></td>\n<td align=\"left\"><p>Disable UE-V for the current user on the computer.</p>\n<p>Use –EnableSync to enable or re-enable.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Clear-UevConfiguration –Computer -&lt;setting name&gt;</p></td>\n<td align=\"left\"><p>Clear a specific setting for all users on the computer.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Clear-UevConfiguration –CurrentComputerUser -&lt;setting name&gt;</p></td>\n<td align=\"left\"><p>Clear a specific setting for the current user only.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Export-UevConfiguration &lt;settings migration file&gt;</p></td>\n<td align=\"left\"><p>Export the UE-V computer configuration to a settings migration file. The extension of the file must be “.uev”.</p>\n<p>The export cmdlet exports all UE-V agent settings that are configurable with the -computer parameter.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Import-UevConfiguration &lt;settings migration file&gt;</p></td>\n<td align=\"left\"><p>Import the UE-V computer configuration from a settings migration file (.uev file).</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"PowerShell command","pos":[124,142]},{"content":"Description","pos":[189,200]},{"content":"Get-UevConfiguration","pos":[263,283]},{"content":"View the effective UE-V agent settings. User-specific settings have precedence over the computer settings.","pos":[321,427],"nodes":[{"content":"View the effective UE-V agent settings.","pos":[0,39]},{"content":"User-specific settings have precedence over the computer settings.","pos":[40,106]}]},{"content":"Get-UevConfiguration - CurrentComputerUser","pos":[480,522]},{"content":"View the UE-V agent settings values for the current user only.","pos":[560,622]},{"content":"Get-UevConfiguration -Computer","pos":[676,706]},{"content":"View the UE-V agent configuration settings values for all users on the computer.","pos":[736,816]},{"content":"Set-UevConfiguration -Computer -SettingsStoragePath <ph id=\"ph1\">&amp;lt;</ph>path to _settings_storage_location","pos":[869,959]},{"content":"Define a per-computer settings storage location.","pos":[993,1041]},{"content":"Set-UevConfiguration -CurrentComputerUser -SettingsStoragePath <ph id=\"ph1\">&amp;lt;</ph>path to _settings_storage_location","pos":[1095,1196]},{"content":"Define a per-user settings storage location.","pos":[1230,1274]},{"content":"Set-UevConfiguration -Computer -SyncTimeoutInMilliseconds <ph id=\"ph1\">&amp;lt;</ph>timeout in milliseconds","pos":[1327,1412]},{"content":"Set the synchronization timeout in milliseconds","pos":[1446,1493]},{"content":"Set-UevConfiguration -CurrentComputerUser -SyncTimeoutInMilliseconds <ph id=\"ph1\">&amp;lt;</ph>timeout in milliseconds","pos":[1547,1643]},{"content":"Set the synchronization timeout for the current user.","pos":[1677,1730]},{"content":"Set-UevConfiguration -Computer -MaxPackageSizeInBytes <ph id=\"ph1\">&amp;lt;</ph>size in bytes","pos":[1783,1854]},{"content":"Configure the UE-V agent to report when a settings package file size reaches a defined threshold. Set the threshold package size in bytes.","pos":[1888,2026],"nodes":[{"content":"Configure the UE-V agent to report when a settings package file size reaches a defined threshold.","pos":[0,97]},{"content":"Set the threshold package size in bytes.","pos":[98,138]}]},{"content":"Set-UevConfiguration -CurrentComputerUser -MaxPackageSizeInBytes <ph id=\"ph1\">&amp;lt;</ph>size in bytes","pos":[2080,2162]},{"content":"Set the package size warning threshold for the current user.","pos":[2196,2256]},{"content":"Set-UevConfiguration –Computer –SettingsTemplateCatalogPath <ph id=\"ph1\">&amp;lt;</ph>path to catalog","pos":[2309,2388]},{"content":"Set the settings template catalog path.","pos":[2422,2461]},{"content":"Set-UevConfiguration -Computer -SyncMethod <ph id=\"ph1\">&amp;lt;</ph>sync method","pos":[2515,2573]},{"content":"Set the synchronization method: OfflineFiles or None.","pos":[2607,2660]},{"content":"Set-UevConfiguration -CurrentComputerUser -SyncMethod <ph id=\"ph1\">&amp;lt;</ph>sync method","pos":[2713,2782]},{"content":"Set the synchronization method for the current user: OfflineFiles or None.","pos":[2816,2890]},{"content":"Set-UEVConfiguration -Computer –EnableSettingsImportNotify","pos":[2944,3002]},{"content":"Enable notification to occur when the import of user settings is delayed.","pos":[3032,3105]},{"content":"Use –DisableSettingsImportNotify to disable notification.","pos":[3113,3170]},{"content":"Set-UEVConfiguration - CurrentComputerUser -EnableSettingsImportNotify","pos":[3223,3293]},{"content":"Enable notification for the current user when the import of user settings is delayed.","pos":[3323,3408]},{"content":"Use –DisableSettingsImportNotify to disable notification.","pos":[3416,3473]},{"content":"Set-UEVConfiguration -Computer -SettingsImportNotifyDelayInSeconds","pos":[3527,3593]},{"content":"Specify the time in seconds before the user is notified","pos":[3623,3678]},{"content":"Set-UEVConfiguration - CurrentComputerUser -SettingsImportNotifyDelayInSeconds","pos":[3731,3809]},{"content":"Specify the time in seconds before notification for the current user.","pos":[3839,3908]},{"content":"Set-UevConfiguration –Computer –DisableSync","pos":[3962,4005]},{"content":"Disable UE-V for all the users on the computer.","pos":[4035,4082]},{"content":"Use –EnableSync to enable or re-enable.","pos":[4090,4129]},{"content":"Set-UevConfiguration –CurrentComputerUser -DisableSync","pos":[4182,4236]},{"content":"Disable UE-V for the current user on the computer.","pos":[4266,4316]},{"content":"Use –EnableSync to enable or re-enable.","pos":[4324,4363]},{"content":"Clear-UevConfiguration –Computer -<ph id=\"ph1\">&amp;lt;</ph>setting name","pos":[4417,4467]},{"content":"Clear a specific setting for all users on the computer.","pos":[4501,4556]},{"content":"Clear-UevConfiguration –CurrentComputerUser -<ph id=\"ph1\">&amp;lt;</ph>setting name","pos":[4609,4670]},{"content":"Clear a specific setting for the current user only.","pos":[4704,4755]},{"content":"Export-UevConfiguration <ph id=\"ph1\">&amp;lt;</ph>settings migration file","pos":[4809,4860]},{"content":"Export the UE-V computer configuration to a settings migration file. The extension of the file must be “.uev”.","pos":[4894,5004],"nodes":[{"content":"Export the UE-V computer configuration to a settings migration file.","pos":[0,68]},{"content":"The extension of the file must be “.uev”.","pos":[69,110]}]},{"content":"The export cmdlet exports all UE-V agent settings that are configurable with the -computer parameter.","pos":[5012,5113]},{"content":"Import-UevConfiguration <ph id=\"ph1\">&amp;lt;</ph>settings migration file","pos":[5166,5217]},{"content":"Import the UE-V computer configuration from a settings migration file (.uev file).","pos":[5251,5333]}]},{"content":"How to export UE-V package settings and repair UE-V templates with PowerShell","pos":[7436,7513]},{"content":"Open a PowerShell window as an Administrator.","pos":[7521,7566]},{"content":"Import the UE-V PowerShell module with the following command.","pos":[7567,7628]},{"content":"Use the following PowerShell commands to configure the agent.","pos":[7680,7741]},{"pos":[7747,8473],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><strong>PowerShell command</strong></p></td>\n<td align=\"left\"><p><strong>Description</strong></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Export-UevPackage MicrosoftCalculator6.pkgx</p></td>\n<td align=\"left\"><p>Extracts the settings from a Microsoft Calculator package file and converts them into a human-readable format in XML.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Repair-UevTemplateIndex</p></td>\n<td align=\"left\"><p>Repairs the index of the UE-V settings location templates.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"PowerShell command","pos":[124,142]},{"content":"Description","pos":[189,200]},{"content":"Export-UevPackage MicrosoftCalculator6.pkgx","pos":[263,306]},{"content":"Extracts the settings from a Microsoft Calculator package file and converts them into a human-readable format in XML.","pos":[336,453]},{"content":"Repair-UevTemplateIndex","pos":[506,529]},{"content":"Repairs the index of the UE-V settings location templates.","pos":[559,617]}]},{"content":"How to configure the UE-V Agent with WMI","pos":[8484,8524]},{"content":"User Experience Virtualization provides the following set of WMI commands.","pos":[8532,8606]},{"content":"Administrators can use this interface to configure the UE-V agent from the command line and automate typical configuration tasks.","pos":[8607,8736]},{"content":"Use an account with administrator rights to open a PowerShell window.","pos":[8742,8811]},{"content":"Use the following WMI commands to configure the agent.","pos":[8817,8871]},{"pos":[8877,12262],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">PowerShell command</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Get-WmiObject -Namespace root\\Microsoft\\UEV Configuration</p>\n<p></p></td>\n<td align=\"left\"><p>View the active UE-V agent settings. User-specific settings have precedence over the computer settings.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguration</p></td>\n<td align=\"left\"><p>View the UE-V agent configuration that is defined for user.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p></td>\n<td align=\"left\"><p>View the UE-V agent configuration that is defined for computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n<p>$config.SettingsStoragePath = &lt;path_to_settings_storage_location&gt;</p>\n<p>$config.Put()</p></td>\n<td align=\"left\"><p>Define a per-computer settings storage location.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguration</p>\n<p>$config.SettingsStoragePath = &lt;path_to_settings_storage_location&gt;</p>\n<p>$config.Put()</p></td>\n<td align=\"left\"><p>Define a per-user settings storage location.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n<p>$config.SyncTimeoutInMilliseconds = &lt;timeout_in_milliseconds&gt;</p>\n<p>$config.Put()</p></td>\n<td align=\"left\"><p>Set the synchronization timeout in milliseconds.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n<p>$config.MaxPackageSizeInBytes = &lt;size_in_bytes&gt;</p>\n<p>$config.Put()</p></td>\n<td align=\"left\"><p>Configure the UE-V agent to report when a settings package file size reaches a defined threshold. Set the threshold package file size in bytes.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n<p>$config.SyncMethod = &lt;sync_method&gt;</p>\n<p>$config.Put()</p></td>\n<td align=\"left\"><p>Set the synchronization method: OfflineFiles or None.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n<p>$config.&lt;setting name&gt; = &lt;setting value&gt;</p>\n<p>$config.Put()</p></td>\n<td align=\"left\"><p>Update a specific per-computer setting. To clear the setting, use $null as the setting value.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n<p>$config.&lt;setting name&gt; = &lt;setting value&gt;</p>\n<p>$config.Put()</p></td>\n<td align=\"left\"><p>Update a specific per-user setting. To clear the setting, use $null as the setting value.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"PowerShell command","pos":[116,134]},{"content":"Description","pos":[157,168]},{"content":"Get-WmiObject -Namespace root\\Microsoft\\UEV Configuration","pos":[234,291]},{"content":"View the active UE-V agent settings. User-specific settings have precedence over the computer settings.","pos":[329,432],"nodes":[{"content":"View the active UE-V agent settings.","pos":[0,36]},{"content":"User-specific settings have precedence over the computer settings.","pos":[37,103]}]},{"content":"Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguration","pos":[486,547]},{"content":"View the UE-V agent configuration that is defined for user.","pos":[577,636]},{"content":"Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration","pos":[689,754]},{"content":"View the UE-V agent configuration that is defined for computer.","pos":[784,847]},{"content":"$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration","pos":[901,976]},{"content":"$config.SettingsStoragePath = <ph id=\"ph1\">&amp;lt;</ph>path_to_settings_storage_location","pos":[984,1051]},{"content":"$config.Put()","pos":[1063,1076]},{"content":"Define a per-computer settings storage location.","pos":[1106,1154]},{"content":"$config = Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguration","pos":[1207,1278]},{"content":"$config.SettingsStoragePath = <ph id=\"ph1\">&amp;lt;</ph>path_to_settings_storage_location","pos":[1286,1353]},{"content":"$config.Put()","pos":[1365,1378]},{"content":"Define a per-user settings storage location.","pos":[1408,1452]},{"content":"$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration","pos":[1506,1581]},{"content":"$config.SyncTimeoutInMilliseconds = <ph id=\"ph1\">&amp;lt;</ph>timeout_in_milliseconds","pos":[1589,1652]},{"content":"$config.Put()","pos":[1664,1677]},{"content":"Set the synchronization timeout in milliseconds.","pos":[1707,1755]},{"content":"$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration","pos":[1808,1883]},{"content":"$config.MaxPackageSizeInBytes = <ph id=\"ph1\">&amp;lt;</ph>size_in_bytes","pos":[1891,1940]},{"content":"$config.Put()","pos":[1952,1965]},{"content":"Configure the UE-V agent to report when a settings package file size reaches a defined threshold. Set the threshold package file size in bytes.","pos":[1995,2138],"nodes":[{"content":"Configure the UE-V agent to report when a settings package file size reaches a defined threshold.","pos":[0,97]},{"content":"Set the threshold package file size in bytes.","pos":[98,143]}]},{"content":"$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration","pos":[2192,2267]},{"content":"$config.SyncMethod = <ph id=\"ph1\">&amp;lt;</ph>sync_method","pos":[2275,2311]},{"content":"$config.Put()","pos":[2323,2336]},{"content":"Set the synchronization method: OfflineFiles or None.","pos":[2366,2419]},{"content":"$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration","pos":[2472,2547]},{"content":"$config.<ph id=\"ph1\">&amp;lt;</ph>setting name<ph id=\"ph2\">&amp;gt; = &amp;lt;</ph>setting value","pos":[2555,2603]},{"content":"$config.Put()","pos":[2615,2628]},{"content":"Update a specific per-computer setting. To clear the setting, use $null as the setting value.","pos":[2658,2751],"nodes":[{"content":"Update a specific per-computer setting.","pos":[0,39]},{"content":"To clear the setting, use $null as the setting value.","pos":[40,93]}]},{"content":"$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration","pos":[2805,2880]},{"content":"$config.<ph id=\"ph1\">&amp;lt;</ph>setting name<ph id=\"ph2\">&amp;gt; = &amp;lt;</ph>setting value","pos":[2888,2936]},{"content":"$config.Put()","pos":[2948,2961]},{"content":"Update a specific per-user setting. To clear the setting, use $null as the setting value.","pos":[2991,3080],"nodes":[{"content":"Update a specific per-user setting.","pos":[0,35]},{"content":"To clear the setting, use $null as the setting value.","pos":[36,89]}]}]},{"content":"Upon configuration of the UE-V Agent with WMI and PowerShell, the defined configuration is stored in the registry in the following locations:","pos":[12275,12416]},{"content":"Related topics","pos":[12560,12574]},{"content":"Administering UE-V 1.0","pos":[12578,12600]},{"content":"Operations for UE-V 1.0","pos":[12630,12653]}],"content":"---\ntitle: Managing the UE-V 1.0 Agent and Packages with PowerShell and WMI\ndescription: Managing the UE-V 1.0 Agent and Packages with PowerShell and WMI\nauthor: jamiejdt\nms.assetid: c8989b01-1769-4e69-82b1-4aadb261d2d5\nms.pagetype: mdop, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w8\n---\n\n\n# Managing the UE-V 1.0 Agent and Packages with PowerShell and WMI\n\n\nYou can use WMI and PowerShell to manage Microsoft User Experience Virtualization (UE-V) Agent configuration and synchronization behavior.\n\n**How to deploy the UE-V agent with PowerShell**\n\n1.  Stage the UE-V installer file in an accessible network share.\n\n    **Note**  \n    Use AgentSetup.exe to deploy both 32-bit and 64-bit versions of the UE-V Agent. Windows Installer Files versions, AgentSetupx86.msi and AgentSetupx64.msi, are available for each architecture. To uninstall the UE-V Agent at a later time using the installation file, you must use the same file type.\n\n     \n\n2.  Use one of the following PowerShell commands to install the agent.\n\n    `& AgentSetup.exe /quiet /norestart /log \"%temp%\\UE-VAgentInstaller.log\" SettingsStoragePath=\\\\server\\settingsshare\\%username%`\n\n    `& msiexec.exe /i \"<path to msi file>\" /quiet /norestart /l*v \"%temp%\\UE-VAgentInstaller.log\" SettingsStoragePath=\\\\server\\settingsshare\\%username%`\n\n**How to configure the UE-V Agent with PowerShell**\n\n1.  Use an account with administrator rights to open a PowerShell window. Import the UE-V PowerShell module by using the following command.\n\n    ``` syntax\n    Import-module UEV\n    ```\n\n2.  Use the following PowerShell commands to configure the agent.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><strong>PowerShell command</strong></p></td>\n    <td align=\"left\"><p><strong>Description</strong></p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Get-UevConfiguration</p>\n    <p></p></td>\n    <td align=\"left\"><p>View the effective UE-V agent settings. User-specific settings have precedence over the computer settings.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Get-UevConfiguration - CurrentComputerUser</p>\n    <p></p></td>\n    <td align=\"left\"><p>View the UE-V agent settings values for the current user only.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Get-UevConfiguration -Computer</p></td>\n    <td align=\"left\"><p>View the UE-V agent configuration settings values for all users on the computer.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Set-UevConfiguration -Computer -SettingsStoragePath &lt;path to _settings_storage_location&gt;</p></td>\n    <td align=\"left\"><p>Define a per-computer settings storage location.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Set-UevConfiguration -CurrentComputerUser -SettingsStoragePath &lt;path to _settings_storage_location&gt;</p></td>\n    <td align=\"left\"><p>Define a per-user settings storage location.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Set-UevConfiguration -Computer -SyncTimeoutInMilliseconds &lt;timeout in milliseconds&gt;</p></td>\n    <td align=\"left\"><p>Set the synchronization timeout in milliseconds</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Set-UevConfiguration -CurrentComputerUser -SyncTimeoutInMilliseconds &lt;timeout in milliseconds&gt;</p></td>\n    <td align=\"left\"><p>Set the synchronization timeout for the current user.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Set-UevConfiguration -Computer -MaxPackageSizeInBytes &lt;size in bytes&gt;</p></td>\n    <td align=\"left\"><p>Configure the UE-V agent to report when a settings package file size reaches a defined threshold. Set the threshold package size in bytes.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Set-UevConfiguration -CurrentComputerUser -MaxPackageSizeInBytes &lt;size in bytes&gt;</p></td>\n    <td align=\"left\"><p>Set the package size warning threshold for the current user.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Set-UevConfiguration –Computer –SettingsTemplateCatalogPath &lt;path to catalog&gt;</p></td>\n    <td align=\"left\"><p>Set the settings template catalog path.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Set-UevConfiguration -Computer -SyncMethod &lt;sync method&gt;</p></td>\n    <td align=\"left\"><p>Set the synchronization method: OfflineFiles or None.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Set-UevConfiguration -CurrentComputerUser -SyncMethod &lt;sync method&gt;</p></td>\n    <td align=\"left\"><p>Set the synchronization method for the current user: OfflineFiles or None.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Set-UEVConfiguration -Computer –EnableSettingsImportNotify</p></td>\n    <td align=\"left\"><p>Enable notification to occur when the import of user settings is delayed.</p>\n    <p>Use –DisableSettingsImportNotify to disable notification.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Set-UEVConfiguration - CurrentComputerUser -EnableSettingsImportNotify</p></td>\n    <td align=\"left\"><p>Enable notification for the current user when the import of user settings is delayed.</p>\n    <p>Use –DisableSettingsImportNotify to disable notification.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Set-UEVConfiguration -Computer -SettingsImportNotifyDelayInSeconds</p></td>\n    <td align=\"left\"><p>Specify the time in seconds before the user is notified</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Set-UEVConfiguration - CurrentComputerUser -SettingsImportNotifyDelayInSeconds</p></td>\n    <td align=\"left\"><p>Specify the time in seconds before notification for the current user.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Set-UevConfiguration –Computer –DisableSync</p></td>\n    <td align=\"left\"><p>Disable UE-V for all the users on the computer.</p>\n    <p>Use –EnableSync to enable or re-enable.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Set-UevConfiguration –CurrentComputerUser -DisableSync</p></td>\n    <td align=\"left\"><p>Disable UE-V for the current user on the computer.</p>\n    <p>Use –EnableSync to enable or re-enable.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Clear-UevConfiguration –Computer -&lt;setting name&gt;</p></td>\n    <td align=\"left\"><p>Clear a specific setting for all users on the computer.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Clear-UevConfiguration –CurrentComputerUser -&lt;setting name&gt;</p></td>\n    <td align=\"left\"><p>Clear a specific setting for the current user only.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Export-UevConfiguration &lt;settings migration file&gt;</p></td>\n    <td align=\"left\"><p>Export the UE-V computer configuration to a settings migration file. The extension of the file must be “.uev”.</p>\n    <p>The export cmdlet exports all UE-V agent settings that are configurable with the -computer parameter.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Import-UevConfiguration &lt;settings migration file&gt;</p></td>\n    <td align=\"left\"><p>Import the UE-V computer configuration from a settings migration file (.uev file).</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n**How to export UE-V package settings and repair UE-V templates with PowerShell**\n\n1.  Open a PowerShell window as an Administrator. Import the UE-V PowerShell module with the following command.\n\n    ``` syntax\n    Import-module UEV\n    ```\n\n2.  Use the following PowerShell commands to configure the agent.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><strong>PowerShell command</strong></p></td>\n    <td align=\"left\"><p><strong>Description</strong></p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Export-UevPackage MicrosoftCalculator6.pkgx</p></td>\n    <td align=\"left\"><p>Extracts the settings from a Microsoft Calculator package file and converts them into a human-readable format in XML.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Repair-UevTemplateIndex</p></td>\n    <td align=\"left\"><p>Repairs the index of the UE-V settings location templates.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n**How to configure the UE-V Agent with WMI**\n\n1.  User Experience Virtualization provides the following set of WMI commands. Administrators can use this interface to configure the UE-V agent from the command line and automate typical configuration tasks.\n\n    Use an account with administrator rights to open a PowerShell window.\n\n2.  Use the following WMI commands to configure the agent.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\">PowerShell command</th>\n    <th align=\"left\">Description</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Get-WmiObject -Namespace root\\Microsoft\\UEV Configuration</p>\n    <p></p></td>\n    <td align=\"left\"><p>View the active UE-V agent settings. User-specific settings have precedence over the computer settings.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguration</p></td>\n    <td align=\"left\"><p>View the UE-V agent configuration that is defined for user.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p></td>\n    <td align=\"left\"><p>View the UE-V agent configuration that is defined for computer.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n    <p>$config.SettingsStoragePath = &lt;path_to_settings_storage_location&gt;</p>\n    <p>$config.Put()</p></td>\n    <td align=\"left\"><p>Define a per-computer settings storage location.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV UserConfiguration</p>\n    <p>$config.SettingsStoragePath = &lt;path_to_settings_storage_location&gt;</p>\n    <p>$config.Put()</p></td>\n    <td align=\"left\"><p>Define a per-user settings storage location.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n    <p>$config.SyncTimeoutInMilliseconds = &lt;timeout_in_milliseconds&gt;</p>\n    <p>$config.Put()</p></td>\n    <td align=\"left\"><p>Set the synchronization timeout in milliseconds.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n    <p>$config.MaxPackageSizeInBytes = &lt;size_in_bytes&gt;</p>\n    <p>$config.Put()</p></td>\n    <td align=\"left\"><p>Configure the UE-V agent to report when a settings package file size reaches a defined threshold. Set the threshold package file size in bytes.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n    <p>$config.SyncMethod = &lt;sync_method&gt;</p>\n    <p>$config.Put()</p></td>\n    <td align=\"left\"><p>Set the synchronization method: OfflineFiles or None.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n    <p>$config.&lt;setting name&gt; = &lt;setting value&gt;</p>\n    <p>$config.Put()</p></td>\n    <td align=\"left\"><p>Update a specific per-computer setting. To clear the setting, use $null as the setting value.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>$config = Get-WmiObject -Namespace root\\Microsoft\\UEV ComputerConfiguration</p>\n    <p>$config.&lt;setting name&gt; = &lt;setting value&gt;</p>\n    <p>$config.Put()</p></td>\n    <td align=\"left\"><p>Update a specific per-user setting. To clear the setting, use $null as the setting value.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n    Upon configuration of the UE-V Agent with WMI and PowerShell, the defined configuration is stored in the registry in the following locations:\n\n    `\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\UEV\\Agent\\Configuration`\n\n    `\\HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\UEV\\Agent\\Configuration`\n\n## Related topics\n\n\n[Administering UE-V 1.0](administering-ue-v-10.md)\n\n[Operations for UE-V 1.0](operations-for-ue-v-10.md)\n\n \n\n \n\n\n\n\n\n"}