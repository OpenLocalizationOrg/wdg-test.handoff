{"nodes":[{"content":"Verify the Condition of a Compressed Migration Store (Windows 10)","pos":[11,76]},{"content":"Verify the Condition of a Compressed Migration Store","pos":[90,142]},{"content":"Verify the Condition of a Compressed Migration Store","pos":[275,327]},{"content":"When you migrate files and settings during a typical PC-refresh migration, the user state is usually stored in a compressed folder on the intermediate store.","pos":[330,487]},{"content":"This compressed folder, also called the compressed migration store, is a single image file that contains:","pos":[488,593]},{"content":"All of the files being migrated.","pos":[599,631]},{"content":"The user’s settings.","pos":[637,657]},{"content":"A catalog file that contains metadata for all files in the migration store.","pos":[663,738]},{"content":"When you run the <bpt id=\"p1\">**</bpt>LoadState<ept id=\"p1\">**</ept> command to load the data from these files to the destination computer, LoadState requires a valid catalog file in order to open the migration store.","pos":[740,919]},{"content":"You can run the <bpt id=\"p1\">**</bpt>UsmtUtils<ept id=\"p1\">**</ept> command with the <bpt id=\"p2\">**</bpt>/verify<ept id=\"p2\">**</ept> option to determine whether the compressed migration store is intact, or whether it contains corrupted files or a corrupted catalog.","pos":[920,1111]},{"content":"You should run the <bpt id=\"p1\">**</bpt>/verify<ept id=\"p1\">**</ept> option on the migration store before you overwrite the original user-state files and settings.","pos":[1112,1237]},{"content":"When you use the <bpt id=\"p1\">**</bpt>/verify<ept id=\"p1\">**</ept> option, you can specify what type of information to report in the UsmtUtils log file.","pos":[1239,1353]},{"content":"These report types are:","pos":[1354,1377]},{"pos":[1383,1441],"content":"<bpt id=\"p1\">**</bpt>Catalog<ept id=\"p1\">**</ept>: Displays the status of only the catalog file."},{"pos":[1447,1517],"content":"<bpt id=\"p1\">**</bpt>All<ept id=\"p1\">**</ept>: Displays the status of all files, including the catalog file."},{"pos":[1523,1584],"content":"<bpt id=\"p1\">**</bpt>Failure only<ept id=\"p1\">**</ept>: Displays only the files that are corrupted."},{"content":"In This Topic","pos":[1589,1602]},{"pos":[1605,1778],"content":"The following sections demonstrate how to run the <bpt id=\"p1\">**</bpt>UsmtUtils<ept id=\"p1\">**</ept> command with the <bpt id=\"p2\">**</bpt>/verify<ept id=\"p2\">**</ept> option, and how to specify the information to display in the UsmtUtils log file."},{"content":"The UsmtUtils syntax for the /verify option","pos":[1785,1828]},{"content":"To verify that the migration store is intact","pos":[1856,1900]},{"content":"To verify the status of only the catalog file","pos":[1933,1978]},{"content":"To verify the status of all files","pos":[2007,2040]},{"content":"To verify the status of the files and return only the corrupted files","pos":[2070,2139]},{"pos":[2207,2250],"content":"The UsmtUtils Syntax for the /verify Option"},{"content":"To verify the condition of a compressed migration store, use the following UsmtUtils syntax:","pos":[2252,2344]},{"content":"cd /d<ph id=\"ph1\">&amp;lt;</ph>USMTpath<ph id=\"ph2\">&amp;gt;</ph>usmtutils /verify<ph id=\"ph3\">\\[</ph>:<ph id=\"ph4\">&amp;lt;</ph>reportType<ph id=\"ph5\">&amp;gt;\\]</ph> <ph id=\"ph6\">&amp;lt;</ph>filePath<ph id=\"ph7\">&amp;gt;</ph> <ph id=\"ph8\">\\[</ph>/l:<ph id=\"ph9\">&amp;lt;</ph>logfile<ph id=\"ph10\">&amp;gt;\\]</ph> <ph id=\"ph11\">\\[</ph>/decrypt <ph id=\"ph12\">\\[</ph>:<ph id=\"ph13\">&amp;lt;</ph>AlgID<ph id=\"ph14\">&amp;gt;\\]</ph> {/key:<ph id=\"ph15\">&amp;lt;</ph>keystring<ph id=\"ph16\">&amp;gt;</ph> | /keyfile:<ph id=\"ph17\">&amp;lt;</ph>filename<ph id=\"ph18\">&amp;gt;</ph>}","pos":[2346,2530]},{"content":"Where the placeholders have the following values:","pos":[2534,2583]},{"pos":[2589,2670],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>USMTpath<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the location where you have saved the USMT files and tools."},{"pos":[2676,2790],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>reportType<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> specifies whether to report on all files, corrupted files only, or the status of the catalog."},{"pos":[2796,2865],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>filePath<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the location of the compressed migration store."},{"pos":[2871,2930],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>logfile<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the location and name of the log file."},{"pos":[2936,3061],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>AlgID<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the cryptographic algorithm that was used to create the migration store on the <bpt id=\"p2\">**</bpt>ScanState<ept id=\"p2\">**</ept> command line."},{"pos":[3067,3154],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>keystring<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the encryption key that was used to encrypt the migration store."},{"pos":[3160,3254],"content":"<bpt id=\"p1\">*</bpt><ph id=\"ph1\">&amp;lt;</ph>filename<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">*</ept> is the location and name of the text file that contains the encryption key."},{"pos":[3303,3347],"content":"To Verify that the Migration Store is Intact"},{"content":"To verify whether the migration store is intact or whether it contains corrupted files or a corrupted catalog, type:","pos":[3349,3465]},{"content":"Because no report type is specified, UsmtUtils displays the default summary report.","pos":[3531,3614]},{"pos":[3659,3704],"content":"To Verify the Status of Only the Catalog File"},{"content":"To verify whether the catalog file is corrupted or intact, type:","pos":[3706,3770]},{"pos":[3888,3921],"content":"To Verify the Status of all Files"},{"content":"To verify whether there are any corrupted files in the compressed migration store, and to specify the name and location of the log file, type:","pos":[3923,4065]},{"content":"In addition to verifying the status of all files, this example decrypts the files.","pos":[4154,4236]},{"content":"Because no encryption algorithm is specified, UsmtUtils uses the default 3DES cryptographic algorithm.","pos":[4237,4339]},{"pos":[4386,4455],"content":"To Verify the Status of the Files and Return Only the Corrupted Files"},{"content":"In this example, the log file will only list the files that became corrupted during the ScanState process.","pos":[4457,4563]},{"content":"This list will include the catalog file if it is also corrupted.","pos":[4564,4628]},{"content":"This example also decrypts the files by specifying the cryptographic algorithm and the location of the file that contains the encryption key.","pos":[4758,4899]},{"content":"Next Steps","pos":[4905,4915]},{"content":"If the <bpt id=\"p1\">**</bpt>/verify<ept id=\"p1\">**</ept> option indicates that there are corrupted files in the migration store, you can use the <bpt id=\"p2\">**</bpt>/extract<ept id=\"p2\">**</ept> option in the UsmtUtils tool to recover data from some corrupted stores.","pos":[4917,5109]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Extract Files from a Compressed USMT Migration Store<ept id=\"p1\">](usmt-extract-files-from-a-compressed-migration-store.md)</ept>.","pos":[5110,5248]},{"content":"Related topics","pos":[5253,5267]},{"content":"UsmtUtils Syntax","pos":[5271,5287]},{"content":"Return Codes","pos":[5310,5322]}],"content":"---\ntitle: Verify the Condition of a Compressed Migration Store (Windows 10)\ndescription: Verify the Condition of a Compressed Migration Store\nms.assetid: 4a3fda96-5f7d-494a-955f-6b865ec9fcae\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: greg-lindsay\n---\n\n# Verify the Condition of a Compressed Migration Store\n\n\nWhen you migrate files and settings during a typical PC-refresh migration, the user state is usually stored in a compressed folder on the intermediate store. This compressed folder, also called the compressed migration store, is a single image file that contains:\n\n-   All of the files being migrated.\n\n-   The user’s settings.\n\n-   A catalog file that contains metadata for all files in the migration store.\n\nWhen you run the **LoadState** command to load the data from these files to the destination computer, LoadState requires a valid catalog file in order to open the migration store. You can run the **UsmtUtils** command with the **/verify** option to determine whether the compressed migration store is intact, or whether it contains corrupted files or a corrupted catalog. You should run the **/verify** option on the migration store before you overwrite the original user-state files and settings.\n\nWhen you use the **/verify** option, you can specify what type of information to report in the UsmtUtils log file. These report types are:\n\n-   **Catalog**: Displays the status of only the catalog file.\n\n-   **All**: Displays the status of all files, including the catalog file.\n\n-   **Failure only**: Displays only the files that are corrupted.\n\n## In This Topic\n\n\nThe following sections demonstrate how to run the **UsmtUtils** command with the **/verify** option, and how to specify the information to display in the UsmtUtils log file.\n\n-   [The UsmtUtils syntax for the /verify option](#bkmk-verifysyntax)\n\n-   [To verify that the migration store is intact](#bkmk-verifyintactstore)\n\n-   [To verify the status of only the catalog file](#bkmk-verifycatalog)\n\n-   [To verify the status of all files](#bkmk-verifyallfiles)\n\n-   [To verify the status of the files and return only the corrupted files](#bkmk-returncorrupted)\n\n### <a href=\"\" id=\"bkmk-verifysyntax\"></a>The UsmtUtils Syntax for the /verify Option\n\nTo verify the condition of a compressed migration store, use the following UsmtUtils syntax:\n\ncd /d&lt;USMTpath&gt;usmtutils /verify\\[:&lt;reportType&gt;\\] &lt;filePath&gt; \\[/l:&lt;logfile&gt;\\] \\[/decrypt \\[:&lt;AlgID&gt;\\] {/key:&lt;keystring&gt; | /keyfile:&lt;filename&gt;}\\]\n\nWhere the placeholders have the following values:\n\n-   *&lt;USMTpath&gt;* is the location where you have saved the USMT files and tools.\n\n-   *&lt;reportType&gt;* specifies whether to report on all files, corrupted files only, or the status of the catalog.\n\n-   *&lt;filePath&gt;* is the location of the compressed migration store.\n\n-   *&lt;logfile&gt;* is the location and name of the log file.\n\n-   *&lt;AlgID&gt;* is the cryptographic algorithm that was used to create the migration store on the **ScanState** command line.\n\n-   *&lt;keystring&gt;* is the encryption key that was used to encrypt the migration store.\n\n-   *&lt;filename&gt;* is the location and name of the text file that contains the encryption key.\n\n### <a href=\"\" id=\"bkmk-verifyintactstore\"></a>To Verify that the Migration Store is Intact\n\nTo verify whether the migration store is intact or whether it contains corrupted files or a corrupted catalog, type:\n\n``` syntax\nusmtutils /verify D:\\MyMigrationStore\\store.mig\n```\n\nBecause no report type is specified, UsmtUtils displays the default summary report.\n\n### <a href=\"\" id=\"bkmk-verifycatalog\"></a>To Verify the Status of Only the Catalog File\n\nTo verify whether the catalog file is corrupted or intact, type:\n\n``` syntax\nusmtutils /verify:catalog D:\\MyMigrationStore\\store.mig\n```\n\n### <a href=\"\" id=\"bkmk-verifyallfiles\"></a>To Verify the Status of all Files\n\nTo verify whether there are any corrupted files in the compressed migration store, and to specify the name and location of the log file, type:\n\n`usmtutils /verify:all D:\\MyMigrationStore\\store.mig /decrypt /l:D:\\UsmtUtilsLog.txt`\n\nIn addition to verifying the status of all files, this example decrypts the files. Because no encryption algorithm is specified, UsmtUtils uses the default 3DES cryptographic algorithm.\n\n### <a href=\"\" id=\"bkmk-returncorrupted\"></a>To Verify the Status of the Files and Return Only the Corrupted Files\n\nIn this example, the log file will only list the files that became corrupted during the ScanState process. This list will include the catalog file if it is also corrupted.\n\n``` syntax\nusmtutils /verify:failureonly D:\\MyMigrationStore\\USMT\\store.mig /decrypt:AES_192 /keyfile:D:\\encryptionKey.txt\n```\n\nThis example also decrypts the files by specifying the cryptographic algorithm and the location of the file that contains the encryption key.\n\n### Next Steps\n\nIf the **/verify** option indicates that there are corrupted files in the migration store, you can use the **/extract** option in the UsmtUtils tool to recover data from some corrupted stores. For more information, see [Extract Files from a Compressed USMT Migration Store](usmt-extract-files-from-a-compressed-migration-store.md).\n\n## Related topics\n\n\n[UsmtUtils Syntax](usmt-utilities.md)\n\n[Return Codes](usmt-return-codes.md)\n\n \n\n \n\n\n\n\n\n"}