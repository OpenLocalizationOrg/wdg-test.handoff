{"nodes":[{"content":"Planning for Client Security","pos":[11,39]},{"content":"Planning for Client Security","pos":[53,81]},{"content":"Planning for Client Security","pos":[255,283]},{"content":"The App-V Client provides several security enhancements that were not present in previous versions of the product.","pos":[286,400]},{"content":"These changes provide improved security after installation and through later configuration of the client settings.","pos":[401,515]},{"content":"This topic describes some of those enhancements and identifies several important security-related configuration settings that you should consider during your planning process.","pos":[516,691]},{"content":"It is important to remember that virtual applications are still executables, so you must ensure that these assets cannot be tampered with by unauthorized people.","pos":[692,853]},{"content":"For this reason, the Open Software Descriptor (OSD) file cache is protected as described later in this topic, and we strongly recommend that you use RTSPS, HTTPS, and IPsec to protect publishing and streaming.","pos":[854,1063]},{"content":"App-V Client Security","pos":[1068,1089]},{"content":"By default, at installation the App-V client is configured with the minimum permissions required to allow a user to perform a publishing refresh and to start applications.","pos":[1092,1263]},{"content":"Other security enhancements provided in the App-V client include the following:","pos":[1264,1343]},{"content":"By default, the OSD file cache can be updated only by administrators and by using the publishing refresh process.","pos":[1349,1462]},{"content":"The log file (sftlog.txt) is accessible only by accounts with local administrative access to the client.","pos":[1468,1572]},{"content":"The log file now has a maximum size.","pos":[1578,1614]},{"content":"File Type Associations","pos":[1620,1642]},{"content":"By default, the installation of the client registers file type associations (FTAs) for OSD files, which enables users to start applications directly from OSD files instead of the published shortcuts.","pos":[1644,1843]},{"content":"If a user with local administrator rights receives an OSD file containing malicious code, either in e-mail or downloaded from a Web site, the user can open the OSD file and start the application even if the client has been set to restrict the <bpt id=\"p1\">**</bpt>Add Application<ept id=\"p1\">**</ept> permission.","pos":[1844,2118]},{"content":"You can unregister the FTAs for the OSD to reduce this risk.","pos":[2119,2179]},{"content":"Also, consider blocking this extension in the e-mail system and at the firewall.","pos":[2180,2260]},{"content":"For more information about configuring Outlook to block extensions, see <bpt id=\"p1\">&lt;</bpt>http://go.microsoft.com/fwlink/?LinkId=133278<ept id=\"p1\">&gt;</ept>.","pos":[2261,2381]},{"content":"Security Note:","pos":[2385,2399]},{"content":"Starting with App-V version 4.6, the file type association is no longer created for OSD files during a new installation of the client, although the existing settings will be maintained during an upgrade from version 4.2 or 4.5 of the App-V client.","pos":[2405,2652]},{"content":"If for any reason it is essential to create the file type association, you can create the following registry keys and set their values as shown:","pos":[2653,2797]},{"content":"Authorization","pos":[3045,3058]},{"content":"During installation, you can use the <bpt id=\"p1\">**</bpt>RequireAuthorizationIfCached<ept id=\"p1\">**</ept> parameter to configure the client to require authorization from the server when the user tries to start an application.","pos":[3060,3249]},{"content":"You should consider carefully how to set this parameter.","pos":[3250,3306]},{"content":"If the App-V server is unavailable for any reason, the application will use the most recent stored state of this parameter to control user access to the application.","pos":[3307,3472]},{"content":"If the user has not launched the application successfully before the App-V server becomes unavailable, they will not be able to launch the application until they can communicate with the server and receive authorization.","pos":[3473,3693]},{"content":"However, if you set the parameter so that the client does not require authorization and if the server is unavailable, all previously cached applications can be started whether authorized or not.","pos":[3694,3888]},{"content":"Also, if the user has permission to change the client to Work Offline mode through permissions or if the user is a local administrator, the user would be able to open all cached packages as if the App-V infrastructure was unavailable.","pos":[3889,4123]},{"content":"Antivirus Scanning","pos":[4129,4147]},{"content":"Antivirus software running on an App-V Client computer can detect and report an infected file in the virtual environment.","pos":[4149,4270]},{"content":"However, it cannot disinfect the file.","pos":[4271,4309]},{"content":"If a virus is detected in the virtual environment, the antivirus software would perform the configured quarantine or repair operation in the cache, not in the actual package.","pos":[4310,4484]},{"content":"Configure the antivirus software with an exception for the sftfs.fsd file.","pos":[4485,4559]},{"content":"This file is the cache file that stores packages on the App-V Client.","pos":[4560,4629]},{"content":"Security Note:","pos":[4633,4647]},{"content":"If a virus is detected in an application or package deployed in the production environment, replace the application or package with a virus-free version.","pos":[4653,4806]},{"content":"Communication Between Client and Server","pos":[4811,4850]},{"content":"Publishing refreshes and package streaming are also areas where security considerations relating to client-server communication are important.","pos":[4853,4995]},{"content":"Publishing Refresh","pos":[5001,5019]},{"content":"When the client communicates with the server to perform a publishing refresh, it uses the credentials of the logged on user to request information about the application packages.","pos":[5021,5199]},{"content":"You should secure the communication that occurs between the App-V client and App-V Management Server to ensure that none of the publishing information can be tampered with in transit.","pos":[5200,5383]},{"content":"This is done by using the Enhanced Security option, which will use RTSPS/HTTPS.","pos":[5384,5463]},{"content":"Communication between the Client and the location where the ICO and OSD files are stored should use IPsec for SMB/CIFS shares and HTTPS for an IIS server.","pos":[5464,5618]},{"content":"Note","pos":[5622,5626]},{"content":"If you are using IIS to publish the ICO and OSD files, configure a MIME type for OSD=TXT; otherwise, IIS will refuse to serve the ICO and OSD files to clients.","pos":[5631,5790]},{"content":"Package Streaming","pos":[5799,5816]},{"content":"When a user launches an application for the first time, or if auto-loading parameters have been set on the client, the application package is streamed from a server to the client cache.","pos":[5818,6003]},{"content":"This process supports the RTSP/RTSPS, HTTP/HTTPS, and SMB/CIFS protocols.","pos":[6004,6077]},{"content":"The OSD files control which protocols are used, unless the <bpt id=\"p1\">**</bpt>ApplicationSourceRoot<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>OverrideURL<ept id=\"p2\">**</ept> setting has been configured on the clients.","pos":[6078,6225]},{"content":"You should configure communication to occur over RTSPS, HTTPS, or IPsec for SMB/CIFS to achieve higher levels of security.","pos":[6226,6348]},{"content":"For more information about choosing which communication method to use, see the App-V Planning and Deployment Guide at <bpt id=\"p1\">&lt;</bpt>http://go.microsoft.com/fwlink/?LinkId=122063<ept id=\"p1\">&gt;</ept>.","pos":[6349,6515]},{"content":"Note","pos":[6519,6523]},{"content":"If you are using IIS to publish packages (SFT files), configure a MIME type for SFT=Binary; otherwise, IIS will refuse to serve the SFT files to clients.","pos":[6528,6681]},{"content":"Roaming Profiles and Folder Redirection","pos":[6690,6729]},{"content":"The App-V system stores user-specific changes to packages in the usrvol<ph id=\"ph1\">\\_</ph>sftfs<ph id=\"ph2\">\\_</ph>v1.pkg file.","pos":[6731,6823]},{"content":"This file is located in the Application Data folder of a user’s profile.","pos":[6824,6896]},{"content":"Because the profile or a redirected Application Data folder is transferred between the client and the server, use IPsec to secure the communication.","pos":[6897,7045]},{"content":"Considerations for Internet-Facing Clients","pos":[7050,7092]},{"content":"For Internet-facing clients, it is important to consider whether the client is domain joined or non-domain joined.","pos":[7095,7209]},{"content":"Domain Joined Client","pos":[7215,7235]},{"content":"By default, App-V Clients use Kerberos tickets that were issued by Active Directory Domain Services for authentication and authorization on the intranet.","pos":[7237,7390]},{"content":"These Kerberos tickets are valid for 10 hours by default.","pos":[7391,7448]},{"content":"The client will use this ticket to access the App-V server for as long as the ticket is valid, even if the computer is unable to connect to the domain controller to refresh the ticket.","pos":[7449,7633]},{"content":"If the Kerberos ticket expires, the App-V client will revert to NTLM authentication and use the user’s cached credentials.","pos":[7634,7756]},{"content":"Non-Domain Joined Client","pos":[7762,7786]},{"content":"If a user is home-based and the computer is not joined to the company domain, App-V can still support delivering applications.","pos":[7788,7914]},{"content":"To authenticate and authorize a user to perform a publishing refresh and to start applications, configure the user account on the client computer to store the user name and password that has access to the App-V environment and to provide appropriate permissions to the applications.","pos":[7915,8197]},{"content":"Related topics","pos":[8202,8216]},{"content":"Planning for Security and Protection","pos":[8220,8256]}],"content":"---\ntitle: Planning for Client Security\ndescription: Planning for Client Security\nauthor: jamiejdt\nms.assetid: 4840a60f-4c91-489c-ad0b-6671882abf9b\nms.pagetype: mdop, appcompat, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w8\n---\n\n\n# Planning for Client Security\n\n\nThe App-V Client provides several security enhancements that were not present in previous versions of the product. These changes provide improved security after installation and through later configuration of the client settings. This topic describes some of those enhancements and identifies several important security-related configuration settings that you should consider during your planning process. It is important to remember that virtual applications are still executables, so you must ensure that these assets cannot be tampered with by unauthorized people. For this reason, the Open Software Descriptor (OSD) file cache is protected as described later in this topic, and we strongly recommend that you use RTSPS, HTTPS, and IPsec to protect publishing and streaming.\n\n## App-V Client Security\n\n\nBy default, at installation the App-V client is configured with the minimum permissions required to allow a user to perform a publishing refresh and to start applications. Other security enhancements provided in the App-V client include the following:\n\n-   By default, the OSD file cache can be updated only by administrators and by using the publishing refresh process.\n\n-   The log file (sftlog.txt) is accessible only by accounts with local administrative access to the client.\n\n-   The log file now has a maximum size.\n\n### File Type Associations\n\nBy default, the installation of the client registers file type associations (FTAs) for OSD files, which enables users to start applications directly from OSD files instead of the published shortcuts. If a user with local administrator rights receives an OSD file containing malicious code, either in e-mail or downloaded from a Web site, the user can open the OSD file and start the application even if the client has been set to restrict the **Add Application** permission. You can unregister the FTAs for the OSD to reduce this risk. Also, consider blocking this extension in the e-mail system and at the firewall. For more information about configuring Outlook to block extensions, see <http://go.microsoft.com/fwlink/?LinkId=133278>.\n\n**Security Note:  **\n\nStarting with App-V version 4.6, the file type association is no longer created for OSD files during a new installation of the client, although the existing settings will be maintained during an upgrade from version 4.2 or 4.5 of the App-V client. If for any reason it is essential to create the file type association, you can create the following registry keys and set their values as shown:\n\n    Create HKEY\\_CLASSES\\_ROOT\\\\.osd with a default value of SoftGrid.osd.File\n\n    Under HKEY\\_LOCAL\\_MACHINE\\\\software\\\\classes\\\\Softgrid.osd.file, create a string value named AppUserModelID with a data value of Microsoft.AppV.Client.Tray\n\n### Authorization\n\nDuring installation, you can use the **RequireAuthorizationIfCached** parameter to configure the client to require authorization from the server when the user tries to start an application. You should consider carefully how to set this parameter. If the App-V server is unavailable for any reason, the application will use the most recent stored state of this parameter to control user access to the application. If the user has not launched the application successfully before the App-V server becomes unavailable, they will not be able to launch the application until they can communicate with the server and receive authorization. However, if you set the parameter so that the client does not require authorization and if the server is unavailable, all previously cached applications can be started whether authorized or not. Also, if the user has permission to change the client to Work Offline mode through permissions or if the user is a local administrator, the user would be able to open all cached packages as if the App-V infrastructure was unavailable.\n\n### Antivirus Scanning\n\nAntivirus software running on an App-V Client computer can detect and report an infected file in the virtual environment. However, it cannot disinfect the file. If a virus is detected in the virtual environment, the antivirus software would perform the configured quarantine or repair operation in the cache, not in the actual package. Configure the antivirus software with an exception for the sftfs.fsd file. This file is the cache file that stores packages on the App-V Client.\n\n**Security Note:  **\n\nIf a virus is detected in an application or package deployed in the production environment, replace the application or package with a virus-free version.\n\n## Communication Between Client and Server\n\n\nPublishing refreshes and package streaming are also areas where security considerations relating to client-server communication are important.\n\n### Publishing Refresh\n\nWhen the client communicates with the server to perform a publishing refresh, it uses the credentials of the logged on user to request information about the application packages. You should secure the communication that occurs between the App-V client and App-V Management Server to ensure that none of the publishing information can be tampered with in transit. This is done by using the Enhanced Security option, which will use RTSPS/HTTPS. Communication between the Client and the location where the ICO and OSD files are stored should use IPsec for SMB/CIFS shares and HTTPS for an IIS server.\n\n**Note**  \nIf you are using IIS to publish the ICO and OSD files, configure a MIME type for OSD=TXT; otherwise, IIS will refuse to serve the ICO and OSD files to clients.\n\n \n\n### Package Streaming\n\nWhen a user launches an application for the first time, or if auto-loading parameters have been set on the client, the application package is streamed from a server to the client cache. This process supports the RTSP/RTSPS, HTTP/HTTPS, and SMB/CIFS protocols. The OSD files control which protocols are used, unless the **ApplicationSourceRoot** or **OverrideURL** setting has been configured on the clients. You should configure communication to occur over RTSPS, HTTPS, or IPsec for SMB/CIFS to achieve higher levels of security. For more information about choosing which communication method to use, see the App-V Planning and Deployment Guide at <http://go.microsoft.com/fwlink/?LinkId=122063>.\n\n**Note**  \nIf you are using IIS to publish packages (SFT files), configure a MIME type for SFT=Binary; otherwise, IIS will refuse to serve the SFT files to clients.\n\n \n\n### Roaming Profiles and Folder Redirection\n\nThe App-V system stores user-specific changes to packages in the usrvol\\_sftfs\\_v1.pkg file. This file is located in the Application Data folder of a user’s profile. Because the profile or a redirected Application Data folder is transferred between the client and the server, use IPsec to secure the communication.\n\n## Considerations for Internet-Facing Clients\n\n\nFor Internet-facing clients, it is important to consider whether the client is domain joined or non-domain joined.\n\n### Domain Joined Client\n\nBy default, App-V Clients use Kerberos tickets that were issued by Active Directory Domain Services for authentication and authorization on the intranet. These Kerberos tickets are valid for 10 hours by default. The client will use this ticket to access the App-V server for as long as the ticket is valid, even if the computer is unable to connect to the domain controller to refresh the ticket. If the Kerberos ticket expires, the App-V client will revert to NTLM authentication and use the user’s cached credentials.\n\n### Non-Domain Joined Client\n\nIf a user is home-based and the computer is not joined to the company domain, App-V can still support delivering applications. To authenticate and authorize a user to perform a publishing refresh and to start applications, configure the user account on the client computer to store the user name and password that has access to the App-V environment and to provide appropriate permissions to the applications.\n\n## Related topics\n\n\n[Planning for Security and Protection](planning-for-security-and-protection.md)\n\n \n\n \n\n\n\n\n\n"}