{"nodes":[{"content":"Configuring Advanced Settings by Using Windows PowerShell","pos":[11,68]},{"content":"Configuring Advanced Settings by Using Windows PowerShell","pos":[82,139]},{"content":"Configuring Advanced Settings by Using Windows PowerShell","pos":[302,359]},{"content":"The MED-V workspace package that you create includes a Windows PowerShell script (.ps1) file that you can edit before you test and deploy your MED-V workspace package.","pos":[362,529]},{"content":"This section provides information and guidance to help you manage MED-V configuration settings by using Windows PowerShell before you deploy the MED-V workspaces.","pos":[530,692]},{"content":"Using Windows PowerShell Cmdlets in MED-V","pos":[697,738]},{"content":"The following Windows PowerShell cmdlets are available in Microsoft Enterprise Desktop Virtualization (MED-V) 2.0:","pos":[741,855]},{"content":"New-MedvConfiguration","pos":[859,880]},{"content":"Export-MedvConfiguration","pos":[886,910]},{"content":"New-MedvWorkspace","pos":[916,933]},{"content":"Export-MedvWorkspace","pos":[939,959]},{"content":"To access Windows PowerShell cmdlets for MED-V, open Windows PowerShell and type the following command to import the MED-V modules.","pos":[963,1094]},{"content":"After the modules are imported, you can access inline help for the cmdlets by using the standard Windows PowerShell Help commands, <bpt id=\"p1\">**</bpt>man<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>get-help<ept id=\"p2\">**</ept>.","pos":[1141,1296]},{"content":"For example, to access a description of the <bpt id=\"p1\">**</bpt>New-MedvConfiguration<ept id=\"p1\">**</ept> cmdlet including a complete list of available parameters, type the following command.","pos":[1297,1452]},{"content":"You can also view help for specific parameters.","pos":[1501,1548]},{"content":"For example, to view help for the parameter VmMemory, type the following:","pos":[1549,1622]},{"content":"To view a list of all MED-V configuration settings and their defaults, type the following command.","pos":[1691,1789]},{"content":"To view a list of all MED-V configuration settings and their current values, type the following command.","pos":[1844,1948]},{"content":"Creating a MED-V Workspace with Custom Settings","pos":[2024,2071]},{"content":"After you successfully create a MED-V workspace package by using the MED-V Workspace Packager, a Windows PowerShell script is generated in the folder you specified for saving your packager files.","pos":[2074,2269]},{"content":"The contents of this script show some of the available MED-V configuration settings that you can edit.","pos":[2270,2372]},{"content":"Following these steps, you can customize the script and then run it in Windows PowerShell to create a MED-V workspace with the new settings.","pos":[2374,2514]},{"content":"Important","pos":[2518,2527]},{"content":"Run Windows PowerShell with administrative credentials, and ensure that the Windows PowerShell execution policy allows the running of scripts.","pos":[2532,2674]},{"content":"Edit the Windows PowerShell script that was generated by the MED-V Workspace Packager, or author a new script with the configuration settings that you want.","pos":[2680,2836]},{"content":"Run Windows PowerShell with administrative credentials and at the command prompt, type the following command.","pos":[2842,2951]},{"content":"This command runs the Windows PowerShell script and runs the <bpt id=\"p1\">**</bpt>New-MedvWorkspace<ept id=\"p1\">**</ept> cmdlet to generate a new MED-V workspace package.","pos":[3011,3143]},{"content":"The new packager files are saved in the folder that you originally specified for storing your MED-V Workspace Packager files.","pos":[3144,3269]},{"content":"For additional help about this cmdlet, see the Windows PowerShell Help.","pos":[3270,3341]},{"content":"Exporting a MED-V Configuration to a Registry File","pos":[3349,3399]},{"content":"You can update MED-V configuration settings after the MED-V workspace is installed.","pos":[3402,3485]},{"content":"Use the <bpt id=\"p1\">**</bpt>New-MedvConfiguration<ept id=\"p1\">**</ept> cmdlet to specify the parameters that you want to change.","pos":[3486,3577]},{"content":"For example, to create a registry file that changes the virtual machine memory setting, type the following commands.","pos":[3578,3694]},{"content":"You can import the resultant registry file from the host computer to a MED-V workspace to apply the new configuration settings.","pos":[3817,3944]},{"content":"Related topics","pos":[3949,3963]},{"content":"Managing MED-V Workspace Configuration Settings","pos":[3967,4014]},{"content":"Test And Deploy the MED-V Workspace Package","pos":[4070,4113]}],"content":"---\ntitle: Configuring Advanced Settings by Using Windows PowerShell\ndescription: Configuring Advanced Settings by Using Windows PowerShell\nauthor: jamiejdt\nms.assetid: 437a31cc-2a11-456f-b448-b0b869fb53f7\nms.pagetype: mdop, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w7\n---\n\n\n# Configuring Advanced Settings by Using Windows PowerShell\n\n\nThe MED-V workspace package that you create includes a Windows PowerShell script (.ps1) file that you can edit before you test and deploy your MED-V workspace package. This section provides information and guidance to help you manage MED-V configuration settings by using Windows PowerShell before you deploy the MED-V workspaces.\n\n## Using Windows PowerShell Cmdlets in MED-V\n\n\nThe following Windows PowerShell cmdlets are available in Microsoft Enterprise Desktop Virtualization (MED-V) 2.0:\n\n**New-MedvConfiguration**\n\n**Export-MedvConfiguration**\n\n**New-MedvWorkspace**\n\n**Export-MedvWorkspace**\n\nTo access Windows PowerShell cmdlets for MED-V, open Windows PowerShell and type the following command to import the MED-V modules.\n\n``` syntax\nImport-Module microsoft.medv\n```\n\nAfter the modules are imported, you can access inline help for the cmdlets by using the standard Windows PowerShell Help commands, **man** or **get-help**. For example, to access a description of the **New-MedvConfiguration** cmdlet including a complete list of available parameters, type the following command.\n\n``` syntax\nget-help New-MedvConfiguration\n```\n\nYou can also view help for specific parameters. For example, to view help for the parameter VmMemory, type the following:\n\n``` syntax\nget-help New-MedvConfiguration -parameter VmMemory\n```\n\nTo view a list of all MED-V configuration settings and their defaults, type the following command.\n\n``` syntax\nNew-MedvConfiguration -ForceDefaults\n```\n\nTo view a list of all MED-V configuration settings and their current values, type the following command.\n\n``` syntax\ngwmi -Class \"Setting” -Namespace \"root/microsoft/medv”\n```\n\n## Creating a MED-V Workspace with Custom Settings\n\n\nAfter you successfully create a MED-V workspace package by using the MED-V Workspace Packager, a Windows PowerShell script is generated in the folder you specified for saving your packager files. The contents of this script show some of the available MED-V configuration settings that you can edit.\n\nFollowing these steps, you can customize the script and then run it in Windows PowerShell to create a MED-V workspace with the new settings.\n\n**Important**  \nRun Windows PowerShell with administrative credentials, and ensure that the Windows PowerShell execution policy allows the running of scripts.\n\n1.  Edit the Windows PowerShell script that was generated by the MED-V Workspace Packager, or author a new script with the configuration settings that you want.\n\n2.  Run Windows PowerShell with administrative credentials and at the command prompt, type the following command.\n\n    ``` syntax\n    & “.\\<workspacename>.ps1”\n    ```\n\n    This command runs the Windows PowerShell script and runs the **New-MedvWorkspace** cmdlet to generate a new MED-V workspace package. The new packager files are saved in the folder that you originally specified for storing your MED-V Workspace Packager files. For additional help about this cmdlet, see the Windows PowerShell Help.\n\n \n\n## Exporting a MED-V Configuration to a Registry File\n\n\nYou can update MED-V configuration settings after the MED-V workspace is installed. Use the **New-MedvConfiguration** cmdlet to specify the parameters that you want to change. For example, to create a registry file that changes the virtual machine memory setting, type the following commands.\n\n``` syntax\nNew-MedvConfiguration  -VmMemory 1024 | Export-MedvConfiguration -Path c:\\medvConfiguration\\myConfig.reg\n```\n\nYou can import the resultant registry file from the host computer to a MED-V workspace to apply the new configuration settings.\n\n## Related topics\n\n\n[Managing MED-V Workspace Configuration Settings](managing-med-v-workspace-configuration-settings.md)\n\n[Test And Deploy the MED-V Workspace Package](test-and-deploy-the-med-v-workspace-package.md)\n\n \n\n \n\n\n\n\n\n"}