{"nodes":[{"content":"How to Manage App-V 5.1 Packages Running on a Stand-Alone Computer by Using PowerShell","pos":[11,97]},{"content":"How to Manage App-V 5.1 Packages Running on a Stand-Alone Computer by Using PowerShell","pos":[111,197]},{"content":"How to Manage App-V 5.1 Packages Running on a Stand-Alone Computer by Using PowerShell","pos":[372,458]},{"content":"The following sections explain how to perform various management tasks on a stand-alone client computer by using PowerShell:","pos":[461,585]},{"content":"To return a list of packages","pos":[592,620]},{"content":"To add a package","pos":[663,679]},{"content":"To publish a package","pos":[719,739]},{"content":"To publish a package to a specific user","pos":[778,817]},{"content":"To add and publish a package","pos":[863,891]},{"content":"To unpublish an existing package","pos":[934,966]},{"content":"To unpublish a package for a specific user","pos":[1007,1049]},{"content":"To remove an existing package","pos":[1085,1114]},{"content":"To enable only administrators to publish or unpublish packages","pos":[1156,1218]},{"content":"Understanding pending packages (UserPending and GlobalPending)","pos":[1249,1311]},{"pos":[1396,1424],"content":"To return a list of packages"},{"content":"Use the following information to return a list of packages that are entitled to a specific user:","pos":[1427,1523]},{"pos":[1525,1558],"content":"<bpt id=\"p1\">**</bpt>Cmdlet<ept id=\"p1\">**</ept>: Get-AppvClientPackage"},{"pos":[1560,1612],"content":"<bpt id=\"p1\">**</bpt>Parameters<ept id=\"p1\">**</ept>: -Name -Version -PackageID -VersionID"},{"pos":[1614,1686],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>: Get-AppvClientPackage –Name “ContosoApplication” -Version 2"},{"pos":[1741,1757],"content":"To add a package"},{"content":"Use the following information to add a package to a computer.","pos":[1760,1821]},{"content":"Important","pos":[1825,1834]},{"content":"This example only adds a package.","pos":[1839,1872]},{"content":"It does not publish the package to the user or the computer.","pos":[1873,1933]},{"pos":[1938,1971],"content":"<bpt id=\"p1\">**</bpt>Cmdlet<ept id=\"p1\">**</ept>: Add-AppvClientPackage"},{"pos":[1973,2051],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>: $Contoso = Add-AppvClientPackage <ph id=\"ph1\">\\\\\\\\</ph>path<ph id=\"ph2\">\\\\</ph>to<ph id=\"ph3\">\\\\</ph>appv<ph id=\"ph4\">\\\\</ph>package.appv"},{"pos":[2105,2125],"content":"To publish a package"},{"content":"Use the following information to publish a package that has been added to a specific user or globally to any user on the computer.","pos":[2128,2258]},{"content":"Publishing method","pos":[2376,2393]},{"content":"Cmdlet and example","pos":[2416,2434]},{"content":"Publishing to the user","pos":[2500,2522]},{"content":"Cmdlet<ph id=\"ph1\">&lt;/strong&gt;</ph>: Publish-AppvClientPackage","pos":[2560,2602]},{"content":"Example<ph id=\"ph1\">&lt;/strong&gt;</ph>: Publish-AppvClientPackage “ContosoApplication”","pos":[2618,2682]},{"content":"Publishing globally","pos":[2736,2755]},{"content":"Cmdlet<ph id=\"ph1\">&lt;/strong&gt;</ph>: Publish-AppvClientPackage","pos":[2793,2835]},{"content":"Example<ph id=\"ph1\">&lt;/strong&gt;</ph>: Publish-AppvClientPackage “ContosoApplication” -Global","pos":[2851,2923]},{"pos":[3020,3059],"content":"To publish a package to a specific user"},{"content":"Note","pos":[3064,3068]},{"content":"You must use App-V 5.0 SP2 Hotfix Package 5 or later to use this parameter.","pos":[3073,3148]},{"pos":[3153,3379],"content":"An administrator can publish a package to a specific user by specifying the optional <bpt id=\"p1\">**</bpt>–UserSID<ept id=\"p1\">**</ept> parameter with the <bpt id=\"p2\">**</bpt>Publish-AppvClientPackage<ept id=\"p2\">**</ept> cmdlet, where <bpt id=\"p3\">**</bpt>-UserSID<ept id=\"p3\">**</ept> represents the end user’s security identifier (SID)."},{"content":"To use this parameter:","pos":[3381,3403]},{"content":"You can run this cmdlet from the user or administrator session.","pos":[3409,3472]},{"content":"You must be logged in with administrative credentials to use the parameter.","pos":[3478,3553]},{"content":"The end user must be logged in.","pos":[3559,3590]},{"content":"You must provide the end user’s security identifier (SID).","pos":[3596,3654]},{"pos":[3656,3693],"content":"<bpt id=\"p1\">**</bpt>Cmdlet<ept id=\"p1\">**</ept>: Publish-AppvClientPackage"},{"pos":[3695,3807],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>: Publish-AppvClientPackage “ContosoApplication” -UserSID S-1-2-34-56789012-3456789012-345678901-2345"},{"pos":[3865,3893],"content":"To add and publish a package"},{"content":"Use the following information to add a package to a computer and publish it to the user.","pos":[3896,3984]},{"pos":[3986,4019],"content":"<bpt id=\"p1\">**</bpt>Cmdlet<ept id=\"p1\">**</ept>: Add-AppvClientPackage"},{"pos":[4021,4116],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>: Add-AppvClientPackage <ph id=\"ph1\">\\\\\\\\</ph>path<ph id=\"ph2\">\\\\</ph>to<ph id=\"ph3\">\\\\</ph>appv<ph id=\"ph4\">\\\\</ph>package.appv | Publish-AppvClientPackage"},{"pos":[4172,4204],"content":"To unpublish an existing package"},{"content":"Use the following information to unpublish a package which has been entitled to a user but not remove the package from the computer.","pos":[4207,4339]},{"pos":[4341,4380],"content":"<bpt id=\"p1\">**</bpt>Cmdlet<ept id=\"p1\">**</ept>: Unpublish-AppvClientPackage"},{"pos":[4382,4443],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>: Unpublish-AppvClientPackage “ContosoApplication”"},{"pos":[4494,4536],"content":"To unpublish a package for a specific user"},{"content":"Note","pos":[4541,4545]},{"content":"You must use App-V 5.0 SP2 Hotfix Package 5 or later to use this parameter.","pos":[4550,4625]},{"pos":[4630,4856],"content":"An administrator can unpublish a package for a specific user by using the optional <bpt id=\"p1\">**</bpt>–UserSID<ept id=\"p1\">**</ept> parameter with the <bpt id=\"p2\">**</bpt>Unpublish-AppvClientPackage<ept id=\"p2\">**</ept> cmdlet, where <bpt id=\"p3\">**</bpt>-UserSID<ept id=\"p3\">**</ept> represents the end user’s security identifier (SID)."},{"content":"To use this parameter:","pos":[4858,4880]},{"content":"You can run this cmdlet from the user or administrator session.","pos":[4886,4949]},{"content":"You must be logged in with administrative credentials to use the parameter.","pos":[4955,5030]},{"content":"The end user must be logged in.","pos":[5036,5067]},{"content":"You must provide the end user’s security identifier (SID).","pos":[5073,5131]},{"pos":[5133,5172],"content":"<bpt id=\"p1\">**</bpt>Cmdlet<ept id=\"p1\">**</ept>: Unpublish-AppvClientPackage"},{"pos":[5174,5288],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>: Unpublish-AppvClientPackage “ContosoApplication” -UserSID S-1-2-34-56789012-3456789012-345678901-2345"},{"pos":[5345,5374],"content":"To remove an existing package"},{"content":"Use the following information to remove a package from the computer.","pos":[5377,5445]},{"pos":[5447,5483],"content":"<bpt id=\"p1\">**</bpt>Cmdlet<ept id=\"p1\">**</ept>: Remove-AppvClientPackage"},{"pos":[5485,5543],"content":"<bpt id=\"p1\">**</bpt>Example<ept id=\"p1\">**</ept>: Remove-AppvClientPackage “ContosoApplication”"},{"content":"Note","pos":[5547,5551]},{"content":"App-V cmdlets have been assigned to variables for the previous examples for clarity only; assignment is not a requirement.","pos":[5556,5678]},{"content":"Most cmdlets can be combined as displayed in <bpt id=\"p1\">[</bpt>To add and publish a package<ept id=\"p1\">](#bkmk-add-pub-pkg-standalone-posh)</ept>.","pos":[5679,5790]},{"content":"For a detailed tutorial, see <bpt id=\"p1\">[</bpt>App-V 5.0 Client PowerShell Deep Dive<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=324466)</ept>.","pos":[5791,5907]},{"pos":[5956,6018],"content":"To enable only administrators to publish or unpublish packages"},{"content":"Note","pos":[6023,6027]},{"content":"This feature is supported starting in App-V 5.0 SP3.","pos":[6034,6086]},{"content":"Use the following cmdlet and parameter to enable only administrators (not end users) to publish or unpublish packages:","pos":[6093,6211]},{"content":"Cmdlet","pos":[6337,6343]},{"content":"Set-AppvClientConfiguration","pos":[6382,6409]},{"content":"Parameter","pos":[6471,6480]},{"content":"-RequirePublishAsAdmin","pos":[6519,6541]},{"content":"Parameter values:","pos":[6549,6566]},{"content":"0 - False","pos":[6583,6592]},{"content":"1 - True","pos":[6609,6617]},{"content":"Example:<ph id=\"ph1\">&lt;/strong&gt;</ph>: Set-AppvClientConfiguration –RequirePublishAsAdmin1","pos":[6644,6714]},{"pos":[6752,6942],"content":"To use the App-V Management console to set this configuration, see <bpt id=\"p1\">[</bpt>How to Publish a Package by Using the Management Console<ept id=\"p1\">](how-to-publish-a-package-by-using-the-management-console-51.md)</ept>."},{"pos":[6991,7053],"content":"Understanding pending packages (UserPending and GlobalPending)"},{"content":"<bpt id=\"p1\">**</bpt>Starting in App-V 5.0 SP2<ept id=\"p1\">**</ept>: If you run a PowerShell cmdlet that affects a package that is currently in use, the task that you are trying to perform is placed in a pending state.","pos":[7056,7236]},{"content":"For example, if you try to publish a package when an application in that package is being used, and then run <bpt id=\"p1\">**</bpt>Get-AppvClientPackage<ept id=\"p1\">**</ept>, the pending status appears in the cmdlet output as follows:","pos":[7237,7432]},{"content":"Cmdlet output item","pos":[7550,7568]},{"content":"Description","pos":[7591,7602]},{"content":"UserPending","pos":[7668,7679]},{"content":"Indicates whether the listed package has a pending task that is being applied to the user:","pos":[7709,7799]},{"content":"True","pos":[7816,7820]},{"content":"False","pos":[7837,7842]},{"content":"GlobalPending","pos":[7907,7920]},{"content":"Indicates whether the listed package has a pending task that is being applied globally to the computer:","pos":[7950,8053]},{"content":"True","pos":[8070,8074]},{"content":"False","pos":[8091,8096]},{"content":"The pending task will run later, according to the following rules:","pos":[8145,8211]},{"content":"Task type","pos":[8329,8338]},{"content":"Applicable rule","pos":[8361,8376]},{"content":"User-based task, e.g., publishing a package to a user","pos":[8442,8495]},{"content":"The pending task will be performed after the user logs off and then logs back on.","pos":[8525,8606]},{"content":"Globally based task, e.g., enabling a connection group globally","pos":[8660,8723]},{"content":"The pending task will be performed when the computer is shut down and then restarted.","pos":[8753,8838]},{"pos":[8876,8993],"content":"For more information about pending tasks, see <bpt id=\"p1\">[</bpt>About App-V 5.0 SP2<ept id=\"p1\">](about-app-v-50-sp2.md#bkmk-pkg-upgr-pendg-tasks)</ept>."},{"content":"<bpt id=\"p1\">**</bpt>Got a suggestion for App-V<ept id=\"p1\">**</ept>?","pos":[8995,9026]},{"content":"Add or vote on suggestions <bpt id=\"p1\">[</bpt>here<ept id=\"p1\">](http://appv.uservoice.com/forums/280448-microsoft-application-virtualization)</ept>.","pos":[9027,9139]},{"content":"Got an App-V issue?","pos":[9142,9161]},{"content":"Use the <bpt id=\"p1\">[</bpt>App-V TechNet Forum<ept id=\"p1\">](https://social.technet.microsoft.com/Forums/home?forum=mdopappv)</ept>.","pos":[9164,9259]},{"content":"Related topics","pos":[9264,9278]},{"content":"Operations for App-V 5.1","pos":[9282,9306]},{"content":"Administering App-V 5.1 by Using PowerShell","pos":[9338,9381]}],"content":"---\ntitle: How to Manage App-V 5.1 Packages Running on a Stand-Alone Computer by Using PowerShell\ndescription: How to Manage App-V 5.1 Packages Running on a Stand-Alone Computer by Using PowerShell\nauthor: jamiejdt\nms.assetid: c3fd06f6-102f-43d1-a577-d5ced6ac537d\nms.pagetype: mdop, appcompat, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w10\n---\n\n\n# How to Manage App-V 5.1 Packages Running on a Stand-Alone Computer by Using PowerShell\n\n\nThe following sections explain how to perform various management tasks on a stand-alone client computer by using PowerShell:\n\n-   [To return a list of packages](#bkmk-return-pkgs-standalone-posh)\n\n-   [To add a package](#bkmk-add-pkgs-standalone-posh)\n\n-   [To publish a package](#bkmk-pub-pkg-standalone-posh)\n\n-   [To publish a package to a specific user](#bkmk-pub-pkg-a-user-standalone-posh)\n\n-   [To add and publish a package](#bkmk-add-pub-pkg-standalone-posh)\n\n-   [To unpublish an existing package](#bkmk-unpub-pkg-standalone-posh)\n\n-   [To unpublish a package for a specific user](#bkmk-unpub-pkg-specfc-use)\n\n-   [To remove an existing package](#bkmk-remove-pkg-standalone-posh)\n\n-   [To enable only administrators to publish or unpublish packages](#bkmk-admins-pub-pkgs)\n\n-   [Understanding pending packages (UserPending and GlobalPending)](#bkmk-understd-pend-pkgs)\n\n## <a href=\"\" id=\"bkmk-return-pkgs-standalone-posh\"></a>To return a list of packages\n\n\nUse the following information to return a list of packages that are entitled to a specific user:\n\n**Cmdlet**: Get-AppvClientPackage\n\n**Parameters**: -Name -Version -PackageID -VersionID\n\n**Example**: Get-AppvClientPackage –Name “ContosoApplication” -Version 2\n\n## <a href=\"\" id=\"bkmk-add-pkgs-standalone-posh\"></a>To add a package\n\n\nUse the following information to add a package to a computer.\n\n**Important**  \nThis example only adds a package. It does not publish the package to the user or the computer.\n\n \n\n**Cmdlet**: Add-AppvClientPackage\n\n**Example**: $Contoso = Add-AppvClientPackage \\\\\\\\path\\\\to\\\\appv\\\\package.appv\n\n## <a href=\"\" id=\"bkmk-pub-pkg-standalone-posh\"></a>To publish a package\n\n\nUse the following information to publish a package that has been added to a specific user or globally to any user on the computer.\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Publishing method</th>\n<th align=\"left\">Cmdlet and example</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Publishing to the user</p></td>\n<td align=\"left\"><p><strong>Cmdlet</strong>: Publish-AppvClientPackage</p>\n<p><strong>Example</strong>: Publish-AppvClientPackage “ContosoApplication”</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Publishing globally</p></td>\n<td align=\"left\"><p><strong>Cmdlet</strong>: Publish-AppvClientPackage</p>\n<p><strong>Example</strong>: Publish-AppvClientPackage “ContosoApplication” -Global</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n## <a href=\"\" id=\"bkmk-pub-pkg-a-user-standalone-posh\"></a>To publish a package to a specific user\n\n\n**Note**  \nYou must use App-V 5.0 SP2 Hotfix Package 5 or later to use this parameter.\n\n \n\nAn administrator can publish a package to a specific user by specifying the optional **–UserSID** parameter with the **Publish-AppvClientPackage** cmdlet, where **-UserSID** represents the end user’s security identifier (SID).\n\nTo use this parameter:\n\n-   You can run this cmdlet from the user or administrator session.\n\n-   You must be logged in with administrative credentials to use the parameter.\n\n-   The end user must be logged in.\n\n-   You must provide the end user’s security identifier (SID).\n\n**Cmdlet**: Publish-AppvClientPackage\n\n**Example**: Publish-AppvClientPackage “ContosoApplication” -UserSID S-1-2-34-56789012-3456789012-345678901-2345\n\n## <a href=\"\" id=\"bkmk-add-pub-pkg-standalone-posh\"></a>To add and publish a package\n\n\nUse the following information to add a package to a computer and publish it to the user.\n\n**Cmdlet**: Add-AppvClientPackage\n\n**Example**: Add-AppvClientPackage \\\\\\\\path\\\\to\\\\appv\\\\package.appv | Publish-AppvClientPackage\n\n## <a href=\"\" id=\"bkmk-unpub-pkg-standalone-posh\"></a>To unpublish an existing package\n\n\nUse the following information to unpublish a package which has been entitled to a user but not remove the package from the computer.\n\n**Cmdlet**: Unpublish-AppvClientPackage\n\n**Example**: Unpublish-AppvClientPackage “ContosoApplication”\n\n## <a href=\"\" id=\"bkmk-unpub-pkg-specfc-use\"></a>To unpublish a package for a specific user\n\n\n**Note**  \nYou must use App-V 5.0 SP2 Hotfix Package 5 or later to use this parameter.\n\n \n\nAn administrator can unpublish a package for a specific user by using the optional **–UserSID** parameter with the **Unpublish-AppvClientPackage** cmdlet, where **-UserSID** represents the end user’s security identifier (SID).\n\nTo use this parameter:\n\n-   You can run this cmdlet from the user or administrator session.\n\n-   You must be logged in with administrative credentials to use the parameter.\n\n-   The end user must be logged in.\n\n-   You must provide the end user’s security identifier (SID).\n\n**Cmdlet**: Unpublish-AppvClientPackage\n\n**Example**: Unpublish-AppvClientPackage “ContosoApplication” -UserSID S-1-2-34-56789012-3456789012-345678901-2345\n\n## <a href=\"\" id=\"bkmk-remove-pkg-standalone-posh\"></a>To remove an existing package\n\n\nUse the following information to remove a package from the computer.\n\n**Cmdlet**: Remove-AppvClientPackage\n\n**Example**: Remove-AppvClientPackage “ContosoApplication”\n\n**Note**  \nApp-V cmdlets have been assigned to variables for the previous examples for clarity only; assignment is not a requirement. Most cmdlets can be combined as displayed in [To add and publish a package](#bkmk-add-pub-pkg-standalone-posh). For a detailed tutorial, see [App-V 5.0 Client PowerShell Deep Dive](http://go.microsoft.com/fwlink/?LinkId=324466).\n\n \n\n## <a href=\"\" id=\"bkmk-admins-pub-pkgs\"></a>To enable only administrators to publish or unpublish packages\n\n\n**Note**  \n**This feature is supported starting in App-V 5.0 SP3.**\n\n \n\nUse the following cmdlet and parameter to enable only administrators (not end users) to publish or unpublish packages:\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><strong>Cmdlet</strong></p></td>\n<td align=\"left\"><p>Set-AppvClientConfiguration</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><strong>Parameter</strong></p></td>\n<td align=\"left\"><p>-RequirePublishAsAdmin</p>\n<p>Parameter values:</p>\n<ul>\n<li><p>0 - False</p></li>\n<li><p>1 - True</p></li>\n</ul>\n<p><strong>Example:</strong>: Set-AppvClientConfiguration –RequirePublishAsAdmin1</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\nTo use the App-V Management console to set this configuration, see [How to Publish a Package by Using the Management Console](how-to-publish-a-package-by-using-the-management-console-51.md).\n\n## <a href=\"\" id=\"bkmk-understd-pend-pkgs\"></a>Understanding pending packages (UserPending and GlobalPending)\n\n\n**Starting in App-V 5.0 SP2**: If you run a PowerShell cmdlet that affects a package that is currently in use, the task that you are trying to perform is placed in a pending state. For example, if you try to publish a package when an application in that package is being used, and then run **Get-AppvClientPackage**, the pending status appears in the cmdlet output as follows:\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Cmdlet output item</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>UserPending</p></td>\n<td align=\"left\"><p>Indicates whether the listed package has a pending task that is being applied to the user:</p>\n<ul>\n<li><p>True</p></li>\n<li><p>False</p></li>\n</ul></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>GlobalPending</p></td>\n<td align=\"left\"><p>Indicates whether the listed package has a pending task that is being applied globally to the computer:</p>\n<ul>\n<li><p>True</p></li>\n<li><p>False</p></li>\n</ul></td>\n</tr>\n</tbody>\n</table>\n\n \n\nThe pending task will run later, according to the following rules:\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Task type</th>\n<th align=\"left\">Applicable rule</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>User-based task, e.g., publishing a package to a user</p></td>\n<td align=\"left\"><p>The pending task will be performed after the user logs off and then logs back on.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Globally based task, e.g., enabling a connection group globally</p></td>\n<td align=\"left\"><p>The pending task will be performed when the computer is shut down and then restarted.</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\nFor more information about pending tasks, see [About App-V 5.0 SP2](about-app-v-50-sp2.md#bkmk-pkg-upgr-pendg-tasks).\n\n**Got a suggestion for App-V**? Add or vote on suggestions [here](http://appv.uservoice.com/forums/280448-microsoft-application-virtualization). **Got an App-V issue?** Use the [App-V TechNet Forum](https://social.technet.microsoft.com/Forums/home?forum=mdopappv).\n\n## Related topics\n\n\n[Operations for App-V 5.1](operations-for-app-v-51.md)\n\n[Administering App-V 5.1 by Using PowerShell](administering-app-v-51-by-using-powershell.md)\n\n \n\n \n\n\n\n\n\n"}