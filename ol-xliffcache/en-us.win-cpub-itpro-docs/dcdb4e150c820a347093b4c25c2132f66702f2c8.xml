{"nodes":[{"content":"Select the types of rules to create (Windows 10)","pos":[11,59]},{"content":"This topic lists resources you can use when selecting your application control policy rules by using AppLocker.","pos":[73,184]},{"content":"Select the types of rules to create","pos":[340,375]},{"content":"Applies to","pos":[379,389]},{"content":"Windows 10","pos":[396,406]},{"content":"This topic lists resources you can use when selecting your application control policy rules by using AppLocker.","pos":[408,519]},{"content":"When determining what types of rules to create for each of your groups, you should also determine what enforcement setting to use for each group.","pos":[521,666]},{"content":"Different rule types are more applicable for some apps, depending on the way that the applications are deployed in a specific business group.","pos":[667,808]},{"content":"The following topics provide additional information about AppLocker rules that can help you decide what rules to use for your applications:","pos":[810,949]},{"content":"Understanding AppLocker rule behavior","pos":[956,993]},{"content":"Understanding AppLocker rule exceptions","pos":[1042,1081]},{"content":"Understanding AppLocker rule collections","pos":[1132,1172]},{"content":"Understanding AppLocker allow and deny actions on rules","pos":[1224,1279]},{"content":"Understanding AppLocker rule condition types","pos":[1346,1390]},{"content":"Understanding AppLocker default rules","pos":[1446,1483]},{"content":"Select the rule collection","pos":[1532,1558]},{"content":"The rules you create will be in one of the following rule collections:","pos":[1560,1630]},{"content":"Executable files: .exe and .com","pos":[1636,1667]},{"content":"Windows Installer files: .msi, .msp, and .mst","pos":[1672,1717]},{"content":"Scripts: .ps1, .bat, .cmd, .vbs, and .js","pos":[1722,1762]},{"content":"Packaged apps and packaged app installers: .appx","pos":[1767,1815]},{"content":"DLLs: .dll and .ocx","pos":[1820,1839]},{"content":"By default, the rules will allow a file to run based upon user or group privilege.","pos":[1841,1923]},{"content":"If you use DLL rules, a DLL allow rule has to be created for each DLL that is used by all of the allowed apps.","pos":[1924,2034]},{"content":"The DLL rule collection is not enabled by default.","pos":[2035,2085]},{"content":"In the Woodgrove Bank example, the line-of-business app for the Bank Tellers business group is C:<ph id=\"ph1\">\\\\</ph>Program Files<ph id=\"ph2\">\\\\</ph>Woodgrove<ph id=\"ph3\">\\\\</ph>Teller.exe, and this app needs to be included in a rule.","pos":[2087,2268]},{"content":"In addition, because this rule is part of a list of allowed applications, all the Windows files under C:<ph id=\"ph1\">\\\\</ph>Windows must be included as well.","pos":[2269,2408]},{"content":"Determine the rule condition","pos":[2414,2442]},{"content":"A rule condition is criteria upon which an AppLocker rule is based and can only be one of the rule conditions in the following table.","pos":[2444,2577]},{"content":"Rule condition","pos":[2581,2595]},{"content":"Usage scenario","pos":[2598,2612]},{"content":"Resources","pos":[2615,2624]},{"content":"Publisher","pos":[2643,2652]},{"content":"To use a publisher condition, the files must be digitally signed by the software publisher, or you must do so by using an internal certificate.","pos":[2655,2798]},{"content":"Rules that are specified to the version level might have to be updated when a new version of the file is released.","pos":[2799,2913]},{"pos":[2914,3077],"content":"For more info about this rule condition, see <bpt id=\"p1\">[</bpt>Understanding the publisher rule condition in AppLocker<ept id=\"p1\">](understanding-the-publisher-rule-condition-in-applocker.md)</ept>."},{"content":"Path","pos":[3080,3084]},{"content":"Any file can be assigned this rule condition; however, because path rules specify locations within the file system, any subdirectory will also be affected by the rule (unless explicitly exempted).","pos":[3086,3282]},{"pos":[3284,3437],"content":"For more info about this rule condition, see <bpt id=\"p1\">[</bpt>Understanding the path rule condition in AppLocker<ept id=\"p1\">](understanding-the-path-rule-condition-in-applocker.md)</ept>."},{"content":"File hash","pos":[3442,3451]},{"content":"Any file can be assigned this rule condition; however, the rule must be updated each time a new version of the file is released because the hash value is based in part upon the version.","pos":[3454,3639]},{"pos":[3641,3804],"content":"For more info about this rule condition, see <bpt id=\"p1\">[</bpt>Understanding the file hash rule condition in AppLocker<ept id=\"p1\">](understanding-the-file-hash-rule-condition-in-applocker.md)</ept>."},{"content":"In the Woodgrove Bank example, the line-of-business app for the Bank Tellers business group is signed and is located at C:<ph id=\"ph1\">\\\\</ph>Program Files<ph id=\"ph2\">\\\\</ph>Woodgrove<ph id=\"ph3\">\\\\</ph>Teller.exe.","pos":[3809,3970]},{"content":"Therefore, the rule can be defined with a publisher condition.","pos":[3971,4033]},{"content":"If the rule is defined to a specific version and above (for example, Teller.exe version 8.0 and above), then this will allow any updates to this app to occur without interruption of access to the users if the app's name and signed attributes stay the same.","pos":[4034,4290]},{"content":"Determine how to allow system files to run","pos":[4296,4338]},{"content":"Because AppLocker rules build a list of allowed apps, a rule or rules must be created to allow all Windows files to run.","pos":[4340,4460]},{"content":"AppLocker provides a means to ensure system files are properly considered in your rule collection by generating the default rules for each rule collection.","pos":[4461,4616]},{"content":"You can use the default rules as a template when creating your own rules.","pos":[4617,4690]},{"content":"However, these rules are only meant to function as a starter policy when you are first testing AppLocker rules so that the system files in the Windows folders will be allowed to run.","pos":[4691,4873]},{"content":"When a default rule is created, it is denoted with \"(Default rule)\" in its name as it appears in the rule collection.","pos":[4874,4991]},{"content":"You can also create a rule for the system files based on the path condition.","pos":[4993,5069]},{"content":"In the preceding example, for the Bank Tellers group, all Windows files reside under C:<ph id=\"ph1\">\\\\</ph>Windows and can be defined with the path rule condition type.","pos":[5070,5220]},{"content":"This will permit access to these files whenever updates are applied and the files change.","pos":[5221,5310]},{"content":"If you require additional application security, you might need to modify the rules created from the built-in default rule collection.","pos":[5311,5444]},{"content":"For example, the default rule to allow all users to run .exe files in the Windows folder is based on a path condition that allows all files within the Windows folder to run.","pos":[5445,5618]},{"content":"The Windows folder contains a Temp subfolder to which the Users group is given the following permissions:","pos":[5619,5724]},{"content":"Traverse Folder/Execute File","pos":[5730,5758]},{"content":"Create Files/Write Data","pos":[5763,5786]},{"content":"Create Folders/Append Data","pos":[5791,5817]},{"content":"These permissions settings are applied to this folder for application compatibility.","pos":[5819,5903]},{"content":"However, because any user can create files in this location, allowing apps to be run from this location might conflict with your organization's security policy.","pos":[5904,6064]},{"content":"Next steps","pos":[6069,6079]},{"pos":[6081,6238],"content":"After you have selected the types of rules to create, record your findings as explained in <bpt id=\"p1\">[</bpt>Document your AppLocker rules<ept id=\"p1\">](document-your-applocker-rules.md)</ept>."},{"content":"After recording your findings for the AppLocker rules to create, you will need to consider how to enforce the rules.","pos":[6240,6356]},{"content":"For info about how to do this, see <bpt id=\"p1\">[</bpt>Determine Group Policy structure and rule enforcement<ept id=\"p1\">](determine-group-policy-structure-and-rule-enforcement.md)</ept>.","pos":[6357,6506]}],"content":"---\ntitle: Select the types of rules to create (Windows 10)\ndescription: This topic lists resources you can use when selecting your application control policy rules by using AppLocker.\nms.assetid: 14751169-0ed1-47cc-822c-8c01a7477784\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Select the types of rules to create\n\n**Applies to**\n-   Windows 10\n\nThis topic lists resources you can use when selecting your application control policy rules by using AppLocker.\n\nWhen determining what types of rules to create for each of your groups, you should also determine what enforcement setting to use for each group. Different rule types are more applicable for some apps, depending on the way that the applications are deployed in a specific business group.\n\nThe following topics provide additional information about AppLocker rules that can help you decide what rules to use for your applications:\n\n-   [Understanding AppLocker rule behavior](understanding-applocker-rule-behavior.md)\n-   [Understanding AppLocker rule exceptions](understanding-applocker-rule-exceptions.md)\n-   [Understanding AppLocker rule collections](understanding-applocker-rule-collections.md)\n-   [Understanding AppLocker allow and deny actions on rules](understanding-applocker-allow-and-deny-actions-on-rules.md)\n-   [Understanding AppLocker rule condition types](understanding-applocker-rule-condition-types.md)\n-   [Understanding AppLocker default rules](understanding-applocker-default-rules.md)\n\n### Select the rule collection\n\nThe rules you create will be in one of the following rule collections:\n\n-   Executable files: .exe and .com\n-   Windows Installer files: .msi, .msp, and .mst\n-   Scripts: .ps1, .bat, .cmd, .vbs, and .js\n-   Packaged apps and packaged app installers: .appx\n-   DLLs: .dll and .ocx\n\nBy default, the rules will allow a file to run based upon user or group privilege. If you use DLL rules, a DLL allow rule has to be created for each DLL that is used by all of the allowed apps. The DLL rule collection is not enabled by default.\n\nIn the Woodgrove Bank example, the line-of-business app for the Bank Tellers business group is C:\\\\Program Files\\\\Woodgrove\\\\Teller.exe, and this app needs to be included in a rule. In addition, because this rule is part of a list of allowed applications, all the Windows files under C:\\\\Windows must be included as well.\n\n### Determine the rule condition\n\nA rule condition is criteria upon which an AppLocker rule is based and can only be one of the rule conditions in the following table.\n\n| Rule condition | Usage scenario | Resources |\n| - | - | - |\n| Publisher | To use a publisher condition, the files must be digitally signed by the software publisher, or you must do so by using an internal certificate. Rules that are specified to the version level might have to be updated when a new version of the file is released.|For more info about this rule condition, see [Understanding the publisher rule condition in AppLocker](understanding-the-publisher-rule-condition-in-applocker.md).\n| Path| Any file can be assigned this rule condition; however, because path rules specify locations within the file system, any subdirectory will also be affected by the rule (unless explicitly exempted).| For more info about this rule condition, see [Understanding the path rule condition in AppLocker](understanding-the-path-rule-condition-in-applocker.md). |\n| File hash | Any file can be assigned this rule condition; however, the rule must be updated each time a new version of the file is released because the hash value is based in part upon the version.| For more info about this rule condition, see [Understanding the file hash rule condition in AppLocker](understanding-the-file-hash-rule-condition-in-applocker.md). |\n \nIn the Woodgrove Bank example, the line-of-business app for the Bank Tellers business group is signed and is located at C:\\\\Program Files\\\\Woodgrove\\\\Teller.exe. Therefore, the rule can be defined with a publisher condition. If the rule is defined to a specific version and above (for example, Teller.exe version 8.0 and above), then this will allow any updates to this app to occur without interruption of access to the users if the app's name and signed attributes stay the same.\n\n### Determine how to allow system files to run\n\nBecause AppLocker rules build a list of allowed apps, a rule or rules must be created to allow all Windows files to run. AppLocker provides a means to ensure system files are properly considered in your rule collection by generating the default rules for each rule collection. You can use the default rules as a template when creating your own rules. However, these rules are only meant to function as a starter policy when you are first testing AppLocker rules so that the system files in the Windows folders will be allowed to run. When a default rule is created, it is denoted with \"(Default rule)\" in its name as it appears in the rule collection.\n\nYou can also create a rule for the system files based on the path condition. In the preceding example, for the Bank Tellers group, all Windows files reside under C:\\\\Windows and can be defined with the path rule condition type. This will permit access to these files whenever updates are applied and the files change. If you require additional application security, you might need to modify the rules created from the built-in default rule collection. For example, the default rule to allow all users to run .exe files in the Windows folder is based on a path condition that allows all files within the Windows folder to run. The Windows folder contains a Temp subfolder to which the Users group is given the following permissions:\n\n-   Traverse Folder/Execute File\n-   Create Files/Write Data\n-   Create Folders/Append Data\n\nThese permissions settings are applied to this folder for application compatibility. However, because any user can create files in this location, allowing apps to be run from this location might conflict with your organization's security policy.\n\n## Next steps\n\nAfter you have selected the types of rules to create, record your findings as explained in [Document your AppLocker rules](document-your-applocker-rules.md).\n\nAfter recording your findings for the AppLocker rules to create, you will need to consider how to enforce the rules. For info about how to do this, see [Determine Group Policy structure and rule enforcement](determine-group-policy-structure-and-rule-enforcement.md).\n"}