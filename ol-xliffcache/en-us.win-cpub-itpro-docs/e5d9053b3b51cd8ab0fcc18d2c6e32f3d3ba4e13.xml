{"nodes":[{"content":"Creating the DaRT 10 Recovery Image","pos":[11,46]},{"content":"Creating the DaRT 10 Recovery Image","pos":[60,95]},{"content":"Creating the DaRT 10 Recovery Image","pos":[244,279]},{"content":"After installing Microsoft Diagnostics and Recovery Toolset (DaRT) 10, you create a DaRT 10 recovery image.","pos":[282,389]},{"content":"The recovery image starts Windows RE, from which you can then start the DaRT tools.","pos":[390,473]},{"content":"You can generate International Organization for Standardization (ISO) files and Windows Imaging Format (WIM) images.","pos":[474,590]},{"content":"In addition, you can use PowerShell to generate scripts that use the settings you select in the DaRT Recovery Image wizard.","pos":[591,714]},{"content":"You can use the script later to rebuild recovery images by using the same settings.","pos":[715,798]},{"content":"The recovery image provides a variety of recovery tools.","pos":[799,855]},{"content":"For a description of the tools, see <bpt id=\"p1\">[</bpt>Overview of the Tools in DaRT 10<ept id=\"p1\">](overview-of-the-tools-in-dart-10.md)</ept>.","pos":[856,964]},{"content":"After you boot the computer into DaRT, you can run the different DaRT tools to try to diagnose and repair the computer.","pos":[966,1085]},{"content":"This section walks you through the process of creating the DaRT recovery image and lets you select the tools and features that you want to include as part of the image.","pos":[1086,1254]},{"content":"You can create the DaRT recovery image by using either of two methods:","pos":[1256,1326]},{"content":"Use the DaRT Recovery Image wizard, which runs in a Windows environment.","pos":[1332,1404]},{"content":"Modify an example PowerShell script with the values you want.","pos":[1410,1471]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How to Use a PowerShell Script to Create the Recovery Image<ept id=\"p1\">](how-to-use-a-powershell-script-to-create-the-recovery-image-dart-10.md)</ept>.","pos":[1472,1632]},{"content":"You can write the ISO to a recordable CD or DVD, save it to a USB flash drive, or save it in a format that you can use to boot into DaRT from a remote partition or from a recovery partition.","pos":[1634,1824]},{"content":"Once you have created the ISO image, you can burn it onto a blank CD or DVD (if your computer has a CD or DVD drive).","pos":[1826,1943]},{"content":"If your computer does not have a drive for this purpose, you can use most generic programs that are used to burn CDs or DVDs.","pos":[1944,2069]},{"content":"Select the image architecture and specify the path","pos":[2074,2124]},{"content":"On the Windows 10 Media page, you select whether to create a 32-bit or 64-bit DaRT recovery image.","pos":[2127,2225]},{"content":"Use the 32-bit Windows to build 32-bit DaRT recovery images, and 64-bit Windows to build 64-bit DaRT recovery images.","pos":[2226,2343]},{"content":"You can use a single computer to create recovery images for both architecture types, but you cannot create one image that works on both 32-bit and 64-bit architectures.","pos":[2344,2512]},{"content":"You also indicate the path of the Windows 10 installation media.","pos":[2513,2577]},{"content":"Choose the architecture that matches the one of the recovery image that you are creating.","pos":[2578,2667]},{"content":"To select the image architecture and specify the path","pos":[2671,2724]},{"pos":[2732,2794],"content":"On the <bpt id=\"p1\">**</bpt>Windows 10 Media<ept id=\"p1\">**</ept> page, select one of the following:"},{"pos":[2804,2905],"content":"If you are creating a recovery image for 64-bit computers, select <bpt id=\"p1\">**</bpt>Create x64 (64-bit) DaRT image<ept id=\"p1\">**</ept>."},{"pos":[2915,3016],"content":"If you are creating a recovery image for 32-bit computers, select <bpt id=\"p1\">**</bpt>Create x86 (32-bit) DaRT image<ept id=\"p1\">**</ept>."},{"content":"In the <bpt id=\"p1\">**</bpt>Specify the root path of the Windows 10 <ph id=\"ph1\">&amp;lt;</ph>64-bit or 32-bit<ph id=\"ph2\">&amp;gt;</ph> install media<ept id=\"p1\">**</ept> box, type the path of the Windows 10 installation files.","pos":[3022,3168]},{"content":"Use a path that matches the architecture of the recovery image that you are creating.","pos":[3169,3254]},{"pos":[3260,3275],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>."},{"content":"Select the tools to include on the recovery image","pos":[3280,3329]},{"content":"On the Tools page, you can select numerous tools to include on the recovery image.","pos":[3332,3414]},{"content":"These tools will be available to end users when they boot into the DaRT image.","pos":[3415,3493]},{"content":"However, if you enable remote connectivity when creating the DaRT image, all of the tools will be available when a help desk worker connects to the end user’s computer, regardless of which tools you chose to include on the image.","pos":[3494,3723]},{"content":"To restrict end-user access to these tools, but still retain full access to the tools through the Remote Connection Viewer, do not select those tools on the Tools page.","pos":[3725,3893]},{"content":"End users will be able to use only Remote Connection and will be able to see, but not access, any tools that you exclude from the recovery image.","pos":[3894,4039]},{"content":"To select the tools to include on the recovery image","pos":[4043,4095]},{"pos":[4103,4202],"content":"On the <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept> page, select the check box beside each tool that you want to include on the image."},{"pos":[4208,4223],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>."},{"content":"Choose whether to allow remote connectivity by a help desk","pos":[4228,4286]},{"content":"On the Remote Connection page, you can choose to enable a help desk worker to remotely connect to and run the DaRT tools on an end user’s computer.","pos":[4289,4436]},{"content":"The remote connectivity option is then shown as an available option in the Diagnostics and Recovery Toolset window.","pos":[4437,4552]},{"content":"After help desk workers establish a remote connection, they can run the DaRT tools on the end-user computer from a remote location.","pos":[4553,4684]},{"content":"To choose whether to allow remote connectivity by help desk workers","pos":[4688,4755]},{"pos":[4763,4930],"content":"On the <bpt id=\"p1\">**</bpt>Remote Connection<ept id=\"p1\">**</ept> page, select the <bpt id=\"p2\">**</bpt>Allow remote connections<ept id=\"p2\">**</ept> check box to allow remote connections, or clear the check box to prevent remote connections."},{"content":"If you cleared the <bpt id=\"p1\">**</bpt>Allow remote connections<ept id=\"p1\">**</ept> check box, click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept>.","pos":[4936,5010]},{"content":"Otherwise, go to the next step to continue configuring remote connectivity.","pos":[5011,5086]},{"content":"Select one of the following:","pos":[5092,5120]},{"content":"Let Windows choose an open port number.","pos":[5130,5169]},{"content":"Specify the port number.","pos":[5179,5203]},{"content":"If you select this option, enter a port number between 1 and 65535 in the field beneath the option.","pos":[5204,5303]},{"content":"This port number will be used when establishing a remote connection.","pos":[5304,5372]},{"content":"We recommend that the port number be 1024 or higher to minimize the possibility of a conflict.","pos":[5373,5467]},{"content":"(Optional) in the <bpt id=\"p1\">**</bpt>Remote connection welcome<ept id=\"p1\">**</ept> message box, create a customized message that end users receive when they establish a remote connection.","pos":[5473,5625]},{"content":"The message can be a maximum of 2048 characters.","pos":[5626,5674]},{"pos":[5680,5695],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>."},{"pos":[5701,5909],"content":"For more information about running the DaRT tools remotely, see <bpt id=\"p1\">[</bpt>How to Recover Remote Computers by Using the DaRT Recovery Image<ept id=\"p1\">](how-to-recover-remote-computers-by-using-the-dart-recovery-image-dart-10.md)</ept>."},{"content":"Add drivers to the recovery image","pos":[5914,5947]},{"content":"On the Drivers tab of the Advanced Options page, you can add additional device drivers that you may need when repairing a computer.","pos":[5950,6081]},{"content":"These may typically include storage or network controllers that Windows 10 does not provide.","pos":[6082,6174]},{"content":"Drivers are installed when the image is created.","pos":[6175,6223]},{"content":"Important","pos":[6227,6236]},{"content":"When you select drivers to include, be aware that wireless connectivity (such as Bluetooth or 802.11a/b/g/n) is not supported in DaRT.","pos":[6241,6375]},{"content":"To add drivers to the recovery image","pos":[6382,6418]},{"pos":[6426,6486],"content":"On the <bpt id=\"p1\">**</bpt>Advanced Options<ept id=\"p1\">**</ept> page, click the <bpt id=\"p2\">**</bpt>Drivers<ept id=\"p2\">**</ept> tab."},{"pos":[6492,6506],"content":"Click <bpt id=\"p1\">**</bpt>Add<ept id=\"p1\">**</ept>."},{"pos":[6512,6583],"content":"Browse to the file to be added for the driver, and then click <bpt id=\"p1\">**</bpt>Open<ept id=\"p1\">**</ept>."},{"pos":[6589,6689],"content":"**Note**  \nThe driver file is provided by the manufacturer of the storage or network controller.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"The driver file is provided by the manufacturer of the storage or network controller.","pos":[11,96]}]},{"content":"Repeat Steps 2 and 3 for every driver that you want to include.","pos":[6702,6765]},{"pos":[6771,6786],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>."},{"content":"Add WinPE optional packages to the recovery image","pos":[6791,6840]},{"content":"On the WinPE tab of the Advanced Options page, you can add WinPE optional packages to the DaRT image.","pos":[6843,6944]},{"content":"These packages are part of the Windows ADK, which is an installation prerequisite for the DaRT Recovery Image wizard.","pos":[6945,7062]},{"content":"The tools that you can select are all optional.","pos":[7063,7110]},{"content":"Any required packages are added automatically, based on the tools you selected on the Tools page.","pos":[7111,7208]},{"content":"You can also specify the size of the scratch space.","pos":[7210,7261]},{"content":"Scratch space is the amount of RAM disk space that is set aside for DaRT to run.","pos":[7262,7342]},{"content":"The scratch space is useful in case the end user’s hard disk is not available.","pos":[7343,7421]},{"content":"If you are running additional tools and drivers, you may want to increase the scratch space.","pos":[7422,7514]},{"content":"To add WinPE optional packages to the recovery image","pos":[7518,7570]},{"pos":[7578,7636],"content":"On the <bpt id=\"p1\">**</bpt>Advanced Options<ept id=\"p1\">**</ept> page, click the <bpt id=\"p2\">**</bpt>WinPE<ept id=\"p2\">**</ept> tab."},{"pos":[7642,7784],"content":"Select the check box beside each package that you want to include on the image, or click the <bpt id=\"p1\">**</bpt>Name<ept id=\"p1\">**</ept> check box to select all of the packages."},{"pos":[7790,7937],"content":"In the <bpt id=\"p1\">**</bpt>Scratch Space<ept id=\"p1\">**</ept> field, select the amount of RAM disk space to allocate for running DaRT in case the end user’s hard disk is not available."},{"pos":[7943,7958],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>."},{"content":"Add the debugging tools for Crash Analyzer","pos":[7963,8005]},{"content":"If you include the Crash Analyzer tool in the ISO image, you must also include the Debugging Tools for Windows.","pos":[8008,8119]},{"content":"On the Crash Analyzer tab of the Advanced Options page, you enter the path of the Windows 10 Debugging Tools, which Crash Analyzer uses to analyze memory dump files.","pos":[8120,8285]},{"content":"You can use the tools that are on the computer where you are running the DaRT Recovery Image wizard, or you can use the tools that are on the end-user computer.","pos":[8286,8446]},{"content":"If you decide to use the tools on the end-user computer, remember that every computer that you diagnose must have the Debugging Tools installed.","pos":[8447,8591]},{"content":"If you installed the Microsoft Windows Software Development Kit (SDK) or the Microsoft Windows Development Kit (WDK), the Windows 10 Debugging Tools are added to the recovery image by default, and the path to the Debugging Tools is automatically filled in.","pos":[8593,8849]},{"content":"You can change the path of the Windows 10 Debugging Tools if the files are located somewhere other than the location indicated by the default file path.","pos":[8850,9002]},{"content":"A link in the wizard lets you download and install debugging tools for Windows if they are not already installed.","pos":[9003,9116]},{"content":"To download the Windows Debugging Tools, see <bpt id=\"p1\">[</bpt>Debugging Tools for Windows<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=266248)</ept>.","pos":[9118,9240]},{"content":"Install the Debugging Tools to the default location.","pos":[9241,9293]},{"content":"Note","pos":[9297,9301]},{"content":"The DaRT wizard checks for the tools in the <ph id=\"ph1\">`HKLM\\Software\\Microsoft\\Windows Kits\\Installed Roots\\WindowsDebuggersRoot`</ph> registry key.","pos":[9306,9439]},{"content":"If the registry value is not there, the wizard looks in one of the following locations, depending on your system architecture:","pos":[9440,9566]},{"content":"To add the debugging tools for Crash Analyzer","pos":[9679,9724]},{"pos":[9732,9799],"content":"On the <bpt id=\"p1\">**</bpt>Advanced Options<ept id=\"p1\">**</ept> page, click the <bpt id=\"p2\">**</bpt>Crash Analyzer<ept id=\"p2\">**</ept> tab."},{"pos":[9805,9899],"content":"(Optional) Click <bpt id=\"p1\">**</bpt>Download the Debugging Tools<ept id=\"p1\">**</ept> to download the Debugging Tools for Windows."},{"content":"Select one of the following options:","pos":[9905,9941]},{"content":"<bpt id=\"p1\">**</bpt>Include the Windows 10 <ph id=\"ph1\">&amp;lt;</ph>64-bit or 32-bit<ph id=\"ph2\">&amp;gt;</ph> Debugging Tools<ept id=\"p1\">**</ept>.","pos":[9951,10019]},{"content":"If you select this option, browse to and select the location of the tools if the path is not already displaying.","pos":[10020,10132]},{"content":"<bpt id=\"p1\">**</bpt>Use the Debugging Tools from the system that is being debugged<ept id=\"p1\">**</ept>.","pos":[10142,10209]},{"content":"If you select this option, the Crash Analyzer will not work if the Debugging Tools for Windows are not found on the problem computer.","pos":[10210,10343]},{"pos":[10349,10364],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>."},{"content":"Select the types of recovery image files to create","pos":[10369,10419]},{"content":"On the Create Image page, you choose an output folder for the recovery image, enter an image name, and select the types of DaRT recovery image files to create.","pos":[10422,10581]},{"content":"During the recovery image creation process, Windows source files are unpacked, DaRT files are copied to it, and the image is then “re-packed” into the file formats that you select on this page.","pos":[10582,10775]},{"content":"The available image file types are:","pos":[10777,10812]},{"pos":[10818,10932],"content":"<bpt id=\"p1\">**</bpt>Windows Imaging File (WIM)<ept id=\"p1\">**</ept> - used to deploy DaRT to a preboot execution environment (PXE) or local partition)."},{"content":"<bpt id=\"p1\">**</bpt>International Standards Organization (ISO)<ept id=\"p1\">**</ept> – used to deploy to CD or DVD, or for use in virtual machines (VM)s).","pos":[10938,11054]},{"content":"The wizard requires that the ISO image have an .iso file name extension because most programs that burn a CD or DVD require that extension.","pos":[11055,11194]},{"content":"If you do not specify a different location, the ISO image is created on your desktop with the name DaRT10.ISO.","pos":[11195,11305]},{"content":"<bpt id=\"p1\">**</bpt>PowerShell script<ept id=\"p1\">**</ept> – creates a DaRT recovery image with commands that provide essentially the same options that you can select by using the DaRT Recovery Image wizard.","pos":[11311,11481]},{"content":"The script also enables you to add or changes files in the DaRT recovery image.","pos":[11482,11561]},{"content":"If you select the Edit Image check box on this page, you can customize the recovery image during the image creation process.","pos":[11563,11687]},{"content":"For example, you can change the “winpeshl.ini” file to create a custom startup order or to add third-party tools.","pos":[11688,11801]},{"content":"To select the types of recovery image files to create","pos":[11805,11858]},{"pos":[11866,11960],"content":"On the <bpt id=\"p1\">**</bpt>Create Image<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Browse<ept id=\"p2\">**</ept> to choose the output folder for the image file."},{"pos":[11966,12094],"content":"**Note**  \nThe size of the image will vary, depending on the tools that you select and the files that you add in the wizard.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"The size of the image will vary, depending on the tools that you select and the files that you add in the wizard.","pos":[11,124]}]},{"pos":[12107,12220],"content":"In the <bpt id=\"p1\">**</bpt>Image name<ept id=\"p1\">**</ept> box, enter a name for the DaRT recovery image, or accept the default name, which is DaRT10."},{"content":"The wizard creates a subfolder in the output path by this name.","pos":[12226,12289]},{"content":"Select the types of image files that you want to create.","pos":[12295,12351]},{"content":"Choose one of the following:","pos":[12357,12385]},{"pos":[12395,12536],"content":"To change the files in the recovery image before you create the image files, select the <bpt id=\"p1\">**</bpt>Edit Image<ept id=\"p1\">**</ept> check box, and then click <bpt id=\"p2\">**</bpt>Prepare<ept id=\"p2\">**</ept>."},{"pos":[12546,12620],"content":"To create the recovery image without changing the files, click <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept>."},{"pos":[12632,12647],"content":"Click <bpt id=\"p1\">**</bpt>Next<ept id=\"p1\">**</ept>."},{"content":"Edit the recovery image files","pos":[12652,12681]},{"content":"You can edit the recovery image only if you selected the Edit Image check box on the Create Image page.","pos":[12684,12787]},{"content":"After the recovery image has been prepared for editing, you can add and modify the recovery image files before creating the bootable media.","pos":[12788,12927]},{"content":"For example, you can create a custom order for startup, add various third-party tools, and so on.","pos":[12928,13025]},{"content":"To edit the recovery image files","pos":[13029,13061]},{"pos":[13069,13132],"content":"On the <bpt id=\"p1\">**</bpt>Edit Image<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Open<ept id=\"p2\">**</ept> in Windows Explorer."},{"content":"Create a subfolder in the folder that is listed in the dialog box.","pos":[13138,13204]},{"content":"Copy the files that you want to the new subfolder, or remove files that you don’t want.","pos":[13210,13297]},{"pos":[13303,13357],"content":"Click <bpt id=\"p1\">**</bpt>Create<ept id=\"p1\">**</ept> to start creating the recovery image."},{"content":"Generate the recovery image files","pos":[13362,13395]},{"content":"On the Generate Files page, the DaRT recovery image is generated for the file types that you selected on the Create Image page.","pos":[13398,13525]},{"content":"To generate the recovery image files","pos":[13529,13565]},{"pos":[13573,13657],"content":"On the <bpt id=\"p1\">**</bpt>Generate Files<ept id=\"p1\">**</ept> page, click <bpt id=\"p2\">**</bpt>Next<ept id=\"p2\">**</ept> to generate the recovery image files."},{"content":"Copy the recovery image to a CD, DVD, or USB","pos":[13662,13706]},{"content":"On the Create Bootable Media page, you can optionally copy the image file to a CD, DVD, or USB flash drive (UFD).","pos":[13709,13822]},{"content":"You can also create additional bootable media from this page by restarting the wizard.","pos":[13823,13909]},{"content":"Note","pos":[13913,13917]},{"content":"The Preboot execution environment (PXE) and local image deployment are not supported natively by this tool since they require additional enterprise tools, such as System Center Configuration Manager server and Microsoft Development Toolkit.","pos":[13922,14162]},{"content":"To copy the recovery image to a CD, DVD, or USB","pos":[14169,14216]},{"pos":[14224,14305],"content":"On the <bpt id=\"p1\">**</bpt>Create Bootable Media<ept id=\"p1\">**</ept> page, select the iso file that you want to copy."},{"content":"Insert a CD, DVD, or USB, and then select the drive.","pos":[14311,14363]},{"pos":[14369,14527],"content":"**Note**  \nIf a drive is not recognized and you install a new drive, you can click **Refresh** to force the wizard to update the list of available drives.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"If a drive is not recognized and you install a new drive, you can click <bpt id=\"p1\">**</bpt>Refresh<ept id=\"p1\">**</ept> to force the wizard to update the list of available drives.","pos":[11,154]}]},{"pos":[14540,14583],"content":"Click the <bpt id=\"p1\">**</bpt>Create Bootable Media<ept id=\"p1\">**</ept> button."},{"pos":[14589,14718],"content":"To create another recovery image, click Restart, or click <bpt id=\"p1\">**</bpt>Close<ept id=\"p1\">**</ept> if you have finished creating all of the media that you want."},{"content":"Related topics","pos":[14723,14737]},{"content":"Overview of the Tools in DaRT 10","pos":[14741,14773]},{"content":"Deploying DaRT 10","pos":[14814,14831]}],"content":"---\ntitle: Creating the DaRT 10 Recovery Image\ndescription: Creating the DaRT 10 Recovery Image\nauthor: jamiejdt\nms.assetid: 173556de-2f20-4ea6-9e29-fc5ccc71ebd7\nms.pagetype: mdop\nms.mktglfcycl: support\nms.sitesec: library\nms.prod: w10\n---\n\n\n# Creating the DaRT 10 Recovery Image\n\n\nAfter installing Microsoft Diagnostics and Recovery Toolset (DaRT) 10, you create a DaRT 10 recovery image. The recovery image starts Windows RE, from which you can then start the DaRT tools. You can generate International Organization for Standardization (ISO) files and Windows Imaging Format (WIM) images. In addition, you can use PowerShell to generate scripts that use the settings you select in the DaRT Recovery Image wizard. You can use the script later to rebuild recovery images by using the same settings. The recovery image provides a variety of recovery tools. For a description of the tools, see [Overview of the Tools in DaRT 10](overview-of-the-tools-in-dart-10.md).\n\nAfter you boot the computer into DaRT, you can run the different DaRT tools to try to diagnose and repair the computer. This section walks you through the process of creating the DaRT recovery image and lets you select the tools and features that you want to include as part of the image.\n\nYou can create the DaRT recovery image by using either of two methods:\n\n-   Use the DaRT Recovery Image wizard, which runs in a Windows environment.\n\n-   Modify an example PowerShell script with the values you want. For more information, see [How to Use a PowerShell Script to Create the Recovery Image](how-to-use-a-powershell-script-to-create-the-recovery-image-dart-10.md).\n\nYou can write the ISO to a recordable CD or DVD, save it to a USB flash drive, or save it in a format that you can use to boot into DaRT from a remote partition or from a recovery partition.\n\nOnce you have created the ISO image, you can burn it onto a blank CD or DVD (if your computer has a CD or DVD drive). If your computer does not have a drive for this purpose, you can use most generic programs that are used to burn CDs or DVDs.\n\n## Select the image architecture and specify the path\n\n\nOn the Windows 10 Media page, you select whether to create a 32-bit or 64-bit DaRT recovery image. Use the 32-bit Windows to build 32-bit DaRT recovery images, and 64-bit Windows to build 64-bit DaRT recovery images. You can use a single computer to create recovery images for both architecture types, but you cannot create one image that works on both 32-bit and 64-bit architectures. You also indicate the path of the Windows 10 installation media. Choose the architecture that matches the one of the recovery image that you are creating.\n\n**To select the image architecture and specify the path**\n\n1.  On the **Windows 10 Media** page, select one of the following:\n\n    -   If you are creating a recovery image for 64-bit computers, select **Create x64 (64-bit) DaRT image**.\n\n    -   If you are creating a recovery image for 32-bit computers, select **Create x86 (32-bit) DaRT image**.\n\n2.  In the **Specify the root path of the Windows 10 &lt;64-bit or 32-bit&gt; install media** box, type the path of the Windows 10 installation files. Use a path that matches the architecture of the recovery image that you are creating.\n\n3.  Click **Next**.\n\n## Select the tools to include on the recovery image\n\n\nOn the Tools page, you can select numerous tools to include on the recovery image. These tools will be available to end users when they boot into the DaRT image. However, if you enable remote connectivity when creating the DaRT image, all of the tools will be available when a help desk worker connects to the end user’s computer, regardless of which tools you chose to include on the image.\n\nTo restrict end-user access to these tools, but still retain full access to the tools through the Remote Connection Viewer, do not select those tools on the Tools page. End users will be able to use only Remote Connection and will be able to see, but not access, any tools that you exclude from the recovery image.\n\n**To select the tools to include on the recovery image**\n\n1.  On the **Tools** page, select the check box beside each tool that you want to include on the image.\n\n2.  Click **Next**.\n\n## Choose whether to allow remote connectivity by a help desk\n\n\nOn the Remote Connection page, you can choose to enable a help desk worker to remotely connect to and run the DaRT tools on an end user’s computer. The remote connectivity option is then shown as an available option in the Diagnostics and Recovery Toolset window. After help desk workers establish a remote connection, they can run the DaRT tools on the end-user computer from a remote location.\n\n**To choose whether to allow remote connectivity by help desk workers**\n\n1.  On the **Remote Connection** page, select the **Allow remote connections** check box to allow remote connections, or clear the check box to prevent remote connections.\n\n2.  If you cleared the **Allow remote connections** check box, click **Next**. Otherwise, go to the next step to continue configuring remote connectivity.\n\n3.  Select one of the following:\n\n    -   Let Windows choose an open port number.\n\n    -   Specify the port number. If you select this option, enter a port number between 1 and 65535 in the field beneath the option. This port number will be used when establishing a remote connection. We recommend that the port number be 1024 or higher to minimize the possibility of a conflict.\n\n4.  (Optional) in the **Remote connection welcome** message box, create a customized message that end users receive when they establish a remote connection. The message can be a maximum of 2048 characters.\n\n5.  Click **Next**.\n\n    For more information about running the DaRT tools remotely, see [How to Recover Remote Computers by Using the DaRT Recovery Image](how-to-recover-remote-computers-by-using-the-dart-recovery-image-dart-10.md).\n\n## Add drivers to the recovery image\n\n\nOn the Drivers tab of the Advanced Options page, you can add additional device drivers that you may need when repairing a computer. These may typically include storage or network controllers that Windows 10 does not provide. Drivers are installed when the image is created.\n\n**Important**  \nWhen you select drivers to include, be aware that wireless connectivity (such as Bluetooth or 802.11a/b/g/n) is not supported in DaRT.\n\n \n\n**To add drivers to the recovery image**\n\n1.  On the **Advanced Options** page, click the **Drivers** tab.\n\n2.  Click **Add**.\n\n3.  Browse to the file to be added for the driver, and then click **Open**.\n\n    **Note**  \n    The driver file is provided by the manufacturer of the storage or network controller.\n\n     \n\n4.  Repeat Steps 2 and 3 for every driver that you want to include.\n\n5.  Click **Next**.\n\n## Add WinPE optional packages to the recovery image\n\n\nOn the WinPE tab of the Advanced Options page, you can add WinPE optional packages to the DaRT image. These packages are part of the Windows ADK, which is an installation prerequisite for the DaRT Recovery Image wizard. The tools that you can select are all optional. Any required packages are added automatically, based on the tools you selected on the Tools page.\n\nYou can also specify the size of the scratch space. Scratch space is the amount of RAM disk space that is set aside for DaRT to run. The scratch space is useful in case the end user’s hard disk is not available. If you are running additional tools and drivers, you may want to increase the scratch space.\n\n**To add WinPE optional packages to the recovery image**\n\n1.  On the **Advanced Options** page, click the **WinPE** tab.\n\n2.  Select the check box beside each package that you want to include on the image, or click the **Name** check box to select all of the packages.\n\n3.  In the **Scratch Space** field, select the amount of RAM disk space to allocate for running DaRT in case the end user’s hard disk is not available.\n\n4.  Click **Next**.\n\n## Add the debugging tools for Crash Analyzer\n\n\nIf you include the Crash Analyzer tool in the ISO image, you must also include the Debugging Tools for Windows. On the Crash Analyzer tab of the Advanced Options page, you enter the path of the Windows 10 Debugging Tools, which Crash Analyzer uses to analyze memory dump files. You can use the tools that are on the computer where you are running the DaRT Recovery Image wizard, or you can use the tools that are on the end-user computer. If you decide to use the tools on the end-user computer, remember that every computer that you diagnose must have the Debugging Tools installed.\n\nIf you installed the Microsoft Windows Software Development Kit (SDK) or the Microsoft Windows Development Kit (WDK), the Windows 10 Debugging Tools are added to the recovery image by default, and the path to the Debugging Tools is automatically filled in. You can change the path of the Windows 10 Debugging Tools if the files are located somewhere other than the location indicated by the default file path. A link in the wizard lets you download and install debugging tools for Windows if they are not already installed.\n\nTo download the Windows Debugging Tools, see [Debugging Tools for Windows](http://go.microsoft.com/fwlink/?LinkId=266248). Install the Debugging Tools to the default location.\n\n**Note**  \nThe DaRT wizard checks for the tools in the `HKLM\\Software\\Microsoft\\Windows Kits\\Installed Roots\\WindowsDebuggersRoot` registry key. If the registry value is not there, the wizard looks in one of the following locations, depending on your system architecture:\n\n`%ProgramFilesX86%\\Windows Kits\\10.0\\Debuggers\\x64`\n\n`%ProgramFilesX86%\\Windows Kits\\10.0\\Debuggers\\x86`\n\n \n\n**To add the debugging tools for Crash Analyzer**\n\n1.  On the **Advanced Options** page, click the **Crash Analyzer** tab.\n\n2.  (Optional) Click **Download the Debugging Tools** to download the Debugging Tools for Windows.\n\n3.  Select one of the following options:\n\n    -   **Include the Windows 10 &lt;64-bit or 32-bit&gt; Debugging Tools**. If you select this option, browse to and select the location of the tools if the path is not already displaying.\n\n    -   **Use the Debugging Tools from the system that is being debugged**. If you select this option, the Crash Analyzer will not work if the Debugging Tools for Windows are not found on the problem computer.\n\n4.  Click **Next**.\n\n## Select the types of recovery image files to create\n\n\nOn the Create Image page, you choose an output folder for the recovery image, enter an image name, and select the types of DaRT recovery image files to create. During the recovery image creation process, Windows source files are unpacked, DaRT files are copied to it, and the image is then “re-packed” into the file formats that you select on this page.\n\nThe available image file types are:\n\n-   **Windows Imaging File (WIM)** - used to deploy DaRT to a preboot execution environment (PXE) or local partition).\n\n-   **International Standards Organization (ISO)** – used to deploy to CD or DVD, or for use in virtual machines (VM)s). The wizard requires that the ISO image have an .iso file name extension because most programs that burn a CD or DVD require that extension. If you do not specify a different location, the ISO image is created on your desktop with the name DaRT10.ISO.\n\n-   **PowerShell script** – creates a DaRT recovery image with commands that provide essentially the same options that you can select by using the DaRT Recovery Image wizard. The script also enables you to add or changes files in the DaRT recovery image.\n\nIf you select the Edit Image check box on this page, you can customize the recovery image during the image creation process. For example, you can change the “winpeshl.ini” file to create a custom startup order or to add third-party tools.\n\n**To select the types of recovery image files to create**\n\n1.  On the **Create Image** page, click **Browse** to choose the output folder for the image file.\n\n    **Note**  \n    The size of the image will vary, depending on the tools that you select and the files that you add in the wizard.\n\n     \n\n2.  In the **Image name** box, enter a name for the DaRT recovery image, or accept the default name, which is DaRT10.\n\n    The wizard creates a subfolder in the output path by this name.\n\n3.  Select the types of image files that you want to create.\n\n4.  Choose one of the following:\n\n    -   To change the files in the recovery image before you create the image files, select the **Edit Image** check box, and then click **Prepare**.\n\n    -   To create the recovery image without changing the files, click **Create**.\n\n5.  \n\n    Click **Next**.\n\n## Edit the recovery image files\n\n\nYou can edit the recovery image only if you selected the Edit Image check box on the Create Image page. After the recovery image has been prepared for editing, you can add and modify the recovery image files before creating the bootable media. For example, you can create a custom order for startup, add various third-party tools, and so on.\n\n**To edit the recovery image files**\n\n1.  On the **Edit Image** page, click **Open** in Windows Explorer.\n\n2.  Create a subfolder in the folder that is listed in the dialog box.\n\n3.  Copy the files that you want to the new subfolder, or remove files that you don’t want.\n\n4.  Click **Create** to start creating the recovery image.\n\n## Generate the recovery image files\n\n\nOn the Generate Files page, the DaRT recovery image is generated for the file types that you selected on the Create Image page.\n\n**To generate the recovery image files**\n\n-   On the **Generate Files** page, click **Next** to generate the recovery image files.\n\n## Copy the recovery image to a CD, DVD, or USB\n\n\nOn the Create Bootable Media page, you can optionally copy the image file to a CD, DVD, or USB flash drive (UFD). You can also create additional bootable media from this page by restarting the wizard.\n\n**Note**  \nThe Preboot execution environment (PXE) and local image deployment are not supported natively by this tool since they require additional enterprise tools, such as System Center Configuration Manager server and Microsoft Development Toolkit.\n\n \n\n**To copy the recovery image to a CD, DVD, or USB**\n\n1.  On the **Create Bootable Media** page, select the iso file that you want to copy.\n\n2.  Insert a CD, DVD, or USB, and then select the drive.\n\n    **Note**  \n    If a drive is not recognized and you install a new drive, you can click **Refresh** to force the wizard to update the list of available drives.\n\n     \n\n3.  Click the **Create Bootable Media** button.\n\n4.  To create another recovery image, click Restart, or click **Close** if you have finished creating all of the media that you want.\n\n## Related topics\n\n\n[Overview of the Tools in DaRT 10](overview-of-the-tools-in-dart-10.md)\n\n[Deploying DaRT 10](deploying-dart-10.md)\n\n \n\n \n\n\n\n\n\n"}