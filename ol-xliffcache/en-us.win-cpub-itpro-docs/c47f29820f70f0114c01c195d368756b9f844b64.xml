{"nodes":[{"content":"Modify the Port on Which the AGPM Service Listens","pos":[11,60]},{"content":"Modify the Port on Which the AGPM Service Listens","pos":[74,123]},{"content":"Modify the Port on Which the AGPM Service Listens","pos":[271,320]},{"content":"The AGPM Service is a Windows service that acts as a security proxy, managing client access to Group Policy objects (GPOs) in the archive and production environment.","pos":[323,488]},{"content":"By default, the AGPM Service listens on port 4600.","pos":[489,539]},{"content":"You can change this port by modifying the Advanced Group Policy Management (AGPM) archive index file for each archive.","pos":[540,658]},{"content":"Note","pos":[662,666]},{"content":"Before modifying the port on which the AGPM Service listens, it is recommended that you back up the AGPM archive index file (gpostate.xml).","pos":[671,810]},{"content":"This file is located in the folder entered as the archive path during the installation of Advanced Group Policy Management - Server.","pos":[811,943]},{"content":"By default, this location of this file is %CommonAppData%<ph id=\"ph1\">\\\\</ph>Microsoft<ph id=\"ph2\">\\\\</ph>AGPM<ph id=\"ph3\">\\\\</ph>gpostate.xml on the AGPM Server.","pos":[944,1052]},{"content":"If you do not know which computer hosts the archive, you can follow the procedure for modifying the archive path to display the current archive path.","pos":[1053,1202]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Modify the Archive Path<ept id=\"p1\">](modify-the-archive-path.md)</ept>.","pos":[1203,1283]},{"content":"A user account with access to the AGPM Server (the computer on which the AGPM Service is installed) and the archive index file is required to complete this procedure.","pos":[1288,1454]},{"content":"To modify the port on which the AGPM Service listens","pos":[1458,1510]},{"content":"On the computer hosting the archive, open the archive index file (gpostate.xml) in a text editor.","pos":[1518,1615]},{"pos":[1621,1666],"content":"In the file, search for <bpt id=\"p1\">**</bpt>agpm:port=\"4600\"<ept id=\"p1\">**</ept>."},{"pos":[1672,1774],"content":"Replace <bpt id=\"p1\">**</bpt>4600<ept id=\"p1\">**</ept> with the port on which the AGPM Service should listen; then, save and close the file."},{"content":"On the AGPM Server, restart the AGPM Service.","pos":[1780,1825]},{"content":"(For more information, see <bpt id=\"p1\">[</bpt>Start and Stop the AGPM Service<ept id=\"p1\">](start-and-stop-the-agpm-service.md)</ept>.)","pos":[1826,1924]},{"content":"Modify the port in the AGPM Server connection for each Group Policy administrator.","pos":[1930,2012]},{"content":"(For more information, see <bpt id=\"p1\">[</bpt>Configure the AGPM Server Connection<ept id=\"p1\">](configure-the-agpm-server-connection.md)</ept>.)","pos":[2013,2121]},{"content":"Repeat for each archive and AGPM Server.","pos":[2127,2167]},{"content":"Additional references","pos":[2173,2194]},{"content":"Managing the AGPM Service","pos":[2201,2226]}],"content":"---\ntitle: Modify the Port on Which the AGPM Service Listens\ndescription: Modify the Port on Which the AGPM Service Listens\nauthor: jamiejdt\nms.assetid: a82c6873-e916-4a04-b263-aa612cd6956b\nms.pagetype: mdop\nms.mktglfcycl: manage\nms.sitesec: library\nms.prod: w10\n---\n\n\n# Modify the Port on Which the AGPM Service Listens\n\n\nThe AGPM Service is a Windows service that acts as a security proxy, managing client access to Group Policy objects (GPOs) in the archive and production environment. By default, the AGPM Service listens on port 4600. You can change this port by modifying the Advanced Group Policy Management (AGPM) archive index file for each archive.\n\n**Note**  \nBefore modifying the port on which the AGPM Service listens, it is recommended that you back up the AGPM archive index file (gpostate.xml). This file is located in the folder entered as the archive path during the installation of Advanced Group Policy Management - Server. By default, this location of this file is %CommonAppData%\\\\Microsoft\\\\AGPM\\\\gpostate.xml on the AGPM Server. If you do not know which computer hosts the archive, you can follow the procedure for modifying the archive path to display the current archive path. For more information, see [Modify the Archive Path](modify-the-archive-path.md).\n\n \n\nA user account with access to the AGPM Server (the computer on which the AGPM Service is installed) and the archive index file is required to complete this procedure.\n\n**To modify the port on which the AGPM Service listens**\n\n1.  On the computer hosting the archive, open the archive index file (gpostate.xml) in a text editor.\n\n2.  In the file, search for **agpm:port=\"4600\"**.\n\n3.  Replace **4600** with the port on which the AGPM Service should listen; then, save and close the file.\n\n4.  On the AGPM Server, restart the AGPM Service. (For more information, see [Start and Stop the AGPM Service](start-and-stop-the-agpm-service.md).)\n\n5.  Modify the port in the AGPM Server connection for each Group Policy administrator. (For more information, see [Configure the AGPM Server Connection](configure-the-agpm-server-connection.md).)\n\n6.  Repeat for each archive and AGPM Server.\n\n### Additional references\n\n-   [Managing the AGPM Service](managing-the-agpm-service.md)\n\n \n\n \n\n\n\n\n\n"}