{"nodes":[{"content":"Operations Troubleshooting","pos":[11,37]},{"content":"Operations Troubleshooting","pos":[51,77]},{"content":"Operations Troubleshooting","pos":[240,266]},{"content":"This topic includes information that you can use to help troubleshoot general operational issues in Microsoft Enterprise Desktop Virtualization (MED-V) 2.0.","pos":[269,425]},{"content":"Troubleshooting Issues in MED-V Operations","pos":[430,472]},{"content":"The following are some issues end users might encounter when they run MED-V and solutions to help troubleshoot these issues:","pos":[475,599]},{"content":"<bpt id=\"p1\">**</bpt>Documentation Redirection Fails<ept id=\"p1\">**</ept>.","pos":[601,637]},{"content":"This issue typically occurs when an end user’s My Documents folder points to a network location.","pos":[638,734]},{"content":"Windows does not support creating a share from another shared folder.","pos":[735,804]},{"content":"When a drive or folder is redirected to the guest, RDP<ph id=\"ph1\">\\\\</ph>Windows Virtual PC creates a share for that folder.","pos":[805,912]},{"content":"Therefore, if the My Documents folder on the host is already pointing to a share, RDP<ph id=\"ph1\">\\\\</ph>Windows Virtual PC cannot create a share of a share.","pos":[913,1052]},{"content":"Another possible cause of this issue is that the credentials that are required to connect to the network resource might differ from the user’s domain credentials.","pos":[1054,1216]},{"content":"MED-V might be detecting that documents are redirected on the host, send that information to the guest, and then try to reconnect the network resource.","pos":[1217,1368]},{"content":"If the user’s credentials do not authenticate, MED-V might stop trying to authenticate.","pos":[1369,1456]},{"content":"Solution","pos":[1460,1468]},{"content":"Try one of the following to resolve this issue:","pos":[1472,1519]},{"content":"Set the user’s root directory inside Active Directory.","pos":[1525,1579]},{"content":"The guest and host should then connect to the same network resource.","pos":[1580,1648]},{"content":"Instead of redirecting the My Documents folder to a UNC path, map it to a drive letter (on the host, map a drive that points to the network resource).","pos":[1654,1804]},{"content":"The My Documents folder can then be set to use the drive letter instead of the UNC path.","pos":[1805,1893]},{"content":"The guest will then redirect to that same mapped drive as expected.","pos":[1894,1961]},{"content":"Create a startup script in the guest that redirects the My Documents folder to the network resource and provides additional credentials as needed.","pos":[1967,2113]},{"content":"<bpt id=\"p1\">**</bpt>URL Redirection Fails<ept id=\"p1\">**</ept>.","pos":[2115,2141]},{"content":"A URL that you have specified for redirection from the host to the guest is not redirecting as intended or is returning an error message that indicates that the website does not exist.","pos":[2142,2326]},{"content":"Solution","pos":[2330,2338]},{"content":"This error can occur when there is a misspelling or incorrect use of characters, such as asterisk (<ph id=\"ph1\">\\*</ph>), in the URL redirection information.","pos":[2342,2481]},{"content":"Check the registry value for URL redirection and correct any mistakes.","pos":[2482,2552]},{"pos":[2554,2624],"content":"The registry key is called <ph id=\"ph1\">`RedirectUrls`</ph> and is typically located at:"},{"content":"Computer<ph id=\"ph1\">\\\\</ph>HKEY<ph id=\"ph2\">\\_</ph>LOCAL<ph id=\"ph3\">\\_</ph>MACHINE<ph id=\"ph4\">\\\\</ph>SOFTWARE<ph id=\"ph5\">\\\\</ph>Microsoft<ph id=\"ph6\">\\\\</ph>MEDV<ph id=\"ph7\">\\\\</ph>v2<ph id=\"ph8\">\\\\</ph>UserExperience","pos":[2626,2703]},{"content":"<bpt id=\"p1\">**</bpt>Icon in Taskbar Misleading<ept id=\"p1\">**</ept>.","pos":[2705,2736]},{"content":"By default, the icon that appears in an end user’s taskbar for published applications and redirected URLs is the icon for Windows Virtual PC.","pos":[2737,2878]},{"content":"If an end user is not aware of this default behavior, they can become confused when looking at the taskbar to locate their application.","pos":[2879,3014]},{"content":"Solution","pos":[3018,3026]},{"content":"The only way to avoid this default behavior is to change the user settings for the taskbar properties as follows:","pos":[3030,3143]},{"pos":[3149,3203],"content":"Right-click the taskbar and then click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>."},{"pos":[3209,3292],"content":"In the <bpt id=\"p1\">**</bpt>Taskbar and Start Menu Properties<ept id=\"p1\">**</ept> dialog box, click the <bpt id=\"p2\">**</bpt>Taskbar<ept id=\"p2\">**</ept> tab."},{"pos":[3298,3377],"content":"In the drop-down bar for the <bpt id=\"p1\">**</bpt>Taskbar buttons<ept id=\"p1\">**</ept> box, select <bpt id=\"p2\">**</bpt>Never combine<ept id=\"p2\">**</ept>."},{"pos":[3383,3396],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"The expected icons for published applications and redirected URLs are displayed.","pos":[3398,3478]},{"content":"<bpt id=\"p1\">**</bpt>Warning Issued if Second User Attempts Log on or if Virtual Machine is in Use<ept id=\"p1\">**</ept>.","pos":[3480,3562]},{"content":"A warning message is issued when a second user logs on to a MED-V workspace while a first user is still running MED-V.","pos":[3563,3681]},{"content":"The warning is also issued if MED-V is started while the virtual machine is being used, for example, if the virtual machine was started through Windows Virtual PC on the <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> menu.","pos":[3682,3867]},{"content":"When the end user accepts the warning message, MED-V shuts down.","pos":[3868,3932]},{"content":"Solution","pos":[3936,3944]},{"content":"An end user must verify that all other users are logged off MED-V before they try to log on.","pos":[3948,4040]},{"content":"This ensures that no other instance of MED-V is running and that Windows Virtual PC is not in control of the virtual machine.","pos":[4041,4166]},{"content":"<bpt id=\"p1\">**</bpt>Beeps Heard During First Time Setup<ept id=\"p1\">**</ept>.","pos":[4168,4208]},{"content":"Occasionally, beeps are heard while MED-V is running first time setup.","pos":[4209,4279]},{"content":"This can be confusing to an end user.","pos":[4280,4317]},{"content":"The beeps are originating from the virtual machine when it performs certain actions, such as shutting down.","pos":[4318,4425]},{"content":"Solution","pos":[4429,4437]},{"content":"You can stop the beep service by specifying the \"net stop beep\" command at the beginning of each virtual machine start sequence.","pos":[4441,4569]},{"content":"Or you can disable the beep service by specifying the “sc config beep start= disabled\" command.","pos":[4570,4665]},{"content":"You can specify these commands either before you seal the image or as part of Sysprep.","pos":[4666,4752]},{"content":"<bpt id=\"p1\">**</bpt>Multiple Network Connections Created for MED-V Workspaces in BRIDGED Mode<ept id=\"p1\">**</ept>.","pos":[4754,4832]},{"content":"If first time setup is creating a MED-V workspace that is configured for NAT mode, it only creates a single network connection in Windows Virtual PC.","pos":[4833,4982]},{"content":"However, if first time setup is creating a MED-V workspace that is configured for BRIDGED mode, it creates a separate network connection for each network adapter that is installed in the computer, because MED-V cannot determine which network adapter is active.","pos":[4983,5243]},{"content":"This also ensures that roaming users always have a network adapter available for wired and wireless connections.","pos":[5244,5356]},{"content":"Solution","pos":[5360,5368]},{"content":"None.","pos":[5372,5377]},{"content":"<bpt id=\"p1\">**</bpt>MED-V Application is Unresponsive for Too Long when Closing<ept id=\"p1\">**</ept>.","pos":[5379,5443]},{"content":"In some instances, a MED-V application stops responding when it is trying to close.","pos":[5444,5527]},{"content":"Solution","pos":[5531,5539]},{"content":"You can specify the length of time that MED-V waits to close unresponsive applications by setting the WaitToKillAppTimeout registry key in the guest virtual machine.","pos":[5543,5708]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>How To Increase Shutdown Time So That Processes Can Quit Properly in Windows XP<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=206819)</ept> (http://go.microsoft.com/fwlink/?LinkId=206819).","pos":[5709,5912]},{"content":"<bpt id=\"p1\">**</bpt>Renaming a Published Application Shortcut in the Guest Virtual Machine does not Change the Published Name in the Host<ept id=\"p1\">**</ept>.","pos":[5914,6036]},{"content":"When you publish an application by creating a shortcut and then rename the shortcut in the guest virtual machine, the original application name remains in the host <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> menu.","pos":[6037,6216]},{"content":"The program continues to run as expected, however the program will always retain the original name.","pos":[6217,6316]},{"content":"Solution","pos":[6320,6328]},{"content":"None.","pos":[6332,6337]},{"content":"This is a known behavior of Windows Virtual PC.","pos":[6338,6385]},{"content":"<bpt id=\"p1\">**</bpt>Moving a Shortcut in the Guest Virtual Machine does not Update the Location on the Host Computer Start Menu<ept id=\"p1\">**</ept>.","pos":[6387,6499]},{"content":"MED-V application shortcuts that are published to the host computer <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> menu are cataloged in the registry.","pos":[6500,6613]},{"content":"If you move an application shortcut into a subfolder, the registry is not updated to reflect the change.","pos":[6614,6718]},{"content":"Solution","pos":[6722,6730]},{"content":"Follow these steps to change the location of a MED-V application shortcut:","pos":[6734,6808]},{"content":"When MED-V is running, open up Windows Explorer on the MED-V guest virtual machine.","pos":[6814,6897]},{"content":"Browse to the \"%ALLUSERSPROFILE%<ph id=\"ph1\">\\\\</ph>Start Menu<ph id=\"ph2\">\\\\</ph>Programs\" directory.","pos":[6903,6969]},{"content":"Move the application shortcuts out of the startmenu or programs folders.","pos":[6975,7047]},{"pos":[7053,7155],"content":"After about 30 seconds, validate that the shortcuts are removed from the host computer <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> menu."},{"content":"Move the application shortcuts back in to the new program folders under the Start Menu<ph id=\"ph1\">\\\\</ph>Programs directory.","pos":[7161,7268]},{"pos":[7274,7374],"content":"After about 30 seconds, validate that the shortcuts are updated in the host computer <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept> Menu."},{"content":"<bpt id=\"p1\">**</bpt>Published Applications can Time Out after Sitting Idle<ept id=\"p1\">**</ept>.","pos":[7376,7435]},{"content":"In some cases, published applications will time out if they have sat idle for some time.","pos":[7436,7524]},{"content":"This situation only occurs if IPsec is enabled and the MED-V workspace is configured for NAT mode.","pos":[7525,7623]},{"content":"This situation does not occur if running in BRIDGED mode.","pos":[7624,7681]},{"content":"Solution","pos":[7685,7693]},{"content":"Disable IPsec when you are running the MED-V workspace in NAT mode.","pos":[7697,7764]},{"content":"<bpt id=\"p1\">**</bpt>Pinning a Published Application to the Taskbar Bypasses MED-V<ept id=\"p1\">**</ept>.","pos":[7766,7832]},{"content":"If an end user pins a published application to the taskbar and then closes the application, MED-V is bypassed the next time that the application is opened from the taskbar icon.","pos":[7833,8010]},{"content":"Instead, the application opens directly in a VMSAL window.","pos":[8011,8069]},{"content":"Solution","pos":[8073,8081]},{"content":"Do not pin the applications published in MED-V to the taskbar.","pos":[8085,8147]},{"content":"Related topics","pos":[8152,8166]},{"content":"Security Best Practices for MED-V Operations","pos":[8170,8214]},{"content":"Deployment Troubleshooting","pos":[8267,8293]}],"content":"---\ntitle: Operations Troubleshooting\ndescription: Operations Troubleshooting\nauthor: jamiejdt\nms.assetid: 948d7869-accd-44da-974f-93409234dee7\nms.pagetype: mdop, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w7\n---\n\n\n# Operations Troubleshooting\n\n\nThis topic includes information that you can use to help troubleshoot general operational issues in Microsoft Enterprise Desktop Virtualization (MED-V) 2.0.\n\n## Troubleshooting Issues in MED-V Operations\n\n\nThe following are some issues end users might encounter when they run MED-V and solutions to help troubleshoot these issues:\n\n**Documentation Redirection Fails**. This issue typically occurs when an end user’s My Documents folder points to a network location. Windows does not support creating a share from another shared folder. When a drive or folder is redirected to the guest, RDP\\\\Windows Virtual PC creates a share for that folder. Therefore, if the My Documents folder on the host is already pointing to a share, RDP\\\\Windows Virtual PC cannot create a share of a share.\n\nAnother possible cause of this issue is that the credentials that are required to connect to the network resource might differ from the user’s domain credentials. MED-V might be detecting that documents are redirected on the host, send that information to the guest, and then try to reconnect the network resource. If the user’s credentials do not authenticate, MED-V might stop trying to authenticate.\n\n**Solution**\n\nTry one of the following to resolve this issue:\n\n-   Set the user’s root directory inside Active Directory. The guest and host should then connect to the same network resource.\n\n-   Instead of redirecting the My Documents folder to a UNC path, map it to a drive letter (on the host, map a drive that points to the network resource). The My Documents folder can then be set to use the drive letter instead of the UNC path. The guest will then redirect to that same mapped drive as expected.\n\n-   Create a startup script in the guest that redirects the My Documents folder to the network resource and provides additional credentials as needed.\n\n**URL Redirection Fails**. A URL that you have specified for redirection from the host to the guest is not redirecting as intended or is returning an error message that indicates that the website does not exist.\n\n**Solution**\n\nThis error can occur when there is a misspelling or incorrect use of characters, such as asterisk (\\*), in the URL redirection information. Check the registry value for URL redirection and correct any mistakes.\n\nThe registry key is called `RedirectUrls` and is typically located at:\n\nComputer\\\\HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\MEDV\\\\v2\\\\UserExperience\n\n**Icon in Taskbar Misleading**. By default, the icon that appears in an end user’s taskbar for published applications and redirected URLs is the icon for Windows Virtual PC. If an end user is not aware of this default behavior, they can become confused when looking at the taskbar to locate their application.\n\n**Solution**\n\nThe only way to avoid this default behavior is to change the user settings for the taskbar properties as follows:\n\n1.  Right-click the taskbar and then click **Properties**.\n\n2.  In the **Taskbar and Start Menu Properties** dialog box, click the **Taskbar** tab.\n\n3.  In the drop-down bar for the **Taskbar buttons** box, select **Never combine**.\n\n4.  Click **OK**.\n\nThe expected icons for published applications and redirected URLs are displayed.\n\n**Warning Issued if Second User Attempts Log on or if Virtual Machine is in Use**. A warning message is issued when a second user logs on to a MED-V workspace while a first user is still running MED-V. The warning is also issued if MED-V is started while the virtual machine is being used, for example, if the virtual machine was started through Windows Virtual PC on the **Start** menu. When the end user accepts the warning message, MED-V shuts down.\n\n**Solution**\n\nAn end user must verify that all other users are logged off MED-V before they try to log on. This ensures that no other instance of MED-V is running and that Windows Virtual PC is not in control of the virtual machine.\n\n**Beeps Heard During First Time Setup**. Occasionally, beeps are heard while MED-V is running first time setup. This can be confusing to an end user. The beeps are originating from the virtual machine when it performs certain actions, such as shutting down.\n\n**Solution**\n\nYou can stop the beep service by specifying the \"net stop beep\" command at the beginning of each virtual machine start sequence. Or you can disable the beep service by specifying the “sc config beep start= disabled\" command. You can specify these commands either before you seal the image or as part of Sysprep.\n\n**Multiple Network Connections Created for MED-V Workspaces in BRIDGED Mode**. If first time setup is creating a MED-V workspace that is configured for NAT mode, it only creates a single network connection in Windows Virtual PC. However, if first time setup is creating a MED-V workspace that is configured for BRIDGED mode, it creates a separate network connection for each network adapter that is installed in the computer, because MED-V cannot determine which network adapter is active. This also ensures that roaming users always have a network adapter available for wired and wireless connections.\n\n**Solution**\n\nNone.\n\n**MED-V Application is Unresponsive for Too Long when Closing**. In some instances, a MED-V application stops responding when it is trying to close.\n\n**Solution**\n\nYou can specify the length of time that MED-V waits to close unresponsive applications by setting the WaitToKillAppTimeout registry key in the guest virtual machine. For more information, see [How To Increase Shutdown Time So That Processes Can Quit Properly in Windows XP](http://go.microsoft.com/fwlink/?LinkId=206819) (http://go.microsoft.com/fwlink/?LinkId=206819).\n\n**Renaming a Published Application Shortcut in the Guest Virtual Machine does not Change the Published Name in the Host**. When you publish an application by creating a shortcut and then rename the shortcut in the guest virtual machine, the original application name remains in the host **Start** menu. The program continues to run as expected, however the program will always retain the original name.\n\n**Solution**\n\nNone. This is a known behavior of Windows Virtual PC.\n\n**Moving a Shortcut in the Guest Virtual Machine does not Update the Location on the Host Computer Start Menu**. MED-V application shortcuts that are published to the host computer **Start** menu are cataloged in the registry. If you move an application shortcut into a subfolder, the registry is not updated to reflect the change.\n\n**Solution**\n\nFollow these steps to change the location of a MED-V application shortcut:\n\n1.  When MED-V is running, open up Windows Explorer on the MED-V guest virtual machine.\n\n2.  Browse to the \"%ALLUSERSPROFILE%\\\\Start Menu\\\\Programs\" directory.\n\n3.  Move the application shortcuts out of the startmenu or programs folders.\n\n4.  After about 30 seconds, validate that the shortcuts are removed from the host computer **Start** menu.\n\n5.  Move the application shortcuts back in to the new program folders under the Start Menu\\\\Programs directory.\n\n6.  After about 30 seconds, validate that the shortcuts are updated in the host computer **Start** Menu.\n\n**Published Applications can Time Out after Sitting Idle**. In some cases, published applications will time out if they have sat idle for some time. This situation only occurs if IPsec is enabled and the MED-V workspace is configured for NAT mode. This situation does not occur if running in BRIDGED mode.\n\n**Solution**\n\nDisable IPsec when you are running the MED-V workspace in NAT mode.\n\n**Pinning a Published Application to the Taskbar Bypasses MED-V**. If an end user pins a published application to the taskbar and then closes the application, MED-V is bypassed the next time that the application is opened from the taskbar icon. Instead, the application opens directly in a VMSAL window.\n\n**Solution**\n\nDo not pin the applications published in MED-V to the taskbar.\n\n## Related topics\n\n\n[Security Best Practices for MED-V Operations](security-best-practices-for-med-v-operations.md)\n\n[Deployment Troubleshooting](deployment-troubleshooting.md)\n\n \n\n \n\n\n\n\n\n"}