{"nodes":[{"content":"Get apps to run on Device Guard-protected devices (Windows 10)","pos":[11,73]},{"content":"Windows 10 introduces several new features and settings that when combined all equal what we're calling, Device Guard.","pos":[87,205]},{"content":"Get apps to run on Device Guard-protected devices","pos":[430,479]},{"content":"Applies to","pos":[483,493]},{"content":"Windows 10","pos":[500,510]},{"content":"Windows 10 introduces several new features and settings that when combined all equal what we're calling, Device Guard.","pos":[512,630]},{"content":"Device Guard can help to protect your enterprise devices against the accidental running of malicious apps by requiring all of your apps to be signed by a trusted entity.","pos":[631,800]},{"content":"To use Device Guard in an enterprise, you must be able to get your existing line-of-business and Independent Software Vendor (ISV)-developed apps to run on a protected device.","pos":[802,977]},{"content":"Unfortunately, many line-of-business apps aren't signed, and in many cases, aren't even being actively developed.","pos":[978,1091]},{"content":"Similarly, you may have unsigned software from an ISV that you want to run, or you want to run certain applications from an ISV while not trusting all applications from that ISV.","pos":[1092,1270]},{"content":"As part of the Device Guard features, Windows 10 includes a new tool called Package Inspector.","pos":[1271,1365]},{"content":"Package Inspector scans your unsigned apps, and creates catalog files of the installed and running binaries, which can then be signed by the Sign Tool Windows SDK utility and distributed using Group Policy so that your apps will run on Device Guard-protected devices.","pos":[1366,1633]},{"content":"What you need to run your apps on Device-Guard protected devices","pos":[1638,1702]},{"content":"Before you can get your apps to run on Device Guard-protected devices, you must have:","pos":[1704,1789]},{"content":"A device running Windows 10 Enterprise, Windows 10 Education, or Windows Server 2016 Technical Preview.","pos":[1795,1898]},{"content":"Determined which unsigned apps you need to include in your catalog file.","pos":[1903,1975]},{"content":"Created a code integrity policy for use by Device Guard.","pos":[1980,2036]},{"pos":[2041,2178],"content":"A <bpt id=\"p1\">[</bpt>code signing certificate<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619282)</ept>, created using an internal public key infrastructure (PKI)."},{"content":"<bpt id=\"p1\">[</bpt>SignTool<ept id=\"p1\">]( http://go.microsoft.com/fwlink/p/?LinkId=619283)</ept>.","pos":[2183,2244]},{"content":"A command-line tool that digitally signs files, verifies signatures in files, or time stamps files.","pos":[2245,2344]},{"content":"The tool is installed in the <ph id=\"ph1\">\\\\</ph>Bin folder of the Microsoft Windows Software Development Kit (SDK) installation path.","pos":[2345,2461]},{"content":"Create a catalog file for unsigned apps","pos":[2466,2505]},{"content":"You must run Package Inspector on a device that's running a temporary Code Integrity Policy in audit mode, created explicitly for this purpose.","pos":[2507,2650]},{"content":"Audit mode lets this policy catch any binaries missed by the inspection tool, but because it's audit mode, allows everything to continue running.","pos":[2651,2796]},{"pos":[2799,2885],"content":"<bpt id=\"p1\">**</bpt>Important:<ept id=\"p1\">**</ept>  This temporary policy, shouldn't be used for normal business purposes."},{"content":"To create a catalog file for an existing app","pos":[2890,2934]},{"content":"Start PowerShell as an administrator, and create your temporary policy file by typing:","pos":[2941,3027]},{"content":"Restart your device.","pos":[3254,3274]},{"content":"Start PowerShell as an administrator, and start scanning your file system by typing:","pos":[3279,3363]},{"pos":[3425,4041],"content":"Where:\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Option</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>start &lt;<em>drive_letter</em>&gt;:</p></td>\n<td align=\"left\"><p>Specifies to start a scan. For example, starting to scan the C: drive.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>-path</p></td>\n<td align=\"left\"><p>File path to the package being inspected.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Where:","pos":[0,6]},{"content":"Option","pos":[123,129]},{"content":"Description","pos":[152,163]},{"content":"start <ph id=\"ph1\">&amp;lt;&lt;em&gt;</ph>drive_letter<ph id=\"ph2\">&lt;/em&gt;&amp;gt;</ph>:","pos":[229,265]},{"content":"Specifies to start a scan. For example, starting to scan the C: drive.","pos":[295,365],"nodes":[{"content":"Specifies to start a scan.","pos":[0,26]},{"content":"For example, starting to scan the C: drive.","pos":[27,70]}]},{"content":"-path","pos":[419,424]},{"content":"File path to the package being inspected.","pos":[454,495]}]},{"content":"Copy the app installation media to your C:<ph id=\"ph1\">\\\\</ph> drive, and then install and run the program.","pos":[4052,4141]},{"content":"Copying the media to your local drive helps to make sure that the installer and its related files are included in your catalog file.","pos":[4147,4279]},{"content":"If you miss the install files, your Code Integrity Policy might trust the app to run, but not to install.","pos":[4280,4385]},{"content":"After you've installed the app, you should check for updates.","pos":[4386,4447]},{"content":"If updates happen while the app is open, you should close and restart the app to make sure everything is caught during the inspection process.","pos":[4448,4590]},{"pos":[4602,4820],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  Because the Package Inspector creates a log entry in the catalog for every binary laid down on the file system, we recommend that you don't run any other installations or updates during the scanning process."},{"content":"<bpt id=\"p1\">**</bpt>Optional:<ept id=\"p1\">**</ept> If you want to create a multi-app catalog (many apps included in a single catalog file), you can continue to run Steps 2-3 for each additional app.","pos":[4831,4992]},{"content":"After you've added all of the apps you want to add, you can continue to Step 5.","pos":[4993,5072]},{"content":"<bpt id=\"p1\">**</bpt>Note: <ept id=\"p1\">**</ept>  To streamline your process, we suggest: <ph id=\"ph1\">    -   </ph><bpt id=\"p2\">**</bpt>Actively supported and updated apps.<ept id=\"p2\">**</ept>","pos":[5079,5179]},{"content":"Create a single catalog file for each app.","pos":[5180,5222]},{"content":"Legacy apps, non-active or not updated.","pos":[5233,5272]},{"content":"Create a single catalog file for all of your legacy apps.","pos":[5275,5332]},{"content":"Stop the scanning process and create the .<ph id=\"ph1\">\\\\</ph>InspectedPackage.cat and InspectedPackage.cdf files for your single app in your specified location, by typing:","pos":[5343,5497]},{"content":"You can also use the <ph id=\"ph1\">`scan`</ph> command in place of using both <ph id=\"ph2\">`start`</ph> and <ph id=\"ph3\">`stop`</ph> if you want to create a catalog of files that are already present on your hard drive.","pos":[5554,5717]},{"content":"The <ph id=\"ph1\">`scan`</ph> command recursively scans a specified directory and includes all signable files in the catalog.","pos":[5718,5824]},{"content":"You can scan a specified directory by typing:","pos":[5825,5870]},{"pos":[5939,6027],"content":"The following table shows the available options for both the <ph id=\"ph1\">`scan`</ph> and <ph id=\"ph2\">`stop`</ph> commands."},{"content":"Option","pos":[6144,6150]},{"content":"Description","pos":[6173,6184]},{"content":"stop <ph id=\"ph1\">&amp;lt;&lt;em&gt;</ph>drive_letter<ph id=\"ph2\">&lt;/em&gt;&amp;gt;</ph>:","pos":[6250,6285]},{"content":"Specifies that a scan of the specified location is complete, creating either a catalog or a definition file.","pos":[6315,6423]},{"content":"For example, <ph id=\"ph1\">&lt;em&gt;</ph>C:","pos":[6424,6443]},{"content":"scan <ph id=\"ph1\">&lt;em&gt;&amp;lt;</ph>path to scan","pos":[6502,6527]},{"content":"Specifies a directory path to scan.","pos":[6566,6601]},{"content":"This command recursively scans a specified directory and includes all signable files in the catalog.","pos":[6602,6702]},{"content":"-out","pos":[6755,6759]},{"content":"Specifies what type of info should be created by the tool.","pos":[6789,6847]},{"content":"You can use either <ph id=\"ph1\">&lt;code&gt;CAT&lt;/code&gt;</ph> for a catalog file, <ph id=\"ph2\">&lt;code&gt;CDF&lt;/code&gt;</ph> for a catalog definition file or <ph id=\"ph3\">&lt;code&gt;list&lt;/code&gt;</ph> for a delimited list of files.","pos":[6848,7002]},{"content":"-listpath","pos":[7056,7065]},{"content":"Specifies the location where the installer will output the list of files for <ph id=\"ph1\">&lt;code&gt;-out list&lt;/code&gt;</ph>.","pos":[7095,7195]},{"content":"-cdfPath <ph id=\"ph1\">&amp;lt;&lt;em&gt;</ph>file_name","pos":[7248,7274]},{"content":"Specifies where the tool should put the created .cdf file.","pos":[7313,7371]},{"content":"If you use this option, you must also specify the file name.","pos":[7372,7432]},{"content":"We recommend that you use the full path to the file.","pos":[7440,7492]},{"content":"However, relative paths are supported.","pos":[7493,7531]},{"content":"-resdir","pos":[7585,7592]},{"content":"This option isn't currently supported.","pos":[7622,7660]},{"content":"-name","pos":[7713,7718]},{"content":"This option isn't currently supported.","pos":[7748,7786]},{"content":"-ph","pos":[7840,7843]},{"content":"Specifies whether to include page hashes in the catalog.","pos":[7899,7955]},{"content":"You can use either <ph id=\"ph1\">&lt;code&gt;True&lt;/code&gt;</ph> to add the hashes or <ph id=\"ph2\">&lt;code&gt;False&lt;/code&gt;</ph> to not add the hashes.","pos":[7956,8055]},{"content":"-en","pos":[8108,8111]},{"content":"Specifies the catalog's encoding type.","pos":[8141,8179]},{"content":"By default, it's PKCS_7_ASN_ENCODING | X509_ASN_ENCODING, 0x00010001.","pos":[8180,8249]},{"content":"-ca1","pos":[8303,8307]},{"content":"Specifies the CATATTR1 in the catalog and catalog definition files.","pos":[8337,8404]},{"content":"-ca2","pos":[8457,8461]},{"content":"Specifies the CATATTR2 in the catalog and catalog definition files.","pos":[8491,8558]},{"content":"You can add additional parameters to your catalog beyond what's listed here.","pos":[8594,8670]},{"content":"For more info, see the <bpt id=\"p1\">[</bpt>MakeCat<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=618024)</ept> topic.","pos":[8671,8759]},{"content":"Sign your catalog file using Sign Tool","pos":[8764,8802]},{"content":"You can sign your catalog file using Sign Tool, located in the Windows 7 or later Windows Software Development Kit (SDK) or by using the Device Guard signing portal.","pos":[8804,8969]},{"content":"For details on using the Device Guard signing portal, see <bpt id=\"p1\">[</bpt>Device Guard signing<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=698760)</ept>.","pos":[8970,9100]},{"content":"This process shows how to use a password-protected Personal Information Exchange (.pfx) file to sign the catalog file.","pos":[9101,9219]},{"pos":[9223,9417],"content":"<bpt id=\"p1\">**</bpt>Important:<ept id=\"p1\">**</ept>  To use this tool, you must have an internal certificate authority code signing certificate, or a code signing certificate issued by an external third-party certificate authority."},{"content":"To use Sign Tool","pos":[9422,9438]},{"content":"Check that your code signing certificates have been imported into your certificate store or that they're on the file system.","pos":[9446,9570]},{"pos":[9575,9720],"content":"Open SignTool.exe and sign the catalog file, based on where your certificate is stored.\nIf you are using the PFX from a file system location:","leadings":["","    "],"nodes":[{"content":"Open SignTool.exe and sign the catalog file, based on where your certificate is stored.","pos":[0,87]},{"content":"If you are using the PFX from a file system location:","pos":[88,141]}]},{"content":"If you have imported the certificate into your cert store:","pos":[9820,9878]},{"pos":[9986,11968],"content":"Where:\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Option</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>signtool</p></td>\n<td align=\"left\"><p>Specifies the full path location to SignTool.exe.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>sign</p></td>\n<td align=\"left\"><p>Digitally signs files. For a list of the options supported by the sign command, see the [SignTool options](http://go.microsoft.com/fwlink/p/?LinkId=619283).</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>/n <em>SubjectName</em></p></td>\n<td align=\"left\"><p>Specifies the name of the subject of the signing certificate. This value can be a substring of the entire subject name.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>/f <em>SignCertFileLocation</em></p></td>\n<td align=\"left\"><p>Specifies the signing certificate in a file.</p>\n<p>If the file is in .pfx format and protected by a password, use the /p option to specify the password. If the file does not contain private keys, use the /csp and /k options to specify the .csp and private key container name.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>/p <em>Password</em></p></td>\n<td align=\"left\"><p>Specifies the password to use when opening a PFX file. (Use the /f option to specify a PFX file.)</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>/fd <em>Algorithm</em></p></td>\n<td align=\"left\"><p>Specifies the file digest algorithm to use for creating file signatures. The default is SHA2.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>/v</p></td>\n<td align=\"left\"><p>Displays verbose output regardless of whether the command runs successfully or fails, and displays warning messages.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Where:","pos":[0,6]},{"content":"Option","pos":[123,129]},{"content":"Description","pos":[152,163]},{"content":"signtool","pos":[229,237]},{"content":"Specifies the full path location to SignTool.exe.","pos":[267,316]},{"content":"sign","pos":[370,374]},{"content":"Digitally signs files. For a list of the options supported by the sign command, see the [SignTool options](http://go.microsoft.com/fwlink/p/?LinkId=619283).","pos":[404,560],"nodes":[{"content":"Digitally signs files.","pos":[0,22]},{"content":"For a list of the options supported by the sign command, see the <bpt id=\"p1\">[</bpt>SignTool options<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619283)</ept>.","pos":[23,156]}]},{"content":"/n <ph id=\"ph1\">&lt;em&gt;</ph>SubjectName","pos":[613,631]},{"content":"Specifies the name of the subject of the signing certificate. This value can be a substring of the entire subject name.","pos":[666,785],"nodes":[{"content":"Specifies the name of the subject of the signing certificate.","pos":[0,61]},{"content":"This value can be a substring of the entire subject name.","pos":[62,119]}]},{"content":"/f <ph id=\"ph1\">&lt;em&gt;</ph>SignCertFileLocation","pos":[839,866]},{"content":"Specifies the signing certificate in a file.","pos":[901,945]},{"content":"If the file is in .pfx format and protected by a password, use the /p option to specify the password. If the file does not contain private keys, use the /csp and /k options to specify the .csp and private key container name.","pos":[953,1177],"nodes":[{"content":"If the file is in .pfx format and protected by a password, use the /p option to specify the password.","pos":[0,101]},{"content":"If the file does not contain private keys, use the /csp and /k options to specify the .csp and private key container name.","pos":[102,224]}]},{"content":"/p <ph id=\"ph1\">&lt;em&gt;</ph>Password","pos":[1230,1245]},{"content":"Specifies the password to use when opening a PFX file. (Use the /f option to specify a PFX file.)","pos":[1280,1377],"nodes":[{"content":"Specifies the password to use when opening a PFX file.","pos":[0,54]},{"content":"(Use the /f option to specify a PFX file.)","pos":[55,97]}]},{"content":"/fd <ph id=\"ph1\">&lt;em&gt;</ph>Algorithm","pos":[1431,1448]},{"content":"Specifies the file digest algorithm to use for creating file signatures. The default is SHA2.","pos":[1483,1576],"nodes":[{"content":"Specifies the file digest algorithm to use for creating file signatures.","pos":[0,72]},{"content":"The default is SHA2.","pos":[73,93]}]},{"content":"/v","pos":[1629,1631]},{"content":"Displays verbose output regardless of whether the command runs successfully or fails, and displays warning messages.","pos":[1661,1777]}]},{"pos":[11979,12134],"content":"For more detailed info and examples using the available options, see the <bpt id=\"p1\">[</bpt>SignTool.exe (Sign Tool)<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=618026)</ept> topic."},{"pos":[12144,12324],"content":"In File Explorer, right-click your catalog file, click <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept>, and then click the <bpt id=\"p2\">**</bpt>Digital Signatures<ept id=\"p2\">**</ept> tab to make sure your catalog file's digital signature is accurate."},{"content":"Copy your catalog file to C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>System32<ph id=\"ph3\">\\\\</ph>catroot<ph id=\"ph4\">\\\\</ph>{F750E6C3-38EE-11D1-85E5-00C04FC295EE} and test the file.","pos":[12329,12444]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  For testing purposes, you can manually copy your file to this location.","pos":[12451,12533]},{"content":"However, we recommend that you use Group Policy to copy the catalog file to all of your devices for large-scale implementations.","pos":[12534,12662]},{"content":"Troubleshooting the Package Inspector","pos":[12671,12708]},{"content":"If you see \"Error 1181\" while stopping the Package Inspector, you'll need to increase your USN journal size and then clear all of the cached data before re-scanning the impacted apps.","pos":[12710,12893]},{"content":"You must make sure that you clear the cache by creating and setting a new temporary policy.","pos":[12895,12986]},{"content":"If you reuse the same policy, the Package Inspector will fail.","pos":[12987,13049]},{"content":"To increase your journal size","pos":[13053,13082]},{"content":"Open a command-prompt window, and then type:","pos":[13089,13133]},{"content":"Where the \"m\" value needs to be increased.","pos":[13216,13258]},{"content":"We recommend that you change the value to at least 4 times the default value of m=0x2000000.","pos":[13259,13351]},{"content":"Re-run the failed app installation(s).","pos":[13356,13394]},{"content":"To clear your cached data and re-scan your apps","pos":[13398,13445]},{"content":"Delete the SIPolicy.p7b file from the C:<ph id=\"ph1\">\\\\</ph>Windows<ph id=\"ph2\">\\\\</ph>System32<ph id=\"ph3\">\\\\</ph>CodeIntegrity<ph id=\"ph4\">\\\\</ph> folder.","pos":[13453,13537]},{"content":"Create a new temporary Code Integrity Policy to clear all of the cached data by starting Windows Powershell as an administrator and typing:","pos":[13542,13681]},{"pos":[14000,14140],"content":"Restart your device and follow the steps in the <bpt id=\"p1\">[</bpt>Create a catalog file for unsigned apps<ept id=\"p1\">](#create-a-catalog-file-for-unsigned-apps)</ept> section."},{"content":"Related topics","pos":[14145,14159]},{"content":"Download SignTool","pos":[14162,14179]}],"content":"---\ntitle: Get apps to run on Device Guard-protected devices (Windows 10)\ndescription: Windows 10 introduces several new features and settings that when combined all equal what we're calling, Device Guard.\nms.assetid: E62B68C3-8B9F-4842-90FC-B4EE9FF8A67E\nkeywords: Package Inspector, packageinspector.exe, sign catalog file\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Get apps to run on Device Guard-protected devices\n\n**Applies to**\n-   Windows 10\n\nWindows 10 introduces several new features and settings that when combined all equal what we're calling, Device Guard. Device Guard can help to protect your enterprise devices against the accidental running of malicious apps by requiring all of your apps to be signed by a trusted entity.\n\nTo use Device Guard in an enterprise, you must be able to get your existing line-of-business and Independent Software Vendor (ISV)-developed apps to run on a protected device. Unfortunately, many line-of-business apps aren't signed, and in many cases, aren't even being actively developed. Similarly, you may have unsigned software from an ISV that you want to run, or you want to run certain applications from an ISV while not trusting all applications from that ISV. As part of the Device Guard features, Windows 10 includes a new tool called Package Inspector. Package Inspector scans your unsigned apps, and creates catalog files of the installed and running binaries, which can then be signed by the Sign Tool Windows SDK utility and distributed using Group Policy so that your apps will run on Device Guard-protected devices.\n\n## What you need to run your apps on Device-Guard protected devices\n\nBefore you can get your apps to run on Device Guard-protected devices, you must have:\n\n-   A device running Windows 10 Enterprise, Windows 10 Education, or Windows Server 2016 Technical Preview.\n-   Determined which unsigned apps you need to include in your catalog file.\n-   Created a code integrity policy for use by Device Guard.\n-   A [code signing certificate](http://go.microsoft.com/fwlink/p/?LinkId=619282), created using an internal public key infrastructure (PKI).\n-   [SignTool]( http://go.microsoft.com/fwlink/p/?LinkId=619283). A command-line tool that digitally signs files, verifies signatures in files, or time stamps files. The tool is installed in the \\\\Bin folder of the Microsoft Windows Software Development Kit (SDK) installation path.\n\n## Create a catalog file for unsigned apps\n\nYou must run Package Inspector on a device that's running a temporary Code Integrity Policy in audit mode, created explicitly for this purpose. Audit mode lets this policy catch any binaries missed by the inspection tool, but because it's audit mode, allows everything to continue running.\n> **Important:**  This temporary policy, shouldn't be used for normal business purposes.\n \n**To create a catalog file for an existing app**\n1.  Start PowerShell as an administrator, and create your temporary policy file by typing:\n    ``` syntax\n    mkdir temp\n    New-CIPolicy -l FileName -f .\\tempdeny.xml -s .\\temp -u\n    ConvertFrom-CIPolicy .\\tempdeny.xml .\\tempdeny.bin\n    cp .\\tempdeny.bin C:\\Windows\\System32\\CodeIntegrity\\SIPolicy.p7b\n    ```\n2.  Restart your device.\n3.  Start PowerShell as an administrator, and start scanning your file system by typing:\n    ``` syntax\n    PackageInspector.exe start c:\n    ```\n    Where:\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\">Option</th>\n    <th align=\"left\">Description</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>start &lt;<em>drive_letter</em>&gt;:</p></td>\n    <td align=\"left\"><p>Specifies to start a scan. For example, starting to scan the C: drive.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>-path</p></td>\n    <td align=\"left\"><p>File path to the package being inspected.</p></td>\n    </tr>\n    </tbody>\n    </table>\n     \n4.  Copy the app installation media to your C:\\\\ drive, and then install and run the program.\n\n    Copying the media to your local drive helps to make sure that the installer and its related files are included in your catalog file. If you miss the install files, your Code Integrity Policy might trust the app to run, but not to install. After you've installed the app, you should check for updates. If updates happen while the app is open, you should close and restart the app to make sure everything is caught during the inspection process.\n    \n    > **Note:**  Because the Package Inspector creates a log entry in the catalog for every binary laid down on the file system, we recommend that you don't run any other installations or updates during the scanning process.\n     \n5.  **Optional:** If you want to create a multi-app catalog (many apps included in a single catalog file), you can continue to run Steps 2-3 for each additional app. After you've added all of the apps you want to add, you can continue to Step 5.\n    > **Note: **  To streamline your process, we suggest:\n    -   **Actively supported and updated apps.** Create a single catalog file for each app.\n    -   **Legacy apps, non-active or not updated.** Create a single catalog file for all of your legacy apps.\n     \n6.  Stop the scanning process and create the .\\\\InspectedPackage.cat and InspectedPackage.cdf files for your single app in your specified location, by typing:\n    ``` syntax\n    PackageInspector.exe stop c:\n    ```\nYou can also use the `scan` command in place of using both `start` and `stop` if you want to create a catalog of files that are already present on your hard drive. The `scan` command recursively scans a specified directory and includes all signable files in the catalog. You can scan a specified directory by typing:\n``` syntax\nPackageInspector.exe scan c:\\<insert directory path>\n```\nThe following table shows the available options for both the `scan` and `stop` commands.\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Option</th>\n<th align=\"left\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>stop &lt;<em>drive_letter</em>&gt;:</p></td>\n<td align=\"left\"><p>Specifies that a scan of the specified location is complete, creating either a catalog or a definition file. For example, <em>C:</em></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>scan <em>&lt;path to scan&gt;</em></p></td>\n<td align=\"left\"><p>Specifies a directory path to scan. This command recursively scans a specified directory and includes all signable files in the catalog.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>-out</p></td>\n<td align=\"left\"><p>Specifies what type of info should be created by the tool. You can use either <code>CAT</code> for a catalog file, <code>CDF</code> for a catalog definition file or <code>list</code> for a delimited list of files.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>-listpath</p></td>\n<td align=\"left\"><p>Specifies the location where the installer will output the list of files for <code>-out list</code>.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>-cdfPath &lt;<em>file_name</em>&gt;</p></td>\n<td align=\"left\"><p>Specifies where the tool should put the created .cdf file. If you use this option, you must also specify the file name.</p>\n<p>We recommend that you use the full path to the file. However, relative paths are supported.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>-resdir</p></td>\n<td align=\"left\"><p>This option isn't currently supported.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>-name</p></td>\n<td align=\"left\"><p>This option isn't currently supported.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>-ph <code>[true|false]</code></p></td>\n<td align=\"left\"><p>Specifies whether to include page hashes in the catalog. You can use either <code>True</code> to add the hashes or <code>False</code> to not add the hashes.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>-en</p></td>\n<td align=\"left\"><p>Specifies the catalog's encoding type. By default, it's PKCS_7_ASN_ENCODING | X509_ASN_ENCODING, 0x00010001.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>-ca1</p></td>\n<td align=\"left\"><p>Specifies the CATATTR1 in the catalog and catalog definition files.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>-ca2</p></td>\n<td align=\"left\"><p>Specifies the CATATTR2 in the catalog and catalog definition files.</p></td>\n</tr>\n</tbody>\n</table>\n \nYou can add additional parameters to your catalog beyond what's listed here. For more info, see the [MakeCat](http://go.microsoft.com/fwlink/p/?LinkId=618024) topic.\n\n## Sign your catalog file using Sign Tool\n\nYou can sign your catalog file using Sign Tool, located in the Windows 7 or later Windows Software Development Kit (SDK) or by using the Device Guard signing portal. For details on using the Device Guard signing portal, see [Device Guard signing](http://go.microsoft.com/fwlink/p/?LinkID=698760).\nThis process shows how to use a password-protected Personal Information Exchange (.pfx) file to sign the catalog file.\n\n> **Important:**  To use this tool, you must have an internal certificate authority code signing certificate, or a code signing certificate issued by an external third-party certificate authority.\n \n**To use Sign Tool**\n\n1.  Check that your code signing certificates have been imported into your certificate store or that they're on the file system.\n2.  Open SignTool.exe and sign the catalog file, based on where your certificate is stored.\n    If you are using the PFX from a file system location:\n    ``` syntax\n    signtool sign /f <\\\\SignCertLocation> /p <\\\\password> /fd sha256 /v\n    ```\n    If you have imported the certificate into your cert store:\n    ``` syntax\n    signtool sign /n <\\\\CertSubjectName> /fd sha256 /v <CatalogNameAndLocation>\n    ```\n    Where:\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\">Option</th>\n    <th align=\"left\">Description</th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>signtool</p></td>\n    <td align=\"left\"><p>Specifies the full path location to SignTool.exe.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>sign</p></td>\n    <td align=\"left\"><p>Digitally signs files. For a list of the options supported by the sign command, see the [SignTool options](http://go.microsoft.com/fwlink/p/?LinkId=619283).</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>/n <em>SubjectName</em></p></td>\n    <td align=\"left\"><p>Specifies the name of the subject of the signing certificate. This value can be a substring of the entire subject name.</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>/f <em>SignCertFileLocation</em></p></td>\n    <td align=\"left\"><p>Specifies the signing certificate in a file.</p>\n    <p>If the file is in .pfx format and protected by a password, use the /p option to specify the password. If the file does not contain private keys, use the /csp and /k options to specify the .csp and private key container name.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>/p <em>Password</em></p></td>\n    <td align=\"left\"><p>Specifies the password to use when opening a PFX file. (Use the /f option to specify a PFX file.)</p></td>\n    </tr>\n    <tr class=\"even\">\n    <td align=\"left\"><p>/fd <em>Algorithm</em></p></td>\n    <td align=\"left\"><p>Specifies the file digest algorithm to use for creating file signatures. The default is SHA2.</p></td>\n    </tr>\n    <tr class=\"odd\">\n    <td align=\"left\"><p>/v</p></td>\n    <td align=\"left\"><p>Displays verbose output regardless of whether the command runs successfully or fails, and displays warning messages.</p></td>\n    </tr>\n    </tbody>\n    </table>\n     \n    For more detailed info and examples using the available options, see the [SignTool.exe (Sign Tool)](http://go.microsoft.com/fwlink/p/?LinkId=618026) topic.\n    \n3.  In File Explorer, right-click your catalog file, click **Properties**, and then click the **Digital Signatures** tab to make sure your catalog file's digital signature is accurate.\n4.  Copy your catalog file to C:\\\\Windows\\\\System32\\\\catroot\\\\{F750E6C3-38EE-11D1-85E5-00C04FC295EE} and test the file.\n\n    >**Note:**  For testing purposes, you can manually copy your file to this location. However, we recommend that you use Group Policy to copy the catalog file to all of your devices for large-scale implementations.\n    \n## Troubleshooting the Package Inspector\n\nIf you see \"Error 1181\" while stopping the Package Inspector, you'll need to increase your USN journal size and then clear all of the cached data before re-scanning the impacted apps.\n\nYou must make sure that you clear the cache by creating and setting a new temporary policy. If you reuse the same policy, the Package Inspector will fail.\n\n**To increase your journal size**\n1.  Open a command-prompt window, and then type:\n    ``` syntax\n    fsutil usn createjournal m=0x8000000 a=0x800000 C:\n    ```\n    Where the \"m\" value needs to be increased. We recommend that you change the value to at least 4 times the default value of m=0x2000000.\n2.  Re-run the failed app installation(s).\n\n**To clear your cached data and re-scan your apps**\n\n1.  Delete the SIPolicy.p7b file from the C:\\\\Windows\\\\System32\\\\CodeIntegrity\\\\ folder.\n2.  Create a new temporary Code Integrity Policy to clear all of the cached data by starting Windows Powershell as an administrator and typing:\n    ``` syntax\n    mkdir temp\n    cp C:\\Windows\\System32\\PackageInspector.exe .\\temp\\\n    New-CIPolicy -l Hash -f .\\DenyPackageInspector.xml -s .\\temp -u -deny\n    ConvertFrom-CIPolicy .\\DenyPackageInspector.xml .\\DenyPackageInspector.bin\n    cp .\\DenyPackageInspector.bin C:\\Windows\\System32\\SIPolicy.p7b\n    ```\n3.  Restart your device and follow the steps in the [Create a catalog file for unsigned apps](#create-a-catalog-file-for-unsigned-apps) section.\n\n## Related topics\n\n[Download SignTool]( http://go.microsoft.com/fwlink/p/?LinkId=619283)\n"}