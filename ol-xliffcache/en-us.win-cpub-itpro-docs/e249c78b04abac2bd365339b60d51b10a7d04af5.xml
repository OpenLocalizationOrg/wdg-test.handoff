{"nodes":[{"content":"Use web services in MDT (Windows 10)","pos":[11,47]},{"content":"In this topic, you will learn how to create a simple web service that generates computer names and then configure MDT to use that service during your Windows 10 deployment.","pos":[61,233]},{"content":"Use web services in MDT","pos":[407,430]},{"content":"In this topic, you will learn how to create a simple web service that generates computer names and then configure MDT to use that service during your Windows 10 deployment.","pos":[432,604]},{"content":"Web services provide a powerful way to assign settings during a deployment.","pos":[605,680]},{"content":"Simply put, web services are web applications that run code on the server side, and MDT has built-in functions to call these web services.","pos":[681,819]},{"content":"Using a web service in MDT is straightforward, but it does require that you have enabled the Web Server (IIS) role on the server.","pos":[820,949]},{"content":"Developing web services involves a little bit of coding, but for most web services used with MDT, you can use the free Microsoft Visual Studio Express 2013 for Web.","pos":[950,1114]},{"pos":[1145,1172],"content":"Create a sample web service"},{"pos":[1174,1458],"content":"In these steps we assume you have installed Microsoft Visual Studio Express 2013 for Web on PC0001 (the Windows 10 client) and downloaded the <bpt id=\"p1\">[</bpt>MDT Sample Web Service<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=619363)</ept> from the Microsoft Download Center and extracted it to C:<ph id=\"ph1\">\\\\</ph>Projects."},{"content":"On PC0001, using Visual Studio Express 2013 for Web, open the C:<ph id=\"ph1\">\\\\</ph>Projects<ph id=\"ph2\">\\\\</ph>MDTSample<ph id=\"ph3\">\\\\</ph> MDTSample.sln solution file.","pos":[1463,1579]},{"content":"On the ribbon bar, verify that Release is selected.","pos":[1584,1635]},{"pos":[1640,1701],"content":"In the <bpt id=\"p1\">**</bpt>Debug<ept id=\"p1\">**</ept> menu, select the <bpt id=\"p2\">**</bpt>Build MDTSample<ept id=\"p2\">**</ept> action."},{"pos":[1706,1769],"content":"On MDT01, create a folder structure for <bpt id=\"p1\">**</bpt>E:<ph id=\"ph1\">\\\\</ph>MDTSample<ph id=\"ph2\">\\\\</ph>bin<ept id=\"p1\">**</ept>."},{"pos":[1774,1900],"content":"From PC0001, copy the C:<ph id=\"ph1\">\\\\</ph>Projects<ph id=\"ph2\">\\\\</ph>MDTSample<ph id=\"ph3\">\\\\</ph>obj<ph id=\"ph4\">\\\\</ph>Release<ph id=\"ph5\">\\\\</ph>MDTSample.dll file to the <bpt id=\"p1\">**</bpt>E:<ph id=\"ph6\">\\\\</ph>MDTSample<ph id=\"ph7\">\\\\</ph>bin<ept id=\"p1\">**</ept> folder on MDT01."},{"pos":[1905,2018],"content":"From PC0001, copy the following files from C:<ph id=\"ph1\">\\\\</ph>Projects<ph id=\"ph2\">\\\\</ph>MDTSample file to the <bpt id=\"p1\">**</bpt>E:<ph id=\"ph3\">\\\\</ph>MDTSample<ept id=\"p1\">**</ept> folder on MDT01:"},{"content":"Web.config","pos":[2027,2037]},{"content":"mdtsample.asmx","pos":[2046,2060]},{"content":"figure 15","pos":[2064,2073]},{"content":"Figure 15.","pos":[2101,2111]},{"content":"The sample project in Microsoft Visual Studio Express 2013 for Web.","pos":[2112,2179]},{"pos":[2210,2256],"content":"Create an application pool for the web service"},{"content":"This section assumes that you have enabled the Web Server (IIS) role on MDT01.","pos":[2258,2336]},{"pos":[2341,2471],"content":"On MDT01, using Server Manager, install the <bpt id=\"p1\">**</bpt>IIS Management Console<ept id=\"p1\">**</ept> role (available under Web Server (IIS) / Management Tools)."},{"content":"Using Internet Information Services (IIS) Manager, expand the <bpt id=\"p1\">**</bpt>MDT01 (CONTOSO<ph id=\"ph1\">\\\\</ph>Administrator)<ept id=\"p1\">**</ept> node.","pos":[2476,2578]},{"content":"If prompted with the \"Do you want to get started with Microsoft Web Platform?\"","pos":[2579,2657]},{"content":"question, select the <bpt id=\"p1\">**</bpt>Do not show this message<ept id=\"p1\">**</ept> check box and then click <bpt id=\"p2\">**</bpt>No<ept id=\"p2\">**</ept>.","pos":[2658,2740]},{"pos":[2745,2880],"content":"Right-click <bpt id=\"p1\">**</bpt>Application Pools<ept id=\"p1\">**</ept>, select <bpt id=\"p2\">**</bpt>Add Application Pool<ept id=\"p2\">**</ept>, and configure the new application pool with the following settings:"},{"content":"Name: MDTSample","pos":[2889,2904]},{"content":".NET Framework version: .NET Framework 4.0.30319","pos":[2913,2961]},{"content":"Manage pipeline mode: Integrated","pos":[2970,3002]},{"pos":[3011,3071],"content":"Select the <bpt id=\"p1\">**</bpt>Start application pool immediately<ept id=\"p1\">**</ept> check box."},{"pos":[3080,3093],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>."},{"content":"figure 16","pos":[3097,3106]},{"content":"Figure 16.","pos":[3134,3144]},{"content":"The new MDTSample application.","pos":[3145,3175]},{"pos":[3206,3229],"content":"Install the web service"},{"content":"On MDT01, using Internet Information Services (IIS) Manager, expand <bpt id=\"p1\">**</bpt>Sites<ept id=\"p1\">**</ept>, right-click <bpt id=\"p2\">**</bpt>Default Web Site<ept id=\"p2\">**</ept>, and select <bpt id=\"p3\">**</bpt>Add Application<ept id=\"p3\">**</ept>.","pos":[3235,3379]},{"content":"Use the following settings for the application:","pos":[3380,3427]},{"content":"Alias: MDTSample","pos":[3436,3452]},{"content":"Application pool: MDTSample","pos":[3461,3488]},{"content":"Physical Path: E:<ph id=\"ph1\">\\\\</ph>MDTSample","pos":[3497,3525]},{"content":"figure 17","pos":[3533,3542]},{"content":"Figure 17.","pos":[3574,3584]},{"content":"Adding the MDTSample web application.","pos":[3585,3622]},{"content":"In the <bpt id=\"p1\">**</bpt>Default Web Site<ept id=\"p1\">**</ept> node, select the MDTSample web application, and in the right pane, double-click <bpt id=\"p2\">**</bpt>Authentication<ept id=\"p2\">**</ept>.","pos":[3628,3755]},{"content":"Use the following settings for the <bpt id=\"p1\">**</bpt>Authentication<ept id=\"p1\">**</ept> dialog box:","pos":[3756,3821]},{"content":"Anonymous Authentication: Enabled","pos":[3830,3863]},{"content":"ASP.NET Impersonation: Disabled","pos":[3872,3903]},{"content":"figure 18","pos":[3907,3916]},{"content":"Figure 18.","pos":[3944,3954]},{"content":"Configuring Authentication for the MDTSample web service.","pos":[3955,4012]},{"pos":[4043,4084],"content":"Test the web service in Internet Explorer"},{"pos":[4090,4181],"content":"On PC0001, using Internet Explorer, navigate to: <bpt id=\"p1\">**</bpt>http://MDT01/MDTSample/mdtsample.asmx<ept id=\"p1\">**</ept>."},{"pos":[4186,4221],"content":"Click the <bpt id=\"p1\">**</bpt>GetComputerName<ept id=\"p1\">**</ept> link."},{"content":"figure 19","pos":[4229,4238]},{"content":"Figure 19.","pos":[4270,4280]},{"content":"The MDT Sample web service.","pos":[4281,4308]},{"pos":[4313,4399],"content":"On the <bpt id=\"p1\">**</bpt>GetComputerName<ept id=\"p1\">**</ept> page, type in the following settings, and click <bpt id=\"p2\">**</bpt>Invoke<ept id=\"p2\">**</ept>:"},{"content":"Model: Hewlett-Packard","pos":[4408,4430]},{"content":"SerialNumber: 123456789","pos":[4439,4462]},{"content":"figure 20","pos":[4466,4475]},{"content":"Figure 20.","pos":[4503,4513]},{"content":"The result from the MDT Sample web service.","pos":[4514,4557]},{"pos":[4588,4642],"content":"Test the web service in the MDT simulation environment"},{"content":"After verifying the web service using Internet Explorer, you are ready to do the same test in the MDT simulation environment.","pos":[4644,4769]},{"pos":[4775,4872],"content":"On PC0001, edit the CustomSettings.ini file in the <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>MDT<ept id=\"p1\">**</ept> folder to look like the following:"},{"content":"figure 21","pos":[5139,5148]},{"content":"Figure 21.","pos":[5180,5190]},{"content":"The updated CustomSettings.ini file.","pos":[5191,5227]},{"content":"Save the CustomSettings.ini file.","pos":[5233,5266]},{"content":"Using an elevated Windows PowerShell prompt (run as Administrator), run the following commands.","pos":[5271,5366]},{"content":"Press <bpt id=\"p1\">**</bpt>Enter<ept id=\"p1\">**</ept> after each command:","pos":[5367,5402]},{"pos":[5471,5542],"content":"Review the ZTIGather.log in the <bpt id=\"p1\">**</bpt>C:<ph id=\"ph1\">\\\\</ph>MININT<ph id=\"ph2\">\\\\</ph>SMSOSD<ph id=\"ph3\">\\\\</ph>OSDLOGS<ept id=\"p1\">**</ept> folder."},{"content":"figure 22","pos":[5546,5555]},{"content":"Figure 22.","pos":[5583,5593]},{"content":"The OSDCOMPUTERNAME value obtained from the web service.","pos":[5594,5650]},{"content":"Related topics","pos":[5655,5669]},{"content":"Set up MDT for BitLocker","pos":[5672,5696]},{"content":"Configure MDT deployment share rules","pos":[5734,5770]},{"content":"Configure MDT for UserExit scripts","pos":[5815,5849]},{"content":"Simulate a Windows 10 deployment in a test environment","pos":[5897,5951]},{"content":"Use the MDT database to stage Windows 10 deployment information","pos":[6014,6077]},{"content":"Assign applications using roles in MDT","pos":[6149,6187]},{"content":"Use Orchestrator runbooks with MDT","pos":[6239,6273]}],"content":"---\ntitle: Use web services in MDT (Windows 10)\ndescription: In this topic, you will learn how to create a simple web service that generates computer names and then configure MDT to use that service during your Windows 10 deployment.\nms.assetid: 8f47535e-0551-4ccb-8f02-bb97539c6522\nkeywords: deploy, web apps\nms.prod: w10\nms.mktglfcycl: deploy\nms.pagetype: mdt\nms.sitesec: library\nauthor: mtniehaus\n---\n\n# Use web services in MDT\n\nIn this topic, you will learn how to create a simple web service that generates computer names and then configure MDT to use that service during your Windows 10 deployment. Web services provide a powerful way to assign settings during a deployment. Simply put, web services are web applications that run code on the server side, and MDT has built-in functions to call these web services.\nUsing a web service in MDT is straightforward, but it does require that you have enabled the Web Server (IIS) role on the server. Developing web services involves a little bit of coding, but for most web services used with MDT, you can use the free Microsoft Visual Studio Express 2013 for Web.\n\n## <a href=\"\" id=\"sec01\"></a>Create a sample web service\n\nIn these steps we assume you have installed Microsoft Visual Studio Express 2013 for Web on PC0001 (the Windows 10 client) and downloaded the [MDT Sample Web Service](http://go.microsoft.com/fwlink/p/?LinkId=619363) from the Microsoft Download Center and extracted it to C:\\\\Projects.\n1.  On PC0001, using Visual Studio Express 2013 for Web, open the C:\\\\Projects\\\\MDTSample\\\\ MDTSample.sln solution file.\n2.  On the ribbon bar, verify that Release is selected.\n3.  In the **Debug** menu, select the **Build MDTSample** action.\n4.  On MDT01, create a folder structure for **E:\\\\MDTSample\\\\bin**.\n5.  From PC0001, copy the C:\\\\Projects\\\\MDTSample\\\\obj\\\\Release\\\\MDTSample.dll file to the **E:\\\\MDTSample\\\\bin** folder on MDT01.\n6.  From PC0001, copy the following files from C:\\\\Projects\\\\MDTSample file to the **E:\\\\MDTSample** folder on MDT01:\n    1.  Web.config\n    2.  mdtsample.asmx\n\n![figure 15](images/mdt-09-fig15.png)\n\nFigure 15. The sample project in Microsoft Visual Studio Express 2013 for Web.\n\n## <a href=\"\" id=\"sec02\"></a>Create an application pool for the web service\n\nThis section assumes that you have enabled the Web Server (IIS) role on MDT01.\n1.  On MDT01, using Server Manager, install the **IIS Management Console** role (available under Web Server (IIS) / Management Tools).\n2.  Using Internet Information Services (IIS) Manager, expand the **MDT01 (CONTOSO\\\\Administrator)** node. If prompted with the \"Do you want to get started with Microsoft Web Platform?\" question, select the **Do not show this message** check box and then click **No**.\n3.  Right-click **Application Pools**, select **Add Application Pool**, and configure the new application pool with the following settings:\n    1.  Name: MDTSample\n    2.  .NET Framework version: .NET Framework 4.0.30319\n    3.  Manage pipeline mode: Integrated\n    4.  Select the **Start application pool immediately** check box.\n    5.  Click **OK**.\n\n![figure 16](images/mdt-09-fig16.png)\n\nFigure 16. The new MDTSample application.\n\n## <a href=\"\" id=\"sec03\"></a>Install the web service\n\n1.  On MDT01, using Internet Information Services (IIS) Manager, expand **Sites**, right-click **Default Web Site**, and select **Add Application**. Use the following settings for the application:\n    1.  Alias: MDTSample\n    2.  Application pool: MDTSample\n    3.  Physical Path: E:\\\\MDTSample\n\n    ![figure 17](images/mdt-09-fig17.png)\n\n    Figure 17. Adding the MDTSample web application.\n\n2.  In the **Default Web Site** node, select the MDTSample web application, and in the right pane, double-click **Authentication**. Use the following settings for the **Authentication** dialog box:\n    1.  Anonymous Authentication: Enabled\n    2.  ASP.NET Impersonation: Disabled\n\n![figure 18](images/mdt-09-fig18.png)\n\nFigure 18. Configuring Authentication for the MDTSample web service.\n\n## <a href=\"\" id=\"sec04\"></a>Test the web service in Internet Explorer\n\n1.  On PC0001, using Internet Explorer, navigate to: **http://MDT01/MDTSample/mdtsample.asmx**.\n2.  Click the **GetComputerName** link.\n\n    ![figure 19](images/mdt-09-fig19.png)\n\n    Figure 19. The MDT Sample web service.\n3.  On the **GetComputerName** page, type in the following settings, and click **Invoke**:\n    1.  Model: Hewlett-Packard\n    2.  SerialNumber: 123456789\n\n![figure 20](images/mdt-09-fig20.png)\n\nFigure 20. The result from the MDT Sample web service.\n\n## <a href=\"\" id=\"sec05\"></a>Test the web service in the MDT simulation environment\n\nAfter verifying the web service using Internet Explorer, you are ready to do the same test in the MDT simulation environment.\n\n1.  On PC0001, edit the CustomSettings.ini file in the **C:\\\\MDT** folder to look like the following:\n    ``` syntax\n    [Settings]\n    Priority=Default, GetComputerName\n    [Default]\n    OSInstall=YES\n    [GetComputerName]\n    WebService=http://mdt01/MDTSample/mdtsample.asmx/GetComputerName\n    Parameters=Model,SerialNumber\n    OSDComputerName=string\n    ```\n    ![figure 21](images/mdt-09-fig21.png)\n\n    Figure 21. The updated CustomSettings.ini file.\n\n2.  Save the CustomSettings.ini file.\n3.  Using an elevated Windows PowerShell prompt (run as Administrator), run the following commands. Press **Enter** after each command:\n    ``` syntax\n    Set-Location C:\\MDT\n    .\\Gather.ps1\n    ```\n4.  Review the ZTIGather.log in the **C:\\\\MININT\\\\SMSOSD\\\\OSDLOGS** folder.\n\n![figure 22](images/mdt-09-fig22.png)\n\nFigure 22. The OSDCOMPUTERNAME value obtained from the web service.\n\n## Related topics\n\n[Set up MDT for BitLocker](set-up-mdt-2013-for-bitlocker.md)\n\n[Configure MDT deployment share rules](configure-mdt-deployment-share-rules.md)\n\n[Configure MDT for UserExit scripts](configure-mdt-2013-for-userexit-scripts.md)\n\n[Simulate a Windows 10 deployment in a test environment](simulate-a-windows-10-deployment-in-a-test-environment.md)\n\n[Use the MDT database to stage Windows 10 deployment information](use-the-mdt-database-to-stage-windows-10-deployment-information.md)\n\n[Assign applications using roles in MDT](assign-applications-using-roles-in-mdt-2013.md)\n\n[Use Orchestrator runbooks with MDT](use-orchestrator-runbooks-with-mdt-2013.md)\n "}