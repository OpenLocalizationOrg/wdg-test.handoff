{"nodes":[{"content":"Advanced UEFI security features for Surface Pro 3 (Surface)","pos":[11,70]},{"content":"This article describes how to install and configure the v3.11.760.0 UEFI update to enable additional security options for Surface Pro 3 devices.","pos":[84,228]},{"content":"Advanced UEFI security features for Surface Pro 3","pos":[478,527]},{"content":"This article describes how to install and configure the v3.11.760.0 UEFI update to enable additional security options for Surface Pro 3 devices.","pos":[530,674]},{"content":"To address more granular control over the security of Surface devices, the v3.11.760.0 UEFI update provides additional security options that allow you to disable specific hardware devices or to prevent starting from those devices.","pos":[676,906]},{"content":"After the UEFI update is installed on a device, you can configure it manually or automatically by running a script.","pos":[907,1022]},{"content":"Manually install the UEFI update","pos":[1027,1059]},{"content":"Before you can configure the advanced security features of your Surface device, you must first install the v3.11.760.0 UEFI update.","pos":[1062,1193]},{"content":"This update is installed automatically if you receive your updates from Windows Update.","pos":[1194,1281]},{"content":"For more information about how to configure Windows to update automatically by using Windows Update, see <bpt id=\"p1\">[</bpt>How to configure and use Automatic Updates in Windows<ept id=\"p1\">]( http://go.microsoft.com/fwlink/p/?LinkID=618030)</ept>.","pos":[1282,1493]},{"content":"To update the UEFI on Surface Pro 3, you can download and install the Surface UEFI updates as part of the Surface Pro 3 Firmware and Driver Pack.","pos":[1495,1640]},{"content":"These firmware and driver packs are available from the <bpt id=\"p1\">[</bpt>Surface Pro 3 page<ept id=\"p1\">](https://www.microsoft.com/en-us/download/details.aspx?id=38826)</ept> on the Microsoft Download Center.","pos":[1641,1814]},{"content":"You can find out more about the firmware and driver packs at <bpt id=\"p1\">[</bpt>Download the latest firmware and drivers for Surface devices<ept id=\"p1\">](https://technet.microsoft.com/en-us/itpro/surface/deploy-the-latest-firmware-and-drivers-for-surface-devices)</ept>.","pos":[1815,2049]},{"content":"The firmware and driver packs are available as both self-contained Windows Installer (.msi) and archive (.zip) formats.","pos":[2050,2169]},{"content":"You can find out more about these two formats and how you can use them to update your drivers at <bpt id=\"p1\">[</bpt>Manage Surface driver and firmware updates<ept id=\"p1\">](https://technet.microsoft.com/en-us/itpro/surface/manage-surface-pro-3-firmware-updates)</ept>.","pos":[2170,2401]},{"content":"Manually configure additional security settings","pos":[2406,2453]},{"pos":[2457,2717],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>To enter firmware setup on a Surface device, begin with the device powered off, press and hold the <bpt id=\"p2\">**</bpt>Volume Up<ept id=\"p2\">**</ept> button, then press and release the <bpt id=\"p3\">**</bpt>Power<ept id=\"p3\">**</ept> button, then release the <bpt id=\"p4\">**</bpt>Volume Up<ept id=\"p4\">**</ept> button after the device has begun to boot."},{"content":"After the v3.11.760.0 UEFI update is installed on a Surface device, an additional UEFI menu named <bpt id=\"p1\">**</bpt>Advanced Device Security<ept id=\"p1\">**</ept> becomes available.","pos":[2719,2864]},{"content":"If you click this menu, the following options are displayed:","pos":[2865,2925]},{"content":"Option","pos":[2929,2935]},{"content":"Description","pos":[2946,2957]},{"content":"Available settings (default listed in bold)","pos":[3129,3172]},{"content":"Network Boot","pos":[3425,3437]},{"content":"Enables or disables the ability of your Surface device to boot from the network (also known as PXE boot).","pos":[3442,3547]},{"pos":[3625,3650],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>, Not Bootable"},{"content":"Side USB","pos":[3673,3681]},{"content":"Enables or disables the USB port on the side of the Surface device.","pos":[3690,3757]},{"content":"Additionally, the USB port can be enabled, but not allow booting.","pos":[3758,3823]},{"pos":[3873,3908],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>, Not Bootable, Disabled"},{"content":"Docking Port","pos":[3921,3933]},{"content":"Enables or disables the ports on the Surface docking station.","pos":[3938,3999]},{"content":"Additionally, the docking port can be enabled, but block booting from any USB or Ethernet port in the docking station.","pos":[4000,4118]},{"pos":[4121,4156],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>, Not Bootable, Disabled"},{"content":"Front Camera","pos":[4169,4181]},{"content":"Enables or disables the camera on the front of the Surface device.","pos":[4186,4252]},{"pos":[4369,4390],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>, Disabled"},{"content":"Rear Camera","pos":[4417,4428]},{"content":"Enables or disables the camera on the rear of the Surface device.","pos":[4434,4499]},{"pos":[4617,4638],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>, Disabled"},{"content":"On Board Audio","pos":[4665,4679]},{"content":"Enables or disables audio on the Surface device.","pos":[4682,4730]},{"pos":[4865,4886],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>, Disabled"},{"content":"microSD","pos":[4913,4920]},{"content":"Enables or disables the microSD slot on the Surface device.","pos":[4930,4989]},{"pos":[5113,5134],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>, Disabled"},{"content":"WiFi","pos":[5161,5165]},{"content":"Enables or disables the built-in Wi-Fi transceiver in the Surface device.","pos":[5178,5251]},{"content":"This also disables Bluetooth.","pos":[5252,5281]},{"pos":[5361,5382],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>, Disabled"},{"content":"Bluetooth","pos":[5409,5418]},{"content":"Enables or disables the built-in Bluetooth transceiver in the Surface device.","pos":[5426,5503]},{"pos":[5609,5630],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept>, Disabled"},{"content":"Automate additional security settings","pos":[5662,5699]},{"content":"As an IT professional with administrative privileges, you can automate the configuration of UEFI settings by leveraging <bpt id=\"p1\">[</bpt>Surface Pro 3 Firmware Tools (476 KB)<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=618038)</ept> available from the Microsoft Download Center.","pos":[5702,5956]},{"content":"These tools install a .NET assembly that can be called from any custom application or script.","pos":[5957,6050]},{"content":"Prerequisites","pos":[6054,6067]},{"content":"The sample scripts below leverage the previously mentioned extension and therefore assume that the tool has been installed on the device being managed.","pos":[6075,6226]},{"content":"The scripts must be run with administrative privilege.","pos":[6231,6285]},{"pos":[6290,6489],"content":"The Windows PowerShell command <bpt id=\"p1\">[</bpt><bpt id=\"p2\">**</bpt>Set-ExecutionPolicy Unrestricted<ept id=\"p2\">**</ept><ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkID=618039)</ept> must be called prior to running sample scripts if they are not digitally signed."},{"content":"Sample scripts","pos":[6493,6507]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept>:<ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The UEFI password used in the sample scripts below is presented in clear text.","pos":[6512,6611]},{"content":"We strongly recommend saving the scripts in a protected location and running them in a controlled environment.","pos":[6612,6722]},{"content":"Show all configurable options:","pos":[6725,6755]},{"content":"Set or change UEFI password:","pos":[7557,7585]},{"content":"Check status of proposed changes:","pos":[8031,8064]},{"content":"Revert UEFI to default values:","pos":[8938,8968]},{"content":"Status code interpretation","pos":[9543,9569]},{"content":"00 - The proposed update was a success","pos":[9575,9613]},{"content":"02 - One of the proposed values had an invalid value","pos":[9618,9670]},{"content":"03 - There was a proposed value set that was not recognized","pos":[9675,9734]},{"content":"0F - The unlock password did not match currently set password","pos":[9739,9800]}],"content":"---\ntitle: Advanced UEFI security features for Surface Pro 3 (Surface)\ndescription: This article describes how to install and configure the v3.11.760.0 UEFI update to enable additional security options for Surface Pro 3 devices.\nms.assetid: 90F790C0-E5FC-4482-AD71-60589E3C9C93\nkeywords: security, features, configure, hardware, device, custom, script, update\nms.prod: w10\nms.mktglfcycl: manage\nms.pagetype: surface, devices, security\nms.sitesec: library\nauthor: miladCA\n---\n\n# Advanced UEFI security features for Surface Pro 3\n\n\nThis article describes how to install and configure the v3.11.760.0 UEFI update to enable additional security options for Surface Pro 3 devices.\n\nTo address more granular control over the security of Surface devices, the v3.11.760.0 UEFI update provides additional security options that allow you to disable specific hardware devices or to prevent starting from those devices. After the UEFI update is installed on a device, you can configure it manually or automatically by running a script.\n\n## Manually install the UEFI update\n\n\nBefore you can configure the advanced security features of your Surface device, you must first install the v3.11.760.0 UEFI update. This update is installed automatically if you receive your updates from Windows Update. For more information about how to configure Windows to update automatically by using Windows Update, see [How to configure and use Automatic Updates in Windows]( http://go.microsoft.com/fwlink/p/?LinkID=618030).\n\nTo update the UEFI on Surface Pro 3, you can download and install the Surface UEFI updates as part of the Surface Pro 3 Firmware and Driver Pack. These firmware and driver packs are available from the [Surface Pro 3 page](https://www.microsoft.com/en-us/download/details.aspx?id=38826) on the Microsoft Download Center. You can find out more about the firmware and driver packs at [Download the latest firmware and drivers for Surface devices](https://technet.microsoft.com/en-us/itpro/surface/deploy-the-latest-firmware-and-drivers-for-surface-devices). The firmware and driver packs are available as both self-contained Windows Installer (.msi) and archive (.zip) formats. You can find out more about these two formats and how you can use them to update your drivers at [Manage Surface driver and firmware updates](https://technet.microsoft.com/en-us/itpro/surface/manage-surface-pro-3-firmware-updates).\n\n## Manually configure additional security settings\n\n\n>**Note:**&nbsp;&nbsp;To enter firmware setup on a Surface device, begin with the device powered off, press and hold the **Volume Up** button, then press and release the **Power** button, then release the **Volume Up** button after the device has begun to boot.\n\nAfter the v3.11.760.0 UEFI update is installed on a Surface device, an additional UEFI menu named **Advanced Device Security** becomes available. If you click this menu, the following options are displayed:\n\n| Option         | Description                                                                                                                                                                          | Available settings (default listed in bold) |\n|----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n| Network Boot   | Enables or disables the ability of your Surface device to boot from the network (also known as PXE boot).                                                                            | **Enabled**, Not Bootable                   |\n| Side USB       | Enables or disables the USB port on the side of the Surface device. Additionally, the USB port can be enabled, but not allow booting.                                                | **Enabled**, Not Bootable, Disabled         |\n| Docking Port   | Enables or disables the ports on the Surface docking station. Additionally, the docking port can be enabled, but block booting from any USB or Ethernet port in the docking station. | **Enabled**, Not Bootable, Disabled         |\n| Front Camera   | Enables or disables the camera on the front of the Surface device.                                                                                                                   | **Enabled**, Disabled                       |\n| Rear Camera    | Enables or disables the camera on the rear of the Surface device.                                                                                                                    | **Enabled**, Disabled                       |\n| On Board Audio | Enables or disables audio on the Surface device.                                                                                                                                     | **Enabled**, Disabled                       |\n| microSD        | Enables or disables the microSD slot on the Surface device.                                                                                                                          | **Enabled**, Disabled                       |\n| WiFi           | Enables or disables the built-in Wi-Fi transceiver in the Surface device. This also disables Bluetooth.                                                                              | **Enabled**, Disabled                       |\n| Bluetooth      | Enables or disables the built-in Bluetooth transceiver in the Surface device.                                                                                                        | **Enabled**, Disabled                       |\n\n \n\n## Automate additional security settings\n\n\nAs an IT professional with administrative privileges, you can automate the configuration of UEFI settings by leveraging [Surface Pro 3 Firmware Tools (476 KB)](http://go.microsoft.com/fwlink/p/?LinkID=618038) available from the Microsoft Download Center. These tools install a .NET assembly that can be called from any custom application or script.\n\n**Prerequisites**\n\n-   The sample scripts below leverage the previously mentioned extension and therefore assume that the tool has been installed on the device being managed.\n-   The scripts must be run with administrative privilege.\n-   The Windows PowerShell command [**Set-ExecutionPolicy Unrestricted**](http://go.microsoft.com/fwlink/p/?LinkID=618039) must be called prior to running sample scripts if they are not digitally signed.\n\n**Sample scripts**\n\n>**Note**:&nbsp;&nbsp;The UEFI password used in the sample scripts below is presented in clear text. We strongly recommend saving the scripts in a protected location and running them in a controlled environment.\n\n\nShow all configurable options:\n\n```\n# Load the extension \n[System.Reflection.Assembly]::Load(\"SurfaceUefiManager, Version=1.0.5483.22783, Culture=neutral, PublicKeyToken=20606f4b5276c705\")  \n \n# Get the collection of all configurable settings \n$uefiOptions = [Microsoft.Surface.FirmwareOption]::All() \n \nforeach ($uefiOption in $uefiOptions) \n{ \n    Write-Host \"Name:\" $uefiOption.Name \n    Write-Host \" Description =\" $uefiOption.Description \n    Write-Host \" Current Value =\" $uefiOption.CurrentValue \n    Write-Host \" Default Value =\" $uefiOption.DefaultValue \n    Write-Host \" Proposed Value =\" $uefiOption.ProposedValue \n     \n    # This gives usage and validation information \n    Write-Host \" Allowed Values =\" $uefiOption.FriendlyRegEx \n    Write-Host \" Regular Expression =\" $uefiOption.RegEx \n     \n    Write-Host \n}\n```\n\nSet or change UEFI password:\n\n```\n# Load the extension \n[System.Reflection.Assembly]::Load(\"SurfaceUefiManager, Version=1.0.5483.22783, Culture=neutral, PublicKeyToken=20606f4b5276c705\")  \n \n# Must supply UEFI administrator Password if set \n# If it is not currently set this is ignored \n[Microsoft.Surface.FirmwareOption]::Unlock(\"1234\") \n \n$Password = [Microsoft.Surface.FirmwareOption]::Find(\"Password\") \n \n# Set New value to 12345 \n$Password.ProposedValue = \"12345\"\n```\n\nCheck status of proposed changes:\n\n```\n# Load the extension \n[System.Reflection.Assembly]::Load(\"SurfaceUefiManager, Version=1.0.5483.22783, Culture=neutral, PublicKeyToken=20606f4b5276c705\")  \n \n# Check update status \n$updateStatus = [Microsoft.Surface.FirmwareOption]::UpdateStatus \n$updateIteration = [Microsoft.Surface.FirmwareOption]::UpdateIteration \nWrite-Host \"Last Update Status =\" $updateStatus \nWrite-Host \"Last Update Iteration =\" $updateIteration \n \n# Get the individual results for the last proposed update \n# If the device has never had an update attempt this will be an empty list \n$details = [Microsoft.Surface.FirmwareOption]::UpdateStatusDetails \nWrite-Host $details.Count \"Settings were proposed\" \nif ($details.Count -gt 0) \n{ \n    Write-Host \"Result Details\" \n    foreach ($detail in $details.GetEnumerator()) \n    { \n        Write-Host \" \" $detail.Key \"=\" $detail.Value \n    } \n}\n```\n\nRevert UEFI to default values:\n\n```\n# Load the extension \n[System.Reflection.Assembly]::Load(\"SurfaceUefiManager, Version=1.0.5483.22783, Culture=neutral, PublicKeyToken=20606f4b5276c705\")  \n \n# Must supply UEFI administrator Password if set \n# If it is not currently set this is ignored \n[Microsoft.Surface.FirmwareOption]::Unlock(\"1234\") \n \n# Get the collection of all configurable settings \n$uefiOptions = [Microsoft.Surface.FirmwareOption]::All() \n \n# Reset all options to the factory default \nforeach ($uefiOption in $uefiOptions) \n{ \n    $uefiOption.ProposedValue = $uefiOption.DefaultValue \n}\n```\n\nStatus code interpretation\n\n-   00 - The proposed update was a success\n-   02 - One of the proposed values had an invalid value\n-   03 - There was a proposed value set that was not recognized\n-   0F - The unlock password did not match currently set password\n\n \n\n \n\n\n\n\n\n"}