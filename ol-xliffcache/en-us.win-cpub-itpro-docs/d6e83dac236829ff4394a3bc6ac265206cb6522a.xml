{"nodes":[{"content":"DCOM Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax (Windows 10)","pos":[11,113]},{"content":"Describes the best practices, location, values, and security considerations for the DCOM Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax policy setting.","pos":[127,316]},{"content":"DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax","pos":[472,562]},{"content":"Applies to","pos":[566,576]},{"content":"Windows 10","pos":[583,593]},{"pos":[595,789],"content":"Describes the best practices, location, values, and security considerations for the <bpt id=\"p1\">**</bpt>DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax<ept id=\"p1\">**</ept> policy setting."},{"content":"Reference","pos":[794,803]},{"content":"This policy setting allows you to define additional computer-wide controls that govern access to all Distributed Component Object Model (DCOM)–based applications on a device.","pos":[805,979]},{"content":"These controls restrict call, activation, or launch requests on the device.","pos":[980,1055]},{"content":"A simple way to think about these access controls is as an additional access check that is performed against a device-wide access control list (ACL) on each call, activation, or launch of any COM-based server.","pos":[1056,1265]},{"content":"If the access check fails, the call, activation, or launch request is denied.","pos":[1266,1343]},{"content":"(This check is in addition to any access check that is run against the server-specific ACLs.) In effect, it provides a minimum authorization standard that must be passed to access any COM-based server.","pos":[1344,1545]},{"content":"This policy setting controls access permissions to cover call rights.","pos":[1546,1615]},{"content":"These device-wide ACLs provide a way to override weak security settings that are specified by an application through the CoInitializeSecurity function or application-specific security settings.","pos":[1617,1810]},{"content":"They provide a minimum security standard that must be passed, regardless of the settings of the specific server.","pos":[1811,1923]},{"content":"These ACLs also provide a centralized location for an administrator to set a general authorization policy that applies to all COM-based servers on the device.","pos":[1925,2083]},{"content":"This policy setting allows you to specify an ACL in two different ways.","pos":[2085,2156]},{"content":"You can type the security descriptor in SDDL, or you can grant or deny Local Access and Remote Access permissions to users and groups.","pos":[2157,2291]},{"content":"We recommend that you use the built-in user interface to specify the ACL contents that you want to apply with this setting.","pos":[2292,2415]},{"content":"The default ACL settings vary, depending on the version of Windows you are running.","pos":[2416,2499]},{"content":"Possible values","pos":[2505,2520]},{"pos":[2526,2602],"content":"<bpt id=\"p1\">*</bpt>User-defined input<ept id=\"p1\">*</ept> of the SDDL representation of the groups and privileges"},{"content":"When you specify the users or groups that are to be given permissions, the security descriptor field is populated with the Security Descriptor Definition Language representation of those groups and privileges.","pos":[2608,2817]},{"content":"Users and groups can be given explicit Allow or Deny privileges for local access and remote access.","pos":[2818,2917]},{"content":"Blank","pos":[2923,2928]},{"content":"This represents how the local security policy deletes the policy enforcement key.","pos":[2934,3015]},{"content":"This value deletes the policy and then sets it as Not defined.","pos":[3016,3078]},{"content":"The Blank value is set by using the ACL editor to empty the list, and then pressing OK.","pos":[3079,3166]},{"content":"Location","pos":[3172,3180]},{"content":"Computer Configuration<ph id=\"ph1\">\\\\</ph>Windows Settings<ph id=\"ph2\">\\\\</ph>Security Settings<ph id=\"ph3\">\\\\</ph>Local Policies<ph id=\"ph4\">\\\\</ph>Security Options","pos":[3182,3275]},{"content":"Default values","pos":[3281,3295]},{"content":"The following table lists the actual and effective default values for this policy.","pos":[3297,3379]},{"content":"Default values are also listed on the policy’s property page.","pos":[3380,3441]},{"content":"Server type or GPO","pos":[3445,3463]},{"content":"Default value","pos":[3466,3479]},{"content":"Default Domain Policy","pos":[3492,3513]},{"content":"Blank","pos":[3516,3521]},{"content":"Default Domain Controller Policy","pos":[3526,3558]},{"content":"Blank","pos":[3561,3566]},{"content":"Stand-Alone Server Default Settings","pos":[3572,3607]},{"content":"Blank","pos":[3610,3615]},{"content":"DC Effective Default Settings","pos":[3621,3650]},{"content":"Not defined","pos":[3653,3664]},{"content":"Member Server Effective Default Settings","pos":[3670,3710]},{"content":"Not defined","pos":[3713,3724]},{"content":"Client Computer Effective Default Settings","pos":[3730,3772]},{"content":"Not defined","pos":[3775,3786]},{"content":"Policy management","pos":[3795,3812]},{"content":"This section describes features and tools that are available to help you manage this policy.","pos":[3814,3906]},{"content":"Restart requirement","pos":[3911,3930]},{"content":"None.","pos":[3932,3937]},{"content":"Changes to this policy become effective without a computer restart when they are saved locally or distributed through Group Policy.","pos":[3938,4069]},{"content":"Group Policy","pos":[4075,4087]},{"content":"The registry settings that are created as a result of enabling the <bpt id=\"p1\">**</bpt>DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax<ept id=\"p1\">**</ept> policy setting take precedence over the previous registry settings when this policy setting was configured.","pos":[4089,4358]},{"content":"The Remote Procedure Call (RPC) service checks the new registry keys in the Policies section for the computer restrictions, and these registry entries take precedence over the existing registry keys under OLE.","pos":[4359,4568]},{"content":"This means that previously existing registry settings are no longer effective, and if you make changes to the existing settings, device access permissions for users are not changed.","pos":[4569,4750]},{"content":"Use care in configuring the list of users and groups.","pos":[4751,4804]},{"content":"If the administrator is denied permission to access DCOM applications due to the changes made to DCOM in the Windows operating system, the administrator can use the <bpt id=\"p1\">**</bpt>DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax<ept id=\"p1\">**</ept> policy setting to manage DCOM access to the computer.","pos":[4806,5119]},{"content":"The administrator can use this setting to specify which users and groups can access the DCOM application on the computer locally and remotely.","pos":[5120,5262]},{"content":"This will restore control of the DCOM application to the administrator and users.","pos":[5263,5344]},{"content":"To do this, open the <bpt id=\"p1\">**</bpt>DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax<ept id=\"p1\">**</ept> setting, and click <bpt id=\"p2\">**</bpt>Edit Security<ept id=\"p2\">**</ept>.","pos":[5345,5499]},{"content":"Specify the users or groups you want to include and the computer access permissions for those users or groups.","pos":[5500,5610]},{"content":"This defines the setting and sets the appropriate SDDL value.","pos":[5611,5672]},{"content":"Security considerations","pos":[5677,5700]},{"content":"This section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.","pos":[5702,5896]},{"content":"Vulnerability","pos":[5902,5915]},{"content":"Many COM applications include some security-specific code (for example, to call CoInitializeSecurity), but they use weak settings that allow unauthenticated access to the process.","pos":[5917,6096]},{"content":"Administrators cannot override these settings to force stronger security in earlier versions of Windows without modifying the application.","pos":[6097,6235]},{"content":"An attacker could attempt to exploit weak security in an individual application by attacking it through COM calls.","pos":[6236,6350]},{"content":"Also, the COM infrastructure includes the Remote Procedure Call Services (RPCSS), a system service that runs during and after computer startup.","pos":[6352,6495]},{"content":"This service manages activation of COM objects and the running object table and provides helper services to DCOM remoting.","pos":[6496,6618]},{"content":"It exposes RPC interfaces that can be called remotely.","pos":[6619,6673]},{"content":"Because some COM-based servers allow unauthenticated remote access, these interfaces can be called by anyone, including unauthenticated users.","pos":[6674,6816]},{"content":"As a result, RPCSS can be attacked by malicious users who use remote, unauthenticated computers.","pos":[6817,6913]},{"content":"Countermeasure","pos":[6919,6933]},{"pos":[6935,7138],"content":"To protect individual COM-based applications or services, set the <bpt id=\"p1\">**</bpt>DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax<ept id=\"p1\">**</ept> setting to an appropriate device-wide ACL."},{"content":"Potential impact","pos":[7144,7160]},{"content":"Windows implements default COM ACLs when they are installed.","pos":[7162,7222]},{"content":"Modifying these ACLs from the default may cause some applications or components that communicate by using DCOM to fail.","pos":[7223,7342]},{"content":"If you implement a COM-based server and you override the default security settings, confirm that the application-specific call permissions that ACL assigns are the correct permissions for appropriate users.","pos":[7343,7549]},{"content":"If it does not, you must change your application-specific permission ACL to provide appropriate users with activation rights so that applications and Windows components that use DCOM do not fail.","pos":[7550,7745]},{"content":"Related topics","pos":[7750,7764]},{"content":"Security Options","pos":[7769,7785]}],"content":"---\ntitle: DCOM Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax (Windows 10)\ndescription: Describes the best practices, location, values, and security considerations for the DCOM Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax policy setting.\nms.assetid: 0fe3521a-5252-44df-8a47-8d92cf936e7c\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax\n\n**Applies to**\n-   Windows 10\n\nDescribes the best practices, location, values, and security considerations for the **DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax** policy setting.\n\n## Reference\n\nThis policy setting allows you to define additional computer-wide controls that govern access to all Distributed Component Object Model (DCOM)–based applications on a device. These controls restrict call, activation, or launch requests on the device. A simple way to think about these access controls is as an additional access check that is performed against a device-wide access control list (ACL) on each call, activation, or launch of any COM-based server. If the access check fails, the call, activation, or launch request is denied. (This check is in addition to any access check that is run against the server-specific ACLs.) In effect, it provides a minimum authorization standard that must be passed to access any COM-based server. This policy setting controls access permissions to cover call rights.\n\nThese device-wide ACLs provide a way to override weak security settings that are specified by an application through the CoInitializeSecurity function or application-specific security settings. They provide a minimum security standard that must be passed, regardless of the settings of the specific server.\n\nThese ACLs also provide a centralized location for an administrator to set a general authorization policy that applies to all COM-based servers on the device.\n\nThis policy setting allows you to specify an ACL in two different ways. You can type the security descriptor in SDDL, or you can grant or deny Local Access and Remote Access permissions to users and groups. We recommend that you use the built-in user interface to specify the ACL contents that you want to apply with this setting. The default ACL settings vary, depending on the version of Windows you are running.\n\n### Possible values\n\n-   *User-defined input* of the SDDL representation of the groups and privileges\n\n    When you specify the users or groups that are to be given permissions, the security descriptor field is populated with the Security Descriptor Definition Language representation of those groups and privileges. Users and groups can be given explicit Allow or Deny privileges for local access and remote access.\n\n-   Blank\n\n    This represents how the local security policy deletes the policy enforcement key. This value deletes the policy and then sets it as Not defined. The Blank value is set by using the ACL editor to empty the list, and then pressing OK.\n\n### Location\n\nComputer Configuration\\\\Windows Settings\\\\Security Settings\\\\Local Policies\\\\Security Options\n\n### Default values\n\nThe following table lists the actual and effective default values for this policy. Default values are also listed on the policy’s property page.\n\n| Server type or GPO | Default value\n| - | - |\n| Default Domain Policy | Blank |\n| Default Domain Controller Policy | Blank | \n| Stand-Alone Server Default Settings | Blank | \n| DC Effective Default Settings | Not defined | \n| Member Server Effective Default Settings | Not defined | \n| Client Computer Effective Default Settings | Not defined | \n \n## Policy management\n\nThis section describes features and tools that are available to help you manage this policy.\n### Restart requirement\n\nNone. Changes to this policy become effective without a computer restart when they are saved locally or distributed through Group Policy.\n\n### Group Policy\n\nThe registry settings that are created as a result of enabling the **DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax** policy setting take precedence over the previous registry settings when this policy setting was configured. The Remote Procedure Call (RPC) service checks the new registry keys in the Policies section for the computer restrictions, and these registry entries take precedence over the existing registry keys under OLE. This means that previously existing registry settings are no longer effective, and if you make changes to the existing settings, device access permissions for users are not changed. Use care in configuring the list of users and groups.\n\nIf the administrator is denied permission to access DCOM applications due to the changes made to DCOM in the Windows operating system, the administrator can use the **DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax** policy setting to manage DCOM access to the computer. The administrator can use this setting to specify which users and groups can access the DCOM application on the computer locally and remotely. This will restore control of the DCOM application to the administrator and users. To do this, open the **DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax** setting, and click \n**Edit Security**. Specify the users or groups you want to include and the computer access permissions for those users or groups. This defines the setting and sets the appropriate SDDL value.\n\n## Security considerations\n\nThis section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.\n\n### Vulnerability\n\nMany COM applications include some security-specific code (for example, to call CoInitializeSecurity), but they use weak settings that allow unauthenticated access to the process. Administrators cannot override these settings to force stronger security in earlier versions of Windows without modifying the application. An attacker could attempt to exploit weak security in an individual application by attacking it through COM calls.\n\nAlso, the COM infrastructure includes the Remote Procedure Call Services (RPCSS), a system service that runs during and after computer startup. This service manages activation of COM objects and the running object table and provides helper services to DCOM remoting. It exposes RPC interfaces that can be called remotely. Because some COM-based servers allow unauthenticated remote access, these interfaces can be called by anyone, including unauthenticated users. As a result, RPCSS can be attacked by malicious users who use remote, unauthenticated computers.\n\n### Countermeasure\n\nTo protect individual COM-based applications or services, set the **DCOM: Machine Access Restrictions in Security Descriptor Definition Language (SDDL) syntax** setting to an appropriate device-wide ACL.\n\n### Potential impact\n\nWindows implements default COM ACLs when they are installed. Modifying these ACLs from the default may cause some applications or components that communicate by using DCOM to fail. If you implement a COM-based server and you override the default security settings, confirm that the application-specific call permissions that ACL assigns are the correct permissions for appropriate users. If it does not, you must change your application-specific permission ACL to provide appropriate users with activation rights so that applications and Windows components that use DCOM do not fail.\n\n## Related topics\n\n- [Security Options](security-options.md)\n \n \n"}