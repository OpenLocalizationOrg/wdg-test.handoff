{"nodes":[{"content":"Audit System Integrity (Windows 10)","pos":[11,46]},{"content":"This topic for the IT professional describes the Advanced Security Audit policy setting, Audit System Integrity, which determines whether the operating system audits events that violate the integrity of the security subsystem.","pos":[60,286]},{"content":"Audit System Integrity","pos":[435,457]},{"content":"Applies to","pos":[461,471]},{"content":"Windows 10","pos":[478,488]},{"content":"Windows Server 2016","pos":[493,512]},{"content":"Audit System Integrity determines whether the operating system audits events that violate the integrity of the security subsystem.","pos":[515,645]},{"content":"Activities that violate the integrity of the security subsystem include the following:","pos":[647,733]},{"content":"Audited events are lost due to a failure of the auditing system.","pos":[739,803]},{"content":"A process uses an invalid local procedure call (LPC) port in an attempt to impersonate a client, reply to a client address space, read to a client address space, or write from a client address space.","pos":[809,1008]},{"content":"A remote procedure call (RPC) integrity violation is detected.","pos":[1014,1076]},{"content":"A code integrity violation with an invalid hash value of an executable file is detected.","pos":[1082,1170]},{"content":"Cryptographic tasks are performed.","pos":[1176,1210]},{"content":"Violations of security subsystem integrity are critical and could indicate a potential security attack.","pos":[1212,1315]},{"pos":[1317,1339],"content":"<bpt id=\"p1\">**</bpt>Event volume<ept id=\"p1\">**</ept>: Low."},{"content":"Computer Type","pos":[1343,1356]},{"content":"General Success","pos":[1363,1378]},{"content":"General Failure","pos":[1381,1396]},{"content":"Stronger Success","pos":[1399,1415]},{"content":"Stronger Failure","pos":[1418,1434]},{"content":"Comments","pos":[1437,1445]},{"content":"Domain Controller","pos":[2681,2698]},{"content":"Yes","pos":[2701,2704]},{"content":"Yes","pos":[2719,2722]},{"content":"Yes","pos":[2737,2740]},{"content":"Yes","pos":[2756,2759]},{"content":"The main reason why we recommend Success auditing for this subcategory is to be able to get RPC integrity violation errors and auditing subsystem errors (event 4612).","pos":[2775,2941]},{"content":"However, if you are planning to manually invoke “<bpt id=\"p1\">[</bpt>4618<ept id=\"p1\">](event-4618.md)</ept>(S): A monitored security event pattern has occurred”, then you also need to enable Success auditing for this subcategory.","pos":[2942,3134]},{"content":"The main reason why we recommend Failure auditing for this subcategory is to be able to get <bpt id=\"p1\">[</bpt>Code Integrity<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd348642(v=ws.10).aspx)</ept> failure events.","pos":[3138,3330]},{"content":"Member Server","pos":[3335,3348]},{"content":"Yes","pos":[3355,3358]},{"content":"Yes","pos":[3373,3376]},{"content":"Yes","pos":[3391,3394]},{"content":"Yes","pos":[3410,3413]},{"content":"The main reason why we recommend Success auditing for this subcategory is to be able to get RPC integrity violation errors and auditing subsystem errors (event 4612).","pos":[3429,3595]},{"content":"However, if you are planning to manually invoke “<bpt id=\"p1\">[</bpt>4618<ept id=\"p1\">](event-4618.md)</ept>(S): A monitored security event pattern has occurred”, then you also need to enable Success auditing for this subcategory.","pos":[3596,3788]},{"content":"The main reason why we recommend Failure auditing for this subcategory is to be able to get <bpt id=\"p1\">[</bpt>Code Integrity<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd348642(v=ws.10).aspx)</ept> failure events.","pos":[3792,3984]},{"content":"Workstation","pos":[3989,4000]},{"content":"Yes","pos":[4009,4012]},{"content":"Yes","pos":[4027,4030]},{"content":"Yes","pos":[4045,4048]},{"content":"Yes","pos":[4064,4067]},{"content":"The main reason why we recommend Success auditing for this subcategory is to be able to get RPC integrity violation errors and auditing subsystem errors (event 4612).","pos":[4083,4249]},{"content":"However, if you are planning to manually invoke “<bpt id=\"p1\">[</bpt>4618<ept id=\"p1\">](event-4618.md)</ept>(S): A monitored security event pattern has occurred”, then you also need to enable Success auditing for this subcategory.","pos":[4250,4442]},{"content":"The main reason why we recommend Failure auditing for this subcategory is to be able to get <bpt id=\"p1\">[</bpt>Code Integrity<ept id=\"p1\">](https://technet.microsoft.com/en-us/library/dd348642(v=ws.10).aspx)</ept> failure events.","pos":[4446,4638]},{"content":"Events List:","pos":[4644,4656]},{"pos":[4664,4809],"content":"<bpt id=\"p1\">[</bpt>4612<ept id=\"p1\">](event-4612.md)</ept>(S): Internal resources allocated for the queuing of audit messages have been exhausted, leading to the loss of some audits."},{"pos":[4815,4865],"content":"<bpt id=\"p1\">[</bpt>4615<ept id=\"p1\">](event-4615.md)</ept>(S): Invalid use of LPC port."},{"pos":[4871,4945],"content":"<bpt id=\"p1\">[</bpt>4618<ept id=\"p1\">](event-4618.md)</ept>(S): A monitored security event pattern has occurred."},{"pos":[4951,5050],"content":"<bpt id=\"p1\">[</bpt>4816<ept id=\"p1\">](event-4816.md)</ept>(S): RPC detected an integrity violation while decrypting an incoming message."},{"content":"<bpt id=\"p1\">[</bpt>5038<ept id=\"p1\">](event-5038.md)</ept>(F): Code integrity determined that the image hash of a file is not valid.","pos":[5056,5151]},{"content":"The file could be corrupt due to unauthorized modification or the invalid hash could indicate a potential disk device error.","pos":[5152,5276]},{"pos":[5282,5348],"content":"<bpt id=\"p1\">[</bpt>5056<ept id=\"p1\">](event-5056.md)</ept>(S): A cryptographic self-test was performed."},{"pos":[5354,5432],"content":"<bpt id=\"p1\">[</bpt>5062<ept id=\"p1\">](event-5062.md)</ept>(S): A kernel-mode cryptographic self-test was performed."},{"pos":[5438,5507],"content":"<bpt id=\"p1\">[</bpt>5057<ept id=\"p1\">](event-5057.md)</ept>(F): A cryptographic primitive operation failed."},{"pos":[5513,5569],"content":"<bpt id=\"p1\">[</bpt>5060<ept id=\"p1\">](event-5060.md)</ept>(F): Verification operation failed."},{"pos":[5575,5628],"content":"<bpt id=\"p1\">[</bpt>5061<ept id=\"p1\">](event-5061.md)</ept>(S, F): Cryptographic operation."},{"content":"<bpt id=\"p1\">[</bpt>6281<ept id=\"p1\">](event-6281.md)</ept>(F): Code Integrity determined that the page hashes of an image file are not valid.","pos":[5634,5738]},{"content":"The file could be improperly signed without page hashes or corrupt due to unauthorized modification.","pos":[5739,5839]},{"content":"The invalid hashes could indicate a potential disk device error.","pos":[5840,5904]},{"pos":[5910,6037],"content":"<bpt id=\"p1\">[</bpt>6410<ept id=\"p1\">](event-6410.md)</ept>(F): Code integrity determined that a file does not meet the security requirements to load into a process."}],"content":"---\ntitle: Audit System Integrity (Windows 10)\ndescription: This topic for the IT professional describes the Advanced Security Audit policy setting, Audit System Integrity, which determines whether the operating system audits events that violate the integrity of the security subsystem.\nms.assetid: 942a9a7f-fa31-4067-88c7-f73978bf2034\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# Audit System Integrity\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\nAudit System Integrity determines whether the operating system audits events that violate the integrity of the security subsystem.\n\nActivities that violate the integrity of the security subsystem include the following:\n\n-   Audited events are lost due to a failure of the auditing system.\n\n-   A process uses an invalid local procedure call (LPC) port in an attempt to impersonate a client, reply to a client address space, read to a client address space, or write from a client address space.\n\n-   A remote procedure call (RPC) integrity violation is detected.\n\n-   A code integrity violation with an invalid hash value of an executable file is detected.\n\n-   Cryptographic tasks are performed.\n\nViolations of security subsystem integrity are critical and could indicate a potential security attack.\n\n**Event volume**: Low.\n\n| Computer Type     | General Success | General Failure | Stronger Success | Stronger Failure | Comments                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |\n|-------------------|-----------------|-----------------|------------------|------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Domain Controller | Yes             | Yes             | Yes              | Yes              | The main reason why we recommend Success auditing for this subcategory is to be able to get RPC integrity violation errors and auditing subsystem errors (event 4612). However, if you are planning to manually invoke “[4618](event-4618.md)(S): A monitored security event pattern has occurred”, then you also need to enable Success auditing for this subcategory.<br>The main reason why we recommend Failure auditing for this subcategory is to be able to get [Code Integrity](https://technet.microsoft.com/en-us/library/dd348642(v=ws.10).aspx) failure events. |\n| Member Server     | Yes             | Yes             | Yes              | Yes              | The main reason why we recommend Success auditing for this subcategory is to be able to get RPC integrity violation errors and auditing subsystem errors (event 4612). However, if you are planning to manually invoke “[4618](event-4618.md)(S): A monitored security event pattern has occurred”, then you also need to enable Success auditing for this subcategory.<br>The main reason why we recommend Failure auditing for this subcategory is to be able to get [Code Integrity](https://technet.microsoft.com/en-us/library/dd348642(v=ws.10).aspx) failure events. |\n| Workstation       | Yes             | Yes             | Yes              | Yes              | The main reason why we recommend Success auditing for this subcategory is to be able to get RPC integrity violation errors and auditing subsystem errors (event 4612). However, if you are planning to manually invoke “[4618](event-4618.md)(S): A monitored security event pattern has occurred”, then you also need to enable Success auditing for this subcategory.<br>The main reason why we recommend Failure auditing for this subcategory is to be able to get [Code Integrity](https://technet.microsoft.com/en-us/library/dd348642(v=ws.10).aspx) failure events. |\n\n**Events List:**\n\n-   [4612](event-4612.md)(S): Internal resources allocated for the queuing of audit messages have been exhausted, leading to the loss of some audits.\n\n-   [4615](event-4615.md)(S): Invalid use of LPC port.\n\n-   [4618](event-4618.md)(S): A monitored security event pattern has occurred.\n\n-   [4816](event-4816.md)(S): RPC detected an integrity violation while decrypting an incoming message.\n\n-   [5038](event-5038.md)(F): Code integrity determined that the image hash of a file is not valid. The file could be corrupt due to unauthorized modification or the invalid hash could indicate a potential disk device error.\n\n-   [5056](event-5056.md)(S): A cryptographic self-test was performed.\n\n-   [5062](event-5062.md)(S): A kernel-mode cryptographic self-test was performed.\n\n-   [5057](event-5057.md)(F): A cryptographic primitive operation failed.\n\n-   [5060](event-5060.md)(F): Verification operation failed.\n\n-   [5061](event-5061.md)(S, F): Cryptographic operation.\n\n-   [6281](event-6281.md)(F): Code Integrity determined that the page hashes of an image file are not valid. The file could be improperly signed without page hashes or corrupt due to unauthorized modification. The invalid hashes could indicate a potential disk device error.\n\n-   [6410](event-6410.md)(F): Code integrity determined that a file does not meet the security requirements to load into a process.\n\n"}