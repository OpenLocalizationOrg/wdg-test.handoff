{"nodes":[{"content":"Custom XML Examples (Windows 10)","pos":[11,43]},{"content":"Custom XML Examples","pos":[57,76]},{"content":"Custom XML Examples","pos":[209,228]},{"content":"Note","pos":[233,237]},{"content":"Because the tables in this topic are wide, you may need to adjust the width of its window.","pos":[242,332]},{"content":"In This Topic:","pos":[340,354]},{"content":"Example 1: Migrating an Unsupported Application","pos":[362,409]},{"content":"Example 2: Migrating the My Videos Folder","pos":[427,468]},{"content":"Example 3: Migrating Files and Registry Keys","pos":[487,531]},{"content":"Example 4: Migrating Specific Folders from Various Locations","pos":[550,610]},{"pos":[655,702],"content":"Example 1: Migrating an Unsupported Application"},{"content":"The following is a template for the sections that you need to migrate your application.","pos":[705,792]},{"content":"The template is not functional on its own, but you can use it to write your own .xml file.","pos":[793,883]},{"pos":[4137,4178],"content":"Example 2: Migrating the My Videos Folder"},{"content":"The following is a custom .xml file named CustomFile.xml that migrates My Videos for all users, if the folder exists on the source computer.","pos":[4181,4321]},{"content":"Code","pos":[4439,4443]},{"content":"Behavior","pos":[4466,4474]},{"content":"Verifies that My Videos exists on the source computer.","pos":[4728,4782]},{"content":"Filters out the shortcuts in My Videos that do not resolve on the destination computer.","pos":[4984,5071]},{"content":"This has no effect on files that are not shortcuts.","pos":[5072,5123]},{"content":"For example, if there is a shortcut in My Videos on the source computer that points to C:\\Folder1, that shortcut will be migrated only if C:\\Folder1 exists on the destination computer.","pos":[5124,5308]},{"content":"However, all other files, such as .mp3 files, migrate without any filtering.","pos":[5309,5385]},{"content":"Migrates My Videos for all users.","pos":[5591,5624]},{"pos":[6476,6520],"content":"Example 3: Migrating Files and Registry Keys"},{"content":"This table describes the behavior in the following example .xml file.","pos":[6523,6592]},{"content":"Code","pos":[6710,6714]},{"content":"Behavior","pos":[6737,6745]},{"content":"Migrates all instances of the file Usmttestfile.txt from all sub-directories under %ProgramFiles%\\USMTTestFolder.","pos":[6993,7106]},{"content":"Migrates the whole directory under %ProgramFiles%\\USMTDIRTestFolder.","pos":[7330,7398]},{"content":"Migrates all instances of MyKey under HKCU\\Software\\USMTTESTKEY.","pos":[7622,7686]},{"content":"Migrates the entire registry hive under HKLM\\Software\\USMTTESTKEY.","pos":[7907,7973]},{"pos":[8975,9035],"content":"Example 4: Migrating Specific Folders from Various Locations"},{"pos":[9038,9140],"content":"The behavior for this custom .xml file is described within the <ph id=\"ph1\">&amp;lt;`displayName`&amp;gt;</ph> tags in the code."},{"content":"Related topics","pos":[11293,11307]},{"content":"USMT XML Reference","pos":[11311,11329]},{"content":"Customize USMT XML Files","pos":[11356,11380]}],"content":"---\ntitle: Custom XML Examples (Windows 10)\ndescription: Custom XML Examples\nms.assetid: 48f441d9-6c66-43ef-91e9-7c78cde6fcc0\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: greg-lindsay\n---\n\n# Custom XML Examples\n\n\n**Note**  \nBecause the tables in this topic are wide, you may need to adjust the width of its window.\n\n \n\n## In This Topic:\n\n\n-   [Example 1: Migrating an Unsupported Application](#example)\n\n-   [Example 2: Migrating the My Videos Folder](#example2)\n\n-   [Example 3: Migrating Files and Registry Keys](#example3)\n\n-   [Example 4: Migrating Specific Folders from Various Locations](#example4)\n\n## <a href=\"\" id=\"example\"></a>Example 1: Migrating an Unsupported Application\n\n\nThe following is a template for the sections that you need to migrate your application. The template is not functional on its own, but you can use it to write your own .xml file.\n\n``` syntax\n<migration urlid=\"http://www.microsoft.com/migration/1.0/migxmlext/migtestapp\">\n  <component type=\"Application\">\n    <!-- Name of the application -->\n    <displayName>Some Application</displayName>\n    <!-- Specify whether the environment variables exist in the context of user or system or both -->\n    <environment context=\"System\">\n      <!-- Create the environment variables -->\n      <variable name=\"myVar1\">\n        <!-- Simple text value assignment to a variable -->\n        <text>value</text>\n      </variable>\n      <variable name=\"myAppExePath\">\n        <!-- Make a call to in-built helper function to get a value from a reg key and assign that value to the variable -->\n        <script>MigXMLHelper.GetStringContent(\"Registry\",\"HKLM\\Software\\MyApp\\Installer [EXEPATH]\")</script>\n      </variable>\n    </environment>\n    <role role=\"Settings\">\n      <detects>\n        <!-- All of these checks must be true for the component to be detected -->\n        <detect>\n          <!-- Make a call to in-built helper function to check if an object exists or not -->\n          <condition>MigXMLHelper.DoesObjectExist(\"Registry\",\"HKLM\\Software\\MyApp [win32_version]\")</condition>\n        </detect>\n        <detect>\n          <!-- Either of these checks must be true for the component to be detected -->\n          <!-- Make a call to in-built helper function to check if a file version matches or not -->\n          <condition>MigXMLHelper.DoesFileVersionMatch(\"%MyAppExePath%\",\"ProductVersion\",\"8.*\")</condition>\n          <condition>MigXMLHelper.DoesFileVersionMatch(\"%MyAppExePath%\",\"ProductVersion\",\"9.*\")</condition>\n        </detect>\n      </detects>\n      <!-- Describe the rules that will be executed during migration of this component and the context, whether user, system or both -->\n      <rules context=\"User\">\n        <!-- Delete objects specified in the object set on the destination computer before applying source objects -->\n        <destinationCleanup>\n          <!-- Describe the pattern for the list of objects to be deleted -->\n          <objectSet>\n            <pattern type=\"Registry\">HKCU\\Software\\MyApp\\Toolbar\\* [*]</pattern>\n            <pattern type=\"Registry\">HKCU\\Software\\MyApp\\ListView\\* [*]</pattern>\n            <pattern type=\"Registry\">HKCU\\Software\\MyApp [ShowTips]</pattern>\n          </objectSet>\n        </destinationCleanup>\n        <!-- Specify which set of objects should be migrated -->\n        <include>\n          <!-- Describe the pattern for the list of objects to be included -->\n          <objectSet>\n            <pattern type=\"Registry\">HKCU\\Software\\MyApp\\Toolbar\\* [*]</pattern>\n            <pattern type=\"Registry\">HKCU\\Software\\MyApp\\ListView\\* [*]</pattern>\n            <pattern type=\"Registry\">HKCU\\Software\\MyApp [ShowTips]</pattern>\n          </objectSet>\n        </include>\n        <!-- Specify which set of objects should not be migrated -->\n        <exclude>\n          <!-- Describe the pattern for the list of objects to be excluded from migration -->\n          <objectSet>\n            <pattern type=\"Registry\">HKCU\\Software\\MyApp [Display]</pattern>\n          </objectSet>\n        </exclude>\n      </rules>\n    </role>\n  </component>\n</migration>\n```\n\n## <a href=\"\" id=\"example2\"></a>Example 2: Migrating the My Videos Folder\n\n\nThe following is a custom .xml file named CustomFile.xml that migrates My Videos for all users, if the folder exists on the source computer.\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Code</th>\n<th align=\"left\">Behavior</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre class=\"syntax\" space=\"preserve\"><code>&lt;condition&gt;MigXmlHelper.DoesObjectExist(&quot;File&quot;,&quot;%CSIDL_MYVIDEO%&quot;)&lt;/condition&gt;</code></pre></td>\n<td align=\"left\"><p>Verifies that My Videos exists on the source computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><pre class=\"syntax\" space=\"preserve\"><code>&lt;include filter=&#39;MigXmlHelper.IgnoreIrrelevantLinks()&#39;&gt;</code></pre></td>\n<td align=\"left\"><p>Filters out the shortcuts in My Videos that do not resolve on the destination computer. This has no effect on files that are not shortcuts. For example, if there is a shortcut in My Videos on the source computer that points to C:\\Folder1, that shortcut will be migrated only if C:\\Folder1 exists on the destination computer. However, all other files, such as .mp3 files, migrate without any filtering.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><pre class=\"syntax\" space=\"preserve\"><code>&lt;pattern type=&quot;File&quot;&gt;%CSIDL_MYVIDEO%\\* [*]&lt;/pattern&gt;</code></pre></td>\n<td align=\"left\"><p>Migrates My Videos for all users.</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n``` syntax\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<migration urlid=\"http://www.microsoft.com/migration/1.0/migxmlext/CustomFile\">\n<component type=\"Documents\" context=\"User\">\n        <displayName>My Video</displayName>\n        <role role=\"Data\">\n            <detects>           \n                <detect>\n                    <condition>MigXmlHelper.DoesObjectExist(\"File\",\"%CSIDL_MYVIDEO%\")</condition>\n                </detect>\n            </detects>\n            <rules>\n                <include filter='MigXmlHelper.IgnoreIrrelevantLinks()'>\n                    <objectSet>\n                        <pattern type=\"File\">%CSIDL_MYVIDEO%\\* [*]</pattern>\n                    </objectSet>\n                </include>\n           </rules>\n        </role>\n    </component>\n</migration>\n```\n\n## <a href=\"\" id=\"example3\"></a>Example 3: Migrating Files and Registry Keys\n\n\nThis table describes the behavior in the following example .xml file.\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Code</th>\n<th align=\"left\">Behavior</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><pre class=\"syntax\" space=\"preserve\"><code>&lt;pattern type=&quot;File&quot;&gt;%ProgramFiles%\\USMTTestFolder\\* [USMTTestFile.txt]&lt;/pattern&gt;</code></pre></td>\n<td align=\"left\"><p>Migrates all instances of the file Usmttestfile.txt from all sub-directories under %ProgramFiles%\\USMTTestFolder.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><pre class=\"syntax\" space=\"preserve\"><code>&lt;pattern type=&quot;File&quot;&gt;%ProgramFiles%\\USMTDIRTestFolder\\* [*]&lt;/pattern&gt;</code></pre></td>\n<td align=\"left\"><p>Migrates the whole directory under %ProgramFiles%\\USMTDIRTestFolder.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><pre class=\"syntax\" space=\"preserve\"><code>&lt;pattern type=&quot;Registry&quot;&gt;HKCU\\Software\\USMTTESTKEY\\* [MyKey]&lt;/pattern&gt;</code></pre></td>\n<td align=\"left\"><p>Migrates all instances of MyKey under HKCU\\Software\\USMTTESTKEY.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><pre class=\"syntax\" space=\"preserve\"><code>&lt;pattern type=&quot;Registry&quot;&gt;HKLM\\Software\\USMTTESTKEY\\* [*]&lt;/pattern&gt;</code></pre></td>\n<td align=\"left\"><p>Migrates the entire registry hive under HKLM\\Software\\USMTTESTKEY.</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n``` syntax\n<migration urlid=\"http://www.microsoft.com/migration/1.0/migxmlext/testfilemig\">\n  <component type=\"Application\" context=\"System\">\n   <displayName>File Migration Test</displayName>\n   <role role=\"Data\">\n    <rules context=\"System\">\n     <include>\n      <objectSet>\n        <pattern type=\"File\">%ProgramFiles%\\USMTTestFolder\\* [USMTTestFile.txt]</pattern>\n        <pattern type=\"File\">%ProgramFiles%\\USMTDIRTestFolder\\* [*]</pattern>\n      </objectSet>\n    </include>\n   </rules>\n  </role>\n</component>\n<component type=\"System\">\n  <displayName>Registry Migration Test</displayName>\n  <role role=\"Settings\">\n   <rules context=\"UserAndSystem\">\n     <include>\n      <objectSet>\n          <pattern type=\"Registry\">HKCU\\Software\\USMTTESTKEY\\* [MyKey]</pattern>\n          <pattern type=\"Registry\">HKLM\\Software\\USMTTESTKEY\\* [*]</pattern>\n      </objectSet>\n     </include>\n   </rules>\n  </role>\n </component>\n</migration>\n```\n\n## <a href=\"\" id=\"example4\"></a>Example 4: Migrating Specific Folders from Various Locations\n\n\nThe behavior for this custom .xml file is described within the &lt;`displayName`&gt; tags in the code.\n\n``` syntax\n<migration urlid=\"http://www.microsoft.com/migration/1.0/migxmlext/test\">\n\n<component type=\"Documents\" context=\"System\">\n  <displayName>Component to migrate all Engineering Drafts subfolders without documents in this folder </displayName>\n  <role role=\"Data\">\n    <rules>\n         <include>\n            <objectSet>\n                 <pattern type=\"File\"> C:\\EngineeringDrafts\\* [*]</pattern>\n            </objectSet>\n          </include>\n         <exclude>\n            <objectSet>\n                 <pattern type=\"File\"> C:\\EngineeringDrafts\\ [*]</pattern>\n            </objectSet>\n         </exclude>\n    </rules>\n  </role>\n</component>\n\n<component type=\"Documents\" context=\"System\">\n  <displayName>Component to migrate all user documents except Sample.doc</displayName>\n  <role role=\"Data\">\n    <rules>\n         <include>\n            <objectSet>\n                 <pattern type=\"File\"> C:\\UserDocuments\\* [*]</pattern>\n            </objectSet>\n          </include>\n        <exclude>\n             <objectSet>\n                 <pattern type=\"File\"> C:\\UserDocuments\\ [Sample.doc]</pattern>\n             </objectSet>\n          </exclude>\n    </rules>\n  </role>\n</component>\n\n<component type=\"Documents\" context=\"System\">\n  <displayName>Component to migrate all Requests folders on any drive on the computer </displayName>\n  <role role=\"Data\">\n    <rules>\n         <include>\n            <objectSet>\n         <script>MigXmlHelper.GenerateDrivePatterns (\"\\Requests\\* [*] \", \"Fixed\")</script>            \n         <script>MigXmlHelper.GenerateDrivePatterns (\"*\\Requests\\* [*] \", \"Fixed\")</script>            \n     </objectSet>\n          </include>\n    </rules>\n  </role>\n</component>\n\n<component type=\"Documents\" context=\"System\">\n  <displayName>Component to migrate all Presentations folder from any location on the C: drive </displayName>\n  <role role=\"Data\">\n    <rules>\n         <include>\n            <objectSet>                 \n<pattern type=\"File\"> C:\\*\\Presentations\\* [*]</pattern>\n<pattern type=\"File\"> C:\\Presentations\\* [*]</pattern>\n           </objectSet>\n          </include>\n    </rules>\n  </role>\n</component>\n</migration>\n```\n\n## Related topics\n\n\n[USMT XML Reference](usmt-xml-reference.md)\n\n[Customize USMT XML Files](usmt-customize-xml-files.md)\n\n \n\n \n\n\n\n\n\n"}