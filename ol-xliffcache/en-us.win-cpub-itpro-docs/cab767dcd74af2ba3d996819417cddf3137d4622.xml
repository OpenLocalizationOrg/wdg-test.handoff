{"nodes":[{"content":"Audit Shut down system immediately if unable to log security audits (Windows 10)","pos":[11,91]},{"content":"Describes the best practices, location, values, management practices, and security considerations for the Audit Shut down system immediately if unable to log security audits security policy setting.","pos":[105,303]},{"content":"Audit: Shut down system immediately if unable to log security audits","pos":[459,527]},{"content":"Applies to","pos":[531,541]},{"content":"Windows 10","pos":[548,558]},{"pos":[560,763],"content":"Describes the best practices, location, values, management practices, and security considerations for the <bpt id=\"p1\">**</bpt>Audit: Shut down system immediately if unable to log security audits<ept id=\"p1\">**</ept> security policy setting."},{"content":"Reference","pos":[768,777]},{"content":"The <bpt id=\"p1\">**</bpt>Audit: Shut down system immediately if unable to log security audits<ept id=\"p1\">**</ept> policy setting determines whether the system shuts down if it is unable to log security events.","pos":[779,951]},{"content":"This policy setting is a requirement for Trusted Computer System Evaluation Criteria (TCSEC)-C2 and Common Criteria certification to prevent auditable events from occurring if the audit system is unable to log those events.","pos":[952,1175]},{"content":"Microsoft has chosen to meet this requirement by halting the system and displaying a Stop message in the case of a failure of the auditing system.","pos":[1176,1322]},{"content":"Enabling this policy setting stops the system if a security audit cannot be logged for any reason.","pos":[1323,1421]},{"content":"Typically, an event fails to be logged when the security audit log is full and the value of <bpt id=\"p1\">**</bpt>Retention method for security log<ept id=\"p1\">**</ept> is <bpt id=\"p2\">**</bpt>Do not overwrite events (clear log manually)<ept id=\"p2\">**</ept> or <bpt id=\"p3\">**</bpt>Overwrite events by days<ept id=\"p3\">**</ept>.","pos":[1422,1636]},{"pos":[1638,1844],"content":"With <bpt id=\"p1\">**</bpt>Audit: Shut down system immediately if unable to log security audits<ept id=\"p1\">**</ept> set to <bpt id=\"p2\">**</bpt>Enabled<ept id=\"p2\">**</ept>, if the security log is full and an existing entry cannot be overwritten, the following Stop message appears:"},{"content":"STOP: C0000244 {Audit Failed}","pos":[1942,1971]},{"content":"An attempt to generate a security audit failed.","pos":[1979,2026]},{"content":"To recover, you must log on, archive the log (optional), clear the log, and reset this option as desired.","pos":[2062,2167]},{"content":"If the computer is unable to record events to the security log, critical evidence or important troubleshooting information might not be available for review after a security incident.","pos":[2169,2352]},{"content":"Possible values","pos":[2358,2373]},{"content":"Enabled","pos":[2379,2386]},{"content":"Disabled","pos":[2391,2399]},{"content":"Not defined","pos":[2404,2415]},{"content":"Best practices","pos":[2421,2435]},{"content":"Depending on your security audit requirements, you can enable the <bpt id=\"p1\">**</bpt>Audit: Shut down system immediately if unable to log security audits<ept id=\"p1\">**</ept> setting to ensure that security auditing information is captured for review.","pos":[2441,2656]},{"content":"However, enabling this setting will increase the number of events logged.","pos":[2657,2730]},{"content":"Location","pos":[2736,2744]},{"content":"Computer Configuration<ph id=\"ph1\">\\\\</ph>Windows Settings<ph id=\"ph2\">\\\\</ph>Security Settings<ph id=\"ph3\">\\\\</ph>Local Policies<ph id=\"ph4\">\\\\</ph>Security Options","pos":[2746,2839]},{"content":"Default values","pos":[2845,2859]},{"content":"The following table lists the actual and effective default values for this policy.","pos":[2861,2943]},{"content":"Default values are also listed on the policyâ€™s property page.","pos":[2944,3005]},{"content":"Server type or GPO","pos":[3009,3027]},{"content":"Default value","pos":[3030,3043]},{"content":"Default Domain Policy","pos":[3058,3079]},{"content":"Not defined","pos":[3082,3093]},{"content":"Default Domain Controler Policy","pos":[3097,3128]},{"content":"Not defined","pos":[3131,3142]},{"content":"Stand-Alone Server Default Settings","pos":[3146,3181]},{"content":"Disabled","pos":[3184,3192]},{"content":"DC Effective Default Settings","pos":[3196,3225]},{"content":"Disabled","pos":[3228,3236]},{"content":"Member Server Effective Default Settings","pos":[3240,3280]},{"content":"Disabled","pos":[3283,3291]},{"content":"Client Computer Effective Default Settings","pos":[3295,3337]},{"content":"Disabled","pos":[3340,3348]},{"content":"Policy management","pos":[3355,3372]},{"content":"This section describes features and tools that are available to help you manage this policy.","pos":[3374,3466]},{"content":"The administrative burden of enabling this policy setting can be very high, especially if you also set the <bpt id=\"p1\">**</bpt>Retention method for security log<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Do not overwrite events (clear log manually)<ept id=\"p2\">**</ept>.","pos":[3467,3664]},{"content":"This setting turns a repudiation threat (a backup operator could deny that they backed up or restored data) into a denial-of-service threat, because a server can be forced to shut down if it is overwhelmed with logon events and other security events that are written to the security log.","pos":[3665,3952]},{"content":"Additionally, because the shutdown is not graceful, it is possible that irreparable damage to the operating system, applications, or data could result.","pos":[3953,4104]},{"content":"Although the NTFS file system will guarantee that the file system's integrity will be maintained during a sudden system shutdown, it cannot guarantee that every data file for every application will still be in a usable form when the system is restarted.","pos":[4105,4358]},{"content":"Restart requirement","pos":[4364,4383]},{"content":"None.","pos":[4385,4390]},{"content":"Changes to this policy become effective without a computer restart when they are saved locally or distributed through Group Policy.","pos":[4391,4522]},{"content":"Group Policy","pos":[4528,4540]},{"content":"Modifying this setting may affect compatibility with clients, services, and applications.","pos":[4542,4631]},{"content":"Security considerations","pos":[4636,4659]},{"content":"This section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.","pos":[4661,4855]},{"content":"Vulnerability","pos":[4861,4874]},{"content":"If the computer is unable to record events to the security event log, critical evidence or important troubleshooting information may not be available for review after a security incident.","pos":[4876,5063]},{"content":"Also, an attacker could potentially generate a large volume of security event log events to purposely force a shutdown.","pos":[5064,5183]},{"content":"Countermeasure","pos":[5189,5203]},{"pos":[5205,5365],"content":"Enable the <bpt id=\"p1\">**</bpt>Audit: Shut down system immediately if unable to log security audits<ept id=\"p1\">**</ept> setting to ensure that security auditing information is captured for review."},{"content":"Potential impact","pos":[5371,5387]},{"content":"If you enable this policy setting, the administrative burden can be significant, especially if you also configure the <bpt id=\"p1\">**</bpt>Retention method for the Security log<ept id=\"p1\">**</ept> to <bpt id=\"p2\">**</bpt>Do not overwrite events<ept id=\"p2\">**</ept> (clear log manually).","pos":[5389,5601]},{"content":"This configuration causes a repudiation threat (a backup operator could deny that they backed up or restored data) to become a denial of service (DoS) vulnerability because a server could be forced to shut down if it is overwhelmed with logon events and other security events that are written to the security event log.","pos":[5602,5921]},{"content":"Also, because the shutdown is abrupt, it is possible that irreparable damage to the operating system, applications, or data could result.","pos":[5922,6059]},{"content":"Although the NTFS file system maintains its integrity when this type of computer shutdown occurs, there is no guarantee that every data file for every application will still be in a usable form when the device restarts.","pos":[6060,6279]},{"content":"Related topics","pos":[6284,6298]},{"content":"Security Options","pos":[6303,6319]}],"content":"---\ntitle: Audit Shut down system immediately if unable to log security audits (Windows 10)\ndescription: Describes the best practices, location, values, management practices, and security considerations for the Audit Shut down system immediately if unable to log security audits security policy setting.\nms.assetid: 2cd23cd9-0e44-4d0b-a1f1-39fc29303826\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Audit: Shut down system immediately if unable to log security audits\n\n**Applies to**\n-   Windows 10\n\nDescribes the best practices, location, values, management practices, and security considerations for the **Audit: Shut down system immediately if unable to log security audits** security policy setting.\n\n## Reference\n\nThe **Audit: Shut down system immediately if unable to log security audits** policy setting determines whether the system shuts down if it is unable to log security events. This policy setting is a requirement for Trusted Computer System Evaluation Criteria (TCSEC)-C2 and Common Criteria certification to prevent auditable events from occurring if the audit system is unable to log those events. Microsoft has chosen to meet this requirement by halting the system and displaying a Stop message in the case of a failure of the auditing system. Enabling this policy setting stops the system if a security audit cannot be logged for any reason. Typically, an event fails to be logged when the security audit log is full and the value of **Retention method for security log** is **Do not overwrite events (clear log manually)** or **Overwrite events by days**.\n\nWith **Audit: Shut down system immediately if unable to log security audits** set to **Enabled**, if the security log is full and an existing entry cannot be overwritten, the following Stop message appears:\n<table>\n<colgroup>\n<col width=\"100%\" />\n</colgroup>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>STOP: C0000244 {Audit Failed}</p>\n<p>An attempt to generate a security audit failed.</p></td>\n</tr>\n</tbody>\n</table>\n \nTo recover, you must log on, archive the log (optional), clear the log, and reset this option as desired.\n\nIf the computer is unable to record events to the security log, critical evidence or important troubleshooting information might not be available for review after a security incident.\n\n### Possible values\n\n-   Enabled\n-   Disabled\n-   Not defined\n\n### Best practices\n\n-   Depending on your security audit requirements, you can enable the **Audit: Shut down system immediately if unable to log security audits** setting to ensure that security auditing information is captured for review. However, enabling this setting will increase the number of events logged.\n\n### Location\n\nComputer Configuration\\\\Windows Settings\\\\Security Settings\\\\Local Policies\\\\Security Options\n\n### Default values\n\nThe following table lists the actual and effective default values for this policy. Default values are also listed on the policyâ€™s property page.\n\n| Server type or GPO | Default value |\n| - | - |\n| Default Domain Policy | Not defined \n| Default Domain Controler Policy | Not defined \n| Stand-Alone Server Default Settings | Disabled \n| DC Effective Default Settings | Disabled \n| Member Server Effective Default Settings | Disabled \n| Client Computer Effective Default Settings | Disabled \n \n## Policy management\n\nThis section describes features and tools that are available to help you manage this policy.\nThe administrative burden of enabling this policy setting can be very high, especially if you also set the **Retention method for security log** to **Do not overwrite events (clear log manually)**. This setting turns a repudiation threat (a backup operator could deny that they backed up or restored data) into a denial-of-service threat, because a server can be forced to shut down if it is overwhelmed with logon events and other security events that are written to the security log. Additionally, because the shutdown is not graceful, it is possible that irreparable damage to the operating system, applications, or data could result. Although the NTFS file system will guarantee that the file system's integrity will be maintained during a sudden system shutdown, it cannot guarantee that every data file for every application will still be in a usable form when the system is restarted.\n\n### Restart requirement\n\nNone. Changes to this policy become effective without a computer restart when they are saved locally or distributed through Group Policy.\n\n### Group Policy\n\nModifying this setting may affect compatibility with clients, services, and applications.\n\n## Security considerations\n\nThis section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.\n\n### Vulnerability\n\nIf the computer is unable to record events to the security event log, critical evidence or important troubleshooting information may not be available for review after a security incident. Also, an attacker could potentially generate a large volume of security event log events to purposely force a shutdown.\n\n### Countermeasure\n\nEnable the **Audit: Shut down system immediately if unable to log security audits** setting to ensure that security auditing information is captured for review.\n\n### Potential impact\n\nIf you enable this policy setting, the administrative burden can be significant, especially if you also configure the **Retention method for the Security log** to **Do not overwrite events** (clear log manually). This configuration causes a repudiation threat (a backup operator could deny that they backed up or restored data) to become a denial of service (DoS) vulnerability because a server could be forced to shut down if it is overwhelmed with logon events and other security events that are written to the security event log. Also, because the shutdown is abrupt, it is possible that irreparable damage to the operating system, applications, or data could result. Although the NTFS file system maintains its integrity when this type of computer shutdown occurs, there is no guarantee that every data file for every application will still be in a usable form when the device restarts.\n\n## Related topics\n\n- [Security Options](security-options.md)\n \n \n"}