{"nodes":[{"content":"Configuring MBAM 2.5 Server Features by Using Windows PowerShell","pos":[11,75]},{"content":"Configuring MBAM 2.5 Server Features by Using Windows PowerShell","pos":[89,153]},{"content":"Configuring MBAM 2.5 Server Features by Using Windows PowerShell","pos":[311,375]},{"content":"After you install the MBAM 2.5 Server software, you can use configure MBAM 2.5 Server features by using Windows PowerShell cmdlets or the MBAM Server Configuration wizard.","pos":[378,549]},{"content":"This topic describes how to configure MBAM 2.5 by using the Windows PowerShell cmdlets.","pos":[550,637]},{"content":"To use the wizard instead, see <bpt id=\"p1\">[</bpt>Configuring the MBAM 2.5 Server Features<ept id=\"p1\">](configuring-the-mbam-25-server-features.md)</ept>.","pos":[638,756]},{"content":"In this topic","pos":[761,774]},{"content":"This topic includes the following information about using Windows PowerShell to configure MBAM:","pos":[777,872]},{"content":"How to load Windows PowerShell Help for MBAM 2.5","pos":[879,927]},{"content":"How to get Help about an MBAM Windows PowerShell cmdlet","pos":[957,1012]},{"content":"Configurations that you can do only with Windows PowerShell but not with the MBAM Server Configuration wizard","pos":[1048,1157]},{"content":"Prerequisites and requirements for using Windows PowerShell to configure MBAM Server features","pos":[1189,1282]},{"content":"Using Windows PowerShell to configure MBAM on a remote computer","pos":[1318,1381]},{"content":"Required accounts and corresponding Windows PowerShell cmdlet parameters","pos":[1410,1482]},{"pos":[1508,1768],"content":"For information about the <bpt id=\"p1\">**</bpt>Get-MbamBitLockerRecoveryKey<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Get-MbamTPMOwnerPassword<ept id=\"p2\">**</ept> Windows PowerShell cmdlets, which are used to administer MBAM, see <bpt id=\"p3\">[</bpt>Using Windows PowerShell to Administer MBAM 2.5<ept id=\"p3\">](using-windows-powershell-to-administer-mbam-25.md)</ept>."},{"pos":[1813,1861],"content":"How to load Windows PowerShell Help for MBAM 2.5"},{"pos":[1864,2045],"content":"For a list of the Windows PowerShell cmdlets on TechNet, see <bpt id=\"p1\">[</bpt>Microsoft Desktop Optimization Pack Automation with Windows PowerShell<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=392816)</ept>."},{"content":"To load the MBAM 2.5 Help for Windows PowerShell cmdlets after installing the MBAM Server software","pos":[2049,2147]},{"content":"Open Windows PowerShell or Windows PowerShell Integrated Scripting Environment (ISE).","pos":[2155,2240]},{"pos":[2246,2290],"content":"Type <bpt id=\"p1\">**</bpt>Update-Help â€“Module Microsoft.MBAM<ept id=\"p1\">**</ept>."},{"pos":[2341,2396],"content":"How to get Help about an MBAM Windows PowerShell cmdlet"},{"content":"Windows PowerShell Help for MBAM is available in the following formats:","pos":[2399,2470]},{"content":"Windows PowerShell Help format","pos":[2588,2618]},{"content":"More information","pos":[2641,2657]},{"content":"At a Windows PowerShell command prompt, type <ph id=\"ph1\">&lt;strong&gt;</ph>Get-Help<ph id=\"ph2\">&lt;/strong&gt;</ph> <ph id=\"ph3\">&amp;lt;&lt;em&gt;</ph>cmdlet","pos":[2723,2808]},{"content":"To upload the latest Windows PowerShell cmdlets, follow the instructions in the previous section on how to load Windows PowerShell Help for MBAM.","pos":[2847,2992]},{"content":"On TechNet as webpages","pos":[3046,3068]},{"content":"http://go.microsoft.com/fwlink/?LinkId=393498","pos":[3098,3143]},{"content":"On the Download Center as a Word .docx file","pos":[3196,3239]},{"content":"http://go.microsoft.com/fwlink/?LinkId=393497","pos":[3269,3314]},{"content":"On the Download Center as a .pdf file","pos":[3368,3405]},{"content":"http://go.microsoft.com/fwlink/?LinkId=393499","pos":[3435,3480]},{"pos":[3563,3672],"content":"Configurations that you can do only with Windows PowerShell but not with the MBAM Server Configuration wizard"},{"content":"Configurations that you can do only by using Windows PowerShell","pos":[3791,3854]},{"content":"Details","pos":[3877,3884]},{"content":"Install the web services on a separate computer from the web applications.","pos":[3950,4024]},{"content":"Using the wizard, you must install the web services and web applications on the same computer.","pos":[4054,4148]},{"content":"Enable reports on a separate reporting services point without installing all of the Configuration Manager objects.","pos":[4202,4316]},{"content":"Delete all of the objects from Configuration Manager.","pos":[4399,4452]},{"content":"Deleting the objects in turn deletes all of the compliance data from Configuration Manager.","pos":[4482,4573]},{"content":"Enter a custom connection string for the databases.","pos":[4627,4678]},{"content":"Example: To configure the web applications to work with mirroring, you must use the <ph id=\"ph1\">&lt;strong&gt;</ph>Enable-MbamWebApplication<ph id=\"ph2\">&lt;/strong&gt;</ph> cmdlet to specify the appropriate failover partner syntax in the connection string.","pos":[4708,4918]},{"content":"Skip validation and configure a feature even though the prerequisite check failed.","pos":[4971,5053]},{"content":"Note","pos":[5116,5120]},{"content":"You cannot disable the MBAM databases with a Windows PowerShell cmdlet or the MBAM Server Configuration wizard.","pos":[5125,5236]},{"content":"To prevent the accidental removal of your compliance and audit data, database administrators must remove databases manually.","pos":[5237,5361]},{"pos":[5415,5508],"content":"Prerequisites and requirements for using Windows PowerShell to configure MBAM Server features"},{"content":"Before starting the configuration, complete the following prerequisites.","pos":[5511,5583]},{"content":"Account-related prerequisites","pos":[5587,5616]},{"content":"Prerequisite","pos":[5736,5748]},{"content":"Details or additional information","pos":[5771,5804]},{"content":"Create the required accounts.","pos":[5870,5899]},{"content":"See section <ph id=\"ph1\">&lt;strong&gt;</ph>Required accounts and corresponding Windows PowerShell cmdlet parameters<ph id=\"ph2\">&lt;/strong&gt;</ph> later in this topic.","pos":[5929,6051]},{"content":"User accounts and groups that you pass as parameters to the Windows PowerShell cmdlets must be valid accounts in the domain.","pos":[6105,6229]},{"content":"You cannot use local accounts.","pos":[6259,6289]},{"content":"Specify accounts in the down-level format.","pos":[6342,6384]},{"content":"Examples:","pos":[6414,6423]},{"content":"domainNetBiosName\\userdomainNetBiosName\\group","pos":[6431,6476]},{"content":"Permission-related prerequisites","pos":[6516,6548]},{"content":"Prerequisite","pos":[6668,6680]},{"content":"Details or additional information","pos":[6703,6736]},{"content":"You must be an administrator on the local computer where you are configuring the MBAM feature.","pos":[6802,6896]},{"content":"Use an elevated Windows PowerShell command prompt to run all Windows PowerShell cmdlets.","pos":[6980,7068]},{"content":"For the <ph id=\"ph1\">&lt;strong&gt;</ph>Enable-MbamDatabase<ph id=\"ph2\">&lt;/strong&gt;</ph> cmdlet only:","pos":[7151,7208]},{"content":"You must have <ph id=\"ph1\">&amp;quot;</ph>create any database<ph id=\"ph2\">&amp;quot;</ph> permissions on the instance of the target Microsoft SQL Server database.","pos":[7216,7334]},{"content":"This user account must be a part of the local administrators group or the Backup Operators group to register the MBAM Volume Shadow Copy Service (VSS) Writer.","pos":[7342,7500]},{"content":"By default, the database administrator or system administrator has the required <ph id=\"ph1\">&amp;quot;</ph>create any database<ph id=\"ph2\">&amp;quot;</ph> permissions.","pos":[7530,7654]},{"content":"For more information about VSS Writer, see <bpt id=\"p1\">[</bpt>Volume Shadow Copy Service<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=392814)</ept>.","pos":[7670,7789]},{"content":"For the <ph id=\"ph1\">&lt;strong&gt;</ph>System Center Configuration Manager Integration<ph id=\"ph2\">&lt;/strong&gt;</ph> feature only:","pos":[7843,7929]},{"content":"The user who enables this feature must have these rights in Configuration Manager:","pos":[7937,8019]},{"content":"Type of rights in Configuration Manager","pos":[8162,8201]},{"content":"Required rights","pos":[8224,8239]},{"content":"Configuration Manager Site rights:","pos":[8305,8339]},{"content":"Read","pos":[8371,8375]},{"content":"Configuration Manager Collection rights:","pos":[8429,8469]},{"content":"Create- Delete- Read- Modify- Deploy Configuration Items","pos":[8501,8557]},{"content":"Configuration Manager Configuration item rights:","pos":[8610,8658]},{"content":"Create- Delete- Read","pos":[8690,8710]},{"pos":[8836,8899],"content":"Using Windows PowerShell to configure MBAM on a remote computer"},{"content":"When to use this capability","pos":[9026,9053]},{"content":"When you want to configure the MBAM 2.5 Server features on a remote computer.","pos":[9092,9169]},{"content":"The Windows PowerShell cmdlets are running on one computer, and you are configuring the features on a different, remote computer.","pos":[9170,9299]},{"content":"What you have to do","pos":[9361,9380]},{"content":"To use Windows PowerShell to configure MBAM 2.5 Server features on a remote computer, you must:","pos":[9419,9514]},{"content":"Ensure that the MBAM 2.5 Server software has been installed on the remote computer.","pos":[9531,9614]},{"content":"Use the Credential Security Support Provider (CredSSP) Protocol to open the Windows PowerShell session.","pos":[9631,9734]},{"content":"Enable Windows Remote Management (WinRM).","pos":[9751,9792]},{"content":"If you fail to enable WinRM and to configure it correctly, the <ph id=\"ph1\">&lt;strong&gt;</ph>New-PSSession<ph id=\"ph2\">&lt;/strong&gt;</ph> cmdlet that is described in this table displays an error and describes how to fix the issue.","pos":[9793,9979]},{"content":"For more information about WinRM, see <bpt id=\"p1\">[</bpt>Using Windows Remote Management<ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=393064)</ept>.","pos":[9980,10099]},{"content":"Why you have to do it","pos":[10171,10192]},{"content":"This protocol enables the Windows PowerShell cmdlets to connect to Active Directory Domain Services by using the userâ€™s administrative credentials.","pos":[10231,10378]},{"content":"You might get a validation error if you start the Windows PowerShell session without this protocol.","pos":[10379,10478]},{"content":"How to start a Windows PowerShell session with the CredSSP protocol","pos":[10540,10607]},{"content":"Type the following code at the Windows PowerShell prompt:","pos":[10646,10703]},{"content":"The following code shows an example.","pos":[10808,10844]},{"pos":[11108,11180],"content":"Required accounts and corresponding Windows PowerShell cmdlet parameters"},{"content":"The following table describes the accounts that are required to configure MBAM 2.5 Server features.","pos":[11183,11282]},{"content":"It also lists the corresponding Windows PowerShell cmdlet and parameter for which you have to specify the account during configuration.","pos":[11283,11418]},{"pos":[11420,11489],"content":"Cmdlet Parameter Type (User or Group) Description Enable-MBAMDatabase"},{"content":"AccessAccount","pos":[11491,11504]},{"content":"User or Group","pos":[11506,11519]},{"content":"Specify a domain user or group that has read/write permission to this database to give the web applications access to data and reports in this database.","pos":[11521,11673]},{"content":"If the value is a domain user, then the <bpt id=\"p1\">**</bpt>WebServiceApplicationPoolCredential<ept id=\"p1\">**</ept> parameter that is used when running the <bpt id=\"p2\">**</bpt>Enable-MbamWebApplication<ept id=\"p2\">**</ept> cmdlet must use the same user account.","pos":[11674,11862]},{"content":"If the value is a domain Users group, then the domain account that is used by the <bpt id=\"p1\">**</bpt>WebServiceApplicationPoolCredential<ept id=\"p1\">**</ept> parameter must be a member of this group.","pos":[11863,12026]},{"content":"ReportAccount","pos":[12028,12041]},{"content":"User or Group","pos":[12043,12056]},{"content":"Specify a domain user or Users group that has read-only permission to this database to provide the MBAM reports access to the compliance and audit data.","pos":[12058,12210]},{"content":"If the value is a domain user, then the <bpt id=\"p1\">**</bpt>ComplianceAndAuditDBCredential<ept id=\"p1\">**</ept> parameter of the <bpt id=\"p2\">**</bpt>Enable-MbamReport<ept id=\"p2\">**</ept> cmdlet must use the same user account.","pos":[12211,12363]},{"content":"If the value is a domain Users group, then the domain account that is used by the <bpt id=\"p1\">**</bpt>ComplianceAndAuditDBCredential<ept id=\"p1\">**</ept> parameter must be a member of this group.","pos":[12364,12522]},{"content":"Enable-MbamReport","pos":[12524,12541]},{"content":"ComplianceAndAuditDBCredential","pos":[12543,12573]},{"content":"User","pos":[12575,12579]},{"content":"Specifies the administrative credential that the local SSRS instance uses to connect to the MBAM Compliance and Audit Database.","pos":[12581,12708]},{"content":"The domain user in the administrative credential must be the same as the user account that is used for the <bpt id=\"p1\">**</bpt>ReportAccount<ept id=\"p1\">**</ept> parameter, which is used while running the <bpt id=\"p2\">**</bpt>Enable-MbamDatabase<ept id=\"p2\">**</ept> cmdlet.","pos":[12709,12908]},{"content":"If a domain Users group was used with the <bpt id=\"p1\">**</bpt>ReportAccount<ept id=\"p1\">**</ept> parameter, this account should be a member of that group.","pos":[12909,13026]},{"content":"Important","pos":[13030,13039]},{"content":"The account specified in the administrative credentials should have limited user rights for improved security.","pos":[13044,13154]},{"content":"Also, the password of the account should be set to not expire.","pos":[13155,13217]},{"content":"ReportsReadOnlyAccessGroup","pos":[13222,13248]},{"content":"Group","pos":[13250,13255]},{"content":"Specifies the domain user group that has read permissions to the reports.","pos":[13257,13330]},{"content":"The specified group must be the same group that is used for the <bpt id=\"p1\">**</bpt>ReportsReadOnlyAccessGroup<ept id=\"p1\">**</ept> parameter in the <bpt id=\"p2\">**</bpt>Enable-MbamWebApplication<ept id=\"p2\">**</ept> cmdlet.","pos":[13331,13480]},{"content":"Enable-MBAMWebApplication","pos":[13482,13507]},{"content":"AdvancedHelpdeskAccessGroup","pos":[13509,13536]},{"content":"Group","pos":[13538,13543]},{"content":"Specifies the domain Users group that has access to all areas of the Administration and Monitoring Website except the Reports area.","pos":[13545,13676]},{"content":"HelpdeskAccessGroup","pos":[13678,13697]},{"content":"Group","pos":[13699,13704]},{"pos":[13706,13851],"content":"Specifies the domain Users group that has access to the <bpt id=\"p1\">**</bpt>Manage TPM<ept id=\"p1\">**</ept> and <bpt id=\"p2\">**</bpt>Drive Recovery<ept id=\"p2\">**</ept> areas of the Administration and Monitoring Website."},{"content":"ReportsReadOnlyAccessGroup","pos":[13853,13879]},{"content":"Group","pos":[13881,13886]},{"content":"Specifies the domain Users group that has read permission to the <bpt id=\"p1\">**</bpt>Reports<ept id=\"p1\">**</ept> area of the Administration and Monitoring Website.","pos":[13888,14015]},{"content":"The specified group must be the same group that is used for the <bpt id=\"p1\">**</bpt>ReportsReadOnlyAccessGroup<ept id=\"p1\">**</ept> parameter in the <bpt id=\"p2\">**</bpt>Enable-MbamReport<ept id=\"p2\">**</ept> cmdlet.","pos":[14016,14157]},{"content":"WebServiceApplicationPoolCredential","pos":[14159,14194]},{"content":"User","pos":[14196,14200]},{"content":"Specifies the domain user to be used by the application pool for the MBAM web applications.","pos":[14202,14293]},{"content":"It must be the same domain user account that is specified in the <bpt id=\"p1\">**</bpt>AccessAccount<ept id=\"p1\">**</ept> parameter of the <bpt id=\"p2\">**</bpt>Enable-MbamDatabase<ept id=\"p2\">**</ept> cmdlet.","pos":[14294,14425]},{"content":"If a domain Users group was used by the <bpt id=\"p1\">**</bpt>AccessAccount<ept id=\"p1\">**</ept> parameter when running the <bpt id=\"p2\">**</bpt>Enable-MbamDatabase<ept id=\"p2\">**</ept> cmdlet, the domain user that is specified here must be a member of that group.","pos":[14426,14613]},{"content":"If you do not specify the administrative credentials, the administrative credentials that were specified by any previously enabled web application are used.","pos":[14614,14770]},{"content":"All of the web applications use the same application pool identity.","pos":[14771,14838]},{"content":"If it is specified multiple times, the most recently specified value is used.","pos":[14839,14916]},{"content":"Important","pos":[14920,14929]},{"content":"For improved security, set the account that is specified in the administrative credentials to limited user rights.","pos":[14934,15048]},{"content":"Also, set the password of the account to never expire.","pos":[15049,15103]},{"content":"Ensure that either the built-in IIS<ph id=\"ph1\">\\_</ph>IUSRS account or the account that is used for the <bpt id=\"p1\">**</bpt>WebServiceApplicationPoolCredential<ept id=\"p1\">**</ept> parameter has been added to the <bpt id=\"p2\">**</bpt>Impersonate a client after authentication<ept id=\"p2\">**</ept> local security setting.","pos":[15104,15332]},{"pos":[15334,15637],"content":"To view the local security setting, open the <bpt id=\"p1\">**</bpt>Local Security Policy editor<ept id=\"p1\">**</ept>, expand the <bpt id=\"p2\">**</bpt>Local Policies<ept id=\"p2\">**</ept> node, select the <bpt id=\"p3\">**</bpt>User Rights Assignment<ept id=\"p3\">**</ept> node, and then double-click the <bpt id=\"p4\">**</bpt>Impersonate a client after authentication<ept id=\"p4\">**</ept> and <bpt id=\"p5\">**</bpt>Log on as a batch job<ept id=\"p5\">**</ept> Group Policy settings in the details pane."},{"content":"Got a suggestion for MBAM?","pos":[15648,15674]},{"content":"Add or vote on suggestions <bpt id=\"p1\">[</bpt>here<ept id=\"p1\">](http://mbam.uservoice.com/forums/268571-microsoft-bitlocker-administration-and-monitoring)</ept>.","pos":[15677,15802]},{"content":"For MBAM issues, use the <bpt id=\"p1\">[</bpt>MBAM TechNet Forum<ept id=\"p1\">](https://social.technet.microsoft.com/Forums/home?forum=mdopmbam)</ept>.","pos":[15803,15914]},{"content":"Related topics","pos":[15919,15933]},{"content":"Configuring the MBAM 2.5 Server Features","pos":[15937,15977]},{"content":"Validating the MBAM 2.5 Server Feature Configuration","pos":[16025,16077]},{"content":"Using Windows PowerShell to Administer MBAM 2.5","pos":[16137,16184]}],"content":"---\ntitle: Configuring MBAM 2.5 Server Features by Using Windows PowerShell\ndescription: Configuring MBAM 2.5 Server Features by Using Windows PowerShell\nauthor: jamiejdt\nms.assetid: 826429fd-29bb-44be-b47e-5f5c7d20dd1d\nms.pagetype: mdop, security\nms.mktglfcycl: manage\nms.sitesec: library\nms.prod: w10\n---\n\n\n# Configuring MBAM 2.5 Server Features by Using Windows PowerShell\n\n\nAfter you install the MBAM 2.5 Server software, you can use configure MBAM 2.5 Server features by using Windows PowerShell cmdlets or the MBAM Server Configuration wizard. This topic describes how to configure MBAM 2.5 by using the Windows PowerShell cmdlets. To use the wizard instead, see [Configuring the MBAM 2.5 Server Features](configuring-the-mbam-25-server-features.md).\n\n## In this topic\n\n\nThis topic includes the following information about using Windows PowerShell to configure MBAM:\n\n-   [How to load Windows PowerShell Help for MBAM 2.5](#bkmk-load-posh-help)\n\n-   [How to get Help about an MBAM Windows PowerShell cmdlet](#bkmk-help-specific-cmdlet)\n\n-   [Configurations that you can do only with Windows PowerShell but not with the MBAM Server Configuration wizard](#bkmk-config-only-posh)\n\n-   [Prerequisites and requirements for using Windows PowerShell to configure MBAM Server features](#bkmk-prereqs-posh-mbamsvr)\n\n-   [Using Windows PowerShell to configure MBAM on a remote computer](#bkmk-remote-config)\n\n-   [Required accounts and corresponding Windows PowerShell cmdlet parameters](#bkmk-reqd-posh-accts)\n\nFor information about the **Get-MbamBitLockerRecoveryKey** and **Get-MbamTPMOwnerPassword** Windows PowerShell cmdlets, which are used to administer MBAM, see [Using Windows PowerShell to Administer MBAM 2.5](using-windows-powershell-to-administer-mbam-25.md).\n\n## <a href=\"\" id=\"bkmk-load-posh-help\"></a>How to load Windows PowerShell Help for MBAM 2.5\n\n\nFor a list of the Windows PowerShell cmdlets on TechNet, see [Microsoft Desktop Optimization Pack Automation with Windows PowerShell](http://go.microsoft.com/fwlink/?LinkId=392816).\n\n**To load the MBAM 2.5 Help for Windows PowerShell cmdlets after installing the MBAM Server software**\n\n1.  Open Windows PowerShell or Windows PowerShell Integrated Scripting Environment (ISE).\n\n2.  Type **Update-Help â€“Module Microsoft.MBAM**.\n\n## <a href=\"\" id=\"bkmk-help-specific-cmdlet\"></a>How to get Help about an MBAM Windows PowerShell cmdlet\n\n\nWindows PowerShell Help for MBAM is available in the following formats:\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Windows PowerShell Help format</th>\n<th align=\"left\">More information</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>At a Windows PowerShell command prompt, type <strong>Get-Help</strong> &lt;<em>cmdlet</em>&gt;</p></td>\n<td align=\"left\"><p>To upload the latest Windows PowerShell cmdlets, follow the instructions in the previous section on how to load Windows PowerShell Help for MBAM.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>On TechNet as webpages</p></td>\n<td align=\"left\"><p>http://go.microsoft.com/fwlink/?LinkId=393498</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>On the Download Center as a Word .docx file</p></td>\n<td align=\"left\"><p>http://go.microsoft.com/fwlink/?LinkId=393497</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>On the Download Center as a .pdf file</p></td>\n<td align=\"left\"><p>http://go.microsoft.com/fwlink/?LinkId=393499</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n## <a href=\"\" id=\"bkmk-config-only-posh\"></a>Configurations that you can do only with Windows PowerShell but not with the MBAM Server Configuration wizard\n\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Configurations that you can do only by using Windows PowerShell</th>\n<th align=\"left\">Details</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Install the web services on a separate computer from the web applications.</p></td>\n<td align=\"left\"><p>Using the wizard, you must install the web services and web applications on the same computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Enable reports on a separate reporting services point without installing all of the Configuration Manager objects.</p></td>\n<td align=\"left\"><p></p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Delete all of the objects from Configuration Manager.</p></td>\n<td align=\"left\"><p>Deleting the objects in turn deletes all of the compliance data from Configuration Manager.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Enter a custom connection string for the databases.</p></td>\n<td align=\"left\"><p>Example: To configure the web applications to work with mirroring, you must use the <strong>Enable-MbamWebApplication</strong> cmdlet to specify the appropriate failover partner syntax in the connection string.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Skip validation and configure a feature even though the prerequisite check failed.</p></td>\n<td align=\"left\"></td>\n</tr>\n</tbody>\n</table>\n\n \n\n**Note**  \nYou cannot disable the MBAM databases with a Windows PowerShell cmdlet or the MBAM Server Configuration wizard. To prevent the accidental removal of your compliance and audit data, database administrators must remove databases manually.\n\n \n\n## <a href=\"\" id=\"bkmk-prereqs-posh-mbamsvr\"></a>Prerequisites and requirements for using Windows PowerShell to configure MBAM Server features\n\n\nBefore starting the configuration, complete the following prerequisites.\n\n**Account-related prerequisites**\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Prerequisite</th>\n<th align=\"left\">Details or additional information</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Create the required accounts.</p></td>\n<td align=\"left\"><p>See section <strong>Required accounts and corresponding Windows PowerShell cmdlet parameters</strong> later in this topic.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>User accounts and groups that you pass as parameters to the Windows PowerShell cmdlets must be valid accounts in the domain.</p></td>\n<td align=\"left\"><p>You cannot use local accounts.</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Specify accounts in the down-level format.</p></td>\n<td align=\"left\"><p>Examples:</p>\n<p>domainNetBiosName\\userdomainNetBiosName\\group</p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n**Permission-related prerequisites**\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Prerequisite</th>\n<th align=\"left\">Details or additional information</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>You must be an administrator on the local computer where you are configuring the MBAM feature.</p></td>\n<td align=\"left\"><p></p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Use an elevated Windows PowerShell command prompt to run all Windows PowerShell cmdlets.</p></td>\n<td align=\"left\"><p></p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>For the <strong>Enable-MbamDatabase</strong> cmdlet only:</p>\n<p>You must have &quot;create any database&quot; permissions on the instance of the target Microsoft SQL Server database.</p>\n<p>This user account must be a part of the local administrators group or the Backup Operators group to register the MBAM Volume Shadow Copy Service (VSS) Writer.</p></td>\n<td align=\"left\"><p>By default, the database administrator or system administrator has the required &quot;create any database&quot; permissions.</p>\n<p></p>\n<p>For more information about VSS Writer, see [Volume Shadow Copy Service](http://go.microsoft.com/fwlink/?LinkId=392814).</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>For the <strong>System Center Configuration Manager Integration</strong> feature only:</p>\n<p>The user who enables this feature must have these rights in Configuration Manager:</p></td>\n<td align=\"left\"><table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\">Type of rights in Configuration Manager</th>\n<th align=\"left\">Required rights</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p>Configuration Manager Site rights:</p></td>\n<td align=\"left\"><p>- Read</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p>Configuration Manager Collection rights:</p></td>\n<td align=\"left\"><p>- Create- Delete- Read- Modify- Deploy Configuration Items</p></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p>Configuration Manager Configuration item rights:</p></td>\n<td align=\"left\"><p>- Create- Delete- Read</p></td>\n</tr>\n</tbody>\n</table>\n<p> </p>\n<p></p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n## <a href=\"\" id=\"bkmk-remote-config\"></a>Using Windows PowerShell to configure MBAM on a remote computer\n\n\n<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><strong>When to use this capability</strong></p></td>\n<td align=\"left\"><p>When you want to configure the MBAM 2.5 Server features on a remote computer. The Windows PowerShell cmdlets are running on one computer, and you are configuring the features on a different, remote computer.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><strong>What you have to do</strong></p></td>\n<td align=\"left\"><p>To use Windows PowerShell to configure MBAM 2.5 Server features on a remote computer, you must:</p>\n<ul>\n<li><p>Ensure that the MBAM 2.5 Server software has been installed on the remote computer.</p></li>\n<li><p>Use the Credential Security Support Provider (CredSSP) Protocol to open the Windows PowerShell session.</p></li>\n<li><p>Enable Windows Remote Management (WinRM). If you fail to enable WinRM and to configure it correctly, the <strong>New-PSSession</strong> cmdlet that is described in this table displays an error and describes how to fix the issue. For more information about WinRM, see [Using Windows Remote Management](http://go.microsoft.com/fwlink/?LinkId=393064).</p></li>\n</ul></td>\n</tr>\n<tr class=\"odd\">\n<td align=\"left\"><p><strong>Why you have to do it</strong></p></td>\n<td align=\"left\"><p>This protocol enables the Windows PowerShell cmdlets to connect to Active Directory Domain Services by using the userâ€™s administrative credentials. You might get a validation error if you start the Windows PowerShell session without this protocol.</p></td>\n</tr>\n<tr class=\"even\">\n<td align=\"left\"><p><strong>How to start a Windows PowerShell session with the CredSSP protocol</strong></p></td>\n<td align=\"left\"><p>Type the following code at the Windows PowerShell prompt:</p>\n<p><code>$s = New-PSSession -ComputerName xxx -Authentication Credssp -Credential xxx</code></p>\n<p>The following code shows an example.</p>\n<p><code>$session = New-PSSession -ComputerName &lt;MBAM_server_name&gt; -Authentication Credssp -Credential (Get-Credential)</code></p>\n<p><code>Enter-PSSession $session</code></p></td>\n</tr>\n</tbody>\n</table>\n\n \n\n## <a href=\"\" id=\"bkmk-reqd-posh-accts\"></a>Required accounts and corresponding Windows PowerShell cmdlet parameters\n\n\nThe following table describes the accounts that are required to configure MBAM 2.5 Server features. It also lists the corresponding Windows PowerShell cmdlet and parameter for which you have to specify the account during configuration.\n\nCmdlet\nParameter\nType (User or Group)\nDescription\nEnable-MBAMDatabase\n\nAccessAccount\n\nUser or Group\n\nSpecify a domain user or group that has read/write permission to this database to give the web applications access to data and reports in this database. If the value is a domain user, then the **WebServiceApplicationPoolCredential** parameter that is used when running the **Enable-MbamWebApplication** cmdlet must use the same user account. If the value is a domain Users group, then the domain account that is used by the **WebServiceApplicationPoolCredential** parameter must be a member of this group.\n\nReportAccount\n\nUser or Group\n\nSpecify a domain user or Users group that has read-only permission to this database to provide the MBAM reports access to the compliance and audit data. If the value is a domain user, then the **ComplianceAndAuditDBCredential** parameter of the **Enable-MbamReport** cmdlet must use the same user account. If the value is a domain Users group, then the domain account that is used by the **ComplianceAndAuditDBCredential** parameter must be a member of this group.\n\nEnable-MbamReport\n\nComplianceAndAuditDBCredential\n\nUser\n\nSpecifies the administrative credential that the local SSRS instance uses to connect to the MBAM Compliance and Audit Database. The domain user in the administrative credential must be the same as the user account that is used for the **ReportAccount** parameter, which is used while running the **Enable-MbamDatabase** cmdlet. If a domain Users group was used with the **ReportAccount** parameter, this account should be a member of that group.\n\n**Important**  \nThe account specified in the administrative credentials should have limited user rights for improved security. Also, the password of the account should be set to not expire.\n\n \n\nReportsReadOnlyAccessGroup\n\nGroup\n\nSpecifies the domain user group that has read permissions to the reports. The specified group must be the same group that is used for the **ReportsReadOnlyAccessGroup** parameter in the **Enable-MbamWebApplication** cmdlet.\n\nEnable-MBAMWebApplication\n\nAdvancedHelpdeskAccessGroup\n\nGroup\n\nSpecifies the domain Users group that has access to all areas of the Administration and Monitoring Website except the Reports area.\n\nHelpdeskAccessGroup\n\nGroup\n\nSpecifies the domain Users group that has access to the **Manage TPM** and **Drive Recovery** areas of the Administration and Monitoring Website.\n\nReportsReadOnlyAccessGroup\n\nGroup\n\nSpecifies the domain Users group that has read permission to the **Reports** area of the Administration and Monitoring Website. The specified group must be the same group that is used for the **ReportsReadOnlyAccessGroup** parameter in the **Enable-MbamReport** cmdlet.\n\nWebServiceApplicationPoolCredential\n\nUser\n\nSpecifies the domain user to be used by the application pool for the MBAM web applications. It must be the same domain user account that is specified in the **AccessAccount** parameter of the **Enable-MbamDatabase** cmdlet. If a domain Users group was used by the **AccessAccount** parameter when running the **Enable-MbamDatabase** cmdlet, the domain user that is specified here must be a member of that group. If you do not specify the administrative credentials, the administrative credentials that were specified by any previously enabled web application are used. All of the web applications use the same application pool identity. If it is specified multiple times, the most recently specified value is used.\n\n**Important**  \nFor improved security, set the account that is specified in the administrative credentials to limited user rights. Also, set the password of the account to never expire. Ensure that either the built-in IIS\\_IUSRS account or the account that is used for the **WebServiceApplicationPoolCredential** parameter has been added to the **Impersonate a client after authentication** local security setting.\n\nTo view the local security setting, open the **Local Security Policy editor**, expand the **Local Policies** node, select the **User Rights Assignment** node, and then double-click the **Impersonate a client after authentication** and **Log on as a batch job** Group Policy settings in the details pane.\n\n \n\n \n\n## Got a suggestion for MBAM?\n\n\nAdd or vote on suggestions [here](http://mbam.uservoice.com/forums/268571-microsoft-bitlocker-administration-and-monitoring). For MBAM issues, use the [MBAM TechNet Forum](https://social.technet.microsoft.com/Forums/home?forum=mdopmbam).\n\n## Related topics\n\n\n[Configuring the MBAM 2.5 Server Features](configuring-the-mbam-25-server-features.md)\n\n[Validating the MBAM 2.5 Server Feature Configuration](validating-the-mbam-25-server-feature-configuration.md)\n\n[Using Windows PowerShell to Administer MBAM 2.5](using-windows-powershell-to-administer-mbam-25.md)\n\n \n\n \n\n\n\n\n\n"}