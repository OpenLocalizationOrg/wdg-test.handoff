{"nodes":[{"content":"Monitor app usage with AppLocker (Windows 10)","pos":[11,56]},{"content":"This topic for IT professionals describes how to monitor app usage when AppLocker policies are applied.","pos":[70,173]},{"content":"Monitor app usage with AppLocker","pos":[329,361]},{"content":"Applies to","pos":[365,375]},{"content":"Windows 10","pos":[382,392]},{"content":"This topic for IT professionals describes how to monitor app usage when AppLocker policies are applied.","pos":[394,497]},{"content":"Once you set rules and deploy the AppLocker policies, it is good practice to determine if the policy implementation is what you expected.","pos":[499,636]},{"pos":[690,732],"content":"Discover the effect of an AppLocker policy"},{"content":"You can evaluate how the AppLocker policy is currently implemented for documentation or audit purposes, or before you modify the policy.","pos":[734,870]},{"content":"Updating your AppLocker Policy Deployment Planning document will help you track your findings.","pos":[871,965]},{"content":"For information about creating this document, see <bpt id=\"p1\">[</bpt>Create your AppLocker planning document<ept id=\"p1\">](create-your-applocker-planning-document.md)</ept>.","pos":[966,1102]},{"content":"You can perform one or more of the following steps to understand what application controls are currently enforced through AppLocker rules.","pos":[1103,1241]},{"content":"Analyze the AppLocker logs in Event Viewer","pos":[1249,1291]},{"content":"When AppLocker policy enforcement is set to <bpt id=\"p1\">**</bpt>Enforce rules<ept id=\"p1\">**</ept>, rules are enforced for the rule collection and all events are audited.","pos":[1299,1432]},{"content":"When AppLocker policy enforcement is set to <bpt id=\"p1\">**</bpt>Audit only<ept id=\"p1\">**</ept>, rules are not enforced but are still evaluated to generate audit event data that is written to the AppLocker logs.","pos":[1433,1607]},{"pos":[1613,1718],"content":"For the procedure to access the log, see <bpt id=\"p1\">[</bpt>View the AppLocker Log in Event Viewer<ept id=\"p1\">](#bkmk-applkr-view-log)</ept>."},{"content":"Enable the Audit only AppLocker enforcement setting","pos":[1726,1777]},{"content":"By using the <bpt id=\"p1\">**</bpt>Audit only<ept id=\"p1\">**</ept> enforcement setting, you can ensure that the AppLocker rules are properly configured for your organization.","pos":[1785,1920]},{"content":"When AppLocker policy enforcement is set to <bpt id=\"p1\">**</bpt>Audit only<ept id=\"p1\">**</ept>, rules are only evaluated but all events generated from that evaluation are written to the AppLocker log.","pos":[1921,2085]},{"pos":[2091,2221],"content":"For the procedure to do this, see <bpt id=\"p1\">[</bpt>Configure an AppLocker policy for audit only<ept id=\"p1\">](configure-an-applocker-policy-for-audit-only.md)</ept>."},{"content":"Review AppLocker events with Get-AppLockerFileInformation","pos":[2229,2286]},{"pos":[2294,2593],"content":"For both event subscriptions and local events, you can use the <bpt id=\"p1\">**</bpt>Get-AppLockerFileInformation<ept id=\"p1\">**</ept> Windows PowerShell cmdlet to determine which files have been blocked or would have been blocked (if you are using the audit-only enforcement mode) and how many times the event has occurred for each file."},{"pos":[2599,2721],"content":"For the procedure to do this, see <bpt id=\"p1\">[</bpt>Review AppLocker Events with Get-AppLockerFileInformation<ept id=\"p1\">](#bkmk-applkr-review-events)</ept>."},{"content":"Review AppLocker events with Test-AppLockerPolicy","pos":[2729,2778]},{"pos":[2786,3002],"content":"You can use the <bpt id=\"p1\">**</bpt>Test-AppLockerPolicy<ept id=\"p1\">**</ept> Windows PowerShell cmdlet to determine whether any of the rules in your rule collections will be blocked on your reference device or the device on which you maintain policies."},{"pos":[3008,3158],"content":"For the procedure to do this, see <bpt id=\"p1\">[</bpt>Test an AppLocker policy by using Test-AppLockerPolicy<ept id=\"p1\">](test-an-applocker-policy-by-using-test-applockerpolicy.md)</ept>."},{"pos":[3210,3267],"content":"Review AppLocker events with Get-AppLockerFileInformation"},{"pos":[3269,3572],"content":"For both event subscriptions and local events, you can use the <bpt id=\"p1\">**</bpt>Get-AppLockerFileInformation<ept id=\"p1\">**</ept> Windows PowerShell cmdlet to determine which files have been blocked or would have been blocked (if the <bpt id=\"p2\">**</bpt>Audit only<ept id=\"p2\">**</ept> enforcement setting is applied) and how many times the event has occurred for each file."},{"pos":[3574,3690],"content":"Membership in the local <bpt id=\"p1\">**</bpt>Administrators<ept id=\"p1\">**</ept> group, or equivalent, is the minimum required to complete this procedure."},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  If the AppLocker logs are not on your local device, you will need permission to view the logs.","pos":[3693,3798]},{"content":"If the output is saved to a file, you will need permission to read that file.","pos":[3799,3876]},{"content":"To review AppLocker events with Get-AppLockerFileInformation","pos":[3881,3941]},{"pos":[3949,4014],"content":"At the command prompt, type <bpt id=\"p1\">**</bpt>PowerShell<ept id=\"p1\">**</ept>, and then press ENTER."},{"content":"Run the following command to review how many times a file would have been blocked from running if rules were enforced:","pos":[4019,4137]},{"content":"Run the following command to review how many times a file has been allowed to run or prevented from running:","pos":[4220,4328]},{"pos":[4452,4490],"content":"View the AppLocker Log in Event Viewer"},{"content":"When AppLocker policy enforcement is set to <bpt id=\"p1\">**</bpt>Enforce rules<ept id=\"p1\">**</ept>, rules are enforced for the rule collection and all events are audited.","pos":[4492,4625]},{"content":"When AppLocker policy enforcement is set to <bpt id=\"p1\">**</bpt>Audit only<ept id=\"p1\">**</ept>, rules are only evaluated but all events generated from that evaluation are written to the AppLocker log.","pos":[4626,4790]},{"pos":[4792,4908],"content":"Membership in the local <bpt id=\"p1\">**</bpt>Administrators<ept id=\"p1\">**</ept> group, or equivalent, is the minimum required to complete this procedure."},{"content":"To view events in the AppLocker log by using Event Viewer","pos":[4912,4969]},{"content":"Open Event Viewer.","pos":[4977,4995]},{"content":"To do this, click <bpt id=\"p1\">**</bpt>Start<ept id=\"p1\">**</ept>, type <bpt id=\"p2\">**</bpt>eventvwr.msc<ept id=\"p2\">**</ept>, and then press ENTER.","pos":[4996,5069]},{"pos":[5074,5182],"content":"In the console tree under <bpt id=\"p1\">**</bpt>Application and Services Logs<ph id=\"ph1\">\\\\</ph>Microsoft<ph id=\"ph2\">\\\\</ph>Windows<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>AppLocker<ept id=\"p2\">**</ept>."},{"content":"AppLocker events are listed in either the <bpt id=\"p1\">**</bpt>EXE and DLL<ept id=\"p1\">**</ept> log, the <bpt id=\"p2\">**</bpt>MSI and Script<ept id=\"p2\">**</ept> log, or the <bpt id=\"p3\">**</bpt>Packaged app-Deployment<ept id=\"p3\">**</ept> or <bpt id=\"p4\">**</bpt>Packaged app-Execution<ept id=\"p4\">**</ept> log.","pos":[5184,5344]},{"content":"Event information includes the enforcement setting, file name, date and time, and user name.","pos":[5345,5437]},{"content":"The logs can be exported to other file formats for further analysis.","pos":[5438,5507]},{"content":"Related topics","pos":[5512,5526]},{"content":"AppLocker","pos":[5531,5540]}],"content":"---\ntitle: Monitor app usage with AppLocker (Windows 10)\ndescription: This topic for IT professionals describes how to monitor app usage when AppLocker policies are applied.\nms.assetid: 0516da6e-ebe4-45b4-a97b-31daba96d1cf\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Monitor app usage with AppLocker\n\n**Applies to**\n-   Windows 10\n\nThis topic for IT professionals describes how to monitor app usage when AppLocker policies are applied.\n\nOnce you set rules and deploy the AppLocker policies, it is good practice to determine if the policy implementation is what you expected.\n\n### <a href=\"\" id=\"bkmk-applkr-disc-effect-pol\"></a>Discover the effect of an AppLocker policy\n\nYou can evaluate how the AppLocker policy is currently implemented for documentation or audit purposes, or before you modify the policy. Updating your AppLocker Policy Deployment Planning document will help you track your findings. For information about creating this document, see [Create your AppLocker planning document](create-your-applocker-planning-document.md). You can perform one or more of the following steps to understand what application controls are currently enforced through AppLocker rules.\n\n-   **Analyze the AppLocker logs in Event Viewer**\n\n    When AppLocker policy enforcement is set to **Enforce rules**, rules are enforced for the rule collection and all events are audited. When AppLocker policy enforcement is set to **Audit only**, rules are not enforced but are still evaluated to generate audit event data that is written to the AppLocker logs.\n\n    For the procedure to access the log, see [View the AppLocker Log in Event Viewer](#bkmk-applkr-view-log).\n\n-   **Enable the Audit only AppLocker enforcement setting**\n\n    By using the **Audit only** enforcement setting, you can ensure that the AppLocker rules are properly configured for your organization. When AppLocker policy enforcement is set to **Audit only**, rules are only evaluated but all events generated from that evaluation are written to the AppLocker log.\n\n    For the procedure to do this, see [Configure an AppLocker policy for audit only](configure-an-applocker-policy-for-audit-only.md).\n\n-   **Review AppLocker events with Get-AppLockerFileInformation**\n\n    For both event subscriptions and local events, you can use the **Get-AppLockerFileInformation** Windows PowerShell cmdlet to determine which files have been blocked or would have been blocked (if you are using the audit-only enforcement mode) and how many times the event has occurred for each file.\n\n    For the procedure to do this, see [Review AppLocker Events with Get-AppLockerFileInformation](#bkmk-applkr-review-events).\n\n-   **Review AppLocker events with Test-AppLockerPolicy**\n\n    You can use the **Test-AppLockerPolicy** Windows PowerShell cmdlet to determine whether any of the rules in your rule collections will be blocked on your reference device or the device on which you maintain policies.\n\n    For the procedure to do this, see [Test an AppLocker policy by using Test-AppLockerPolicy](test-an-applocker-policy-by-using-test-applockerpolicy.md).\n\n### <a href=\"\" id=\"bkmk-applkr-review-events\"></a>Review AppLocker events with Get-AppLockerFileInformation\n\nFor both event subscriptions and local events, you can use the **Get-AppLockerFileInformation** Windows PowerShell cmdlet to determine which files have been blocked or would have been blocked (if the **Audit only** enforcement setting is applied) and how many times the event has occurred for each file.\n\nMembership in the local **Administrators** group, or equivalent, is the minimum required to complete this procedure.\n\n>**Note:**  If the AppLocker logs are not on your local device, you will need permission to view the logs. If the output is saved to a file, you will need permission to read that file.\n \n**To review AppLocker events with Get-AppLockerFileInformation**\n\n1.  At the command prompt, type **PowerShell**, and then press ENTER.\n2.  Run the following command to review how many times a file would have been blocked from running if rules were enforced:\n\n    `Get-AppLockerFileInformation –EventLog –EventType Audited –Statistics`\n\n3.  Run the following command to review how many times a file has been allowed to run or prevented from running:\n\n    `Get-AppLockerFileInformation –EventLog –EventType Allowed –Statistics`\n\n### <a href=\"\" id=\"bkmk-applkr-view-log\"></a>View the AppLocker Log in Event Viewer\n\nWhen AppLocker policy enforcement is set to **Enforce rules**, rules are enforced for the rule collection and all events are audited. When AppLocker policy enforcement is set to **Audit only**, rules are only evaluated but all events generated from that evaluation are written to the AppLocker log.\n\nMembership in the local **Administrators** group, or equivalent, is the minimum required to complete this procedure.\n\n**To view events in the AppLocker log by using Event Viewer**\n\n1.  Open Event Viewer. To do this, click **Start**, type **eventvwr.msc**, and then press ENTER.\n2.  In the console tree under **Application and Services Logs\\\\Microsoft\\\\Windows**, double-click **AppLocker**.\n\nAppLocker events are listed in either the **EXE and DLL** log, the **MSI and Script** log, or the **Packaged app-Deployment** or **Packaged app-Execution** log. Event information includes the enforcement setting, file name, date and time, and user name. The logs can be exported to other file \nformats for further analysis.\n\n## Related topics\n\n- [AppLocker](applocker-overview.md)\n"}