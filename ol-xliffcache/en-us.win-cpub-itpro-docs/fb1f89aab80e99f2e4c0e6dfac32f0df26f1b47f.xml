{"nodes":[{"content":"Getting Started with the User State Migration Tool (USMT) (Windows 10)","pos":[11,81]},{"content":"Getting Started with the User State Migration Tool (USMT)","pos":[95,152]},{"content":"Getting Started with the User State Migration Tool (USMT)","pos":[285,342]},{"content":"This topic outlines the general process that you should follow to migrate files and settings.","pos":[343,436]},{"content":"In this Topic","pos":[441,454]},{"content":"Step 1: Plan Your Migration","pos":[460,487]},{"content":"Step 2: Collect files and settings from the source computer","pos":[524,583]},{"content":"Step 3: Prepare the destination computer and restore files and settings","pos":[652,723]},{"content":"Step 1: Plan your migration","pos":[802,829]},{"content":"<bpt id=\"p1\">[</bpt>Plan Your Migration<ept id=\"p1\">](usmt-plan-your-migration.md)</ept>.","pos":[834,885]},{"content":"Depending on whether your migration scenario is refreshing or replacing computers, you can choose an online migration or an offline migration using Windows Preinstallation Environment (WinPE) or the files in the Windows.old directory.","pos":[886,1120]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Common Migration Scenarios<ept id=\"p1\">](usmt-common-migration-scenarios.md)</ept>.","pos":[1121,1212]},{"content":"<bpt id=\"p1\">[</bpt>Determine What to Migrate<ept id=\"p1\">](usmt-determine-what-to-migrate.md)</ept>.","pos":[1218,1281]},{"content":"Data you might consider migrating includes end-user information, applications settings, operating-system settings, files, folders, and registry keys.","pos":[1282,1431]},{"content":"Determine where to store data.","pos":[1437,1467]},{"content":"Depending on the size of your migration store, you can store the data remotely, locally in a hard-link migration store or on a local external storage device, or directly on the destination computer.","pos":[1468,1666]},{"content":"For more information, see <bpt id=\"p1\">[</bpt>Choose a Migration Store Type<ept id=\"p1\">](usmt-choose-migration-store-type.md)</ept>.","pos":[1667,1762]},{"content":"Use the <bpt id=\"p1\">**</bpt>/GenMigXML<ept id=\"p1\">**</ept> command-line option to determine which files will be included in your migration, and to determine whether any modifications are necessary.","pos":[1768,1929]},{"content":"For more information see <bpt id=\"p1\">[</bpt>ScanState Syntax<ept id=\"p1\">](usmt-scanstate-syntax.md)</ept>","pos":[1930,1999]},{"content":"Modify copies of the Migration.xml and MigDocs.xml files and create custom .xml files, if it is required.","pos":[2005,2110]},{"content":"To modify the migration behavior, such as migrating the <bpt id=\"p1\">**</bpt>Documents<ept id=\"p1\">**</ept> folder but not the <bpt id=\"p2\">**</bpt>Music<ept id=\"p2\">**</ept> folder, you can create a custom .xml file or modify the rules in the existing migration .xml files.","pos":[2111,2309]},{"content":"The document finder, or <bpt id=\"p1\">**</bpt>MigXmlHelper.GenerateDocPatterns<ept id=\"p1\">**</ept> helper function, can be used to automatically find user documents on a computer without creating extensive custom migration .xml files.","pos":[2310,2506]},{"pos":[2512,2690],"content":"**Important**  \nWe recommend that you always make and modify copies of the .xml files included in User State Migration Tool (USMT) 10.0. Never modify the original .xml files.","leadings":["","    "],"nodes":[{"content":"Important","pos":[2,11]},{"content":"We recommend that you always make and modify copies of the .xml files included in User State Migration Tool (USMT) 10.0. Never modify the original .xml files.","pos":[16,174],"nodes":[{"content":"We recommend that you always make and modify copies of the .xml files included in User State Migration Tool (USMT) 10.0.","pos":[0,120]},{"content":"Never modify the original .xml files.","pos":[121,158]}]}]},{"content":"You can use the MigXML.xsd file to help you write and validate the .xml files.","pos":[2700,2778]},{"content":"For more information about how to modify these files, see <bpt id=\"p1\">[</bpt>USMT XML Reference<ept id=\"p1\">](usmt-xml-reference.md)</ept>.","pos":[2779,2881]},{"content":"Create a <bpt id=\"p1\">[</bpt>Config.xml File<ept id=\"p1\">](usmt-configxml-file.md)</ept> if you want to exclude any components from the migration.","pos":[2887,2995]},{"content":"To create this file, use the <bpt id=\"p1\">[</bpt>ScanState Syntax<ept id=\"p1\">](usmt-scanstate-syntax.md)</ept> option together with the other .xml files when you use the <bpt id=\"p2\">**</bpt>ScanState<ept id=\"p2\">**</ept> command.","pos":[2996,3151]},{"content":"For example, the following command creates a Config.xml file by using the MigDocs and MigApp.xml files:","pos":[3152,3255]},{"pos":[3352,3504],"content":"Review the migration state of the components listed in the Config.xml file, and specify <ph id=\"ph1\">`migrate=no`</ph> for any components that you do not want to migrate."},{"content":"Step 2: Collect files and settings from the source computer","pos":[3509,3568]},{"content":"Back up the source computer.","pos":[3573,3601]},{"content":"Close all applications.","pos":[3607,3630]},{"content":"If some applications are running when you run the <bpt id=\"p1\">**</bpt>ScanState<ept id=\"p1\">**</ept> command, USMT might not migrate all of the specified data.","pos":[3631,3753]},{"content":"For example, if Microsoft® Office Outlook® is open, USMT might not migrate PST files.","pos":[3754,3839]},{"pos":[3845,4277],"content":"**Note**  \nUSMT will fail if it cannot migrate a file or setting unless you specify the **/C** option. When you specify the **/C** option, USMT will ignore the errors, and log an error every time that it encounters a file that is being used that USMT did not migrate. You can use the **&lt;ErrorControl&gt;** section in the Config.xml file to specify which errors should be ignored, and which should cause the migration to fail.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"USMT will fail if it cannot migrate a file or setting unless you specify the **/C** option. When you specify the **/C** option, USMT will ignore the errors, and log an error every time that it encounters a file that is being used that USMT did not migrate. You can use the **&lt;ErrorControl&gt;** section in the Config.xml file to specify which errors should be ignored, and which should cause the migration to fail.","pos":[11,428],"nodes":[{"content":"USMT will fail if it cannot migrate a file or setting unless you specify the <bpt id=\"p1\">**</bpt>/C<ept id=\"p1\">**</ept> option.","pos":[0,91]},{"content":"When you specify the <bpt id=\"p1\">**</bpt>/C<ept id=\"p1\">**</ept> option, USMT will ignore the errors, and log an error every time that it encounters a file that is being used that USMT did not migrate.","pos":[92,256]},{"content":"You can use the <bpt id=\"p1\">**</bpt><ph id=\"ph1\">&amp;lt;</ph>ErrorControl<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p1\">**</ept> section in the Config.xml file to specify which errors should be ignored, and which should cause the migration to fail.","pos":[257,417]}]}]},{"content":"Run the <bpt id=\"p1\">**</bpt>ScanState<ept id=\"p1\">**</ept> command on the source computer to collect files and settings.","pos":[4283,4366]},{"content":"You should specify all of the .xml files that you want the <bpt id=\"p1\">**</bpt>ScanState<ept id=\"p1\">**</ept> command to use.","pos":[4367,4455]},{"content":"For example,","pos":[4456,4468]},{"pos":[4584,5104],"content":"**Note**  \nIf the source computer is running Windows 7, or Windows 8, you must run the **ScanState** command in **Administrator** mode. To run in **Administrator** mode, right-click **Command Prompt**, and then click **Run As Administrator**. If the source computer is running Windows XP, you must run the **ScanState** command from an account that has administrative credentials. For more information about the how the **ScanState** command processes and stores the data, see [How USMT Works](usmt-how-it-works.md).","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"If the source computer is running Windows 7, or Windows 8, you must run the **ScanState** command in **Administrator** mode. To run in **Administrator** mode, right-click **Command Prompt**, and then click **Run As Administrator**. If the source computer is running Windows XP, you must run the **ScanState** command from an account that has administrative credentials. For more information about the how the **ScanState** command processes and stores the data, see [How USMT Works](usmt-how-it-works.md).","pos":[11,516],"nodes":[{"content":"If the source computer is running Windows 7, or Windows 8, you must run the <bpt id=\"p1\">**</bpt>ScanState<ept id=\"p1\">**</ept> command in <bpt id=\"p2\">**</bpt>Administrator<ept id=\"p2\">**</ept> mode.","pos":[0,124]},{"content":"To run in <bpt id=\"p1\">**</bpt>Administrator<ept id=\"p1\">**</ept> mode, right-click <bpt id=\"p2\">**</bpt>Command Prompt<ept id=\"p2\">**</ept>, and then click <bpt id=\"p3\">**</bpt>Run As Administrator<ept id=\"p3\">**</ept>.","pos":[125,231]},{"content":"If the source computer is running Windows XP, you must run the <bpt id=\"p1\">**</bpt>ScanState<ept id=\"p1\">**</ept> command from an account that has administrative credentials.","pos":[232,369]},{"content":"For more information about the how the <bpt id=\"p1\">**</bpt>ScanState<ept id=\"p1\">**</ept> command processes and stores the data, see <bpt id=\"p2\">[</bpt>How USMT Works<ept id=\"p2\">](usmt-how-it-works.md)</ept>.","pos":[370,505]}]}]},{"pos":[5110,5222],"content":"Run the <bpt id=\"p1\">**</bpt>USMTUtils<ept id=\"p1\">**</ept> command with the <bpt id=\"p2\">**</bpt>/Verify<ept id=\"p2\">**</ept> option to ensure that the store you created is not corrupted."},{"content":"Step 3: Prepare the destination computer and restore files and settings","pos":[5227,5298]},{"content":"Install the operating system on the destination computer.","pos":[5303,5360]},{"content":"Install all applications that were on the source computer.","pos":[5366,5424]},{"content":"Although it is not always required, we recommend installing all applications on the destination computer before you restore the user state.","pos":[5425,5564]},{"content":"This makes sure that migrated settings are preserved.","pos":[5565,5618]},{"pos":[5624,5983],"content":"**Note**  \nThe application version that is installed on the destination computer should be the same version as the one on the source computer. USMT does not support migrating the settings for an older version of an application to a newer version. The exception to this is Microsoft® Office, which USMT can migrate from an older version to a newer version.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"The application version that is installed on the destination computer should be the same version as the one on the source computer. USMT does not support migrating the settings for an older version of an application to a newer version. The exception to this is Microsoft® Office, which USMT can migrate from an older version to a newer version.","pos":[11,355],"nodes":[{"content":"The application version that is installed on the destination computer should be the same version as the one on the source computer.","pos":[0,131]},{"content":"USMT does not support migrating the settings for an older version of an application to a newer version.","pos":[132,235]},{"content":"The exception to this is Microsoft® Office, which USMT can migrate from an older version to a newer version.","pos":[236,344]}]}]},{"content":"Close all applications.","pos":[5989,6012]},{"content":"If some applications are running when you run the <bpt id=\"p1\">**</bpt>LoadState<ept id=\"p1\">**</ept> command, USMT might not migrate all of the specified data.","pos":[6013,6135]},{"content":"For example, if Microsoft Office Outlook is open, USMT might not migrate PST files.","pos":[6136,6219]},{"pos":[6225,6468],"content":"**Note**  \nUse **/C** to continue your migration if errors are encountered, and use the **&lt;ErrorControl&gt;** section in the Config.xml file to specify which errors should be ignored, and which errors should cause the migration to fail.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"Use <bpt id=\"p1\">**</bpt>/C<ept id=\"p1\">**</ept> to continue your migration if errors are encountered, and use the <bpt id=\"p2\">**</bpt><ph id=\"ph1\">&amp;lt;</ph>ErrorControl<ph id=\"ph2\">&amp;gt;</ph><ept id=\"p2\">**</ept> section in the Config.xml file to specify which errors should be ignored, and which errors should cause the migration to fail.","pos":[11,239]}]},{"content":"Run the <bpt id=\"p1\">**</bpt>LoadState<ept id=\"p1\">**</ept> command on the destination computer.","pos":[6474,6532]},{"content":"Specify the same set of .xml files that you specified when you used the <bpt id=\"p1\">**</bpt>ScanState<ept id=\"p1\">**</ept> command.","pos":[6533,6627]},{"content":"However, you do not have to specify the Config.xml file, unless you want to exclude some of the files and settings that you migrated to the store.","pos":[6628,6774]},{"content":"For example, you might want to migrate the My Documents folder to the store, but not to the destination computer.","pos":[6775,6888]},{"content":"To do this, modify the Config.xml file and specify the updated file by using the <bpt id=\"p1\">**</bpt>LoadState<ept id=\"p1\">**</ept> command.","pos":[6889,6992]},{"content":"Then, the <bpt id=\"p1\">**</bpt>LoadState<ept id=\"p1\">**</ept> command will migrate only the files and settings that you want to migrate.","pos":[6993,7091]},{"content":"For more information about the how the <bpt id=\"p1\">**</bpt>LoadState<ept id=\"p1\">**</ept> command processes and migrates data, see <bpt id=\"p2\">[</bpt>How USMT Works<ept id=\"p2\">](usmt-how-it-works.md)</ept>.","pos":[7092,7225]},{"content":"For example, the following command migrates the files and settings:","pos":[7231,7298]},{"pos":[7414,7566],"content":"**Note**  \nRun the **LoadState** command in administrator mode. To do this, right-click **Command Prompt**, and then click **Run As Administrator**.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"Run the **LoadState** command in administrator mode. To do this, right-click **Command Prompt**, and then click **Run As Administrator**.","pos":[11,148],"nodes":[{"content":"Run the <bpt id=\"p1\">**</bpt>LoadState<ept id=\"p1\">**</ept> command in administrator mode.","pos":[0,52]},{"content":"To do this, right-click <bpt id=\"p1\">**</bpt>Command Prompt<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Run As Administrator<ept id=\"p2\">**</ept>.","pos":[53,137]}]}]},{"content":"Log off after you run the <bpt id=\"p1\">**</bpt>LoadState<ept id=\"p1\">**</ept> command.","pos":[7572,7620]},{"content":"Some settings (for example, fonts, wallpaper, and screen saver settings) will not take effect until the next time that the user logs on.","pos":[7621,7757]}],"content":"---\ntitle: Getting Started with the User State Migration Tool (USMT) (Windows 10)\ndescription: Getting Started with the User State Migration Tool (USMT)\nms.assetid: 506ff1d2-94b8-4460-8672-56aad963504b\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: greg-lindsay\n---\n\n# Getting Started with the User State Migration Tool (USMT)\nThis topic outlines the general process that you should follow to migrate files and settings.\n\n## In this Topic\n-   [Step 1: Plan Your Migration](#step-1-plan-your-migration)\n\n-   [Step 2: Collect files and settings from the source computer](#step-2-collect-files-and-settings-from-the-source-computer)\n\n-   [Step 3: Prepare the destination computer and restore files and settings](#step-3-prepare-the-destination-computer-and-restore-files-and-settings)\n\n## Step 1: Plan your migration\n1.  [Plan Your Migration](usmt-plan-your-migration.md). Depending on whether your migration scenario is refreshing or replacing computers, you can choose an online migration or an offline migration using Windows Preinstallation Environment (WinPE) or the files in the Windows.old directory. For more information, see [Common Migration Scenarios](usmt-common-migration-scenarios.md).\n\n2.  [Determine What to Migrate](usmt-determine-what-to-migrate.md). Data you might consider migrating includes end-user information, applications settings, operating-system settings, files, folders, and registry keys.\n\n3.  Determine where to store data. Depending on the size of your migration store, you can store the data remotely, locally in a hard-link migration store or on a local external storage device, or directly on the destination computer. For more information, see [Choose a Migration Store Type](usmt-choose-migration-store-type.md).\n\n4.  Use the **/GenMigXML** command-line option to determine which files will be included in your migration, and to determine whether any modifications are necessary. For more information see [ScanState Syntax](usmt-scanstate-syntax.md)\n\n5.  Modify copies of the Migration.xml and MigDocs.xml files and create custom .xml files, if it is required. To modify the migration behavior, such as migrating the **Documents** folder but not the **Music** folder, you can create a custom .xml file or modify the rules in the existing migration .xml files. The document finder, or **MigXmlHelper.GenerateDocPatterns** helper function, can be used to automatically find user documents on a computer without creating extensive custom migration .xml files.\n\n    **Important**  \n    We recommend that you always make and modify copies of the .xml files included in User State Migration Tool (USMT) 10.0. Never modify the original .xml files.\n    \n    You can use the MigXML.xsd file to help you write and validate the .xml files. For more information about how to modify these files, see [USMT XML Reference](usmt-xml-reference.md).\n\n6.  Create a [Config.xml File](usmt-configxml-file.md) if you want to exclude any components from the migration. To create this file, use the [ScanState Syntax](usmt-scanstate-syntax.md) option together with the other .xml files when you use the **ScanState** command. For example, the following command creates a Config.xml file by using the MigDocs and MigApp.xml files:\n\n    `scanstate /genconfig:config.xml /i:migdocs.xml /i:migapp.xml /v:13 /l:scanstate.log`\n\n7.  Review the migration state of the components listed in the Config.xml file, and specify `migrate=no` for any components that you do not want to migrate.\n\n## Step 2: Collect files and settings from the source computer\n1.  Back up the source computer.\n\n2.  Close all applications. If some applications are running when you run the **ScanState** command, USMT might not migrate all of the specified data. For example, if Microsoft® Office Outlook® is open, USMT might not migrate PST files.\n\n    **Note**  \n    USMT will fail if it cannot migrate a file or setting unless you specify the **/C** option. When you specify the **/C** option, USMT will ignore the errors, and log an error every time that it encounters a file that is being used that USMT did not migrate. You can use the **&lt;ErrorControl&gt;** section in the Config.xml file to specify which errors should be ignored, and which should cause the migration to fail.\n\n3.  Run the **ScanState** command on the source computer to collect files and settings. You should specify all of the .xml files that you want the **ScanState** command to use. For example,\n\n    `scanstate \\\\server\\migration\\mystore /config:config.xml /i:migdocs.xml /i:migapp.xml /v:13 /l:scan.log`\n\n    **Note**  \n    If the source computer is running Windows 7, or Windows 8, you must run the **ScanState** command in **Administrator** mode. To run in **Administrator** mode, right-click **Command Prompt**, and then click **Run As Administrator**. If the source computer is running Windows XP, you must run the **ScanState** command from an account that has administrative credentials. For more information about the how the **ScanState** command processes and stores the data, see [How USMT Works](usmt-how-it-works.md).\n\n4.  Run the **USMTUtils** command with the **/Verify** option to ensure that the store you created is not corrupted.\n\n## Step 3: Prepare the destination computer and restore files and settings\n1.  Install the operating system on the destination computer.\n\n2.  Install all applications that were on the source computer. Although it is not always required, we recommend installing all applications on the destination computer before you restore the user state. This makes sure that migrated settings are preserved.\n\n    **Note**  \n    The application version that is installed on the destination computer should be the same version as the one on the source computer. USMT does not support migrating the settings for an older version of an application to a newer version. The exception to this is Microsoft® Office, which USMT can migrate from an older version to a newer version.\n\n3.  Close all applications. If some applications are running when you run the **LoadState** command, USMT might not migrate all of the specified data. For example, if Microsoft Office Outlook is open, USMT might not migrate PST files.\n\n    **Note**  \n    Use **/C** to continue your migration if errors are encountered, and use the **&lt;ErrorControl&gt;** section in the Config.xml file to specify which errors should be ignored, and which errors should cause the migration to fail.\n\n4.  Run the **LoadState** command on the destination computer. Specify the same set of .xml files that you specified when you used the **ScanState** command. However, you do not have to specify the Config.xml file, unless you want to exclude some of the files and settings that you migrated to the store. For example, you might want to migrate the My Documents folder to the store, but not to the destination computer. To do this, modify the Config.xml file and specify the updated file by using the **LoadState** command. Then, the **LoadState** command will migrate only the files and settings that you want to migrate. For more information about the how the **LoadState** command processes and migrates data, see [How USMT Works](usmt-how-it-works.md).\n\n    For example, the following command migrates the files and settings:\n\n    `loadstate \\\\server\\migration\\mystore /config:config.xml /i:migdocs.xml /i:migapp.xml /v:13 /l:load.log`\n\n    **Note**  \n    Run the **LoadState** command in administrator mode. To do this, right-click **Command Prompt**, and then click **Run As Administrator**.\n\n5.  Log off after you run the **LoadState** command. Some settings (for example, fonts, wallpaper, and screen saver settings) will not take effect until the next time that the user logs on."}