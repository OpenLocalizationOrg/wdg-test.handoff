{"nodes":[{"content":"4945(S) A rule was listed when the Windows Firewall started.","pos":[11,71]},{"content":"(Windows 10)","pos":[72,84]},{"content":"Describes security event 4945(S) A rule was listed when the Windows Firewall started.","pos":[98,183]},{"content":"4945(S): A rule was listed when the Windows Firewall started.","pos":[283,344]},{"content":"Applies to","pos":[348,358]},{"content":"Windows 10","pos":[365,375]},{"content":"Windows Server 2016","pos":[380,399]},{"pos":[519,624],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit MPSSVC Rule-Level Policy Change<ept id=\"p2\">](audit-mpssvc-rule-level-policy-change.md)</ept>"},{"content":"Event Description:","pos":[629,647]},{"content":"This event generates every time Windows Firewall service starts.","pos":[652,716]},{"content":"This event shows the inbound and/or outbound rule which was listed when the Windows Firewall started and applied for “Public” profile.","pos":[718,852]},{"content":"This event generates per rule.","pos":[854,884]},{"pos":[888,1024],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For recommendations, see <bpt id=\"p2\">[</bpt>Security Monitoring Recommendations<ept id=\"p2\">](#security-monitoring-recommendations)</ept> for this event."},{"content":"Event XML:","pos":[1047,1057]},{"pos":[1862,1896],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> None."},{"pos":[1898,1959],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008, Windows Vista."},{"pos":[1961,1985],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Field Descriptions:","pos":[1990,2009]},{"content":"<bpt id=\"p1\">**</bpt>Profile used<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the name of the profile that the rule belongs to.","pos":[2014,2110]},{"content":"It always has value “<bpt id=\"p1\">**</bpt>Public”<ept id=\"p1\">**</ept>, because this event shows rules only for “Public” profile.","pos":[2111,2202]},{"content":"Rule:","pos":[2206,2211]},{"pos":[2219,2293],"content":"<bpt id=\"p1\">**</bpt>Rule ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the unique firewall rule identifier."},{"pos":[2299,2575],"content":"To see the unique ID of the rule you need to navigate to “<bpt id=\"p1\">**</bpt>HKEY<ph id=\"ph1\">\\_</ph>LOCAL<ph id=\"ph2\">\\_</ph>MACHINE<ph id=\"ph3\">\\\\</ph>SYSTEM<ph id=\"ph4\">\\\\</ph>CurrentControlSet<ph id=\"ph5\">\\\\</ph>Services<ph id=\"ph6\">\\\\</ph>SharedAccess<ph id=\"ph7\">\\\\</ph>Parameters<ph id=\"ph8\">\\\\</ph>FirewallPolicy<ph id=\"ph9\">\\\\</ph>FirewallRules”<ept id=\"p1\">**</ept> registry key and you will see the list of Windows Firewall rule IDs (Name column) with parameters:"},{"content":"<bpt id=\"p1\">**</bpt>Rule Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the name of the rule which was listed when the Windows Firewall started.","pos":[2716,2828]},{"content":"You can see the name of Windows Firewall rule using Windows Firewall with Advanced Security management console (<bpt id=\"p1\">**</bpt>wf.msc<ept id=\"p1\">**</ept>), check “Name” column:","pos":[2829,2974]},{"content":"Security Monitoring Recommendations","pos":[3130,3165]},{"content":"For 4945(S): A rule was listed when the Windows Firewall started.","pos":[3167,3232]},{"content":"Typically this event has an informational purpose.","pos":[3238,3288]},{"pos":[3294,3554],"content":"Unfortunately this event shows rules only for <bpt id=\"p1\">**</bpt>Public<ept id=\"p1\">**</ept> profile, but you still can compare this list with your organization's Windows Firewall baseline for Public profile rules on different computers, and trigger an alert if the configuration is not the same."}],"content":"---\ntitle: 4945(S) A rule was listed when the Windows Firewall started. (Windows 10)\ndescription: Describes security event 4945(S) A rule was listed when the Windows Firewall started.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 4945(S): A rule was listed when the Windows Firewall started.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\n<img src=\"images/event-4945.png\" alt=\"Event 4945 illustration\" width=\"449\" height=\"354\" hspace=\"10\" align=\"left\" />\n\n***Subcategory:***&nbsp;[Audit MPSSVC Rule-Level Policy Change](audit-mpssvc-rule-level-policy-change.md)\n\n***Event Description:***\n\nThis event generates every time Windows Firewall service starts.\n\nThis event shows the inbound and/or outbound rule which was listed when the Windows Firewall started and applied for “Public” profile.\n\nThis event generates per rule.\n\n> **Note**&nbsp;&nbsp;For recommendations, see [Security Monitoring Recommendations](#security-monitoring-recommendations) for this event.\n\n<br clear=\"all\">\n\n***Event XML:***\n```\n- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n- <System>\n <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> \n <EventID>4945</EventID> \n <Version>0</Version> \n <Level>0</Level> \n <Task>13571</Task> \n <Opcode>0</Opcode> \n <Keywords>0x8020000000000000</Keywords> \n <TimeCreated SystemTime=\"2015-10-02T23:48:27.535295100Z\" /> \n <EventRecordID>1049946</EventRecordID> \n <Correlation /> \n <Execution ProcessID=\"500\" ThreadID=\"4744\" /> \n <Channel>Security</Channel> \n <Computer>DC01.contoso.local</Computer> \n <Security /> \n </System>\n- <EventData>\n <Data Name=\"ProfileUsed\">Public</Data> \n <Data Name=\"RuleId\">NPS-NPSSvc-In-RPC</Data> \n <Data Name=\"RuleName\">Network Policy Server (RPC)</Data> \n </EventData>\n </Event>\n\n```\n\n***Required Server Roles:*** None.\n\n***Minimum OS Version:*** Windows Server 2008, Windows Vista.\n\n***Event Versions:*** 0.\n\n***Field Descriptions:***\n\n**Profile used** \\[Type = UnicodeString\\]**:** the name of the profile that the rule belongs to. It always has value “**Public”**, because this event shows rules only for “Public” profile.\n\n**Rule:**\n\n-   **Rule ID** \\[Type = UnicodeString\\]: the unique firewall rule identifier.\n\n    To see the unique ID of the rule you need to navigate to “**HKEY\\_LOCAL\\_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\SharedAccess\\\\Parameters\\\\FirewallPolicy\\\\FirewallRules”** registry key and you will see the list of Windows Firewall rule IDs (Name column) with parameters:\n\n<img src=\"images/registry-editor-firewallrules.png\" alt=\"Registry Editor FirewallRules key illustration\" width=\"1412\" height=\"422\" />\n\n-   **Rule Name** \\[Type = UnicodeString\\]: the name of the rule which was listed when the Windows Firewall started. You can see the name of Windows Firewall rule using Windows Firewall with Advanced Security management console (**wf.msc**), check “Name” column:\n\n<img src=\"images/windows-firewall-with-advanced-security.png\" alt=\"Windows Firewall with Advanced Security illustration\" width=\"1082\" height=\"363\" />\n\n## Security Monitoring Recommendations\n\nFor 4945(S): A rule was listed when the Windows Firewall started.\n\n-   Typically this event has an informational purpose.\n\n-   Unfortunately this event shows rules only for **Public** profile, but you still can compare this list with your organization's Windows Firewall baseline for Public profile rules on different computers, and trigger an alert if the configuration is not the same.\n\n"}