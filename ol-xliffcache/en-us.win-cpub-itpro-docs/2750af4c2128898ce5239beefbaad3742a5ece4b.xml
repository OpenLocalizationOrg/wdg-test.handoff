{"nodes":[{"content":"Configure MDT for UserExit scripts (Windows 10)","pos":[11,58]},{"content":"In this topic, you will learn how to configure the MDT rules engine to use a UserExit script to generate computer names based on a prefix and the computer MAC Address.","pos":[72,239]},{"content":"Configure MDT for UserExit scripts","pos":[410,444]},{"content":"In this topic, you will learn how to configure the MDT rules engine to use a UserExit script to generate computer names based on a prefix and the computer MAC Address.","pos":[446,613]},{"content":"MDT supports calling external VBScripts as part of the Gather process; these scripts are referred to as UserExit scripts.","pos":[614,735]},{"content":"The script also removes the colons in the MAC Address.","pos":[736,790]},{"content":"Configure the rules to call a UserExit script","pos":[795,840]},{"content":"You can call a UserExit by referencing the script in your rules.","pos":[842,906]},{"content":"Then you can configure a property to be set to the result of a function of the VBScript.","pos":[907,995]},{"content":"In this example, we have a VBScript named Setname.vbs (provided in the book sample files, in the UserExit folder).","pos":[996,1110]},{"content":"The UserExit=Setname.vbs calls the script and then assigns the computer name to what the SetName function in the script returns.","pos":[1243,1371]},{"content":"In this sample the %MACADDRESS% variable is passed to the script","pos":[1372,1436]},{"content":"The Setname.vbs UserExit script","pos":[1441,1472]},{"content":"The Setname.vbs script takes the MAC Address passed from the rules.","pos":[1474,1541]},{"content":"The script then does some string manipulation to add a prefix (PC) and remove the semicolons from the MAC Address.","pos":[1542,1656]},{"content":"The first three lines of the script make up a header that all UserExit scripts have.","pos":[1926,2010]},{"content":"The interesting part is the lines between Function and End Function.","pos":[2011,2079]},{"content":"Those lines add a prefix (PC), remove the colons from the MAC Address, and return the value to the rules by setting the SetName value.","pos":[2080,2214]},{"content":"Note","pos":[2218,2222]},{"content":"The purpose of this sample is not to recommend that you use the MAC Address as a base for computer naming, but to show you how to take a variable from MDT, pass it to an external script, make some changes to it, and then return the new value to the deployment process.","pos":[2227,2495]},{"content":"Related topics","pos":[2501,2515]},{"content":"Set up MDT for BitLocker","pos":[2518,2542]},{"content":"Configure MDT deployment share rules","pos":[2580,2616]},{"content":"Simulate a Windows 10 deployment in a test environment","pos":[2661,2715]},{"content":"Use the MDT database to stage Windows 10 deployment information","pos":[2778,2841]},{"content":"Assign applications using roles in MDT","pos":[2913,2951]},{"content":"Use web services in MDT","pos":[3003,3026]},{"content":"Use Orchestrator runbooks with MDT","pos":[3063,3097]}],"content":"---\ntitle: Configure MDT for UserExit scripts (Windows 10)\ndescription: In this topic, you will learn how to configure the MDT rules engine to use a UserExit script to generate computer names based on a prefix and the computer MAC Address.\nms.assetid: 29a421d1-12d2-414e-86dc-25b62f5238a7\nkeywords: rules, script\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: mdt\nauthor: mtniehaus\n---\n\n# Configure MDT for UserExit scripts\n\nIn this topic, you will learn how to configure the MDT rules engine to use a UserExit script to generate computer names based on a prefix and the computer MAC Address. MDT supports calling external VBScripts as part of the Gather process; these scripts are referred to as UserExit scripts. The script also removes the colons in the MAC Address.\n\n## Configure the rules to call a UserExit script\n\nYou can call a UserExit by referencing the script in your rules. Then you can configure a property to be set to the result of a function of the VBScript. In this example, we have a VBScript named Setname.vbs (provided in the book sample files, in the UserExit folder).\n\n``` syntax\n[Settings]\nPriority=Default\n[Default]\nOSINSTALL=YES\nUserExit=Setname.vbs\nOSDComputerName=#SetName(\"%MACADDRESS%\")#\n```\n\nThe UserExit=Setname.vbs calls the script and then assigns the computer name to what the SetName function in the script returns. In this sample the %MACADDRESS% variable is passed to the script\n\n## The Setname.vbs UserExit script\n\nThe Setname.vbs script takes the MAC Address passed from the rules. The script then does some string manipulation to add a prefix (PC) and remove the semicolons from the MAC Address.\n\n``` syntax\nFunction UserExit(sType, sWhen, sDetail, bSkip) \n  UserExit = Success \nEnd Function \nFunction SetName(sMac)\n  Dim re\n  Set re = new RegExp\n  re.IgnoreCase = true\n  re.Global = true\n  re.Pattern = \":\"\n  SetName = \"PC\" & re.Replace(sMac, \"\")\nEnd Function\n```\nThe first three lines of the script make up a header that all UserExit scripts have. The interesting part is the lines between Function and End Function. Those lines add a prefix (PC), remove the colons from the MAC Address, and return the value to the rules by setting the SetName value.\n\n**Note**  \nThe purpose of this sample is not to recommend that you use the MAC Address as a base for computer naming, but to show you how to take a variable from MDT, pass it to an external script, make some changes to it, and then return the new value to the deployment process.\n \n## Related topics\n\n[Set up MDT for BitLocker](set-up-mdt-2013-for-bitlocker.md)\n\n[Configure MDT deployment share rules](configure-mdt-deployment-share-rules.md)\n\n[Simulate a Windows 10 deployment in a test environment](simulate-a-windows-10-deployment-in-a-test-environment.md)\n\n[Use the MDT database to stage Windows 10 deployment information](use-the-mdt-database-to-stage-windows-10-deployment-information.md)\n\n[Assign applications using roles in MDT](assign-applications-using-roles-in-mdt-2013.md)\n\n[Use web services in MDT](use-web-services-in-mdt-2013.md)\n\n[Use Orchestrator runbooks with MDT](use-orchestrator-runbooks-with-mdt-2013.md)\n"}