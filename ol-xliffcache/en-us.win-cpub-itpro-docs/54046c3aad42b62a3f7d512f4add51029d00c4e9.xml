{"nodes":[{"content":"Monitor the use of removable storage devices (Windows 10)","pos":[11,68]},{"content":"This topic for the IT professional describes how to monitor attempts to use removable storage devices to access network resources.","pos":[82,212]},{"content":"It describes how to use advanced security auditing options to monitor dynamic access control objects.","pos":[213,314]},{"content":"Monitor the use of removable storage devices","pos":[470,514]},{"content":"Applies to","pos":[518,528]},{"content":"Windows 10","pos":[535,545]},{"content":"This topic for the IT professional describes how to monitor attempts to use removable storage devices to access network resources.","pos":[547,677]},{"content":"It describes how to use advanced security auditing options to monitor dynamic access control objects.","pos":[678,779]},{"content":"If you configure this policy setting, an audit event is generated each time a user attempts to copy, move, or save a resource to a removable storage device.","pos":[781,937]},{"content":"Use the following procedures to monitor the use of removable storage devices and to verify that the devices are being monitored.","pos":[939,1067]},{"pos":[1070,1245],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  Your server might function differently based on the version and edition of the operating system that is installed, your account permissions, and your menu settings."},{"content":"To configure settings to monitor removable storage devices","pos":[1250,1308]},{"content":"Sign in to your domain controller by using domain administrator credentials.","pos":[1316,1392]},{"pos":[1397,1479],"content":"In Server Manager, point to <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Group Policy Management<ept id=\"p2\">**</ept>."},{"pos":[1484,1607],"content":"In the console tree, right-click the flexible access Group Policy Object on the domain controller, and then click <bpt id=\"p1\">**</bpt>Edit<ept id=\"p1\">**</ept>."},{"pos":[1612,1825],"content":"Double-click <bpt id=\"p1\">**</bpt>Computer Configuration<ept id=\"p1\">**</ept>, double-click <bpt id=\"p2\">**</bpt>Security Settings<ept id=\"p2\">**</ept>, double-click <bpt id=\"p3\">**</bpt>Advanced Audit Policy Configuration<ept id=\"p3\">**</ept>, double-click <bpt id=\"p4\">**</bpt>Object Access<ept id=\"p4\">**</ept>, and then double-click <bpt id=\"p5\">**</bpt>Audit Removable Storage<ept id=\"p5\">**</ept>."},{"pos":[1830,1993],"content":"Select the <bpt id=\"p1\">**</bpt>Configure the following audit events<ept id=\"p1\">**</ept> check box, select the <bpt id=\"p2\">**</bpt>Success<ept id=\"p2\">**</ept> check box (and the <bpt id=\"p3\">**</bpt>Failure<ept id=\"p3\">**</ept> check box, if desired), and then click <bpt id=\"p4\">**</bpt>OK<ept id=\"p4\">**</ept>."},{"pos":[1998,2176],"content":"If you selected the <bpt id=\"p1\">**</bpt>Failure<ept id=\"p1\">**</ept> check box, double-click <bpt id=\"p2\">**</bpt>Audit Handle Manipulation<ept id=\"p2\">**</ept>, select the <bpt id=\"p3\">**</bpt>Configure the following audit events check box<ept id=\"p3\">**</ept>, and then select <bpt id=\"p4\">**</bpt>Failure<ept id=\"p4\">**</ept>."},{"pos":[2181,2245],"content":"Click <bpt id=\"p1\">**</bpt>OK<ept id=\"p1\">**</ept>, and then close the Group Policy Management Editor."},{"content":"After you configure the settings to monitor removable storage devices, use the following procedure to verify that the settings are active.","pos":[2247,2385]},{"content":"To verify that removable storage devices are monitored","pos":[2389,2443]},{"content":"Sign in to the computer that hosts the resources that you want to monitor.","pos":[2451,2525]},{"content":"Press the Windows key + R, and then type <bpt id=\"p1\">**</bpt>cmd<ept id=\"p1\">**</ept> to open a Command Prompt window.","pos":[2526,2607]},{"pos":[2614,2750],"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  If the User Account Control dialog box appears, confirm that the action it displays is what you want, and then click <bpt id=\"p2\">**</bpt>Yes<ept id=\"p2\">**</ept>."},{"pos":[2761,2803],"content":"Type <bpt id=\"p1\">**</bpt>gpupdate /force<ept id=\"p1\">**</ept>, and press ENTER."},{"content":"Connect a removable storage device to the targeted computer and attempt to copy a file that is protected with the Removable Storage Audit policy.","pos":[2808,2953]},{"pos":[2958,3026],"content":"In Server Manager, click <bpt id=\"p1\">**</bpt>Tools<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Event Viewer<ept id=\"p2\">**</ept>."},{"pos":[3031,3084],"content":"Expand <bpt id=\"p1\">**</bpt>Windows Logs<ept id=\"p1\">**</ept>, and then click <bpt id=\"p2\">**</bpt>Security<ept id=\"p2\">**</ept>."},{"content":"Look for event 4663, which logs successful attempts to write to or read from a removable storage device.","pos":[3089,3193]},{"content":"Failures will log event 4656.","pos":[3194,3223]},{"content":"Both events include <bpt id=\"p1\">**</bpt>Task Category = Removable Storage device<ept id=\"p1\">**</ept>.","pos":[3224,3289]},{"content":"Key information to look for includes the name and account domain of the user who attempted to access the file, the object that the user is attempting to access, resource attributes of the resource, and the type of access that was attempted.","pos":[3295,3535]},{"content":"<bpt id=\"p1\">**</bpt>Note:<ept id=\"p1\">**</ept>  We do not recommend that you enable this category on a file server that hosts file shares on a removable storage device.","pos":[3542,3673]},{"content":"When Removable Storage Auditing is configured, any attempt to access the removable storage device will generate an audit event.","pos":[3674,3801]},{"content":"Related resource","pos":[3812,3828]},{"content":"Using advanced security auditing options to monitor dynamic access control objects","pos":[3833,3915]}],"content":"---\ntitle: Monitor the use of removable storage devices (Windows 10)\ndescription: This topic for the IT professional describes how to monitor attempts to use removable storage devices to access network resources. It describes how to use advanced security auditing options to monitor dynamic access control objects.\nms.assetid: b0a9e4a5-b7ff-41c6-96ff-0228d4ba5da8\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Monitor the use of removable storage devices\n\n**Applies to**\n-   Windows 10\n\nThis topic for the IT professional describes how to monitor attempts to use removable storage devices to access network resources. It describes how to use advanced security auditing options to monitor dynamic access control objects.\n\nIf you configure this policy setting, an audit event is generated each time a user attempts to copy, move, or save a resource to a removable storage device.\n\nUse the following procedures to monitor the use of removable storage devices and to verify that the devices are being monitored.\n\n>**Note:**  Your server might function differently based on the version and edition of the operating system that is installed, your account permissions, and your menu settings.\n \n**To configure settings to monitor removable storage devices**\n\n1.  Sign in to your domain controller by using domain administrator credentials.\n2.  In Server Manager, point to **Tools**, and then click **Group Policy Management**.\n3.  In the console tree, right-click the flexible access Group Policy Object on the domain controller, and then click **Edit**.\n4.  Double-click **Computer Configuration**, double-click **Security Settings**, double-click **Advanced Audit Policy Configuration**, double-click **Object Access**, and then double-click **Audit Removable Storage**.\n5.  Select the **Configure the following audit events** check box, select the **Success** check box (and the **Failure** check box, if desired), and then click **OK**.\n6.  If you selected the **Failure** check box, double-click **Audit Handle Manipulation**, select the **Configure the following audit events check box**, and then select **Failure**.\n7.  Click **OK**, and then close the Group Policy Management Editor.\n\nAfter you configure the settings to monitor removable storage devices, use the following procedure to verify that the settings are active.\n\n**To verify that removable storage devices are monitored**\n\n1.  Sign in to the computer that hosts the resources that you want to monitor. Press the Windows key + R, and then type **cmd** to open a Command Prompt window.\n\n    >**Note:**  If the User Account Control dialog box appears, confirm that the action it displays is what you want, and then click **Yes**.\n     \n2.  Type **gpupdate /force**, and press ENTER.\n3.  Connect a removable storage device to the targeted computer and attempt to copy a file that is protected with the Removable Storage Audit policy.\n4.  In Server Manager, click **Tools**, and then click **Event Viewer**.\n5.  Expand **Windows Logs**, and then click **Security**.\n6.  Look for event 4663, which logs successful attempts to write to or read from a removable storage device. Failures will log event 4656. Both events include **Task Category = Removable Storage device**.\n\n    Key information to look for includes the name and account domain of the user who attempted to access the file, the object that the user is attempting to access, resource attributes of the resource, and the type of access that was attempted.\n\n    >**Note:**  We do not recommend that you enable this category on a file server that hosts file shares on a removable storage device. When Removable Storage Auditing is configured, any attempt to access the removable storage device will generate an audit event.\n     \n### Related resource\n\n- [Using advanced security auditing options to monitor dynamic access control objects](using-advanced-security-auditing-options-to-monitor-dynamic-access-control-objects.md)\n"}