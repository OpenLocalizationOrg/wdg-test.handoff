{"nodes":[{"content":"4649(S) A replay attack was detected.","pos":[11,48]},{"content":"(Windows 10)","pos":[49,61]},{"content":"Describes security event 4649(S) A replay attack was detected.","pos":[75,137]},{"content":"4649(S): A replay attack was detected.","pos":[237,275]},{"content":"Applies to","pos":[279,289]},{"content":"Windows 10","pos":[296,306]},{"content":"Windows Server 2016","pos":[311,330]},{"pos":[333,447],"content":"This event generates on domain controllers when <bpt id=\"p1\">**</bpt>KRB<ph id=\"ph1\">\\_</ph>AP<ph id=\"ph2\">\\_</ph>ERR<ph id=\"ph3\">\\_</ph>REPEAT<ept id=\"p1\">**</ept> Kerberos response was sent to the client."},{"content":"Domain controllers cache information from recently received tickets.","pos":[449,517]},{"content":"If the server name, client name, time, and microsecond fields from the Authenticator match recently seen entries in the cache, it will return KRB<ph id=\"ph1\">\\_</ph>AP<ph id=\"ph2\">\\_</ph>ERR<ph id=\"ph3\">\\_</ph>REPEAT.","pos":[518,681]},{"content":"You can read more about this in <bpt id=\"p1\">[</bpt>RFC-1510<ept id=\"p1\">](http://www.ietf.org/rfc/rfc1510.txt)</ept>.","pos":[682,762]},{"content":"One potential cause for this is a misconfigured network device between the client and server that could send the same packet(s) repeatedly.","pos":[763,902]},{"content":"There is no example of this event in this document.","pos":[904,955]},{"pos":[957,1049],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit Other Logon/Logoff Events<ept id=\"p2\">](audit-other-logonlogoff-events.md)</ept>"},{"content":"Event Schema:","pos":[1054,1067]},{"content":"A replay attack was detected.","pos":[1073,1102]},{"content":"Subject:","pos":[1106,1114]},{"content":"Security ID:%1","pos":[1120,1134]},{"content":"Account Name:%2","pos":[1141,1156]},{"content":"Account Domain:%3","pos":[1163,1180]},{"content":"Logon ID:%4","pos":[1187,1198]},{"content":"Credentials Which Were Replayed:","pos":[1202,1234]},{"content":"Account Name:%5","pos":[1240,1255]},{"content":"Account Domain:%6","pos":[1262,1279]},{"content":"Process Information:","pos":[1283,1303]},{"content":"Process ID:%12","pos":[1309,1323]},{"content":"Process Name:%13","pos":[1330,1346]},{"content":"Network Information:","pos":[1350,1370]},{"content":"Workstation Name:%10","pos":[1376,1396]},{"content":"Detailed Authentication Information:","pos":[1400,1436]},{"content":"Request Type:%7","pos":[1442,1457]},{"content":"Logon Process:%8","pos":[1464,1480]},{"content":"Authentication Package:%9","pos":[1487,1512]},{"content":"Transited Services:%11","pos":[1519,1541]},{"content":"This event indicates that a Kerberos replay attack was detected- a request was received twice with identical information.","pos":[1545,1666]},{"content":"This condition could be caused by network misconfiguration.\"","pos":[1667,1727]},{"pos":[1730,1794],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> Active Directory domain controller."},{"pos":[1796,1842],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008."},{"pos":[1844,1868],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Security Monitoring Recommendations","pos":[1873,1908]},{"content":"For 4649(S): A replay attack was detected.","pos":[1910,1952]},{"content":"This event can be a sign of Kerberos replay attack or, among other things, network device configuration or routing problems.","pos":[1958,2082]},{"content":"In both cases, we recommend triggering an alert and investigating the reason the event was generated.","pos":[2083,2184]}],"content":"---\ntitle: 4649(S) A replay attack was detected. (Windows 10)\ndescription: Describes security event 4649(S) A replay attack was detected.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 4649(S): A replay attack was detected.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\nThis event generates on domain controllers when **KRB\\_AP\\_ERR\\_REPEAT** Kerberos response was sent to the client.\n\nDomain controllers cache information from recently received tickets. If the server name, client name, time, and microsecond fields from the Authenticator match recently seen entries in the cache, it will return KRB\\_AP\\_ERR\\_REPEAT. You can read more about this in [RFC-1510](http://www.ietf.org/rfc/rfc1510.txt). One potential cause for this is a misconfigured network device between the client and server that could send the same packet(s) repeatedly.\n\nThere is no example of this event in this document.\n\n***Subcategory:***&nbsp;[Audit Other Logon/Logoff Events](audit-other-logonlogoff-events.md)\n\n***Event Schema:***\n\n*A replay attack was detected.*\n\n*Subject:*\n\n> *Security ID:%1*\n>\n> *Account Name:%2*\n>\n> *Account Domain:%3*\n>\n> *Logon ID:%4*\n\n*Credentials Which Were Replayed:*\n\n> *Account Name:%5*\n>\n> *Account Domain:%6*\n\n*Process Information:*\n\n> *Process ID:%12*\n>\n> *Process Name:%13*\n\n*Network Information:*\n\n> *Workstation Name:%10*\n\n*Detailed Authentication Information:*\n\n> *Request Type:%7*\n>\n> *Logon Process:%8*\n>\n> *Authentication Package:%9*\n>\n> *Transited Services:%11*\n\n*This event indicates that a Kerberos replay attack was detected- a request was received twice with identical information. This condition could be caused by network misconfiguration.\"*\n\n***Required Server Roles:*** Active Directory domain controller.\n\n***Minimum OS Version:*** Windows Server 2008.\n\n***Event Versions:*** 0.\n\n## Security Monitoring Recommendations\n\nFor 4649(S): A replay attack was detected.\n\n-   This event can be a sign of Kerberos replay attack or, among other things, network device configuration or routing problems. In both cases, we recommend triggering an alert and investigating the reason the event was generated.\n\n"}