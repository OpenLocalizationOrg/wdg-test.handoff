{"nodes":[{"content":"Replace a process level token (Windows 10)","pos":[11,53]},{"content":"Describes the best practices, location, values, policy management, and security considerations for the Replace a process level token security policy setting.","pos":[67,224]},{"content":"Replace a process level token","pos":[380,409]},{"content":"Applies to","pos":[413,423]},{"content":"Windows 10","pos":[430,440]},{"pos":[442,603],"content":"Describes the best practices, location, values, policy management, and security considerations for the <bpt id=\"p1\">**</bpt>Replace a process level token<ept id=\"p1\">**</ept> security policy setting."},{"content":"Reference","pos":[608,617]},{"content":"This policy setting determines which parent processes can replace the access token that is associated with a child process.","pos":[619,742]},{"content":"Specifically, the <bpt id=\"p1\">**</bpt>Replace a process level token<ept id=\"p1\">**</ept> setting determines which user accounts can call the CreateProcessAsUser() application programming interface (API) so that one service can start another.","pos":[744,948]},{"content":"An example of a process that uses this user right is Task Scheduler, where the user right is extended to any processes that can be managed by Task Scheduler.","pos":[949,1106]},{"content":"An access token is an object that describes the security context of a process or thread.","pos":[1108,1196]},{"content":"The information in a token includes the identity and privileges of the user account that is associated with the process or thread.","pos":[1197,1327]},{"content":"With this user right, every child process that runs on behalf of this user account would have its access token replaced with the process level token.","pos":[1328,1477]},{"content":"Constant: SeAssignPrimaryTokenPrivilege","pos":[1479,1518]},{"content":"Possible values","pos":[1524,1539]},{"content":"User-defined list of accounts","pos":[1545,1574]},{"content":"Defaults","pos":[1579,1587]},{"content":"Not defined","pos":[1592,1603]},{"content":"Best practices","pos":[1609,1623]},{"pos":[1629,1767],"content":"For member servers, ensure that only the Local Service and Network Service accounts have the <bpt id=\"p1\">**</bpt>Replace a process level token<ept id=\"p1\">**</ept> user right."},{"content":"Location","pos":[1773,1781]},{"content":"Computer Configuration<ph id=\"ph1\">\\\\</ph>Windows Settings<ph id=\"ph2\">\\\\</ph>Security Settings<ph id=\"ph3\">\\\\</ph>Local Policies<ph id=\"ph4\">\\\\</ph>User Rights Assignment","pos":[1783,1882]},{"content":"Default values","pos":[1888,1902]},{"content":"By default this setting is Network Service and Local Service on domain controllers and on stand-alone servers.","pos":[1904,2014]},{"content":"The following table lists the actual and effective default policy values for the most recent supported versions of Windows.","pos":[2016,2139]},{"content":"Default values are also listed on the policy’s property page.","pos":[2140,2201]},{"content":"Server type or GPO","pos":[2205,2223]},{"content":"Default value","pos":[2226,2239]},{"content":"Default Domain Policy","pos":[2254,2275]},{"content":"Not defined","pos":[2277,2288]},{"content":"Default Domain Controller Policy","pos":[2293,2325]},{"content":"Network Service","pos":[2328,2343]},{"content":"Local Service","pos":[2348,2361]},{"content":"Stand-Alone Server Default Settings","pos":[2366,2401]},{"content":"Network Service","pos":[2404,2419]},{"content":"Local Service","pos":[2424,2437]},{"content":"Domain Controller Effective Default Settings","pos":[2442,2486]},{"content":"Network Service","pos":[2489,2504]},{"content":"Local Service","pos":[2509,2522]},{"content":"Member Server Effective Default Settings","pos":[2527,2567]},{"content":"Network Service","pos":[2570,2585]},{"content":"Local Service","pos":[2590,2603]},{"content":"Client Computer Effective Default Settings","pos":[2608,2650]},{"content":"Network Service","pos":[2653,2668]},{"content":"Local Service","pos":[2673,2686]},{"content":"Policy management","pos":[2694,2711]},{"content":"This section describes features, tools, and guidance to help you manage this policy.","pos":[2713,2797]},{"content":"A restart of the device is not required for this policy setting to be effective.","pos":[2799,2879]},{"content":"Any change to the user rights assignment for an account becomes effective the next time the owner of the account logs on.","pos":[2881,3002]},{"content":"Group Policy","pos":[3008,3020]},{"content":"Settings are applied in the following order through a Group Policy Object (GPO), which will overwrite settings on the local computer at the next Group Policy update:","pos":[3022,3187]},{"content":"Local policy settings","pos":[3193,3214]},{"content":"Site policy settings","pos":[3219,3239]},{"content":"Domain policy settings","pos":[3244,3266]},{"content":"OU policy settings","pos":[3271,3289]},{"content":"When a local setting is greyed out, it indicates that a GPO currently controls that setting.","pos":[3291,3383]},{"content":"Security considerations","pos":[3388,3411]},{"content":"This section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.","pos":[3413,3607]},{"content":"Vulnerability","pos":[3613,3626]},{"pos":[3628,3760],"content":"Users with the <bpt id=\"p1\">**</bpt>Replace a process level token<ept id=\"p1\">**</ept> user right can start processes as another user if they know the user’s credentials."},{"content":"Countermeasure","pos":[3766,3780]},{"pos":[3782,3920],"content":"For member servers, ensure that only the Local Service and Network Service accounts have the <bpt id=\"p1\">**</bpt>Replace a process level token<ept id=\"p1\">**</ept> user right."},{"content":"Potential impact","pos":[3926,3942]},{"content":"On most computers, restricting the <bpt id=\"p1\">**</bpt>Replace a process level token<ept id=\"p1\">**</ept> user right to the Local Service and the Network Service built-in accounts is the default configuration, and there is no negative impact.","pos":[3944,4149]},{"content":"However, if you have installed optional components such as ASP.NET or IIS, you may need to assign the <bpt id=\"p1\">**</bpt>Replace a process level token<ept id=\"p1\">**</ept> user right to additional accounts.","pos":[4150,4320]},{"content":"For example, IIS requires that the Service, Network Service, and IWAM<ph id=\"ph1\">\\_</ph><bpt id=\"p1\">*</bpt><ph id=\"ph2\">&amp;lt;</ph>ComputerName<ph id=\"ph3\">&amp;gt;</ph><ept id=\"p1\">*</ept> accounts be explicitly granted this user right.","pos":[4321,4462]},{"content":"Related topics","pos":[4467,4481]},{"content":"User Rights Assignment","pos":[4486,4508]}],"content":"---\ntitle: Replace a process level token (Windows 10)\ndescription: Describes the best practices, location, values, policy management, and security considerations for the Replace a process level token security policy setting.\nms.assetid: 5add02db-6339-489e-ba21-ccc3ccbe8745\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nms.pagetype: security\nauthor: brianlic-msft\n---\n\n# Replace a process level token\n\n**Applies to**\n-   Windows 10\n\nDescribes the best practices, location, values, policy management, and security considerations for the **Replace a process level token** security policy setting.\n\n## Reference\n\nThis policy setting determines which parent processes can replace the access token that is associated with a child process.\n\nSpecifically, the **Replace a process level token** setting determines which user accounts can call the CreateProcessAsUser() application programming interface (API) so that one service can start another. An example of a process that uses this user right is Task Scheduler, where the user right is extended to any processes that can be managed by Task Scheduler.\n\nAn access token is an object that describes the security context of a process or thread. The information in a token includes the identity and privileges of the user account that is associated with the process or thread. With this user right, every child process that runs on behalf of this user account would have its access token replaced with the process level token.\n\nConstant: SeAssignPrimaryTokenPrivilege\n\n### Possible values\n\n-   User-defined list of accounts\n-   Defaults\n-   Not defined\n\n### Best practices\n\n-   For member servers, ensure that only the Local Service and Network Service accounts have the **Replace a process level token** user right.\n\n### Location\n\nComputer Configuration\\\\Windows Settings\\\\Security Settings\\\\Local Policies\\\\User Rights Assignment\n\n### Default values\n\nBy default this setting is Network Service and Local Service on domain controllers and on stand-alone servers.\n\nThe following table lists the actual and effective default policy values for the most recent supported versions of Windows. Default values are also listed on the policy’s property page.\n\n| Server type or GPO | Default value |\n| - | - |\n| Default Domain Policy| Not defined| \n| Default Domain Controller Policy | Network Service<br/>Local Service |\n| Stand-Alone Server Default Settings | Network Service<br/>Local Service| \n| Domain Controller Effective Default Settings | Network Service<br/>Local Service| \n| Member Server Effective Default Settings | Network Service<br/>Local Service| \n| Client Computer Effective Default Settings | Network Service<br/>Local Service| \n \n## Policy management\n\nThis section describes features, tools, and guidance to help you manage this policy.\n\nA restart of the device is not required for this policy setting to be effective.\n\nAny change to the user rights assignment for an account becomes effective the next time the owner of the account logs on.\n\n### Group Policy\n\nSettings are applied in the following order through a Group Policy Object (GPO), which will overwrite settings on the local computer at the next Group Policy update:\n\n1.  Local policy settings\n2.  Site policy settings\n3.  Domain policy settings\n4.  OU policy settings\n\nWhen a local setting is greyed out, it indicates that a GPO currently controls that setting.\n\n## Security considerations\n\nThis section describes how an attacker might exploit a feature or its configuration, how to implement the countermeasure, and the possible negative consequences of countermeasure implementation.\n\n### Vulnerability\n\nUsers with the **Replace a process level token** user right can start processes as another user if they know the user’s credentials.\n\n### Countermeasure\n\nFor member servers, ensure that only the Local Service and Network Service accounts have the **Replace a process level token** user right.\n\n### Potential impact\n\nOn most computers, restricting the **Replace a process level token** user right to the Local Service and the Network Service built-in accounts is the default configuration, and there is no negative impact. However, if you have installed optional components such as ASP.NET or IIS, you may need to assign the **Replace a process level token** user right to additional accounts. For example, IIS requires that the Service, Network Service, and IWAM\\_*&lt;ComputerName&gt;* accounts be explicitly granted this user right.\n\n## Related topics\n\n- [User Rights Assignment](user-rights-assignment.md)\n"}