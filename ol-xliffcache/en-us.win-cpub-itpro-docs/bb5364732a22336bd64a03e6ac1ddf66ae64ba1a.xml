{"nodes":[{"content":"Manage Administrative Backup and Restore in UE-V 2.x","pos":[11,63]},{"content":"Manage Administrative Backup and Restore in UE-V 2.x","pos":[77,129]},{"content":"Manage Administrative Backup and Restore in UE-V 2.x","pos":[293,345]},{"content":"As an administrator of Microsoft User Experience Virtualization (UE-V) 2.0, 2.1, or 2.1 SP1, you can restore application and Windows settings to their original state.","pos":[348,514]},{"content":"And new in UE-V 2.1, you can also restore additional settings when a user adopts a new device.","pos":[515,609]},{"content":"Restore Settings in UE-V 2.1 or UE-V 2.1 SP1 when a User Adopts a New Device","pos":[614,690]},{"content":"To restore settings when a user adopts a new device, you can put a settings location template in <bpt id=\"p1\">**</bpt>backup<ept id=\"p1\">**</ept> or <bpt id=\"p2\">**</bpt>roam (default)<ept id=\"p2\">**</ept> profile using the Set-UevTemplateProfile PowerShell cmdlet.","pos":[693,882]},{"content":"This lets computer settings sync to the new computer, in addition to user settings.","pos":[883,966]},{"content":"Templates assigned to the backup profile are backed up for that device and configured on a per-device basis.","pos":[967,1075]},{"content":"To backup settings for a template, use the following cmdlet in Windows PowerShell:","pos":[1076,1158]},{"content":"TemplateID<ph id=\"ph1\">&amp;gt;</ph> is the UE-V Template ID","pos":[1242,1280]},{"content":"backup<ph id=\"ph1\">&amp;gt;</ph> can either be Backup or Roaming","pos":[1290,1332]},{"content":"When replacing a user’s device UE-V automatically restores settings if the user’s domain, username, and device name all match.","pos":[1334,1460]},{"content":"All synchronized and any backup data is restored on the device automatically.","pos":[1461,1538]},{"content":"You can also use the new PowerShell cmdlet, Restore-UevBackup, to restore settings from a different device.","pos":[1540,1647]},{"content":"To clone the settings packages for the new device, use the following cmdlet in Windows PowerShell:","pos":[1648,1746]},{"content":"where <ph id=\"ph1\">&amp;lt;</ph>MachineName<ph id=\"ph2\">&amp;gt;</ph> is the computer name of the device.","pos":[1805,1866]},{"content":"Templates such as the Office 2013 template that include many applications can either all be included in the roamed (default) or backed up profile.","pos":[1868,2014]},{"content":"Individual apps in a template suite follow the group.","pos":[2015,2068]},{"content":"Office 2013 in-box templates include both roaming and backup-only settings.","pos":[2069,2144]},{"content":"Backup-only settings cannot be included in a roaming profile.","pos":[2145,2206]},{"content":"As part of the Backup/Restore feature, UE-V added <bpt id=\"p1\">**</bpt>last known good (LKG)<ept id=\"p1\">**</ept> to the options for rolling back to settings.","pos":[2208,2328]},{"content":"In this release, you can roll back to either the original settings or LKG settings.","pos":[2329,2412]},{"content":"The LKG settings let users roll back to an intermediate and stable point ahead of the pre-UE-V state of the settings.","pos":[2413,2530]},{"content":"How to Backup/Restore Templates with UE-V","pos":[2536,2577]},{"content":"These are the key backup and restore components of UE-V:","pos":[2579,2635]},{"content":"Template profiles","pos":[2641,2658]},{"content":"Settings packages location within the Settings Storage Location template","pos":[2664,2736]},{"content":"Backup trigger","pos":[2742,2756]},{"content":"How settings are restored","pos":[2762,2787]},{"content":"Template Profiles","pos":[2791,2808]},{"content":"A UE-V template profile is defined when the template is registered on the device or post registration through the PowerShell/WMI configuration utility.","pos":[2812,2963]},{"content":"The profile types include:","pos":[2964,2990]},{"content":"Roaming (default)","pos":[2996,3013]},{"content":"Backup","pos":[3019,3025]},{"content":"BackupOnly","pos":[3031,3041]},{"content":"All templates are included in the roaming profile when registered unless otherwise specified.","pos":[3043,3136]},{"content":"These templates synchronize settings to all UE-V enabled devices with the corresponding template enabled.","pos":[3137,3242]},{"content":"Templates can be added to the Backup Profile with PowerShell or WMI using the Set-UevTemplateProfile cmdlet.","pos":[3244,3352]},{"content":"Templates in the Backup Profile back up these settings to the Settings Storage Location in a special Device name directory.","pos":[3353,3476]},{"content":"Specified settings are backed up to this location.","pos":[3477,3527]},{"content":"Templates designated BackupOnly include settings specific to that device that should not be synchronized unless explicitly restored.","pos":[3529,3661]},{"content":"These settings are stored in the same device-specific settings package location on the settings storage location as the Backedup Settings.","pos":[3662,3800]},{"content":"These templates have a special identifier embedded in the template that specifies they should be part of this profile.","pos":[3801,3919]},{"content":"Settings packages location within the Settings Storage Location template","pos":[3923,3995]},{"content":"Roaming Profile settings are stored on the settings storage location.","pos":[3999,4068]},{"content":"Templates assigned to the Backup or the BackupOnly profile store their settings to the Settings Storage Location in a special Device name directory.","pos":[4069,4217]},{"content":"Each device with templates in these profiles has its own device name.","pos":[4218,4287]},{"content":"UE-V does not clean up these directories.","pos":[4288,4329]},{"content":"Backup trigger","pos":[4333,4347]},{"content":"Backup is triggered by the same events that trigger a UE-V synchronization.","pos":[4351,4426]},{"content":"How settings are restored","pos":[4430,4455]},{"content":"Restoring a user’s device restores the currently registered Template’s settings from another device’s backup folder and all synchronized settings to the current machine.","pos":[4459,4628]},{"content":"Settings are restored in these two ways:","pos":[4629,4669]},{"content":"Automatic restore","pos":[4677,4694]},{"content":"If the user’s UE-V settings storage path, domain, and Computer name match the current user then all of the settings for that user are synchronized, with only the latest settings applied.","pos":[4702,4888]},{"content":"If a user logs on to a new device for the first time and these criteria are met, the settings data is applied to that device.","pos":[4889,5014]},{"pos":[5020,5132],"content":"**Note**  \nAccessibility and Windows Desktop settings require the user to re-logon to Windows to be applied.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"Accessibility and Windows Desktop settings require the user to re-logon to Windows to be applied.","pos":[11,108]}]},{"content":"Manual Restore","pos":[5147,5161]},{"content":"If you want to assist users by restoring a device during a refresh, you can choose to use the Restore-UevBackup cmdlet.","pos":[5169,5288]},{"content":"This command ensures that the user’s current settings become the current state on the Settings Storage Location.","pos":[5289,5401]},{"content":"Restore Application and Windows Settings to Original State","pos":[5406,5464]},{"content":"WMI and Windows PowerShell commands let you restore application and Windows settings to the settings values that were on the computer the first time that the application started after the UE-V Agent was installed.","pos":[5467,5680]},{"content":"This restoring action is performed on a per-application or Windows settings basis.","pos":[5681,5763]},{"content":"The settings are restored the next time that the application runs, or the settings are restored when the user logs on to the operating system.","pos":[5764,5906]},{"content":"To restore application settings and Windows settings with Windows PowerShell for UE-V 2.x","pos":[5910,5999]},{"content":"Open the Windows PowerShell window.","pos":[6007,6042]},{"content":"Enter the following Windows PowerShell cmdlet to restore the application settings and Windows settings.","pos":[6048,6151]},{"pos":[6157,6704],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\"><strong>Windows PowerShell cmdlet</strong></th>\n<th align=\"left\"><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Restore-UevUserSetting -&lt;TemplateID&gt;</code></p></td>\n<td align=\"left\"><p>Restores the user settings for an application or restores a group of Windows settings.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"Windows PowerShell cmdlet","pos":[124,149]},{"content":"Description","pos":[189,200]},{"content":"Restores the user settings for an application or restores a group of Windows settings.","pos":[360,446]}]},{"content":"To restore application settings and Windows settings with WMI","pos":[6715,6776]},{"content":"Open a Windows PowerShell window.","pos":[6784,6817]},{"content":"Enter the following WMI command to restore application settings and Windows settings.","pos":[6823,6908]},{"pos":[6914,7531],"content":"<table>\n<colgroup>\n<col width=\"50%\" />\n<col width=\"50%\" />\n</colgroup>\n<thead>\n<tr class=\"header\">\n<th align=\"left\"><strong>WMI command</strong></th>\n<th align=\"left\"><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class UserSettings -Name RestoreByTemplateId -ArgumentList &lt;template_ID&gt;</code></p></td>\n<td align=\"left\"><p>Restores the user settings for an application or restores a group of Windows settings.</p></td>\n</tr>\n</tbody>\n</table>","leadings":["","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    ","    "],"nodes":[{"content":"WMI command","pos":[124,135]},{"content":"Description","pos":[175,186]},{"content":"Restores the user settings for an application or restores a group of Windows settings.","pos":[430,516]}]},{"pos":[7544,7618],"content":"**Note**  \nUE-V does not provide a settings rollback for Windows apps.","leadings":["","    "],"nodes":[{"content":"Note","pos":[2,6]},{"content":"UE-V does not provide a settings rollback for Windows apps.","pos":[11,70]}]},{"content":"Got a suggestion for UE-V?","pos":[7630,7656]},{"content":"Add or vote on suggestions <bpt id=\"p1\">[</bpt>here<ept id=\"p1\">](http://uev.uservoice.com/forums/280428-microsoft-user-experience-virtualization)</ept>.","pos":[7659,7774]},{"content":"For UE-V issues, use the <bpt id=\"p1\">[</bpt>UE-V TechNet Forum<ept id=\"p1\">](https://social.technet.microsoft.com/Forums/home?forum=mdopuev)</ept>.","pos":[7775,7885]},{"content":"Related topics","pos":[7890,7904]},{"content":"Administering UE-V 2.x with Windows PowerShell and WMI","pos":[7908,7962]},{"content":"Administering UE-V 2.x","pos":[8035,8057]}],"content":"---\ntitle: Manage Administrative Backup and Restore in UE-V 2.x\ndescription: Manage Administrative Backup and Restore in UE-V 2.x\nauthor: jamiejdt\nms.assetid: 2eb5ae75-65e5-4afc-adb6-4e83cf4364ae\nms.pagetype: mdop, virtualization\nms.mktglfcycl: deploy\nms.sitesec: library\nms.prod: w10\n---\n\n\n# Manage Administrative Backup and Restore in UE-V 2.x\n\n\nAs an administrator of Microsoft User Experience Virtualization (UE-V) 2.0, 2.1, or 2.1 SP1, you can restore application and Windows settings to their original state. And new in UE-V 2.1, you can also restore additional settings when a user adopts a new device.\n\n## Restore Settings in UE-V 2.1 or UE-V 2.1 SP1 when a User Adopts a New Device\n\n\nTo restore settings when a user adopts a new device, you can put a settings location template in **backup** or **roam (default)** profile using the Set-UevTemplateProfile PowerShell cmdlet. This lets computer settings sync to the new computer, in addition to user settings. Templates assigned to the backup profile are backed up for that device and configured on a per-device basis. To backup settings for a template, use the following cmdlet in Windows PowerShell:\n\n``` syntax\nSet-UevTemplateProfile -ID <TemplateID> -Profile <backup>\n```\n\n-   &lt;TemplateID&gt; is the UE-V Template ID\n\n-   &lt;backup&gt; can either be Backup or Roaming\n\nWhen replacing a user’s device UE-V automatically restores settings if the user’s domain, username, and device name all match. All synchronized and any backup data is restored on the device automatically.\n\nYou can also use the new PowerShell cmdlet, Restore-UevBackup, to restore settings from a different device. To clone the settings packages for the new device, use the following cmdlet in Windows PowerShell:\n\n``` syntax\nRestore-UevBackup –Machine <MachineName>\n```\n\nwhere &lt;MachineName&gt; is the computer name of the device.\n\nTemplates such as the Office 2013 template that include many applications can either all be included in the roamed (default) or backed up profile. Individual apps in a template suite follow the group. Office 2013 in-box templates include both roaming and backup-only settings. Backup-only settings cannot be included in a roaming profile.\n\nAs part of the Backup/Restore feature, UE-V added **last known good (LKG)** to the options for rolling back to settings. In this release, you can roll back to either the original settings or LKG settings. The LKG settings let users roll back to an intermediate and stable point ahead of the pre-UE-V state of the settings.\n\n### How to Backup/Restore Templates with UE-V\n\nThese are the key backup and restore components of UE-V:\n\n-   Template profiles\n\n-   Settings packages location within the Settings Storage Location template\n\n-   Backup trigger\n\n-   How settings are restored\n\n**Template Profiles**\n\nA UE-V template profile is defined when the template is registered on the device or post registration through the PowerShell/WMI configuration utility. The profile types include:\n\n-   Roaming (default)\n\n-   Backup\n\n-   BackupOnly\n\nAll templates are included in the roaming profile when registered unless otherwise specified. These templates synchronize settings to all UE-V enabled devices with the corresponding template enabled.\n\nTemplates can be added to the Backup Profile with PowerShell or WMI using the Set-UevTemplateProfile cmdlet. Templates in the Backup Profile back up these settings to the Settings Storage Location in a special Device name directory. Specified settings are backed up to this location.\n\nTemplates designated BackupOnly include settings specific to that device that should not be synchronized unless explicitly restored. These settings are stored in the same device-specific settings package location on the settings storage location as the Backedup Settings. These templates have a special identifier embedded in the template that specifies they should be part of this profile.\n\n**Settings packages location within the Settings Storage Location template**\n\nRoaming Profile settings are stored on the settings storage location. Templates assigned to the Backup or the BackupOnly profile store their settings to the Settings Storage Location in a special Device name directory. Each device with templates in these profiles has its own device name. UE-V does not clean up these directories.\n\n**Backup trigger**\n\nBackup is triggered by the same events that trigger a UE-V synchronization.\n\n**How settings are restored**\n\nRestoring a user’s device restores the currently registered Template’s settings from another device’s backup folder and all synchronized settings to the current machine. Settings are restored in these two ways:\n\n-   **Automatic restore**\n\n    If the user’s UE-V settings storage path, domain, and Computer name match the current user then all of the settings for that user are synchronized, with only the latest settings applied. If a user logs on to a new device for the first time and these criteria are met, the settings data is applied to that device.\n\n    **Note**  \n    Accessibility and Windows Desktop settings require the user to re-logon to Windows to be applied.\n\n     \n\n-   **Manual Restore**\n\n    If you want to assist users by restoring a device during a refresh, you can choose to use the Restore-UevBackup cmdlet. This command ensures that the user’s current settings become the current state on the Settings Storage Location.\n\n## Restore Application and Windows Settings to Original State\n\n\nWMI and Windows PowerShell commands let you restore application and Windows settings to the settings values that were on the computer the first time that the application started after the UE-V Agent was installed. This restoring action is performed on a per-application or Windows settings basis. The settings are restored the next time that the application runs, or the settings are restored when the user logs on to the operating system.\n\n**To restore application settings and Windows settings with Windows PowerShell for UE-V 2.x**\n\n1.  Open the Windows PowerShell window.\n\n2.  Enter the following Windows PowerShell cmdlet to restore the application settings and Windows settings.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\"><strong>Windows PowerShell cmdlet</strong></th>\n    <th align=\"left\"><strong>Description</strong></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Restore-UevUserSetting -&lt;TemplateID&gt;</code></p></td>\n    <td align=\"left\"><p>Restores the user settings for an application or restores a group of Windows settings.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n**To restore application settings and Windows settings with WMI**\n\n1.  Open a Windows PowerShell window.\n\n2.  Enter the following WMI command to restore application settings and Windows settings.\n\n    <table>\n    <colgroup>\n    <col width=\"50%\" />\n    <col width=\"50%\" />\n    </colgroup>\n    <thead>\n    <tr class=\"header\">\n    <th align=\"left\"><strong>WMI command</strong></th>\n    <th align=\"left\"><strong>Description</strong></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr class=\"odd\">\n    <td align=\"left\"><p><code>Invoke-WmiMethod -Namespace root\\Microsoft\\UEV -Class UserSettings -Name RestoreByTemplateId -ArgumentList &lt;template_ID&gt;</code></p></td>\n    <td align=\"left\"><p>Restores the user settings for an application or restores a group of Windows settings.</p></td>\n    </tr>\n    </tbody>\n    </table>\n\n     \n\n    **Note**  \n    UE-V does not provide a settings rollback for Windows apps.\n\n     \n\n## Got a suggestion for UE-V?\n\n\nAdd or vote on suggestions [here](http://uev.uservoice.com/forums/280428-microsoft-user-experience-virtualization). For UE-V issues, use the [UE-V TechNet Forum](https://social.technet.microsoft.com/Forums/home?forum=mdopuev).\n\n## Related topics\n\n\n[Administering UE-V 2.x with Windows PowerShell and WMI](administering-ue-v-2x-with-windows-powershell-and-wmi-both-uevv2.md)\n\n[Administering UE-V 2.x](administering-ue-v-2x-new-uevv2.md)\n\n \n\n \n\n\n\n\n\n"}