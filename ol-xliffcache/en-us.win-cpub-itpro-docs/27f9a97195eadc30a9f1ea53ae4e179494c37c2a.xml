{"nodes":[{"content":"4662(S, F) An operation was performed on an object.","pos":[11,62]},{"content":"(Windows 10)","pos":[63,75]},{"content":"Describes security event 4662(S, F) An operation was performed on an object.","pos":[89,165]},{"content":"4662(S, F): An operation was performed on an object.","pos":[265,317]},{"content":"Applies to","pos":[321,331]},{"content":"Windows 10","pos":[338,348]},{"content":"Windows Server 2016","pos":[353,372]},{"pos":[492,583],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit Directory Service Access<ept id=\"p2\">](audit-directory-service-access.md)</ept>"},{"content":"Event Description:","pos":[588,606]},{"content":"This event generates every time when an operation was performed on an Active Directory object.","pos":[611,705]},{"pos":[707,912],"content":"This event generates only if appropriate <bpt id=\"p1\">[</bpt>SACL<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/windows/desktop/aa374872(v=vs.85).aspx)</ept> was set for Active Directory object and performed operation meets this SACL."},{"content":"If operation failed then Failure event will be generated.","pos":[914,971]},{"content":"You will get one 4662 for each operation type which was performed.","pos":[973,1039]},{"pos":[1043,1179],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For recommendations, see <bpt id=\"p2\">[</bpt>Security Monitoring Recommendations<ept id=\"p2\">](#security-monitoring-recommendations)</ept> for this event."},{"content":"Event XML:","pos":[1202,1212]},{"pos":[2591,2655],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> Active Directory domain controller."},{"pos":[2657,2703],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008."},{"pos":[2705,2729],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Field Descriptions:","pos":[2734,2753]},{"content":"Subject:","pos":[2760,2768]},{"content":"<bpt id=\"p1\">**</bpt>Security ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = SID<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> SID of account that requested the operation.","pos":[2776,2856]},{"content":"Event Viewer automatically tries to resolve SIDs and show the account name.","pos":[2857,2932]},{"content":"If the SID cannot be resolved, you will see the source data in the event.","pos":[2933,3006]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>A <bpt id=\"p2\">**</bpt>security identifier (SID)<ept id=\"p2\">**</ept> is a unique value of variable length used to identify a trustee (security principal).","pos":[3010,3147]},{"content":"Each account has a unique SID that is issued by an authority, such as an Active Directory domain controller, and stored in a security database.","pos":[3148,3291]},{"content":"Each time a user logs on, the system retrieves the SID for that user from the database and places it in the access token for that user.","pos":[3292,3427]},{"content":"The system uses the SID in the access token to identify the user in all subsequent interactions with Windows security.","pos":[3428,3546]},{"content":"When a SID has been used as the unique identifier for a user or group, it cannot ever be used again to identify another user or group.","pos":[3547,3681]},{"content":"For more information about SIDs, see <bpt id=\"p1\">[</bpt>Security identifiers<ept id=\"p1\">](security-identifiers.md)</ept>.","pos":[3682,3767]},{"pos":[3773,3873],"content":"<bpt id=\"p1\">**</bpt>Account Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the name of the account that requested the operation."},{"content":"<bpt id=\"p1\">**</bpt>Account Domain<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> subject’s domain or computer name.","pos":[3879,3962]},{"content":"Formats vary, and include the following:","pos":[3963,4003]},{"content":"Domain NETBIOS name example: CONTOSO","pos":[4013,4049]},{"content":"Lowercase full domain name: contoso.local","pos":[4059,4100]},{"content":"Uppercase full domain name: CONTOSO.LOCAL","pos":[4110,4151]},{"pos":[4161,4335],"content":"For some <bpt id=\"p1\">[</bpt>well-known security principals<ept id=\"p1\">](https://support.microsoft.com/en-us/kb/243330)</ept>, such as LOCAL SERVICE or ANONYMOUS LOGON, the value of this field is “NT AUTHORITY”."},{"content":"For local user accounts, this field will contain the name of the computer or device that this account belongs to, for example: “Win81”.","pos":[4345,4480]},{"pos":[4486,4714],"content":"<bpt id=\"p1\">**</bpt>Logon ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = HexInt64<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> hexadecimal value that can help you correlate this event with recent events that might contain the same Logon ID, for example, “<bpt id=\"p3\">[</bpt>4624<ept id=\"p3\">](event-4624.md)</ept>: An account was successfully logged on.”"},{"content":"Object:","pos":[4718,4725]},{"pos":[4733,4811],"content":"<bpt id=\"p1\">**</bpt>Object Server<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: has “<bpt id=\"p2\">**</bpt>DS<ept id=\"p2\">**</ept>” value for this event."},{"content":"<bpt id=\"p1\">**</bpt>Object Type<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: type or class of the object that was accessed.","pos":[4817,4905]},{"content":"Some of the common Active Directory object types and classes are:","pos":[4906,4971]},{"content":"container – for containers.","pos":[4981,5008]},{"content":"user – for users.","pos":[5018,5035]},{"content":"group – for groups.","pos":[5045,5064]},{"content":"domainDNS – for domain object.","pos":[5074,5104]},{"content":"groupPolicyContainer – for group policy objects.","pos":[5114,5162]},{"content":"For all possible values of <bpt id=\"p1\">**</bpt>Object Type<ept id=\"p1\">**</ept> open Active Directory Schema snap-in (see how to enable this snap-in: <bpt id=\"p2\">&lt;</bpt>https://technet.microsoft.com/en-us/library/Cc755885(v=WS.10).aspx)<ept id=\"p2\">&gt;</ept> and navigate to <bpt id=\"p3\">**</bpt>Active Directory Schema<ph id=\"ph1\">\\\\</ph>Classes<ept id=\"p3\">**</ept>.","pos":[5172,5408]},{"content":"Or use this document: <bpt id=\"p1\">&lt;</bpt>https://msdn.microsoft.com/en-us/library/cc221630.aspx<ept id=\"p1\">&gt;</ept>","pos":[5409,5487]},{"pos":[5493,5586],"content":"<bpt id=\"p1\">**</bpt>Object Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: distinguished name of the object that was accessed."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>The LDAP API references an LDAP object by its <bpt id=\"p2\">**</bpt>distinguished name (DN)<ept id=\"p2\">**</ept>.","pos":[5590,5684]},{"content":"A DN is a sequence of relative distinguished names (RDN) connected by commas.","pos":[5685,5762]},{"content":"An RDN is an attribute with an associated value in the form attribute=value; .","pos":[5766,5844]},{"content":"These are examples of RDNs attributes:","pos":[5845,5883]},{"content":"• DC - domainComponent","pos":[5887,5909]},{"content":"• CN - commonName","pos":[5913,5930]},{"content":"• OU - organizationalUnitName","pos":[5934,5963]},{"content":"• O - organizationName","pos":[5967,5989]},{"content":"<bpt id=\"p1\">**</bpt>Handle ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = Pointer<ph id=\"ph2\">\\]</ph>: hexadecimal value of a handle to <bpt id=\"p2\">**</bpt>Object Name<ept id=\"p2\">**</ept>.","pos":[5995,6078]},{"content":"This field can help you correlate this event with other events that might contain the same Handle ID, for example, “<bpt id=\"p1\">[</bpt>4661<ept id=\"p1\">](event-4661.md)</ept>: A handle to an object was requested.”","pos":[6079,6255]},{"content":"This parameter might not be captured in the event, and in that case appears as “0x0”.","pos":[6256,6341]},{"content":"Operation:","pos":[6345,6355]},{"content":"<bpt id=\"p1\">**</bpt>Operation Type<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the type of operation which was performed on an object.","pos":[6363,6463]},{"content":"Typically has “<bpt id=\"p1\">**</bpt>Object Access”<ept id=\"p1\">**</ept> value for this event.","pos":[6464,6519]},{"content":"<bpt id=\"p1\">**</bpt>Accesses<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: the type of access used for the operation.","pos":[6525,6606]},{"content":"See “Table 9.","pos":[6607,6620]},{"content":"Active Directory Access Codes and Rights.”","pos":[6621,6663]},{"content":"for more information.","pos":[6664,6685]},{"content":"<bpt id=\"p1\">**</bpt>Access Mask<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = HexInt32<ph id=\"ph2\">\\]</ph>: hexadecimal mask for the type of access used for the operation.","pos":[6691,6791]},{"content":"See “Table 9.","pos":[6792,6805]},{"content":"Active Directory Access Codes and Rights.”","pos":[6806,6848]},{"content":"for more information.","pos":[6849,6870]},{"pos":[6947,6958],"content":"Access Mask"},{"content":"Access Name","pos":[6961,6972]},{"content":"Description","pos":[7000,7011]},{"content":"0x1","pos":[7722,7725]},{"content":"Create Child","pos":[7809,7821]},{"content":"The right to create child objects of the object.","pos":[7848,7896]},{"content":"0x2","pos":[8146,8149]},{"content":"Delete Child","pos":[8233,8245]},{"content":"The right to delete child objects of the object.","pos":[8272,8320]},{"content":"0x4","pos":[8570,8573]},{"content":"List Contents","pos":[8657,8670]},{"content":"The right to list child objects of this object.","pos":[8696,8743]},{"content":"0x8","pos":[8994,8997]},{"content":"SELF","pos":[9081,9085]},{"content":"The right to perform an operation controlled by a validated write access right.","pos":[9120,9199]},{"content":"0x10","pos":[9418,9422]},{"content":"Read Property","pos":[9505,9518]},{"content":"The right to read properties of the object.","pos":[9544,9587]},{"content":"0x20","pos":[9842,9846]},{"content":"Write Property","pos":[9929,9943]},{"content":"The right to write properties of the object.","pos":[9968,10012]},{"content":"0x40","pos":[10266,10270]},{"content":"Delete Tree","pos":[10353,10364]},{"content":"Delete all children of this object, regardless of the permissions of the children.","pos":[10392,10474]},{"content":"It is indicates that “Use Delete Subtree server control” check box was checked during deletion.","pos":[10475,10570]},{"content":"This operation means that all objects within the subtree, including all delete-protected objects, will be deleted.","pos":[10571,10685]},{"content":"0x80","pos":[10690,10694]},{"content":"List Object","pos":[10777,10788]},{"content":"The right to list a particular object.","pos":[10816,10854]},{"content":"0x100","pos":[11114,11119]},{"content":"Control Access","pos":[11201,11215]},{"content":"Access allowed only after extended rights checks supported by the object are performed.","pos":[11240,11327]},{"content":"The right to perform an operation controlled by an extended access right.","pos":[11331,11404]},{"content":"0x10000","pos":[11532,11539]},{"content":"DELETE","pos":[11619,11625]},{"content":"The right to delete the object.","pos":[11658,11689]},{"content":"DELETE also generated when object was moved.","pos":[11694,11738]},{"content":"0x20000","pos":[11950,11957]},{"content":"READ<ph id=\"ph1\">\\_</ph>CONTROL","pos":[12037,12050]},{"content":"The right to read data from the security descriptor of the object, not including the data in the SACL.","pos":[12076,12178]},{"content":"0x40000","pos":[12374,12381]},{"content":"WRITE<ph id=\"ph1\">\\_</ph>DAC","pos":[12461,12471]},{"content":"The right to modify the discretionary access-control list (DACL) in the object security descriptor.","pos":[12500,12599]},{"content":"0x80000","pos":[12798,12805]},{"content":"WRITE<ph id=\"ph1\">\\_</ph>OWNER","pos":[12885,12897]},{"content":"The right to assume ownership of the object.","pos":[12924,12968]},{"content":"The user must be an object trustee.","pos":[12969,13004]},{"content":"The user cannot transfer the ownership to other users.","pos":[13005,13059]},{"content":"0x100000","pos":[13222,13230]},{"content":"SYNCHRONIZE","pos":[13309,13320]},{"content":"The right to use the object for synchronization.","pos":[13348,13396]},{"content":"This enables a thread to wait until the object is in the signaled state.","pos":[13397,13469]},{"content":"0x1000000","pos":[13646,13655]},{"content":"ADS<ph id=\"ph1\">\\_</ph>RIGHT<ph id=\"ph2\">\\_</ph>ACCESS<ph id=\"ph3\">\\_</ph>SYSTEM<ph id=\"ph4\">\\_</ph>SECURITY","pos":[13733,13769]},{"content":"The right to get or set the SACL in the object security descriptor.","pos":[13772,13839]},{"content":"0x80000000","pos":[14070,14080]},{"content":"ADS<ph id=\"ph1\">\\_</ph>RIGHT<ph id=\"ph2\">\\_</ph>GENERIC<ph id=\"ph3\">\\_</ph>READ","pos":[14157,14182]},{"content":"The right to read permissions on this object, read all the properties on this object, list this object name when the parent container is listed, and list the contents of this object if it is a container.","pos":[14196,14399]},{"content":"0x40000000","pos":[14494,14504]},{"content":"ADS<ph id=\"ph1\">\\_</ph>RIGHT<ph id=\"ph2\">\\_</ph>GENERIC<ph id=\"ph3\">\\_</ph>WRITE","pos":[14581,14607]},{"content":"The right to read permissions on this object, write all the properties on this object, and perform all validated writes to this object.","pos":[14620,14755]},{"content":"0x20000000","pos":[14918,14928]},{"content":"ADS<ph id=\"ph1\">\\_</ph>RIGHT<ph id=\"ph2\">\\_</ph>GENERIC<ph id=\"ph3\">\\_</ph>EXECUTE","pos":[15005,15033]},{"content":"The right to read permissions on, and list the contents of, a container object.","pos":[15044,15123]},{"content":"0x10000000","pos":[15342,15352]},{"content":"ADS<ph id=\"ph1\">\\_</ph>RIGHT<ph id=\"ph2\">\\_</ph>GENERIC<ph id=\"ph3\">\\_</ph>ALL","pos":[15429,15453]},{"content":"The right to create or delete child objects, delete a subtree, read and write properties, examine child objects and the object itself, add and remove the object from the directory, and read or write with an extended right.","pos":[15468,15690]},{"content":"Table 9.","pos":[15814,15822]},{"content":"Active Directory Access Codes and Rights.","pos":[15823,15864]},{"content":"<bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: first part is the type of access that was used.","pos":[15870,15958]},{"content":"Typically has the same value as <bpt id=\"p1\">**</bpt>Accesses<ept id=\"p1\">**</ept> field.","pos":[15959,16010]},{"pos":[16016,16137],"content":"Second part is a tree of <bpt id=\"p1\">**</bpt>GUID<ept id=\"p1\">**</ept> values of Active Directory classes or property sets, for which operation was performed."},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph><bpt id=\"p2\">**</bpt>GUID<ept id=\"p2\">**</ept> is an acronym for 'Globally Unique Identifier'.","pos":[16141,16217]},{"content":"It is a 128-bit integer number used to identify resources, activities or instances.","pos":[16218,16301]},{"content":"To translate this GUID, use the following procedure:","pos":[16303,16355]},{"content":"Perform the following LDAP search using LDP.exe tool:","pos":[16361,16414]},{"content":"Base DN: CN=Schema,CN=Configuration,DC=XXX,DC=XXX","pos":[16424,16473]},{"content":"Filter: (&amp;(objectClass=<ph id=\"ph1\">\\*</ph>)(schemaIDGUID=GUID))","pos":[16483,16529]},{"content":"Perform the following operations with the GUID before using it in a search request:","pos":[16543,16626]},{"content":"We have this GUID to search for: bf967a86-0de6-11d0-a285-00aa003049e2","pos":[16644,16713]},{"content":"Take first 3 sections bf967a86-0de6-11d0.","pos":[16731,16772]},{"content":"For each of these 3 sections you need to change (Invert) the order of bytes, like this 867a96bf-e60d-d011","pos":[16790,16895]},{"content":"Add the last 2 sections without transformation: 867a96bf-e60d-d011-a285-00aa003049e2","pos":[16913,16997]},{"content":"Delete - : 867a96bfe60dd011a28500aa003049e2","pos":[17015,17058]},{"content":"Divide bytes with backslashes: <ph id=\"ph1\">\\\\</ph>86<ph id=\"ph2\">\\\\</ph>7a<ph id=\"ph3\">\\\\</ph>96<ph id=\"ph4\">\\\\</ph>bf<ph id=\"ph5\">\\\\</ph>e6<ph id=\"ph6\">\\\\</ph>0d<ph id=\"ph7\">\\\\</ph>d0<ph id=\"ph8\">\\\\</ph>11<ph id=\"ph9\">\\\\</ph>a2<ph id=\"ph10\">\\\\</ph>85<ph id=\"ph11\">\\\\</ph>00<ph id=\"ph12\">\\\\</ph>aa<ph id=\"ph13\">\\\\</ph>00<ph id=\"ph14\">\\\\</ph>30<ph id=\"ph15\">\\\\</ph>49<ph id=\"ph16\">\\\\</ph>e2","pos":[17076,17171]},{"content":"Filter example: (&amp;(objectClass=<ph id=\"ph1\">\\*</ph>)(schemaIDGUID=<ph id=\"ph2\">\\\\</ph>86<ph id=\"ph3\">\\\\</ph>7a<ph id=\"ph4\">\\\\</ph>96<ph id=\"ph5\">\\\\</ph>bf<ph id=\"ph6\">\\\\</ph>e6<ph id=\"ph7\">\\\\</ph>0d<ph id=\"ph8\">\\\\</ph>d0<ph id=\"ph9\">\\\\</ph>11<ph id=\"ph10\">\\\\</ph>a2<ph id=\"ph11\">\\\\</ph>85<ph id=\"ph12\">\\\\</ph>00<ph id=\"ph13\">\\\\</ph>aa<ph id=\"ph14\">\\\\</ph>00<ph id=\"ph15\">\\\\</ph>30<ph id=\"ph16\">\\\\</ph>49<ph id=\"ph17\">\\\\</ph>e2))","pos":[17185,17299]},{"content":"Scope: Subtree","pos":[17309,17323]},{"content":"Attributes: schemaIDGUID","pos":[17333,17357]},{"pos":[17457,17673],"content":"Sometimes GUID refers to pre-defined Active Directory Property Sets, you can find GUID (<bpt id=\"p1\">**</bpt>Rights-GUID<ept id=\"p1\">**</ept> field), “property set name” and details here: <bpt id=\"p2\">&lt;</bpt>https://msdn.microsoft.com/en-us/library/ms683990(v=vs.85).aspx<ept id=\"p2\">&gt;</ept>."},{"pos":[17675,17730],"content":"Here is an example of decoding of <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> field:"},{"content":"Properties","pos":[17734,17744]},{"content":"Translation","pos":[17970,17981]},{"content":"{bf967a86-0de6-11d0-a285-00aa003049e2}","pos":[18516,18554]},{"content":"{91e647de-d96f-4b70-9557-d63ff4f3ccd8}","pos":[18558,18596]},{"content":"{6617e4ac-a2f1-43ab-b60c-11fbd1facf05}","pos":[18601,18639]},{"content":"{b3f93023-9239-4f7c-b99c-6745d87adbc2}","pos":[18644,18682]},{"content":"{b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7}","pos":[18687,18725]},{"content":"Computer","pos":[18728,18736]},{"content":"Private-Information property set","pos":[18740,18772]},{"content":"ms-PKI-RoamingTimeStamp","pos":[18776,18799]},{"content":"ms-PKI-DPAPIMasterKeys","pos":[18803,18825]},{"content":"ms-PKI-AccountCredentials","pos":[18829,18854]},{"content":"Additional Information:","pos":[18860,18883]},{"pos":[18891,18995],"content":"<bpt id=\"p1\">**</bpt>Parameter 1<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> there is no information about this field in this document."},{"pos":[19001,19105],"content":"<bpt id=\"p1\">**</bpt>Parameter 2<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> there is no information about this field in this document."},{"content":"Security Monitoring Recommendations","pos":[19110,19145]},{"content":"For 4662(S, F): An operation was performed on an object.","pos":[19147,19203]},{"pos":[19207,19402],"content":"<bpt id=\"p1\">**</bpt>Important<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For this event, also see <bpt id=\"p2\">[</bpt>Appendix A: Security monitoring recommendations for many audit events<ept id=\"p2\">](appendix-a-security-monitoring-recommendations-for-many-audit-events.md)</ept>."},{"content":"If you need to monitor operations attempts to specific Active Directory classes, monitor for <bpt id=\"p1\">**</bpt>Object Type<ept id=\"p1\">**</ept> field with specific class name.","pos":[19408,19548]},{"content":"For example, we recommend that you monitor all operations attempts to <bpt id=\"p1\">**</bpt>domainDNS<ept id=\"p1\">**</ept> class.","pos":[19549,19639]},{"content":"If you need to monitor operations attempts to specific Active Directory objects, monitor for <bpt id=\"p1\">**</bpt>Object Name<ept id=\"p1\">**</ept> field with specific object name.","pos":[19645,19786]},{"content":"For example, we recommend that you monitor all operations attempts to “<bpt id=\"p1\">**</bpt>CN=AdminSDHolder,CN=System,DC=domain,DC=com”<ept id=\"p1\">**</ept> object.","pos":[19787,19914]},{"content":"Some access types are more important to monitor, for example:","pos":[19920,19981]},{"content":"Write Property","pos":[19991,20005]},{"content":"Control Access","pos":[20015,20029]},{"content":"DELETE","pos":[20039,20045]},{"content":"WRITE<ph id=\"ph1\">\\_</ph>DAC","pos":[20055,20065]},{"content":"WRITE<ph id=\"ph1\">\\_</ph>OWNER","pos":[20075,20087]},{"content":"You can decide to monitor these (or one of these) access types for specific Active Directory objects.","pos":[20097,20198]},{"content":"To do so, monitor for <bpt id=\"p1\">**</bpt>Accesses<ept id=\"p1\">**</ept> field with specific access type.","pos":[20199,20266]},{"pos":[20272,20417],"content":"If you need to monitor operations attempts to specific Active Directory properties, monitor for <bpt id=\"p1\">**</bpt>Properties<ept id=\"p1\">**</ept> field with specific property GUID."},{"content":"Do not forget that <bpt id=\"p1\">**</bpt>Failure<ept id=\"p1\">**</ept> attempts are also very important to audit.","pos":[20423,20496]},{"content":"Decide where you want to monitor Failure attempts based on previous recommendations.","pos":[20497,20581]}],"content":"---\ntitle: 4662(S, F) An operation was performed on an object. (Windows 10)\ndescription: Describes security event 4662(S, F) An operation was performed on an object.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 4662(S, F): An operation was performed on an object.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\n<img src=\"images/event-4662.png\" alt=\"Event 4662 illustration\" width=\"496\" height=\"614\" hspace=\"10\" align=\"left\" />\n\n***Subcategory:***&nbsp;[Audit Directory Service Access](audit-directory-service-access.md)\n\n***Event Description:***\n\nThis event generates every time when an operation was performed on an Active Directory object.\n\nThis event generates only if appropriate [SACL](https://msdn.microsoft.com/en-us/library/windows/desktop/aa374872(v=vs.85).aspx) was set for Active Directory object and performed operation meets this SACL.\n\nIf operation failed then Failure event will be generated.\n\nYou will get one 4662 for each operation type which was performed.\n\n> **Note**&nbsp;&nbsp;For recommendations, see [Security Monitoring Recommendations](#security-monitoring-recommendations) for this event.\n\n<br clear=\"all\">\n\n***Event XML:***\n```\n- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n- <System>\n <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> \n <EventID>4662</EventID> \n <Version>0</Version> \n <Level>0</Level> \n <Task>14080</Task> \n <Opcode>0</Opcode> \n <Keywords>0x8020000000000000</Keywords> \n <TimeCreated SystemTime=\"2015-08-28T01:58:36.894922400Z\" /> \n <EventRecordID>407230</EventRecordID> \n <Correlation /> \n <Execution ProcessID=\"520\" ThreadID=\"600\" /> \n <Channel>Security</Channel> \n <Computer>DC01.contoso.local</Computer> \n <Security /> \n </System>\n- <EventData>\n <Data Name=\"SubjectUserSid\">S-1-5-21-3457937927-2839227994-823803824-1104</Data> \n <Data Name=\"SubjectUserName\">dadmin</Data> \n <Data Name=\"SubjectDomainName\">CONTOSO</Data> \n <Data Name=\"SubjectLogonId\">0x35867</Data> \n <Data Name=\"ObjectServer\">DS</Data> \n <Data Name=\"ObjectType\">%{bf967a86-0de6-11d0-a285-00aa003049e2}</Data> \n <Data Name=\"ObjectName\">%{38b3d2e6-9948-4dc1-ae90-1605d5eab9a2}</Data> \n <Data Name=\"OperationType\">Object Access</Data> \n <Data Name=\"HandleId\">0x0</Data> \n <Data Name=\"AccessList\">%%1537</Data> \n <Data Name=\"AccessMask\">0x10000</Data> \n <Data Name=\"Properties\">%%1537 {bf967a86-0de6-11d0-a285-00aa003049e2}</Data> \n <Data Name=\"AdditionalInfo\">-</Data> \n <Data Name=\"AdditionalInfo2\" /> \n </EventData>\n </Event>\n\n```\n\n***Required Server Roles:*** Active Directory domain controller.\n\n***Minimum OS Version:*** Windows Server 2008.\n\n***Event Versions:*** 0.\n\n***Field Descriptions:***\n\n**Subject:**\n\n-   **Security ID** \\[Type = SID\\]**:** SID of account that requested the operation. Event Viewer automatically tries to resolve SIDs and show the account name. If the SID cannot be resolved, you will see the source data in the event.\n\n> **Note**&nbsp;&nbsp;A **security identifier (SID)** is a unique value of variable length used to identify a trustee (security principal). Each account has a unique SID that is issued by an authority, such as an Active Directory domain controller, and stored in a security database. Each time a user logs on, the system retrieves the SID for that user from the database and places it in the access token for that user. The system uses the SID in the access token to identify the user in all subsequent interactions with Windows security. When a SID has been used as the unique identifier for a user or group, it cannot ever be used again to identify another user or group. For more information about SIDs, see [Security identifiers](security-identifiers.md).\n\n-   **Account Name** \\[Type = UnicodeString\\]**:** the name of the account that requested the operation.\n\n-   **Account Domain** \\[Type = UnicodeString\\]**:** subject’s domain or computer name. Formats vary, and include the following:\n\n    -   Domain NETBIOS name example: CONTOSO\n\n    -   Lowercase full domain name: contoso.local\n\n    -   Uppercase full domain name: CONTOSO.LOCAL\n\n    -   For some [well-known security principals](https://support.microsoft.com/en-us/kb/243330), such as LOCAL SERVICE or ANONYMOUS LOGON, the value of this field is “NT AUTHORITY”.\n\n    -   For local user accounts, this field will contain the name of the computer or device that this account belongs to, for example: “Win81”.\n\n-   **Logon ID** \\[Type = HexInt64\\]**:** hexadecimal value that can help you correlate this event with recent events that might contain the same Logon ID, for example, “[4624](event-4624.md): An account was successfully logged on.”\n\n**Object:**\n\n-   **Object Server** \\[Type = UnicodeString\\]: has “**DS**” value for this event.\n\n-   **Object Type** \\[Type = UnicodeString\\]: type or class of the object that was accessed. Some of the common Active Directory object types and classes are:\n\n    -   container – for containers.\n\n    -   user – for users.\n\n    -   group – for groups.\n\n    -   domainDNS – for domain object.\n\n    -   groupPolicyContainer – for group policy objects.\n\n        For all possible values of **Object Type** open Active Directory Schema snap-in (see how to enable this snap-in: <https://technet.microsoft.com/en-us/library/Cc755885(v=WS.10).aspx)> and navigate to **Active Directory Schema\\\\Classes**. Or use this document: <https://msdn.microsoft.com/en-us/library/cc221630.aspx>\n\n-   **Object Name** \\[Type = UnicodeString\\]: distinguished name of the object that was accessed.\n\n> **Note**&nbsp;&nbsp;The LDAP API references an LDAP object by its **distinguished name (DN)**. A DN is a sequence of relative distinguished names (RDN) connected by commas.\n\n> An RDN is an attribute with an associated value in the form attribute=value; . These are examples of RDNs attributes:\n\n> • DC - domainComponent\n\n> • CN - commonName\n\n> • OU - organizationalUnitName\n\n> • O - organizationName\n\n-   **Handle ID** \\[Type = Pointer\\]: hexadecimal value of a handle to **Object Name**. This field can help you correlate this event with other events that might contain the same Handle ID, for example, “[4661](event-4661.md): A handle to an object was requested.” This parameter might not be captured in the event, and in that case appears as “0x0”.\n\n**Operation:**\n\n-   **Operation Type** \\[Type = UnicodeString\\]: the type of operation which was performed on an object. Typically has “**Object Access”** value for this event.\n\n-   **Accesses** \\[Type = UnicodeString\\]: the type of access used for the operation. See “Table 9. Active Directory Access Codes and Rights.” for more information.\n\n-   **Access Mask** \\[Type = HexInt32\\]: hexadecimal mask for the type of access used for the operation. See “Table 9. Active Directory Access Codes and Rights.” for more information.\n\n| <span id=\"Active_Directory_Access_Codes_and_Types\" class=\"anchor\"></span>Access Mask | Access Name                          | Description                                                                                                                                                                                                                                                                                           |\n|--------------------------------------------------------------------------------------|--------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| 0x1                                                                                  | Create Child                         | The right to create child objects of the object.                                                                                                                                                                                                                                                      |\n| 0x2                                                                                  | Delete Child                         | The right to delete child objects of the object.                                                                                                                                                                                                                                                      |\n| 0x4                                                                                  | List Contents                        | The right to list child objects of this object.                                                                                                                                                                                                                                                       |\n| 0x8                                                                                  | SELF                                 | The right to perform an operation controlled by a validated write access right.                                                                                                                                                                                                                       |\n| 0x10                                                                                 | Read Property                        | The right to read properties of the object.                                                                                                                                                                                                                                                           |\n| 0x20                                                                                 | Write Property                       | The right to write properties of the object.                                                                                                                                                                                                                                                          |\n| 0x40                                                                                 | Delete Tree                          | Delete all children of this object, regardless of the permissions of the children. It is indicates that “Use Delete Subtree server control” check box was checked during deletion. This operation means that all objects within the subtree, including all delete-protected objects, will be deleted. |\n| 0x80                                                                                 | List Object                          | The right to list a particular object.                                                                                                                                                                                                                                                                |\n| 0x100                                                                                | Control Access                       | Access allowed only after extended rights checks supported by the object are performed.<br>The right to perform an operation controlled by an extended access right.                                                                                                                            |\n| 0x10000                                                                              | DELETE                               | The right to delete the object. <br>DELETE also generated when object was moved.                                                                                                                                                                                                                |\n| 0x20000                                                                              | READ\\_CONTROL                        | The right to read data from the security descriptor of the object, not including the data in the SACL.                                                                                                                                                                                                |\n| 0x40000                                                                              | WRITE\\_DAC                           | The right to modify the discretionary access-control list (DACL) in the object security descriptor.                                                                                                                                                                                                   |\n| 0x80000                                                                              | WRITE\\_OWNER                         | The right to assume ownership of the object. The user must be an object trustee. The user cannot transfer the ownership to other users.                                                                                                                                                               |\n| 0x100000                                                                             | SYNCHRONIZE                          | The right to use the object for synchronization. This enables a thread to wait until the object is in the signaled state.                                                                                                                                                                             |\n| 0x1000000                                                                            | ADS\\_RIGHT\\_ACCESS\\_SYSTEM\\_SECURITY | The right to get or set the SACL in the object security descriptor.                                                                                                                                                                                                                                   |\n| 0x80000000                                                                           | ADS\\_RIGHT\\_GENERIC\\_READ            | The right to read permissions on this object, read all the properties on this object, list this object name when the parent container is listed, and list the contents of this object if it is a container.                                                                                           |\n| 0x40000000                                                                           | ADS\\_RIGHT\\_GENERIC\\_WRITE           | The right to read permissions on this object, write all the properties on this object, and perform all validated writes to this object.                                                                                                                                                               |\n| 0x20000000                                                                           | ADS\\_RIGHT\\_GENERIC\\_EXECUTE         | The right to read permissions on, and list the contents of, a container object.                                                                                                                                                                                                                       |\n| 0x10000000                                                                           | ADS\\_RIGHT\\_GENERIC\\_ALL             | The right to create or delete child objects, delete a subtree, read and write properties, examine child objects and the object itself, add and remove the object from the directory, and read or write with an extended right.                                                                        |\n\n> <span id=\"_Ref433797298\" class=\"anchor\"></span>Table 9. Active Directory Access Codes and Rights.\n\n-   **Properties** \\[Type = UnicodeString\\]: first part is the type of access that was used. Typically has the same value as **Accesses** field.\n\n    Second part is a tree of **GUID** values of Active Directory classes or property sets, for which operation was performed.\n\n> **Note**&nbsp;&nbsp;**GUID** is an acronym for 'Globally Unique Identifier'. It is a 128-bit integer number used to identify resources, activities or instances.\n\nTo translate this GUID, use the following procedure:\n\n-   Perform the following LDAP search using LDP.exe tool:\n\n    -   Base DN: CN=Schema,CN=Configuration,DC=XXX,DC=XXX\n\n    -   Filter: (&(objectClass=\\*)(schemaIDGUID=GUID))\n\n        -   Perform the following operations with the GUID before using it in a search request:\n\n            -   We have this GUID to search for: bf967a86-0de6-11d0-a285-00aa003049e2\n\n            -   Take first 3 sections bf967a86-0de6-11d0.\n\n            -   For each of these 3 sections you need to change (Invert) the order of bytes, like this 867a96bf-e60d-d011\n\n            -   Add the last 2 sections without transformation: 867a96bf-e60d-d011-a285-00aa003049e2\n\n            -   Delete - : 867a96bfe60dd011a28500aa003049e2\n\n            -   Divide bytes with backslashes: \\\\86\\\\7a\\\\96\\\\bf\\\\e6\\\\0d\\\\d0\\\\11\\\\a2\\\\85\\\\00\\\\aa\\\\00\\\\30\\\\49\\\\e2\n\n        -   Filter example: (&(objectClass=\\*)(schemaIDGUID=\\\\86\\\\7a\\\\96\\\\bf\\\\e6\\\\0d\\\\d0\\\\11\\\\a2\\\\85\\\\00\\\\aa\\\\00\\\\30\\\\49\\\\e2))\n\n    -   Scope: Subtree\n\n    -   Attributes: schemaIDGUID\n\n<img src=\"images/schema-search.png\" alt=\"Schema search illustration\" width=\"313\" height=\"212\" />\n\nSometimes GUID refers to pre-defined Active Directory Property Sets, you can find GUID (**Rights-GUID** field), “property set name” and details here: <https://msdn.microsoft.com/en-us/library/ms683990(v=vs.85).aspx>.\n\nHere is an example of decoding of **Properties** field:\n\n| Properties                                                                                                                                                                                                                                | Translation                                                                                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|\n| {bf967a86-0de6-11d0-a285-00aa003049e2}<br>{91e647de-d96f-4b70-9557-d63ff4f3ccd8}<br> {6617e4ac-a2f1-43ab-b60c-11fbd1facf05}<br> {b3f93023-9239-4f7c-b99c-6745d87adbc2}<br> {b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7} | Computer<br>Private-Information property set<br>ms-PKI-RoamingTimeStamp<br>ms-PKI-DPAPIMasterKeys<br>ms-PKI-AccountCredentials |\n\n**Additional Information:**\n\n-   **Parameter 1** \\[Type = UnicodeString\\]**:** there is no information about this field in this document.\n\n-   **Parameter 2** \\[Type = UnicodeString\\]**:** there is no information about this field in this document.\n\n## Security Monitoring Recommendations\n\nFor 4662(S, F): An operation was performed on an object.\n\n> **Important**&nbsp;&nbsp;For this event, also see [Appendix A: Security monitoring recommendations for many audit events](appendix-a-security-monitoring-recommendations-for-many-audit-events.md).\n\n-   If you need to monitor operations attempts to specific Active Directory classes, monitor for **Object Type** field with specific class name. For example, we recommend that you monitor all operations attempts to **domainDNS** class.\n\n-   If you need to monitor operations attempts to specific Active Directory objects, monitor for **Object Name** field with specific object name. For example, we recommend that you monitor all operations attempts to “**CN=AdminSDHolder,CN=System,DC=domain,DC=com”** object.\n\n-   Some access types are more important to monitor, for example:\n\n    -   Write Property\n\n    -   Control Access\n\n    -   DELETE\n\n    -   WRITE\\_DAC\n\n    -   WRITE\\_OWNER\n\n        You can decide to monitor these (or one of these) access types for specific Active Directory objects. To do so, monitor for **Accesses** field with specific access type.\n\n-   If you need to monitor operations attempts to specific Active Directory properties, monitor for **Properties** field with specific property GUID.\n\n-   Do not forget that **Failure** attempts are also very important to audit. Decide where you want to monitor Failure attempts based on previous recommendations.\n\n"}