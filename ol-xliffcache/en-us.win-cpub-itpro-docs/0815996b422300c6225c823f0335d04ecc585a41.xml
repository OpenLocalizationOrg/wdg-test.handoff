{"nodes":[{"content":"4944(S) The following policy was active when the Windows Firewall started.","pos":[11,85]},{"content":"(Windows 10)","pos":[86,98]},{"content":"Describes security event 4944(S) The following policy was active when the Windows Firewall started.","pos":[112,211]},{"content":"4944(S): The following policy was active when the Windows Firewall started.","pos":[311,386]},{"content":"Applies to","pos":[390,400]},{"content":"Windows 10","pos":[407,417]},{"content":"Windows Server 2016","pos":[422,441]},{"pos":[561,666],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit MPSSVC Rule-Level Policy Change<ept id=\"p2\">](audit-mpssvc-rule-level-policy-change.md)</ept>"},{"content":"Event Description:","pos":[671,689]},{"content":"This event generates every time Windows Firewall service starts.","pos":[694,758]},{"content":"This event shows Windows Firewall settings that were in effect when the Windows Firewall service started.","pos":[760,865]},{"pos":[869,1005],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For recommendations, see <bpt id=\"p2\">[</bpt>Security Monitoring Recommendations<ept id=\"p2\">](#security-monitoring-recommendations)</ept> for this event."},{"content":"Event XML:","pos":[1028,1038]},{"pos":[2038,2072],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> None."},{"pos":[2074,2135],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008, Windows Vista."},{"pos":[2137,2161],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Field Descriptions:","pos":[2166,2185]},{"content":"<bpt id=\"p1\">**</bpt>Group Policy Applied<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: it always has “No” value for this event.","pos":[2190,2281]},{"content":"This field should show information about: was Group Policy applied for Windows Firewall when it starts or not.","pos":[2282,2392]},{"content":"<bpt id=\"p1\">**</bpt>Profile Used<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: shows the active profile name for the moment Windows Firewall service starts.","pos":[2394,2514]},{"content":"It always has value “<bpt id=\"p1\">**</bpt>Public<ept id=\"p1\">**</ept>” for this event, because when this event generates, the active profile is not switched to “<bpt id=\"p2\">**</bpt>Domain<ept id=\"p2\">**</ept>” or “<bpt id=\"p3\">**</bpt>Private<ept id=\"p3\">**</ept>”.","pos":[2515,2667]},{"content":"Typically you will see “<bpt id=\"p1\">[</bpt>4956<ept id=\"p1\">](event-4956.md)</ept>(S): Windows Firewall has changed the active profile” after this event, which will tell you the real active profile.","pos":[2668,2829]},{"pos":[2831,2877],"content":"<bpt id=\"p1\">**</bpt>Operational mode<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>:"},{"pos":[2883,2962],"content":"<bpt id=\"p1\">**</bpt>On<ept id=\"p1\">**</ept> – if “<bpt id=\"p2\">**</bpt>Firewall state:<ept id=\"p2\">**</ept>” setting was set to “On” for “Public” profile."},{"pos":[2968,3049],"content":"<bpt id=\"p1\">**</bpt>Off<ept id=\"p1\">**</ept> - if “<bpt id=\"p2\">**</bpt>Firewall state:<ept id=\"p2\">**</ept>” setting was set to “Off” for “Public” profile."},{"pos":[3176,3626],"content":"<bpt id=\"p1\">**</bpt>Allow Remote Administration<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: looks like this setting is connected to ”<bpt id=\"p2\">[</bpt>Windows Firewall: Allow remote administration exception<ept id=\"p2\">](https://technet.microsoft.com/en-us/library/cc738900(v=ws.10).aspx)</ept>” Group Policy setting, but it is always Disabled, no matter which option is set for “<bpt id=\"p3\">[</bpt>Windows Firewall: Allow remote administration exception<ept id=\"p3\">](https://technet.microsoft.com/en-us/library/cc738900(v=ws.10).aspx)</ept>” Group Policy."},{"pos":[3628,3712],"content":"<bpt id=\"p1\">**</bpt>Allow Unicast Responses to Multicast/Broadcast Traffic<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>:"},{"pos":[3718,3826],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept> - if “<bpt id=\"p2\">**</bpt>Allow unicast response:<ept id=\"p2\">**</ept>” Settings configuration was set to “Yes” for “Public” profile."},{"pos":[3832,3940],"content":"<bpt id=\"p1\">**</bpt>Disabled<ept id=\"p1\">**</ept> - if “<bpt id=\"p2\">**</bpt>Allow unicast response:<ept id=\"p2\">**</ept>” Settings configuration was set to “No” for “Public” profile."},{"content":"Security Logging:","pos":[4081,4098]},{"pos":[4106,4155],"content":"<bpt id=\"p1\">**</bpt>Log Dropped Packets<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>:"},{"pos":[4165,4269],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept> – if “<bpt id=\"p2\">**</bpt>Log dropped packets:<ept id=\"p2\">**</ept>” Logging configuration was set to “Yes” for “Public” profile."},{"pos":[4279,4383],"content":"<bpt id=\"p1\">**</bpt>Disabled<ept id=\"p1\">**</ept> - if “<bpt id=\"p2\">**</bpt>Log dropped packets:<ept id=\"p2\">**</ept>” Logging configuration was set to “No” for “Public” profile."},{"pos":[4389,4445],"content":"<bpt id=\"p1\">**</bpt>Log Successful Connections<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>:"},{"pos":[4455,4566],"content":"<bpt id=\"p1\">**</bpt>Enabled<ept id=\"p1\">**</ept> - if “<bpt id=\"p2\">**</bpt>Log successful connections:<ept id=\"p2\">**</ept>” Logging configuration was set to “Yes” for “Public” profile."},{"pos":[4576,4680],"content":"<bpt id=\"p1\">**</bpt>Disabled<ept id=\"p1\">**</ept> - if “<bpt id=\"p2\">**</bpt>Log dropped packets:<ept id=\"p2\">**</ept>” Logging configuration was set to “No” for “Public” profile."},{"content":"Security Monitoring Recommendations","pos":[4820,4855]},{"content":"For 4944(S): The following policy was active when the Windows Firewall started.","pos":[4857,4936]},{"pos":[4942,5226],"content":"If you have a standard or baseline for Windows Firewall settings defined for <bpt id=\"p1\">**</bpt>Public<ept id=\"p1\">**</ept> profile (which can be the same as for Domain, for example), monitor this event and check whether the settings reported by the event are still the same as were defined in your standard or baseline."},{"pos":[5232,5500],"content":"Unfortunately this event shows configuration only for <bpt id=\"p1\">**</bpt>Public<ept id=\"p1\">**</ept> profile, but you can still compare all the settings with your organization's Windows Firewall baseline for Public profile on different computers and trigger an alert if the configuration is not the same."}],"content":"---\ntitle: 4944(S) The following policy was active when the Windows Firewall started. (Windows 10)\ndescription: Describes security event 4944(S) The following policy was active when the Windows Firewall started.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 4944(S): The following policy was active when the Windows Firewall started.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\n<img src=\"images/event-4944.png\" alt=\"Event 4944 illustration\" width=\"449\" height=\"391\" hspace=\"10\" align=\"left\" />\n\n***Subcategory:***&nbsp;[Audit MPSSVC Rule-Level Policy Change](audit-mpssvc-rule-level-policy-change.md)\n\n***Event Description:***\n\nThis event generates every time Windows Firewall service starts.\n\nThis event shows Windows Firewall settings that were in effect when the Windows Firewall service started.\n\n> **Note**&nbsp;&nbsp;For recommendations, see [Security Monitoring Recommendations](#security-monitoring-recommendations) for this event.\n\n<br clear=\"all\">\n\n***Event XML:***\n```\n- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n- <System>\n <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> \n <EventID>4944</EventID> \n <Version>0</Version> \n <Level>0</Level> \n <Task>13571</Task> \n <Opcode>0</Opcode> \n <Keywords>0x8020000000000000</Keywords> \n <TimeCreated SystemTime=\"2015-10-03T00:14:56.644728300Z\" /> \n <EventRecordID>1050808</EventRecordID> \n <Correlation /> \n <Execution ProcessID=\"500\" ThreadID=\"2216\" /> \n <Channel>Security</Channel> \n <Computer>DC01.contoso.local</Computer> \n <Security /> \n </System>\n- <EventData>\n <Data Name=\"GroupPolicyApplied\">No</Data> \n <Data Name=\"Profile\">Public</Data> \n <Data Name=\"OperationMode\">Off</Data> \n <Data Name=\"RemoteAdminEnabled\">Disabled</Data> \n <Data Name=\"MulticastFlowsEnabled\">Enabled</Data> \n <Data Name=\"LogDroppedPacketsEnabled\">Disabled</Data> \n <Data Name=\"LogSuccessfulConnectionsEnabled\">Disabled</Data> \n </EventData>\n </Event>\n\n```\n\n***Required Server Roles:*** None.\n\n***Minimum OS Version:*** Windows Server 2008, Windows Vista.\n\n***Event Versions:*** 0.\n\n***Field Descriptions:***\n\n**Group Policy Applied** \\[Type = UnicodeString\\]: it always has “No” value for this event. This field should show information about: was Group Policy applied for Windows Firewall when it starts or not.\n\n**Profile Used** \\[Type = UnicodeString\\]: shows the active profile name for the moment Windows Firewall service starts. It always has value “**Public**” for this event, because when this event generates, the active profile is not switched to “**Domain**” or “**Private**”. Typically you will see “[4956](event-4956.md)(S): Windows Firewall has changed the active profile” after this event, which will tell you the real active profile.\n\n**Operational mode** \\[Type = UnicodeString\\]:\n\n-   **On** – if “**Firewall state:**” setting was set to “On” for “Public” profile.\n\n-   **Off** - if “**Firewall state:**” setting was set to “Off” for “Public” profile.\n\n<img src=\"images/windows-firewall-state-off.png\" alt=\"Windows Firewall set to Off illustration\" width=\"382\" height=\"395\" />\n\n**Allow Remote Administration** \\[Type = UnicodeString\\]: looks like this setting is connected to ”[Windows Firewall: Allow remote administration exception](https://technet.microsoft.com/en-us/library/cc738900(v=ws.10).aspx)” Group Policy setting, but it is always Disabled, no matter which option is set for “[Windows Firewall: Allow remote administration exception](https://technet.microsoft.com/en-us/library/cc738900(v=ws.10).aspx)” Group Policy.\n\n**Allow Unicast Responses to Multicast/Broadcast Traffic** \\[Type = UnicodeString\\]:\n\n-   **Enabled** - if “**Allow unicast response:**” Settings configuration was set to “Yes” for “Public” profile.\n\n-   **Disabled** - if “**Allow unicast response:**” Settings configuration was set to “No” for “Public” profile.\n\n<img src=\"images/firewall-settings-public-profile.png\" alt=\"Firewall Settings, Public Profile illustration\" width=\"411\" height=\"405\" />\n\n**Security Logging:**\n\n-   **Log Dropped Packets** \\[Type = UnicodeString\\]:\n\n    -   **Enabled** – if “**Log dropped packets:**” Logging configuration was set to “Yes” for “Public” profile.\n\n    -   **Disabled** - if “**Log dropped packets:**” Logging configuration was set to “No” for “Public” profile.\n\n-   **Log Successful Connections** \\[Type = UnicodeString\\]:\n\n    -   **Enabled** - if “**Log successful connections:**” Logging configuration was set to “Yes” for “Public” profile.\n\n    -   **Disabled** - if “**Log dropped packets:**” Logging configuration was set to “No” for “Public” profile.\n\n<img src=\"images/logging-settings-public-profile.png\" alt=\"Logging Settings, Public Profile illustration\" width=\"383\" height=\"304\" />\n\n## Security Monitoring Recommendations\n\nFor 4944(S): The following policy was active when the Windows Firewall started.\n\n-   If you have a standard or baseline for Windows Firewall settings defined for **Public** profile (which can be the same as for Domain, for example), monitor this event and check whether the settings reported by the event are still the same as were defined in your standard or baseline.\n\n-   Unfortunately this event shows configuration only for **Public** profile, but you can still compare all the settings with your organization's Windows Firewall baseline for Public profile on different computers and trigger an alert if the configuration is not the same.\n\n"}