{"nodes":[{"content":"4716(S) Trusted domain information was modified.","pos":[11,59]},{"content":"(Windows 10)","pos":[60,72]},{"content":"Describes security event 4716(S) Trusted domain information was modified.","pos":[86,159]},{"content":"4716(S): Trusted domain information was modified.","pos":[259,308]},{"content":"Applies to","pos":[312,322]},{"content":"Windows 10","pos":[329,339]},{"content":"Windows Server 2016","pos":[344,363]},{"pos":[483,582],"content":"<bpt id=\"p1\">***</bpt>Subcategory:<ept id=\"p1\">***</ept><ph id=\"ph1\">&amp;nbsp;</ph><bpt id=\"p2\">[</bpt>Audit Authentication Policy Change<ept id=\"p2\">](audit-authentication-policy-change.md)</ept>"},{"content":"Event Description:","pos":[587,605]},{"content":"This event generates when the trust was modified.","pos":[610,659]},{"content":"This event is generated only on domain controllers.","pos":[661,712]},{"pos":[716,852],"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>For recommendations, see <bpt id=\"p2\">[</bpt>Security Monitoring Recommendations<ept id=\"p2\">](#security-monitoring-recommendations)</ept> for this event."},{"content":"Event XML:","pos":[875,885]},{"pos":[2026,2090],"content":"<bpt id=\"p1\">***</bpt>Required Server Roles:<ept id=\"p1\">***</ept> Active Directory domain controller."},{"pos":[2092,2138],"content":"<bpt id=\"p1\">***</bpt>Minimum OS Version:<ept id=\"p1\">***</ept> Windows Server 2008."},{"pos":[2140,2164],"content":"<bpt id=\"p1\">***</bpt>Event Versions:<ept id=\"p1\">***</ept> 0."},{"content":"Field Descriptions:","pos":[2169,2188]},{"content":"Subject:","pos":[2195,2203]},{"content":"<bpt id=\"p1\">**</bpt>Security ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = SID<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> SID of account that requested the “modify domain trust settings” operation.","pos":[2211,2322]},{"content":"Event Viewer automatically tries to resolve SIDs and show the account name.","pos":[2323,2398]},{"content":"If the SID cannot be resolved, you will see the source data in the event.","pos":[2399,2472]},{"content":"<bpt id=\"p1\">**</bpt>Note<ept id=\"p1\">**</ept><ph id=\"ph1\">&amp;nbsp;&amp;nbsp;</ph>A <bpt id=\"p2\">**</bpt>security identifier (SID)<ept id=\"p2\">**</ept> is a unique value of variable length used to identify a trustee (security principal).","pos":[2476,2613]},{"content":"Each account has a unique SID that is issued by an authority, such as an Active Directory domain controller, and stored in a security database.","pos":[2614,2757]},{"content":"Each time a user logs on, the system retrieves the SID for that user from the database and places it in the access token for that user.","pos":[2758,2893]},{"content":"The system uses the SID in the access token to identify the user in all subsequent interactions with Windows security.","pos":[2894,3012]},{"content":"When a SID has been used as the unique identifier for a user or group, it cannot ever be used again to identify another user or group.","pos":[3013,3147]},{"content":"For more information about SIDs, see <bpt id=\"p1\">[</bpt>Security identifiers<ept id=\"p1\">](security-identifiers.md)</ept>.","pos":[3148,3233]},{"pos":[3239,3370],"content":"<bpt id=\"p1\">**</bpt>Account Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the name of the account that requested the “modify domain trust settings” operation."},{"content":"<bpt id=\"p1\">**</bpt>Account Domain<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> subject’s domain or computer name.","pos":[3376,3459]},{"content":"Formats vary, and include the following:","pos":[3460,3500]},{"content":"Domain NETBIOS name example: CONTOSO","pos":[3510,3546]},{"content":"Lowercase full domain name: contoso.local","pos":[3556,3597]},{"content":"Uppercase full domain name: CONTOSO.LOCAL","pos":[3607,3648]},{"pos":[3658,3832],"content":"For some <bpt id=\"p1\">[</bpt>well-known security principals<ept id=\"p1\">](https://support.microsoft.com/en-us/kb/243330)</ept>, such as LOCAL SERVICE or ANONYMOUS LOGON, the value of this field is “NT AUTHORITY”."},{"content":"For local user accounts, this field will contain the name of the computer or device that this account belongs to, for example: “Win81”.","pos":[3842,3977]},{"pos":[3983,4211],"content":"<bpt id=\"p1\">**</bpt>Logon ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = HexInt64<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> hexadecimal value that can help you correlate this event with recent events that might contain the same Logon ID, for example, “<bpt id=\"p3\">[</bpt>4624<ept id=\"p3\">](event-4624.md)</ept>: An account was successfully logged on.”"},{"content":"Trusted Domain:","pos":[4215,4230]},{"content":"<bpt id=\"p1\">**</bpt>Domain Name<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the name of changed trusted domain.","pos":[4238,4319]},{"content":"If this attribute was not changed, then it will have “<bpt id=\"p1\">**</bpt><ph id=\"ph1\">-</ph><ept id=\"p1\">**</ept>“ value.","pos":[4320,4387]},{"content":"<bpt id=\"p1\">**</bpt>Domain ID<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = SID<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> SID of changed trusted domain.","pos":[4393,4457]},{"content":"Event Viewer automatically tries to resolve SIDs and show the account name.","pos":[4458,4533]},{"content":"If the SID cannot be resolved, you will see the source data in the event.","pos":[4534,4607]},{"content":"New Trust Information:","pos":[4611,4633]},{"content":"<bpt id=\"p1\">**</bpt>Trust Type<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UInt32<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the type of new trust.","pos":[4641,4701]},{"content":"If this attribute was not changed, then it will have “<bpt id=\"p1\">**</bpt><ph id=\"ph1\">-</ph><ept id=\"p1\">**</ept>“ value or its old value.","pos":[4702,4786]},{"content":"The following table contains possible values for this field:","pos":[4787,4847]},{"content":"Value","pos":[4851,4856]},{"content":"Attribute Value","pos":[4859,4874]},{"content":"Description","pos":[4884,4895]},{"content":"1","pos":[5971,5972]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>TYPE<ph id=\"ph2\">\\_</ph>DOWNLEVEL","pos":[5979,6001]},{"content":"The domain controller of the trusted domain is a computer running an operating system earlier than Windows 2000.","pos":[6004,6116]},{"content":"2","pos":[6531,6532]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>TYPE<ph id=\"ph2\">\\_</ph>UPLEVEL","pos":[6539,6559]},{"content":"The domain controller of the trusted domain is a computer running Windows 2000 or later.","pos":[6564,6652]},{"content":"3","pos":[7091,7092]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>TYPE<ph id=\"ph2\">\\_</ph>MIT","pos":[7099,7115]},{"content":"The trusted domain is running a non-Windows, RFC4120-compliant Kerberos distribution.","pos":[7124,7209]},{"content":"This type of trust is distinguished in that (1) a <bpt id=\"p1\">[</bpt>SID<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_83f2020d-0804-4840-a5ac-e06439d50f8d)</ept> is not required for the <bpt id=\"p2\">[</bpt>TDO<ept id=\"p2\">](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_f2ceef4e-999b-4276-84cd-2e2829de5fc4)</ept>, and (2) the default key types include the DES-CBC and DES-CRC encryption types (see <bpt id=\"p3\">[</bpt><ph id=\"ph1\">\\[</ph>RFC4120<ph id=\"ph2\">\\]</ph><ept id=\"p3\">](http://go.microsoft.com/fwlink/?LinkId=90458)</ept> section 8.1).","pos":[7210,7646]},{"content":"4","pos":[7651,7652]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>TYPE<ph id=\"ph2\">\\_</ph>DCE","pos":[7659,7675]},{"content":"The trusted domain is a DCE realm.","pos":[7684,7718]},{"content":"Historical reference, this value is not used in Windows.","pos":[7719,7775]},{"content":"<bpt id=\"p1\">**</bpt>Trust Direction<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UInt32<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the direction of new trust.","pos":[8214,8284]},{"content":"If this attribute was not changed, then it will have “<bpt id=\"p1\">**</bpt><ph id=\"ph1\">-</ph><ept id=\"p1\">**</ept>“ value or its old value.","pos":[8285,8369]},{"content":"The following table contains possible values for this field:","pos":[8370,8430]},{"content":"Value","pos":[8434,8439]},{"content":"Attribute Value","pos":[8442,8457]},{"content":"Description","pos":[8476,8487]},{"content":"0","pos":[8742,8743]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>DIRECTION<ph id=\"ph2\">\\_</ph>DISABLED","pos":[8750,8776]},{"content":"The trust relationship exists, but it has been disabled.","pos":[8784,8840]},{"content":"1","pos":[8896,8897]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>DIRECTION<ph id=\"ph2\">\\_</ph>INBOUND","pos":[8904,8929]},{"content":"The trusted domain trusts the primary domain to perform operations such as name lookups and authentication.","pos":[8938,9045]},{"content":"2","pos":[9050,9051]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>DIRECTION<ph id=\"ph2\">\\_</ph>OUTBOUND","pos":[9058,9084]},{"content":"The primary domain trusts the trusted domain to perform operations such as name lookups and authentication.","pos":[9092,9199]},{"content":"3","pos":[9204,9205]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>DIRECTION<ph id=\"ph2\">\\_</ph>BIDIRECTIONAL","pos":[9212,9243]},{"content":"Both domains trust one another for operations such as name lookups and authentication.","pos":[9246,9332]},{"content":"<bpt id=\"p1\">**</bpt>Trust Attributes<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UInt32<ph id=\"ph2\">\\]</ph><bpt id=\"p2\">**</bpt>:<ept id=\"p2\">**</ept> the decimal value of attributes for new trust.","pos":[9361,9451]},{"content":"You need convert decimal value to hexadecimal and find it in the table below.","pos":[9452,9529]},{"content":"If this attribute was not changed, then it will have “<bpt id=\"p1\">**</bpt><ph id=\"ph1\">-</ph><ept id=\"p1\">**</ept>“ value or its old value.","pos":[9530,9614]},{"content":"The following table contains possible values for this field:","pos":[9615,9675]},{"content":"Value","pos":[9679,9684]},{"content":"Attribute Value","pos":[9687,9702]},{"content":"Description","pos":[9748,9759]},{"content":"0x1","pos":[11803,11806]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>NON<ph id=\"ph3\">\\_</ph>TRANSITIVE","pos":[11811,11844]},{"content":"If this bit is set, then the trust cannot be used transitively.","pos":[11872,11935]},{"content":"For example, if domain A trusts domain B, which in turn trusts domain C, and the A<ph id=\"ph1\">&amp;lt;--&amp;gt;</ph>B trust has this attribute set, then a client in domain A cannot authenticate to a server in domain C over the A<ph id=\"ph2\">&amp;lt;--&amp;gt;</ph>B<ph id=\"ph3\">&amp;lt;--&amp;gt;</ph>C trust linkage.","pos":[11936,12177]},{"content":"0x2","pos":[12865,12868]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>UPLEVEL<ph id=\"ph3\">\\_</ph>ONLY","pos":[12873,12904]},{"content":"If this bit is set in the attribute, then only Windows 2000 operating system and newer clients may use the trust link.","pos":[12934,13052]},{"content":"<bpt id=\"p1\">[</bpt>Netlogon<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_70771a5a-04a3-447d-981b-e03098808c32)</ept> does not consume <bpt id=\"p2\">[</bpt>trust objects<ept id=\"p2\">](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_e81f6436-01d2-4311-93a4-4316bb67eabd)</ept> that have this flag set.","pos":[13053,13313]},{"content":"0x4","pos":[13927,13930]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>QUARANTINED<ph id=\"ph3\">\\_</ph>DOMAIN","pos":[13935,13972]},{"pos":[13996,14352],"content":"If this bit is set, the trusted domain is quarantined and is subject to the rules of <bpt id=\"p1\">[</bpt>SID<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_83f2020d-0804-4840-a5ac-e06439d50f8d)</ept> Filtering as described in <bpt id=\"p2\">[</bpt><ph id=\"ph1\">\\[</ph>MS-PAC<ph id=\"ph2\">\\]</ph><ept id=\"p2\">](https://msdn.microsoft.com/en-us/library/cc237917.aspx)</ept> section <bpt id=\"p3\">[</bpt>4.1.2.2<ept id=\"p3\">](https://msdn.microsoft.com/en-us/library/cc237940.aspx)</ept>."},{"content":"0x8","pos":[14989,14992]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>FOREST<ph id=\"ph3\">\\_</ph>TRANSITIVE","pos":[14997,15033]},{"content":"If this bit is set, the trust link is a <bpt id=\"p1\">[</bpt>cross-forest trust<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_86f3dbf2-338f-462e-8c5b-3c8e05798dbc)</ept> <bpt id=\"p2\">[</bpt><ph id=\"ph1\">\\[</ph>MS-KILE<ph id=\"ph2\">\\]</ph><ept id=\"p2\">](https://msdn.microsoft.com/en-us/library/cc233855.aspx)</ept> between the root domains of two <bpt id=\"p3\">[</bpt>forests<ept id=\"p3\">](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_fd104241-4fb3-457c-b2c4-e0c18bb20b62)</ept>, both of which are running in a <bpt id=\"p4\">[</bpt>forest functional level<ept id=\"p4\">](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_b3240417-ca43-4901-90ec-fde55b32b3b8)</ept> of DS<ph id=\"ph3\">\\_</ph>BEHAVIOR<ph id=\"ph4\">\\_</ph>WIN2003 or greater.","pos":[15058,15613]},{"content":"Only evaluated on Windows Server 2003 operating system, Windows Server 2008 operating system, Windows Server 2008 R2 operating system, Windows Server 2012 operating system, Windows Server 2012 R2 operating system, and Windows Server 2016 Technical Preview operating system.","pos":[15617,15890]},{"content":"Can only be set if forest and trusted forest are running in a forest functional level of DS<ph id=\"ph1\">\\_</ph>BEHAVIOR<ph id=\"ph2\">\\_</ph>WIN2003 or greater.","pos":[15894,16016]},{"content":"0x10","pos":[16039,16043]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>CROSS<ph id=\"ph3\">\\_</ph>ORGANIZATION","pos":[16047,16084]},{"content":"If this bit is set, then the trust is to a domain or forest that is not part of the <bpt id=\"p1\">[</bpt>organization<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_6fae7775-5232-4206-b452-f298546ab54f)</ept>.","pos":[16108,16303]},{"content":"The behavior controlled by this bit is explained in <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\[</ph>MS-KILE<ph id=\"ph2\">\\]</ph><ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc233855.aspx)</ept> section <bpt id=\"p2\">[</bpt>3.3.5.7.5<ept id=\"p2\">](https://msdn.microsoft.com/en-us/library/cc233949.aspx)</ept> and <bpt id=\"p3\">[</bpt><ph id=\"ph3\">\\[</ph>MS-APDS<ph id=\"ph4\">\\]</ph><ept id=\"p3\">](https://msdn.microsoft.com/en-us/library/cc223948.aspx)</ept> section <bpt id=\"p4\">[</bpt>3.1.5<ept id=\"p4\">](https://msdn.microsoft.com/en-us/library/cc223991.aspx)</ept>.","pos":[16304,16648]},{"content":"Only evaluated on Windows Server 2003, Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016 Technical Preview.","pos":[16652,16823]},{"content":"Can only be set if forest and trusted forest are running in a forest functional level of DS<ph id=\"ph1\">\\_</ph>BEHAVIOR<ph id=\"ph2\">\\_</ph>WIN2003 or greater.","pos":[16827,16949]},{"content":"0x20","pos":[17089,17093]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>WITHIN<ph id=\"ph3\">\\_</ph>FOREST","pos":[17097,17129]},{"content":"If this bit is set, then the trusted domain is within the same forest.","pos":[17158,17228]},{"content":"Only evaluated on Windows Server 2003, Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016 Technical Preview.","pos":[17232,17403]},{"content":"0x40","pos":[18145,18149]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>TREAT<ph id=\"ph3\">\\_</ph>AS<ph id=\"ph4\">\\_</ph>EXTERNAL","pos":[18153,18190]},{"content":"If this bit is set, then a cross-forest trust to a domain is to be treated as an external trust for the purposes of SID Filtering.","pos":[18214,18344]},{"content":"Cross-forest trusts are more stringently <bpt id=\"p1\">[</bpt>filtered<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_ffbe7b55-8e84-4f41-a18d-fc29191a4cda)</ept> than external trusts.","pos":[18345,18514]},{"content":"This attribute relaxes those cross-forest trusts to be equivalent to external trusts.","pos":[18515,18600]},{"content":"For more information on how each trust type is filtered, see <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\[</ph>MS-PAC<ph id=\"ph2\">\\]</ph><ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc237917.aspx)</ept> section 4.1.2.2.","pos":[18601,18747]},{"content":"Only evaluated on Windows Server 2003, Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016 Technical Preview.","pos":[18751,18922]},{"content":"Only evaluated if SID Filtering is used.","pos":[18926,18966]},{"content":"Only evaluated on cross-forest trusts having TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>FOREST<ph id=\"ph3\">\\_</ph>TRANSITIVE.","pos":[18970,19052]},{"content":"Can only be set if forest and trusted forest are running in a forest functional level of DS<ph id=\"ph1\">\\_</ph>BEHAVIOR<ph id=\"ph2\">\\_</ph>WIN2003 or greater.","pos":[19056,19178]},{"content":"0x80","pos":[19183,19187]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>USES<ph id=\"ph3\">\\_</ph>RC4<ph id=\"ph4\">\\_</ph>ENCRYPTION","pos":[19191,19230]},{"content":"This bit is set on trusts with the <bpt id=\"p1\">[</bpt>trustType<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc220955.aspx)</ept> set to TRUST<ph id=\"ph1\">\\_</ph>TYPE<ph id=\"ph2\">\\_</ph>MIT, which are capable of using RC4 keys.","pos":[19252,19416]},{"content":"Historically, MIT Kerberos distributions supported only DES and 3DES keys (<bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\[</ph>RFC4120<ph id=\"ph2\">\\]</ph><ept id=\"p1\">](http://go.microsoft.com/fwlink/?LinkId=90458)</ept>, <bpt id=\"p2\">[</bpt><ph id=\"ph3\">\\[</ph>RFC3961<ph id=\"ph4\">\\]</ph><ept id=\"p2\">](http://go.microsoft.com/fwlink/?LinkId=90450)</ept>).","pos":[19417,19614]},{"content":"MIT 1.4.1 adopted the RC4HMAC encryption type common to Windows 2000 <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\[</ph>MS-KILE<ph id=\"ph2\">\\]</ph><ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc233855.aspx)</ept>, so trusted domains deploying later versions of the MIT distribution required this bit.","pos":[19615,19841]},{"content":"For more information, see \"Keys and Trusts\", section <bpt id=\"p1\">[</bpt>6.1.6.9.1<ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc223782.aspx)</ept>.","pos":[19842,19963]},{"content":"Only evaluated on TRUST<ph id=\"ph1\">\\_</ph>TYPE<ph id=\"ph2\">\\_</ph>MIT","pos":[19967,20001]},{"content":"0x200","pos":[20239,20244]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>CROSS<ph id=\"ph3\">\\_</ph>ORGANIZATION<ph id=\"ph4\">\\_</ph>NO<ph id=\"ph5\">\\_</ph>TGT<ph id=\"ph6\">\\_</ph>DELEGATION","pos":[20247,20305]},{"content":"If this bit is set, tickets granted under this trust MUST NOT be trusted for delegation.","pos":[20308,20396]},{"content":"The behavior controlled by this bit is as specified in <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\[</ph>MS-KILE<ph id=\"ph2\">\\]</ph><ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc233855.aspx)</ept> section 3.3.5.7.5.","pos":[20397,20540]},{"content":"Only supported on Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016 Technical Preview.","pos":[20544,20649]},{"content":"0x400","pos":[21295,21300]},{"content":"TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>PIM<ph id=\"ph3\">\\_</ph>TRUST","pos":[21303,21331]},{"content":"If this bit and the TATE bit are set, then a cross-forest trust to a domain is to be treated as Privileged Identity Management trust for the purposes of SID Filtering.","pos":[21364,21531]},{"content":"For more information on how each trust type is filtered, see <bpt id=\"p1\">[</bpt><ph id=\"ph1\">\\[</ph>MS-PAC<ph id=\"ph2\">\\]</ph><ept id=\"p1\">](https://msdn.microsoft.com/en-us/library/cc237917.aspx)</ept> section 4.1.2.2.","pos":[21532,21678]},{"content":"Evaluated only on Windows Server 2016 Technical Preview","pos":[21682,21737]},{"content":"Evaluated only if SID Filtering is used.","pos":[21741,21781]},{"content":"Evaluated only on cross-forest trusts having TRUST<ph id=\"ph1\">\\_</ph>ATTRIBUTE<ph id=\"ph2\">\\_</ph>FOREST<ph id=\"ph3\">\\_</ph>TRANSITIVE.","pos":[21785,21867]},{"content":"Can be set only if the forest and the trusted forest are running in a forest functional level of DS<ph id=\"ph1\">\\_</ph>BEHAVIOR<ph id=\"ph2\">\\_</ph>WINTHRESHOLD or greater.","pos":[21871,22006]},{"pos":[22336,22488],"content":"<bpt id=\"p1\">**</bpt>SID Filtering<ept id=\"p1\">**</ept> <ph id=\"ph1\">\\[</ph>Type = UnicodeString<ph id=\"ph2\">\\]</ph>: <bpt id=\"p2\">[</bpt>SID Filtering<ept id=\"p2\">](https://technet.microsoft.com/en-us/library/cc772633(v=ws.10).aspx)</ept> state for the new trust:"},{"content":"Enabled","pos":[22498,22505]},{"content":"Disabled","pos":[22515,22523]},{"pos":[22533,22617],"content":"If this attribute was not changed, then it will have “<bpt id=\"p1\">**</bpt><ph id=\"ph1\">-</ph><ept id=\"p1\">**</ept>“ value or its old value."},{"content":"Security Monitoring Recommendations","pos":[22622,22657]},{"content":"For 4716(S): Trusted domain information was modified.","pos":[22659,22712]},{"content":"Any changes in Active Directory domain trust settings must be monitored and alerts should be triggered.","pos":[22718,22821]},{"content":"If this change was not planned, investigate the reason for the change.","pos":[22822,22892]}],"content":"---\ntitle: 4716(S) Trusted domain information was modified. (Windows 10)\ndescription: Describes security event 4716(S) Trusted domain information was modified.\nms.pagetype: security\nms.prod: w10\nms.mktglfcycl: deploy\nms.sitesec: library\nauthor: Mir0sh\n---\n\n# 4716(S): Trusted domain information was modified.\n\n**Applies to**\n-   Windows 10\n-   Windows Server 2016\n\n\n<img src=\"images/event-4716.png\" alt=\"Event 4716 illustration\" width=\"449\" height=\"489\" hspace=\"10\" align=\"left\" />\n\n***Subcategory:***&nbsp;[Audit Authentication Policy Change](audit-authentication-policy-change.md)\n\n***Event Description:***\n\nThis event generates when the trust was modified.\n\nThis event is generated only on domain controllers.\n\n> **Note**&nbsp;&nbsp;For recommendations, see [Security Monitoring Recommendations](#security-monitoring-recommendations) for this event.\n\n<br clear=\"all\">\n\n***Event XML:***\n```\n- <Event xmlns=\"http://schemas.microsoft.com/win/2004/08/events/event\">\n- <System>\n <Provider Name=\"Microsoft-Windows-Security-Auditing\" Guid=\"{54849625-5478-4994-A5BA-3E3B0328C30D}\" /> \n <EventID>4716</EventID> \n <Version>0</Version> \n <Level>0</Level> \n <Task>13569</Task> \n <Opcode>0</Opcode> \n <Keywords>0x8020000000000000</Keywords> \n <TimeCreated SystemTime=\"2015-10-01T22:55:54.560735500Z\" /> \n <EventRecordID>1049763</EventRecordID> \n <Correlation /> \n <Execution ProcessID=\"500\" ThreadID=\"4920\" /> \n <Channel>Security</Channel> \n <Computer>DC01.contoso.local</Computer> \n <Security /> \n </System>\n- <EventData>\n <Data Name=\"SubjectUserSid\">S-1-5-21-3457937927-2839227994-823803824-1104</Data> \n <Data Name=\"SubjectUserName\">dadmin</Data> \n <Data Name=\"SubjectDomainName\">CONTOSO</Data> \n <Data Name=\"SubjectLogonId\">0x138eb0</Data> \n <Data Name=\"DomainName\">-</Data> \n <Data Name=\"DomainSid\">S-1-5-21-2226861337-2836268956-2433141405</Data> \n <Data Name=\"TdoType\">2</Data> \n <Data Name=\"TdoDirection\">3</Data> \n <Data Name=\"TdoAttributes\">32</Data> \n <Data Name=\"SidFilteringEnabled\">-</Data> \n </EventData>\n </Event>\n\n```\n\n***Required Server Roles:*** Active Directory domain controller.\n\n***Minimum OS Version:*** Windows Server 2008.\n\n***Event Versions:*** 0.\n\n***Field Descriptions:***\n\n**Subject:**\n\n-   **Security ID** \\[Type = SID\\]**:** SID of account that requested the “modify domain trust settings” operation. Event Viewer automatically tries to resolve SIDs and show the account name. If the SID cannot be resolved, you will see the source data in the event.\n\n> **Note**&nbsp;&nbsp;A **security identifier (SID)** is a unique value of variable length used to identify a trustee (security principal). Each account has a unique SID that is issued by an authority, such as an Active Directory domain controller, and stored in a security database. Each time a user logs on, the system retrieves the SID for that user from the database and places it in the access token for that user. The system uses the SID in the access token to identify the user in all subsequent interactions with Windows security. When a SID has been used as the unique identifier for a user or group, it cannot ever be used again to identify another user or group. For more information about SIDs, see [Security identifiers](security-identifiers.md).\n\n-   **Account Name** \\[Type = UnicodeString\\]**:** the name of the account that requested the “modify domain trust settings” operation.\n\n-   **Account Domain** \\[Type = UnicodeString\\]**:** subject’s domain or computer name. Formats vary, and include the following:\n\n    -   Domain NETBIOS name example: CONTOSO\n\n    -   Lowercase full domain name: contoso.local\n\n    -   Uppercase full domain name: CONTOSO.LOCAL\n\n    -   For some [well-known security principals](https://support.microsoft.com/en-us/kb/243330), such as LOCAL SERVICE or ANONYMOUS LOGON, the value of this field is “NT AUTHORITY”.\n\n    -   For local user accounts, this field will contain the name of the computer or device that this account belongs to, for example: “Win81”.\n\n-   **Logon ID** \\[Type = HexInt64\\]**:** hexadecimal value that can help you correlate this event with recent events that might contain the same Logon ID, for example, “[4624](event-4624.md): An account was successfully logged on.”\n\n**Trusted Domain:**\n\n-   **Domain Name** \\[Type = UnicodeString\\]**:** the name of changed trusted domain. If this attribute was not changed, then it will have “**-**“ value.\n\n-   **Domain ID** \\[Type = SID\\]**:** SID of changed trusted domain. Event Viewer automatically tries to resolve SIDs and show the account name. If the SID cannot be resolved, you will see the source data in the event.\n\n**New Trust Information:**\n\n-   **Trust Type** \\[Type = UInt32\\]**:** the type of new trust. If this attribute was not changed, then it will have “**-**“ value or its old value. The following table contains possible values for this field:\n\n| Value | Attribute Value        | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |\n|-------|------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| 1     | TRUST\\_TYPE\\_DOWNLEVEL | The domain controller of the trusted domain is a computer running an operating system earlier than Windows 2000.                                                                                                                                                                                                                                                                                                                                                                                                                           |\n| 2     | TRUST\\_TYPE\\_UPLEVEL   | The domain controller of the trusted domain is a computer running Windows 2000 or later.                                                                                                                                                                                                                                                                                                                                                                                                                                                   |\n| 3     | TRUST\\_TYPE\\_MIT       | The trusted domain is running a non-Windows, RFC4120-compliant Kerberos distribution. This type of trust is distinguished in that (1) a [SID](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_83f2020d-0804-4840-a5ac-e06439d50f8d) is not required for the [TDO](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_f2ceef4e-999b-4276-84cd-2e2829de5fc4), and (2) the default key types include the DES-CBC and DES-CRC encryption types (see [\\[RFC4120\\]](http://go.microsoft.com/fwlink/?LinkId=90458) section 8.1). |\n| 4     | TRUST\\_TYPE\\_DCE       | The trusted domain is a DCE realm. Historical reference, this value is not used in Windows.                                                                                                                                                                                                                                                                                                                                                                                                                                                |\n\n-   **Trust Direction** \\[Type = UInt32\\]**:** the direction of new trust. If this attribute was not changed, then it will have “**-**“ value or its old value. The following table contains possible values for this field:\n\n| Value | Attribute Value                 | Description                                                                                                 |\n|-------|---------------------------------|-------------------------------------------------------------------------------------------------------------|\n| 0     | TRUST\\_DIRECTION\\_DISABLED      | The trust relationship exists, but it has been disabled.                                                    |\n| 1     | TRUST\\_DIRECTION\\_INBOUND       | The trusted domain trusts the primary domain to perform operations such as name lookups and authentication. |\n| 2     | TRUST\\_DIRECTION\\_OUTBOUND      | The primary domain trusts the trusted domain to perform operations such as name lookups and authentication. |\n| 3     | TRUST\\_DIRECTION\\_BIDIRECTIONAL | Both domains trust one another for operations such as name lookups and authentication.                      |\n\n-   **Trust Attributes** \\[Type = UInt32\\]**:** the decimal value of attributes for new trust. You need convert decimal value to hexadecimal and find it in the table below. If this attribute was not changed, then it will have “**-**“ value or its old value. The following table contains possible values for this field:\n\n| Value | Attribute Value                                            | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n|-------|------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| 0x1   | TRUST\\_ATTRIBUTE\\_NON\\_TRANSITIVE                          | If this bit is set, then the trust cannot be used transitively. For example, if domain A trusts domain B, which in turn trusts domain C, and the A&lt;--&gt;B trust has this attribute set, then a client in domain A cannot authenticate to a server in domain C over the A&lt;--&gt;B&lt;--&gt;C trust linkage.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |\n| 0x2   | TRUST\\_ATTRIBUTE\\_UPLEVEL\\_ONLY                            | If this bit is set in the attribute, then only Windows 2000 operating system and newer clients may use the trust link. [Netlogon](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_70771a5a-04a3-447d-981b-e03098808c32) does not consume [trust objects](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_e81f6436-01d2-4311-93a4-4316bb67eabd) that have this flag set.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n| 0x4   | TRUST\\_ATTRIBUTE\\_QUARANTINED\\_DOMAIN                      | If this bit is set, the trusted domain is quarantined and is subject to the rules of [SID](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_83f2020d-0804-4840-a5ac-e06439d50f8d) Filtering as described in [\\[MS-PAC\\]](https://msdn.microsoft.com/en-us/library/cc237917.aspx) section [4.1.2.2](https://msdn.microsoft.com/en-us/library/cc237940.aspx).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |\n| 0x8   | TRUST\\_ATTRIBUTE\\_FOREST\\_TRANSITIVE                       | If this bit is set, the trust link is a [cross-forest trust](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_86f3dbf2-338f-462e-8c5b-3c8e05798dbc) [\\[MS-KILE\\]](https://msdn.microsoft.com/en-us/library/cc233855.aspx) between the root domains of two [forests](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_fd104241-4fb3-457c-b2c4-e0c18bb20b62), both of which are running in a [forest functional level](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_b3240417-ca43-4901-90ec-fde55b32b3b8) of DS\\_BEHAVIOR\\_WIN2003 or greater.<br>Only evaluated on Windows Server 2003 operating system, Windows Server 2008 operating system, Windows Server 2008 R2 operating system, Windows Server 2012 operating system, Windows Server 2012 R2 operating system, and Windows Server 2016 Technical Preview operating system.<br>Can only be set if forest and trusted forest are running in a forest functional level of DS\\_BEHAVIOR\\_WIN2003 or greater.                   |\n| 0x10  | TRUST\\_ATTRIBUTE\\_CROSS\\_ORGANIZATION                      | If this bit is set, then the trust is to a domain or forest that is not part of the [organization](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_6fae7775-5232-4206-b452-f298546ab54f). The behavior controlled by this bit is explained in [\\[MS-KILE\\]](https://msdn.microsoft.com/en-us/library/cc233855.aspx) section [3.3.5.7.5](https://msdn.microsoft.com/en-us/library/cc233949.aspx) and [\\[MS-APDS\\]](https://msdn.microsoft.com/en-us/library/cc223948.aspx) section [3.1.5](https://msdn.microsoft.com/en-us/library/cc223991.aspx).<br>Only evaluated on Windows Server 2003, Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016 Technical Preview.<br>Can only be set if forest and trusted forest are running in a forest functional level of DS\\_BEHAVIOR\\_WIN2003 or greater.                                                                                                                                        |\n| 0x20  | TRUST\\_ATTRIBUTE\\_WITHIN\\_FOREST                           | If this bit is set, then the trusted domain is within the same forest.<br>Only evaluated on Windows Server 2003, Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016 Technical Preview.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n| 0x40  | TRUST\\_ATTRIBUTE\\_TREAT\\_AS\\_EXTERNAL                      | If this bit is set, then a cross-forest trust to a domain is to be treated as an external trust for the purposes of SID Filtering. Cross-forest trusts are more stringently [filtered](https://msdn.microsoft.com/en-us/library/cc223126.aspx#gt_ffbe7b55-8e84-4f41-a18d-fc29191a4cda) than external trusts. This attribute relaxes those cross-forest trusts to be equivalent to external trusts. For more information on how each trust type is filtered, see [\\[MS-PAC\\]](https://msdn.microsoft.com/en-us/library/cc237917.aspx) section 4.1.2.2.<br>Only evaluated on Windows Server 2003, Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016 Technical Preview.<br>Only evaluated if SID Filtering is used.<br>Only evaluated on cross-forest trusts having TRUST\\_ATTRIBUTE\\_FOREST\\_TRANSITIVE.<br>Can only be set if forest and trusted forest are running in a forest functional level of DS\\_BEHAVIOR\\_WIN2003 or greater. |\n| 0x80  | TRUST\\_ATTRIBUTE\\_USES\\_RC4\\_ENCRYPTION                    | This bit is set on trusts with the [trustType](https://msdn.microsoft.com/en-us/library/cc220955.aspx) set to TRUST\\_TYPE\\_MIT, which are capable of using RC4 keys. Historically, MIT Kerberos distributions supported only DES and 3DES keys ([\\[RFC4120\\]](http://go.microsoft.com/fwlink/?LinkId=90458), [\\[RFC3961\\]](http://go.microsoft.com/fwlink/?LinkId=90450)). MIT 1.4.1 adopted the RC4HMAC encryption type common to Windows 2000 [\\[MS-KILE\\]](https://msdn.microsoft.com/en-us/library/cc233855.aspx), so trusted domains deploying later versions of the MIT distribution required this bit. For more information, see \"Keys and Trusts\", section [6.1.6.9.1](https://msdn.microsoft.com/en-us/library/cc223782.aspx).<br>Only evaluated on TRUST\\_TYPE\\_MIT                                                                                                                                                                                                                                          |\n| 0x200 | TRUST\\_ATTRIBUTE\\_CROSS\\_ORGANIZATION\\_NO\\_TGT\\_DELEGATION | If this bit is set, tickets granted under this trust MUST NOT be trusted for delegation. The behavior controlled by this bit is as specified in [\\[MS-KILE\\]](https://msdn.microsoft.com/en-us/library/cc233855.aspx) section 3.3.5.7.5.<br>Only supported on Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016 Technical Preview.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n| 0x400 | TRUST\\_ATTRIBUTE\\_PIM\\_TRUST                               | If this bit and the TATE bit are set, then a cross-forest trust to a domain is to be treated as Privileged Identity Management trust for the purposes of SID Filtering. For more information on how each trust type is filtered, see [\\[MS-PAC\\]](https://msdn.microsoft.com/en-us/library/cc237917.aspx) section 4.1.2.2.<br>Evaluated only on Windows Server 2016 Technical Preview<br>Evaluated only if SID Filtering is used.<br>Evaluated only on cross-forest trusts having TRUST\\_ATTRIBUTE\\_FOREST\\_TRANSITIVE.<br>Can be set only if the forest and the trusted forest are running in a forest functional level of DS\\_BEHAVIOR\\_WINTHRESHOLD or greater.                                                                                                                                                                                                                                                                                                                                   |\n\n-   **SID Filtering** \\[Type = UnicodeString\\]: [SID Filtering](https://technet.microsoft.com/en-us/library/cc772633(v=ws.10).aspx) state for the new trust:\n\n    -   Enabled\n\n    -   Disabled\n\n        If this attribute was not changed, then it will have “**-**“ value or its old value.\n\n## Security Monitoring Recommendations\n\nFor 4716(S): Trusted domain information was modified.\n\n-   Any changes in Active Directory domain trust settings must be monitored and alerts should be triggered. If this change was not planned, investigate the reason for the change.\n\n"}