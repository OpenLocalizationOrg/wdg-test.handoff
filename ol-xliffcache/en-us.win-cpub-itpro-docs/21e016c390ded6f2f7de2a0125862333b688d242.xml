{"nodes":[{"content":"What's new in security auditing (Windows 10)","pos":[11,55]},{"content":"Security auditing is one of the most powerful tools that you can use to maintain the integrity of your system.","pos":[69,179]},{"content":"What's new in security auditing?","pos":[344,376]},{"content":"Applies to","pos":[379,389]},{"content":"Windows 10","pos":[396,406]},{"content":"Windows 10 Mobile","pos":[411,428]},{"content":"Security auditing is one of the most powerful tools that you can use to maintain the integrity of your system.","pos":[430,540]},{"content":"As part of your overall security strategy, you should determine the level of auditing that is appropriate for your environment.","pos":[541,668]},{"content":"Auditing should identify attacks (successful or not) that pose a threat to your network, and attacks against resources that you have determined to be valuable in your risk assessment.","pos":[669,852]},{"content":"New features in Windows 10, version 1511","pos":[857,897]},{"pos":[903,1138],"content":"The <bpt id=\"p1\">[</bpt>WindowsSecurityAuditing<ept id=\"p1\">](http://go.microsoft.com/fwlink/p/?LinkId=690517)</ept> and <bpt id=\"p2\">[</bpt>Reporting<ept id=\"p2\">](http://go.microsoft.com/fwlink/p/?LinkId=690525)</ept> configuration service providers allow you to add security audit policies to mobile devices."},{"content":"New features in Windows 10","pos":[1143,1169]},{"content":"In Windows 10, security auditing has added some improvements:","pos":[1171,1232]},{"content":"New audit subcategories","pos":[1238,1261]},{"content":"More info added to existing audit events","pos":[1287,1327]},{"pos":[1387,1410],"content":"New audit subcategories"},{"content":"In Windows 10, two new audit subcategories were added to the Advanced Audit Policy Configuration to provide greater granularity in audit events:","pos":[1412,1556]},{"pos":[1561,2522],"content":"[Audit Group Membership](../keep-secure/audit-group-membership.md) Found in the Logon/Logoff audit category, the Audit Group Membership subcategory allows you to audit the group membership information in a user's logon token. Events in this subcategory are generated when group memberships are enumerated or queried on the PC where the logon session was created. For an interactive logon, the security audit event is generated on the PC that the user logged on to. For a network logon, such as accessing a shared folder on the network, the security audit event is generated on the PC hosting the resource.\nWhen this setting is configured, one or more security audit events are generated for each successful logon. You must also enable the **Audit Logon** setting under **Advanced Audit Policy Configuration\\\\System Audit Policies\\\\Logon/Logoff**. Multiple events are generated if the group membership information cannot fit in a single security audit event.","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">[</bpt>Audit Group Membership<ept id=\"p1\">](../keep-secure/audit-group-membership.md)</ept> Found in the Logon/Logoff audit category, the Audit Group Membership subcategory allows you to audit the group membership information in a user's logon token.","pos":[0,225]},{"content":"Events in this subcategory are generated when group memberships are enumerated or queried on the PC where the logon session was created.","pos":[226,362]},{"content":"For an interactive logon, the security audit event is generated on the PC that the user logged on to.","pos":[363,464]},{"content":"For a network logon, such as accessing a shared folder on the network, the security audit event is generated on the PC hosting the resource.","pos":[465,605]},{"content":"When this setting is configured, one or more security audit events are generated for each successful logon.","pos":[606,713]},{"content":"You must also enable the <bpt id=\"p1\">**</bpt>Audit Logon<ept id=\"p1\">**</ept> setting under <bpt id=\"p2\">**</bpt>Advanced Audit Policy Configuration<ph id=\"ph1\">\\\\</ph>System Audit Policies<ph id=\"ph2\">\\\\</ph>Logon/Logoff<ept id=\"p2\">**</ept>.","pos":[714,846]},{"content":"Multiple events are generated if the group membership information cannot fit in a single security audit event.","pos":[847,957]}]},{"pos":[2527,3101],"content":"[Audit PNP Activity](../keep-secure/audit-pnp-activity.md) Found in the Detailed Tracking category, the Audit PNP Activity subcategory allows you to audit when plug and play detects an external device.\nOnly Success audits are recorded for this category. If you do not configure this policy setting, no audit event is generated when an external device is detected by plug and play.\nA PnP audit event can be used to track down changes in system hardware and will be logged on the PC where the change took place. A list of hardware vendor IDs are included in the event.","leadings":["","    ","    "],"nodes":[{"content":"<bpt id=\"p1\">[</bpt>Audit PNP Activity<ept id=\"p1\">](../keep-secure/audit-pnp-activity.md)</ept> Found in the Detailed Tracking category, the Audit PNP Activity subcategory allows you to audit when plug and play detects an external device.","pos":[0,201]},{"content":"Only Success audits are recorded for this category.","pos":[202,253]},{"content":"If you do not configure this policy setting, no audit event is generated when an external device is detected by plug and play.","pos":[254,380]},{"content":"A PnP audit event can be used to track down changes in system hardware and will be logged on the PC where the change took place.","pos":[381,509]},{"content":"A list of hardware vendor IDs are included in the event.","pos":[510,566]}]},{"pos":[3141,3181],"content":"More info added to existing audit events"},{"content":"With Windows 10, we've added more info to existing audit events to make it easier for you to put together a full audit trail and come away with the information you need to protect your enterprise.","pos":[3183,3379]},{"content":"Improvements were made to the following audit events:","pos":[3380,3433]},{"content":"Changed the kernel default audit policy","pos":[3439,3478]},{"content":"Added a default process SACL to LSASS.exe","pos":[3497,3538]},{"content":"Added new fields in the logon event","pos":[3558,3593]},{"content":"Added new fields in the process creation event","pos":[3613,3659]},{"content":"Added new Security Account Manager events","pos":[3679,3720]},{"content":"Added new BCD events","pos":[3738,3758]},{"content":"Added new PNP events","pos":[3776,3796]},{"pos":[3844,3883],"content":"Changed the kernel default audit policy"},{"content":"In previous releases, the kernel depended on the Local Security Authority (LSA) to retrieve info in some of its events.","pos":[3885,4004]},{"content":"In Windows 10, the process creation events audit policy is automatically enabled until an actual audit policy is received from LSA.","pos":[4005,4136]},{"content":"This results in better auditing of services that may start before LSA starts.","pos":[4137,4214]},{"pos":[4251,4292],"content":"Added a default process SACL to LSASS.exe"},{"content":"In Windows 10, a default process SACL was added to LSASS.exe to log processes attempting to access LSASS.exe.","pos":[4294,4403]},{"content":"The SACL is L\"S:(AU;SAFA;0x0010;;;WD)\".","pos":[4404,4443]},{"content":"You can enable this under <bpt id=\"p1\">**</bpt>Advanced Audit Policy Configuration<ph id=\"ph1\">\\\\</ph>Object Access<ph id=\"ph2\">\\\\</ph>Audit Kernel Object<ept id=\"p1\">**</ept>.","pos":[4444,4546]},{"content":"This can help identify attacks that steal credentials from the memory of a process.","pos":[4547,4630]},{"pos":[4667,4696],"content":"New fields in the logon event"},{"content":"The logon event ID 4624 has been updated to include more verbose information to make them easier to analyze.","pos":[4698,4806]},{"content":"The following fields have been added to event 4624:","pos":[4807,4858]},{"pos":[4863,5015],"content":"**MachineLogon** String: yes or no\nIf the account that logged into the PC is a computer account, this field will be yes. Otherwise, the field is no.","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">**</bpt>MachineLogon<ept id=\"p1\">**</ept> String: yes or no If the account that logged into the PC is a computer account, this field will be yes.","pos":[0,120]},{"content":"Otherwise, the field is no.","pos":[121,148]}]},{"pos":[5020,5289],"content":"**ElevatedToken** String: yes or no\nIf the account that logged into the PC is an administrative logon, this field will be yes. Otherwise, the field is no. Additionally, if this is part of a split token, the linked login ID (LSAP\\_LOGON\\_SESSION) will also be shown.","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">**</bpt>ElevatedToken<ept id=\"p1\">**</ept> String: yes or no If the account that logged into the PC is an administrative logon, this field will be yes.","pos":[0,126]},{"content":"Otherwise, the field is no.","pos":[127,154]},{"content":"Additionally, if this is part of a split token, the linked login ID (LSAP<ph id=\"ph1\">\\_</ph>LOGON<ph id=\"ph2\">\\_</ph>SESSION) will also be shown.","pos":[155,265]}]},{"pos":[5294,5474],"content":"<bpt id=\"p1\">**</bpt>TargetOutboundUserName<ept id=\"p1\">**</ept> String <bpt id=\"p2\">**</bpt>TargetOutboundUserDomain<ept id=\"p2\">**</ept> String The username and domain of the identity that was created by the LogonUser method for outbound traffic.","leadings":["","    ","    "]},{"pos":[5479,5632],"content":"**VirtualAccount** String: yes or no\nIf the account that logged into the PC is a virtual account, this field will be yes. Otherwise, the field is no.","leadings":["","    "],"nodes":[{"content":"<bpt id=\"p1\">**</bpt>VirtualAccount<ept id=\"p1\">**</ept> String: yes or no If the account that logged into the PC is a virtual account, this field will be yes.","pos":[0,121]},{"content":"Otherwise, the field is no.","pos":[122,149]}]},{"pos":[5637,5716],"content":"<bpt id=\"p1\">**</bpt>GroupMembership<ept id=\"p1\">**</ept> String A list of all of the groups in the user's token.","leadings":["","    "]},{"pos":[5721,6058],"content":"**RestrictedAdminMode** String: yes or no\nIf the user logs into the PC in restricted admin mode with Remote Desktop, this field will be yes.\nFor more info on restricted admin mode, see [Restricted Admin mode for RDP](http://blogs.technet.com/b/kfalde/archive/2013/08/14/restricted-admin-mode-for-rdp-in-windows-8-1-2012-r2.aspx).","leadings":["","    ","    "],"nodes":[{"content":"<bpt id=\"p1\">**</bpt>RestrictedAdminMode<ept id=\"p1\">**</ept> String: yes or no If the user logs into the PC in restricted admin mode with Remote Desktop, this field will be yes.","pos":[0,140]},{"content":"For more info on restricted admin mode, see <bpt id=\"p1\">[</bpt>Restricted Admin mode for RDP<ept id=\"p1\">](http://blogs.technet.com/b/kfalde/archive/2013/08/14/restricted-admin-mode-for-rdp-in-windows-8-1-2012-r2.aspx)</ept>.","pos":[141,329]}]},{"pos":[6097,6137],"content":"New fields in the process creation event"},{"content":"The logon event ID 4688 has been updated to include more verbose information to make them easier to analyze.","pos":[6139,6247]},{"content":"The following fields have been added to event 4688:","pos":[6248,6299]},{"pos":[6304,6365],"content":"<bpt id=\"p1\">**</bpt>TargetUserSid<ept id=\"p1\">**</ept> String The SID of the target principal.","leadings":["","    "]},{"pos":[6370,6436],"content":"<bpt id=\"p1\">**</bpt>TargetUserName<ept id=\"p1\">**</ept> String The account name of the target user.","leadings":["","    "]},{"pos":[6441,6504],"content":"<bpt id=\"p1\">**</bpt>TargetDomainName<ept id=\"p1\">**</ept> String The domain of the target user..","leadings":["","    "]},{"pos":[6509,6570],"content":"<bpt id=\"p1\">**</bpt>TargetLogonId<ept id=\"p1\">**</ept> String The logon ID of the target user.","leadings":["","    "]},{"pos":[6575,6640],"content":"<bpt id=\"p1\">**</bpt>ParentProcessName<ept id=\"p1\">**</ept> String The name of the creator process.","leadings":["","    "]},{"pos":[6645,6758],"content":"<bpt id=\"p1\">**</bpt>ParentProcessId<ept id=\"p1\">**</ept> String A pointer to the actual parent process if it's different from the creator process.","leadings":["","    "]},{"pos":[6793,6828],"content":"New Security Account Manager events"},{"content":"In Windows 10, new SAM events were added to cover SAM APIs that perform read/query operations.","pos":[6830,6924]},{"content":"In previous versions of Windows, only write operations were audited.","pos":[6925,6993]},{"content":"The new events are event ID 4798 and event ID 4799.","pos":[6994,7045]},{"content":"The following APIs are now audited:","pos":[7046,7081]},{"content":"SamrEnumerateGroupsInDomain","pos":[7086,7113]},{"content":"SamrEnumerateUsersInDomain","pos":[7118,7144]},{"content":"SamrEnumerateAliasesInDomain","pos":[7149,7177]},{"content":"SamrGetAliasMembership","pos":[7182,7204]},{"content":"SamrLookupNamesInDomain","pos":[7209,7232]},{"content":"SamrLookupIdsInDomain","pos":[7237,7258]},{"content":"SamrQueryInformationUser","pos":[7263,7287]},{"content":"SamrQueryInformationGroup","pos":[7292,7317]},{"content":"SamrQueryInformationUserAlias","pos":[7322,7351]},{"content":"SamrGetMembersInGroup","pos":[7356,7377]},{"content":"SamrGetMembersInAlias","pos":[7382,7403]},{"content":"SamrGetUserDomainPasswordInformation","pos":[7408,7444]},{"pos":[7479,7493],"content":"New BCD events"},{"content":"Event ID 4826 has been added to track the following changes to the Boot Configuration Database (BCD):","pos":[7495,7596]},{"content":"DEP/NEX settings","pos":[7601,7617]},{"content":"Test signing","pos":[7622,7634]},{"content":"PCAT SB simulation","pos":[7639,7657]},{"content":"Debug","pos":[7662,7667]},{"content":"Boot debug","pos":[7672,7682]},{"content":"Integrity Services","pos":[7687,7705]},{"content":"Disable Winload debugging menu","pos":[7710,7740]},{"pos":[7775,7789],"content":"New PNP events"},{"content":"Event ID 6416 has been added to track when an external device is detected through Plug and Play.","pos":[7791,7887]},{"content":"One important scenario is if an external device that contains malware is inserted into a high-value machine that doesn’t expect this type of action, such as a domain controller.","pos":[7888,8065]},{"content":"<bpt id=\"p1\">[</bpt>Learn how to manage your security audit policies within your organization<ept id=\"p1\">](../keep-secure/security-auditing-overview.md)</ept>.","pos":[8066,8188]}],"content":"---\ntitle: What's new in security auditing (Windows 10)\ndescription: Security auditing is one of the most powerful tools that you can use to maintain the integrity of your system.\nms.assetid: CB35A02E-5C66-449D-8C90-7B73C636F67B\nms.prod: w10\nms.mktglfcycl: explore\nms.sitesec: library\nauthor: brianlic-msft\nms.pagetype: security, mobile\n---\n\n# What's new in security auditing?\n**Applies to**\n-   Windows 10\n-   Windows 10 Mobile\n\nSecurity auditing is one of the most powerful tools that you can use to maintain the integrity of your system. As part of your overall security strategy, you should determine the level of auditing that is appropriate for your environment. Auditing should identify attacks (successful or not) that pose a threat to your network, and attacks against resources that you have determined to be valuable in your risk assessment.\n\n## New features in Windows 10, version 1511\n\n-   The [WindowsSecurityAuditing](http://go.microsoft.com/fwlink/p/?LinkId=690517) and [Reporting](http://go.microsoft.com/fwlink/p/?LinkId=690525) configuration service providers allow you to add security audit policies to mobile devices.\n\n## New features in Windows 10\n\nIn Windows 10, security auditing has added some improvements:\n-   [New audit subcategories](#bkmk-auditsubcat)\n-   [More info added to existing audit events](#bkmk-moreinfo)\n\n### <a href=\"\" id=\"bkmk-auditsubcat\"></a>New audit subcategories\n\nIn Windows 10, two new audit subcategories were added to the Advanced Audit Policy Configuration to provide greater granularity in audit events:\n-   [Audit Group Membership](../keep-secure/audit-group-membership.md) Found in the Logon/Logoff audit category, the Audit Group Membership subcategory allows you to audit the group membership information in a user's logon token. Events in this subcategory are generated when group memberships are enumerated or queried on the PC where the logon session was created. For an interactive logon, the security audit event is generated on the PC that the user logged on to. For a network logon, such as accessing a shared folder on the network, the security audit event is generated on the PC hosting the resource.\n    When this setting is configured, one or more security audit events are generated for each successful logon. You must also enable the **Audit Logon** setting under **Advanced Audit Policy Configuration\\\\System Audit Policies\\\\Logon/Logoff**. Multiple events are generated if the group membership information cannot fit in a single security audit event.\n-   [Audit PNP Activity](../keep-secure/audit-pnp-activity.md) Found in the Detailed Tracking category, the Audit PNP Activity subcategory allows you to audit when plug and play detects an external device.\n    Only Success audits are recorded for this category. If you do not configure this policy setting, no audit event is generated when an external device is detected by plug and play.\n    A PnP audit event can be used to track down changes in system hardware and will be logged on the PC where the change took place. A list of hardware vendor IDs are included in the event.\n\n### <a href=\"\" id=\"bkmk-moreinfo\"></a>More info added to existing audit events\n\nWith Windows 10, we've added more info to existing audit events to make it easier for you to put together a full audit trail and come away with the information you need to protect your enterprise. Improvements were made to the following audit events:\n-   [Changed the kernel default audit policy](#bkmk-kdal)\n-   [Added a default process SACL to LSASS.exe](#bkmk-lsass)\n-   [Added new fields in the logon event](#bkmk-logon)\n-   [Added new fields in the process creation event](#bkmk-logon)\n-   [Added new Security Account Manager events](#bkmk-sam)\n-   [Added new BCD events](#bkmk-bcd)\n-   [Added new PNP events](#bkmk-pnp)\n\n### <a href=\"\" id=\"bkmk-kdal\"></a>Changed the kernel default audit policy\n\nIn previous releases, the kernel depended on the Local Security Authority (LSA) to retrieve info in some of its events. In Windows 10, the process creation events audit policy is automatically enabled until an actual audit policy is received from LSA. This results in better auditing of services that may start before LSA starts.\n\n### <a href=\"\" id=\"bkmk-lsass\"></a>Added a default process SACL to LSASS.exe\n\nIn Windows 10, a default process SACL was added to LSASS.exe to log processes attempting to access LSASS.exe. The SACL is L\"S:(AU;SAFA;0x0010;;;WD)\". You can enable this under **Advanced Audit Policy Configuration\\\\Object Access\\\\Audit Kernel Object**.\nThis can help identify attacks that steal credentials from the memory of a process.\n\n### <a href=\"\" id=\"bkmk-logon\"></a>New fields in the logon event\n\nThe logon event ID 4624 has been updated to include more verbose information to make them easier to analyze. The following fields have been added to event 4624:\n1.  **MachineLogon** String: yes or no\n    If the account that logged into the PC is a computer account, this field will be yes. Otherwise, the field is no.\n2.  **ElevatedToken** String: yes or no\n    If the account that logged into the PC is an administrative logon, this field will be yes. Otherwise, the field is no. Additionally, if this is part of a split token, the linked login ID (LSAP\\_LOGON\\_SESSION) will also be shown.\n3.  **TargetOutboundUserName** String\n    **TargetOutboundUserDomain** String\n    The username and domain of the identity that was created by the LogonUser method for outbound traffic.\n4.  **VirtualAccount** String: yes or no\n    If the account that logged into the PC is a virtual account, this field will be yes. Otherwise, the field is no.\n5.  **GroupMembership** String\n    A list of all of the groups in the user's token.\n6.  **RestrictedAdminMode** String: yes or no\n    If the user logs into the PC in restricted admin mode with Remote Desktop, this field will be yes.\n    For more info on restricted admin mode, see [Restricted Admin mode for RDP](http://blogs.technet.com/b/kfalde/archive/2013/08/14/restricted-admin-mode-for-rdp-in-windows-8-1-2012-r2.aspx).\n\n### <a href=\"\" id=\"bkmk-process\"></a>New fields in the process creation event\n\nThe logon event ID 4688 has been updated to include more verbose information to make them easier to analyze. The following fields have been added to event 4688:\n1.  **TargetUserSid** String\n    The SID of the target principal.\n2.  **TargetUserName** String\n    The account name of the target user.\n3.  **TargetDomainName** String\n    The domain of the target user..\n4.  **TargetLogonId** String\n    The logon ID of the target user.\n5.  **ParentProcessName** String\n    The name of the creator process.\n6.  **ParentProcessId** String\n    A pointer to the actual parent process if it's different from the creator process.\n\n### <a href=\"\" id=\"bkmk-sam\"></a>New Security Account Manager events\n\nIn Windows 10, new SAM events were added to cover SAM APIs that perform read/query operations. In previous versions of Windows, only write operations were audited. The new events are event ID 4798 and event ID 4799. The following APIs are now audited:\n-   SamrEnumerateGroupsInDomain\n-   SamrEnumerateUsersInDomain\n-   SamrEnumerateAliasesInDomain\n-   SamrGetAliasMembership\n-   SamrLookupNamesInDomain\n-   SamrLookupIdsInDomain\n-   SamrQueryInformationUser\n-   SamrQueryInformationGroup\n-   SamrQueryInformationUserAlias\n-   SamrGetMembersInGroup\n-   SamrGetMembersInAlias\n-   SamrGetUserDomainPasswordInformation\n\n### <a href=\"\" id=\"bkmk-bcd\"></a>New BCD events\n\nEvent ID 4826 has been added to track the following changes to the Boot Configuration Database (BCD):\n-   DEP/NEX settings\n-   Test signing\n-   PCAT SB simulation\n-   Debug\n-   Boot debug\n-   Integrity Services\n-   Disable Winload debugging menu\n\n### <a href=\"\" id=\"bkmk-pnp\"></a>New PNP events\n\nEvent ID 6416 has been added to track when an external device is detected through Plug and Play. One important scenario is if an external device that contains malware is inserted into a high-value machine that doesn’t expect this type of action, such as a domain controller.\n[Learn how to manage your security audit policies within your organization](../keep-secure/security-auditing-overview.md).\n"}